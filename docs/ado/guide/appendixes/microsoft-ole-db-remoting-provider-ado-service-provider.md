---
title: Поставщик службы удаленного взаимодействия Microsoft OLE DB (поставщик служб ADO) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 11/08/2018
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- OLE DB remoting provider [ADO]
- providers [ADO], OLE DB remoting provider
- remoting provider [ADO]
ms.assetid: a4360ed4-b70f-4734-9041-4025d033346b
author: rothja
ms.author: jroth
ms.openlocfilehash: e3ad2ebe195bdcdf97548f040f3ef7dcc1fb1a38
ms.sourcegitcommit: 6037fb1f1a5ddd933017029eda5f5c281939100c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2020
ms.locfileid: "82761612"
---
# <a name="microsoft-ole-db-remoting-provider-overview"></a>Обзор поставщика удаленного взаимодействия Microsoft OLE DB
Поставщик удаленного взаимодействия Microsoft OLE DB позволяет локальному пользователю на клиентском компьютере запускать поставщики данных на удаленном компьютере. Укажите параметры поставщика данных для удаленного компьютера, как если бы вы были локальным пользователем на удаленном компьютере. Затем укажите параметры, используемые поставщиком удаленного взаимодействия для доступа к удаленному компьютеру. Затем можно получить доступ к удаленному компьютеру так, как если бы вы были локальным пользователем.

> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, компоненты RDS больше не включены в операционную систему Windows (Дополнительные сведения см. в статье о совместимости Windows 8 и [Windows server 2012 Cookbook](https://www.microsoft.com/download/details.aspx?id=27416) ). Клиентские компоненты RDS будут удалены в следующей версии Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие RDS, должны переноситься в [службу данных WCF](https://go.microsoft.com/fwlink/?LinkId=199565).

## <a name="provider-keyword"></a>Ключевое слово Provider
 Чтобы вызвать поставщик удаленного взаимодействия OLE DB, укажите в строке подключения следующее ключевое слово и значение. (Обратите внимание на пустое пространство в имени поставщика.)

```vb
"Provider=MS Remote"
```

## <a name="additional-keywords"></a>Дополнительные ключевые слова
 При вызове этого поставщика услуг важны следующие дополнительные ключевые слова.

|Ключевое слово|Описание|
|-------------|-----------------|
|**Источник данных**|Задает имя удаленного источника данных. Он передается поставщику удаленного взаимодействия OLE DB для обработки.<br /><br /> Это ключевое слово эквивалентно [RDS. ](../../../ado/reference/rds-api/datacontrol-object-rds.md)Свойство [соединения](../../../ado/reference/rds-api/connect-property-rds.md) объекта элемента управления DataObject.|

## <a name="dynamic-properties"></a>Динамические свойства
 При вызове этого поставщика услуг в коллекцию [свойств](../../../ado/reference/ado-api/properties-collection-ado.md) объекта [Connection](../../../ado/reference/ado-api/connection-object-ado.md)добавляются следующие динамические свойства.

|Имя динамического свойства|Описание|
|---------------------------|-----------------|
|**дфмоде**|Указывает режим фактической модели. Строка, указывающая требуемую версию объекта [фактов](../../../ado/reference/rds-api/datafactory-object-rdsserver.md) на сервере. Задайте это свойство перед открытием соединения, чтобы запросить определенную **версию этого объекта.** Если запрашиваемая версия недоступна, будет предпринята попытка использовать предыдущую версию. Если предыдущая версия отсутствует, возникнет ошибка. Если **дфмоде** меньше доступной версии, возникнет ошибка. Это свойство доступно только для чтения после установки соединения.<br /><br /> Может быть одним из следующих допустимых строковых значений:<br /><br /> -"25" — версия 2,5 (по умолчанию)<br />-"21" — версия 2,1<br />-"20" — версия 2,0<br />-"15" — версия 1,5|
|**Свойства команды**|Указывает значения, которые будут добавлены к строке свойств команды (набора строк), отправляемых на сервер удаленным поставщиком MS. Значение по умолчанию для этой строки — vt_empty.|
|**Текущий Дфмоде**|Указывает фактический номер версии для **факта** на сервере. Проверьте это свойство, чтобы узнать, была ли учтена версия, запрошенная в свойстве **дфмоде** .<br /><br /> Может быть одним из следующих допустимых длинных целочисленных значений:<br /><br /> -25-версия 2,5 (по умолчанию)<br />-21-версия 2,1<br />-20-версия 2,0<br />-15-версия 1,5<br /><br /> Добавление "Дфмоде = 20;" в строку подключения при использовании поставщика **мсремоте** может повысить производительность сервера при обновлении данных. При использовании этого параметра объект **фактического объекта RDSServer.** DataObject на сервере использует менее ресурсоемкий режим. Однако следующие функции недоступны в этой конфигурации:<br /><br /> — Использование параметризованных запросов.<br />— Получение сведений о параметрах или столбцах перед вызовом метода **EXECUTE** .<br />— Установка значения **true**для **обновлений Transact** .<br />— Получение состояния строки.<br />— Вызов метода **Resync** .<br />— Обновление (явно или автоматически) с помощью свойства повторной **синхронизации обновления** .<br />— Установка свойств **команды** или **набора записей** .<br />— С помощью **адкмдтабледирект**.|
|**Обработчик**|Указывает имя программы настройки на стороне сервера (или обработчика), которая расширяет функциональные возможности [RDSServer.](../../../ado/reference/rds-api/datafactory-object-rdsserver.md)данных и всех параметров, используемых обработчиком, разделенных запятыми (","). Значение типа **String**.|
|**Время ожидания в Интернете**|Указывает максимальное число миллисекунд ожидания запроса к серверу и с сервера. (Значение по умолчанию — 5 минут.)|
|**Удаленный поставщик**|Указывает имя поставщика данных, который будет использоваться на удаленном сервере.|
|**Удаленный сервер**|Указывает имя сервера и протокол связи, которые будут использоваться этим соединением. Это свойство эквивалентно [RDS. ](../../../ado/reference/rds-api/datacontrol-object-rds.md)Свойство [сервера](../../../ado/reference/rds-api/server-property-rds.md) объектов датаконтро.|
|**Обновления Transact**|При установке значения **true**это значение указывает, что при выполнении [UpdateBatch](../../../ado/reference/ado-api/updatebatch-method.md) на сервере он будет выполняться внутри транзакции. Значение по умолчанию для этого динамического свойства Boolean равно **false**.|

 Вы также можете задать динамические свойства, доступные для записи, указав их имена в качестве ключевых слов в строке подключения. Например, задайте для динамического свойства **время ожидания в Интернете** значение 5 секунд, указав следующее:

```vb
Dim cn as New ADODB.Connection
cn.Open "Provider=MS Remote;Internet Timeout=5000"
```

 Вы также можете задать или получить динамическое свойство, указав его имя в качестве индекса для свойства **Properties** . В следующем примере показано, как получить и напечатать текущее значение динамического свойства **timeout в Интернете** , а затем задать новое значение:

```vb
Debug.Print cn.Properties("Internet Timeout")
cn.Properties("Internet Timeout") = 5000
```

## <a name="remarks"></a>Remarks
 В ADO 2,0 поставщик удаленного взаимодействия OLE DB можно указать только в параметре *ActiveConnection* метода **Open** объекта [Recordset](../../../ado/reference/ado-api/recordset-object-ado.md) . Начиная с ADO 2,1, поставщик может быть также указан в параметре *ConnectionString* метода **Open** объекта [Connection](../../../ado/reference/ado-api/connection-object-ado.md) .

 Эквивалент **RDS. **Свойство [SQL](../../../ado/reference/rds-api/sql-property.md) объекта элемента управления DataObject недоступно. Вместо этого используется аргумент " *источник* метода **открытия** объекта [набора записей](../../../ado/reference/ado-api/recordset-object-ado.md) ".

 **Примечание** . Указание "...; Удаленный поставщик = MS Remote;... " создает сценарий из четырех уровней. Сценарии, находящиеся за пределами трех уровней, не были протестированы и не должны быть нужны.

## <a name="example"></a>Пример
 В этом примере выполняется запрос к таблице **authors** базы данных **pubs** на сервере с именем *йоурсервер*. Имена удаленного источника данных и удаленного сервера предоставляются в методе [Open](../../../ado/reference/ado-api/open-method-ado-connection.md) объекта[Connection](../../../ado/reference/ado-api/connection-object-ado.md) , а SQL-запрос указывается в методе[Open](../../../ado/reference/ado-api/open-method-ado-recordset.md) объекта [Recordset](../../../ado/reference/ado-api/recordset-object-ado.md) . Объект **набора записей** возвращается, редактируется и используется для обновления источника данных.

```vb
Dim rs as New ADODB.Recordset
Dim cn as New ADODB.Connection
cn.Open  "Provider=MS Remote;Data Source=pubs;" & _
         "Remote Server=https://YourServer"
rs.Open "SELECT * FROM authors", cn
...                'Edit the recordset
rs.UpdateBatch     'Equivalent of RDS SubmitChanges
...
```

## <a name="see-also"></a>См. также
 [Общие сведения о поставщике удаленного взаимодействия OLE DB](https://msdn.microsoft.com/4083b72f-68c4-4252-b366-abb70db5ca2b)
