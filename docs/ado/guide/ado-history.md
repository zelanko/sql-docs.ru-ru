---
title: Журнал ADO | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2019
ms.reviewer: ''
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ADO, what's new
ms.assetid: 667673f2-3151-432b-894a-3fc60b704ea4
author: MightyPen
ms.author: genemi
ms.openlocfilehash: a84ccbb97c26ea92f31212933aac79bde2784b72
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "67927169"
---
# <a name="ado-features-for-each-release"></a>Функции ADO для каждого выпуска

В этом разделе перечислены новые функции, появившиеся в каждом выпуске ADO, объекты данных ActiveX (MD) и ADOX.

## <a name="ado-60"></a>ADO 6,0

 ADO 6,0 входит в состав Windows Vista, как часть компонентов доступа к данным Windows (Windows DAC) 6,0. ADO 6,0 функционально эквивалентен ADO 2,8.

## <a name="ado-28"></a>ADO 2,8

 ADO 2,8 был включен в Windows XP и Windows Server 2003 в составе компонентов Microsoft Data Access Components (MDAC) 2,8. Также доступна распространяемая версия MDAC 2,8. Обратите внимание, что эта версия распространяемого пакета должна быть установлена только в Windows 2000. ADO 2,8 решает ряд проблем, связанных с безопасностью.

 *Доступ к жесткому диску не разрешен за пределами доверенной зоны.*
В междоменных сценариях, включающих недоверенные сайты, следующие операции отключены: **Stream. SaveToFile**, **Stream. лоадфромфиле**, **Recordset. Save**и **Recordset. Open**, используемые в сочетании с флагом **адкмдфиле** или поставщиком сохраняемости Microsoft OLE DB (мсперсист).

 **Recordset. Open** _,_  **Recordset. Save** _,_  **Stream. SaveToFile** _и_  **Stream. лоадфромфиле**  _работают только с физическими файлами._
Теперь эти методы проверяют, что дескрипторы файлов указывают только на физические файлы.

 Функция **Recordset. ActiveCommand**_возвращает ошибку при вызове из страницы HTML/ASP._  
Это предотвращает невозможность использования объекта **команды** .

 _Количество_**наборов записей**_, возвращаемых вложенной_командой**Shape**,_имеет верхнюю границу._        
Вложенная команда Shape теперь возвращает не более 512 **наборов записей**. Это означает, что команда **Shape** больше не может быть вложенной в какую-либо глубину. Вместо этого максимальная глубина уровня равна 512, если каждая команда приводит к единственному (дочернему) **набору записей**. Если на любом уровне команда **Shape** возвращает несколько **наборов записей**, максимальный уровень глубины будет меньше 512.

## <a name="ado-27"></a>ADO 2,7

 *поддержка 64-разрядных платформ* В ADO 2,7 реализована поддержка 64-разрядных процессоров.

## <a name="ado-26"></a>ADO 2,6

 _Метод_ **кубдеф. жетсчемаобжект**, начиная с ADO 2,6, объекты объекты данных ActiveX (MD) могут быть получены с помощью уникальных имен, как указано в [свойстве UniqueName (объекты данных ActiveX (MD))](../../ado/reference/ado-md-api/uniquename-property-ado-md.md).   Имена родительских объектов не обязательно должны быть известны, а для получения объекта схемы не нужно заполнять родительские коллекции. См. раздел [метод жетсчемаобжект (объекты данных ActiveX (MD))](../../ado/reference/ado-md-api/getschemaobject-method-ado-md.md).

 *Потоки команд* Объект **Command** поддерживает команды в формате потока в качестве альтернативы использованию свойства **CommandText** . [Свойство CommandStream (ADO)](../../ado/reference/ado-api/commandstream-property-ado.md) можно использовать для указания шаблонов XML или диаграмм обновления в качестве входных данных **команды** с помощью поставщика Microsoft OLE DB для SQL Server.

 [Диалект](../../ado/reference/ado-api/dialect-property.md) _свойства_ **диалекта**— это новое свойство, определяющее синтаксис и общие правила, которые поставщик использует для анализа строки или потока.  

 _Метод_ **Command. Execute**. [метод Execute](../../ado/reference/ado-api/execute-method-ado-command.md) объекта **Command** ADO был усовершенствован для использования потоков для ввода и вывода.  

 *Поле статусвалуес* Если при изменении **поля** **набора записей**пользователь обнаруживает ошибку DB_E_ERRORSOCCURRED, ADO теперь заполняет свойство **field. status** соответствующими сведениями о состоянии, чтобы пользователь имел дополнительные сведения о том, что пошло не так. См. [свойство Status (поле ADO)](../../ado/reference/ado-api/status-property-ado-field.md).

 ****_Свойство_ NamedParameters [NamedParameters](../../ado/reference/ado-api/namedparameters-property-ado.md) — это новое свойство объекта **Command** , которое указывает, что поставщик должен использовать именованные параметры.  

 *Результирующие наборы в потоках* ADO может возвращать результирующие наборы из источника данных в **потоке**, а не объекта **набора записей** . Используя последнюю версию поставщика Microsoft OLE DB для SQL Server, можно получить результаты XML от поставщика, выполнив запрос FOR XML. **Поток** , получающий результирующий набор, можно открыть с помощью команды "for XML" в качестве источника. См. раздел [получение результирующих наборов в потоки](../../ado/guide/data/retrieving-resultsets-into-streams.md).

 *Набор результатов с одной строкой* Теперь объект **записи** ADO можно открыть в командной строке или объекте **команды** , возвращающем одну строку данных от поставщика. Это приводит к повышению производительности с помощью поставщиков MDAC 2,6. См. раздел [Open Method (запись ADO)](../../ado/reference/ado-api/open-method-ado-record.md).

## <a name="ado-25"></a>ADO 2,5

 **** _Объект_ записи ADO 2,5 вводит объект **Record** для представления и управления строками из **набора записей** или поставщика данных или объекта, содержащего частично структурированные данные, такие как файл или каталог.

 Объект **Stream** _объекта_ ADO 2,5 также представляет объект **Stream** , который представляет поток двоичных или текстовых данных.

 *Привязка URL-адреса* В ADO 2,5 введено использование URL-адреса в качестве альтернативы строке подключения и тексту команды для именования объектов хранилища данных. URL-адрес может использоваться с существующим **соединением** и объектами **набора записей** , а также с новыми объектами **Record** и **Stream** .

 *Поставщики данных, поддерживающие привязку URL-адресов* ADO 2,5 поддерживает поставщиков OLE DB, которые распознают схемы URL-адресов. К ним относится поставщик OLE DB для публикации в Интернете, который обращается к файловой системе Windows 2000 и распознает существующую схему HTTP.
