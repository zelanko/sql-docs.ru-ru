---
description: Текущая запись и размер набора записей
title: Текущая запись и размер набора записей | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- record location [ADO]
- current record [ADO]
ms.assetid: e63ff331-8655-4be7-82c6-e6cd6cc9d16d
author: rothja
ms.author: jroth
ms.openlocfilehash: 12d4b9803682e94326636dd27bbc3f134eea23d8
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88453606"
---
# <a name="current-record-and-size-of-recordset"></a>Текущая запись и размер набора записей
В этом разделе описывается, как узнать текущую позицию курсора в образце **набора записей** в [примере кода JScript, чтобы получить набор записей](../../../ado/guide/data/jscript-code-example-to-return-a-recordset.md).  
  
## <a name="current-record"></a>Текущая запись  
 Текущая запись в наборе данных соответствует объекту, на который указывает позицию курсора объекта **Recordset** . Когда объект **набора записей** возвращается из источника данных в результате вызова **Recordset. Open**, **Command.Exeмилые**или **Connection.Exeмилые** (включая **Connection. намедкомманд** и **Connection. StoredProcedure**), курсор устанавливается на первую запись. В образце набора данных первоначальной текущей записью является элемент "дядюшка Боба высохнуть груши".  
  
## <a name="size-of-recordset"></a>Размер набора записей  
 Чтобы узнать размер объекта **набора записей** , получите значение свойства **Recordset. RecordCount** . Это значение представляет собой длинное целое число, которое указывает количество записей в **наборе записей**. Если набор данных возвращается поставщиком OLEDB для Microsoft SQL Server, это значение возвращает число возвращаемых строк. Чтение свойства **RecordCount** в закрытом **наборе записей** вызывает ошибку.  
  
 Если число записей не может быть определено, значение свойства равно-1.  
  
 Значение свойства **RecordCount** также зависит от возможностей поставщика и используемого типа курсора. Для однонаправленного курсора значение равно-1. Для курсора статического или ключевого набора данных значением является фактическое число записей, возвращаемых в объекте **Recordset** . Для динамического курсора значение равно-1 или действительное число записей в зависимости от источника данных.  
  
 Курсор, который поддерживает **RecordCount** , должен работать труднее и, следовательно, требует больше вычислительных ресурсов, чем курсор не поддерживает **RecordCount**. Если вам не нужно знать количество записей, использование разных типов курсоров может улучшить производительность приложения, особенно если необходимо работать с большим набором данных.  
  
 В некоторых случаях поставщик или курсор не может определить значение **RecordCount** без предварительной выборки всех записей из источника данных. Чтобы обеспечить точный подсчет, вызовите **набор записей**. Метод **MoveLast** перед вызовом **Recordset. RecordCount**.  
  
 Пример объекта **набора записей** , полученный с помощью [примера кода JScript](../../../ado/guide/data/jscript-code-example-to-return-a-recordset.md) , использует однонаправленный курсор, поэтому вызов **RecordCount** для этого объекта всегда дает значение-1. При изменении строки кода, вызывающей **набор записей**. Метод **Open** , как показано в следующем примере, свойство **RecordCount** возвращает фактическое число выбранных записей.  
  
```  
oRs.Open sSQL, sCnStr, adOpenStatic, adLockOptimistic, adCmdText   
```  
  
 Это обусловлено тем, что статические курсоры с [поставщиком Microsoft OLE DB для SQL Server](../../../ado/guide/appendixes/microsoft-ole-db-provider-for-sql-server.md) поддерживают **RecordCount**. В этом примере имеется пять записей, поэтому **RecordCount** должен возвращать значение 5.  
  
 Этот раздел содержит следующий раздел.  
  
 [Границы набора записей](../../../ado/guide/data/boundaries-of-a-recordset.md)
