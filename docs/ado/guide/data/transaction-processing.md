---
title: Обработка транзакций | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- transactions [ADO]
- data updates [ADO], transaction processing
- updating data [ADO], transaction processing
- nested transactions [ADO]
ms.assetid: 74ab6706-e2dc-42cb-af77-dbc58a9cf4ce
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 4ea890e0e2d49781f06f38f606a6c92582dc44d1
ms.sourcegitcommit: 61381ef939415fe019285def9450d7583df1fed0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47742235"
---
# <a name="transaction-processing"></a>Обработка транзакций
Объект *транзакции* разделяет начало и конец ряда операций доступа к данным выполняется через подключение. Зависит от возможностей источника данных транзакций **подключения** объекта также позволяет создавать и управлять транзакциями. Например используя поставщик Microsoft OLE DB для SQL Server для доступа к базе данных на Microsoft SQL Server, можно создать несколько вложенных транзакций для команд, которые выполняются.  
  
 ADO гарантирует, что изменения источника данных, полученный в результате операции в транзакции происходят успешно друг с другом или вообще не.  
  
 Если отменить транзакцию, или при сбое одного из его операции, результатом будет так, как если ни одна из операций в транзакции произошла. Источник данных останется в том случае, так как она была до начала транзакции.  
  
 ADO предоставляет следующие методы для управления транзакциями: **BeginTrans**, **CommitTrans**, и **RollbackTrans**. Используйте эти методы с **подключения** объекта, если вы хотите сохранить или отменить ряд изменений, внесенных в данные источника, как единое целое. Например для передачи денег между учетными записями, можно вычесть сумму из одного и добавьте столько же для других. Если либо обновите завершается ошибкой, учетные записи больше не сбалансированы. Эти изменения в открытой транзакции гарантирует, что все или изменения проходят через.  
  
> [!NOTE]
>  Не все поставщики поддерживают транзакции. Убедитесь, что свойство, определенное поставщиком "**DDL транзакций**" отображается в **подключения** объекта [свойства](../../../ado/reference/ado-api/properties-collection-ado.md) коллекции, указывающий, что поставщик поддерживает транзакции. Если поставщик не поддерживает транзакции, вызвав один из этих методов возвращает ошибку.  
  
 После вызова метода **BeginTrans** метод, поставщик будет зафиксировать больше не мгновенно изменения, внесенные до вызова метода **CommitTrans** или **RollbackTrans** до конца транзакция.  
  
 Вызов **CommitTrans** метод сохраняет изменения, внесенные в открытые транзакции в соединении и завершает транзакцию. Вызов **RollbackTrans** метод отменяет любые изменения, внесенные в открытые транзакции и завершает транзакцию. Вызов любого из этих методов, если нет открытых транзакций приводит к ошибке.  
  
 В зависимости от **подключения** объекта [атрибуты](../../../ado/reference/ado-api/attributes-property-ado.md) свойство, вызывая **CommitTrans** или **RollbackTrans** может метод автоматически запускает новую транзакцию. Если **атрибуты** свойству **adXactCommitRetaining**, поставщик автоматически запускает новую транзакцию после **CommitTrans** вызова. Если **атрибуты** свойству **adXactAbortRetaining**, поставщик автоматически запускает новую транзакцию после **RollbackTrans** вызова.  
  
## <a name="transaction-isolation-level"></a>Уровень изоляции транзакции  
 Используйте **IsolationLevel** свойство, чтобы задать уровень изоляции транзакции на **подключения** объекта. Этот параметр не вступили в силу только при следующем вызове [BeginTrans](../../../ado/reference/ado-api/begintrans-committrans-and-rollbacktrans-methods-ado.md) метод. Если уровень изоляции, запрошенных недоступен, это означает, поставщик может возвращать больше уровня изоляции. Ссылаться на **IsolationLevel** свойства в справочнике по программированию объектов ADO, Дополнительные сведения о допустимых значений.  
  
## <a name="nested-transactions"></a>Вложенные транзакции  
 Для поставщиков, которые поддерживают вложенные транзакции вызова **BeginTrans** метод в открытой транзакции начинает новый, вложенные транзакции. Возвращаемое значение указывает уровень вложенности: возвращаемое значение «1» указывает, вы открыли транзакцией верхнего уровня (то есть транзакция не вложен в другой транзакции), «2» означает, что вы открыли транзакции второго уровня ( транзакция вложенной транзакции верхнего уровня), и т. д. Вызов **CommitTrans** или **RollbackTrans** затрагивает только последний открытый транзакции; необходимо закрыть или отката текущей транзакции, чтобы связать все более высокого уровня транзакции.
