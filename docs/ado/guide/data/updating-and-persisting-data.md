---
title: Обновление и сохранение данных | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- updating data [ADO]
- data updates [ADO]
- ADO, updating data
ms.assetid: 8dc27274-4f96-43d1-913c-4ff7d01b9a27
author: rothja
ms.author: jroth
ms.openlocfilehash: a77bb6f8f26652a9f435683c56b14d0bc8eb4b65
ms.sourcegitcommit: 6037fb1f1a5ddd933017029eda5f5c281939100c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2020
ms.locfileid: "82750217"
---
# <a name="updating-and-persisting-data"></a>Обновление и сохранение данных
В предыдущих главах обсуждалось использование ADO для получения данных в источнике данных, перемещения по данным и даже изменения данных. Конечно, если цель приложения — разрешить пользователям вносить изменения в данные, необходимо понять, как сохранить эти изменения. Можно либо сохранить изменения **набора записей** в файле с помощью метода **Save** , либо отправить изменения обратно в источник данных для хранения с помощью методов **Update** или **UpdateBatch** .  
  
 В предыдущих главах данные были изменены в нескольких строках **набора записей**. ADO поддерживает два основных понятия, связанные с добавлением, удалением и изменением строк данных.  
  
 Первое понятие заключается в том, что изменения не вносятся сразу в **набор записей**; Вместо этого они создаются во внутреннем *буфере копирования*. Если вы решите, что изменения не нужны, изменения в буфере копирования будут отклонены. Если вы решите избежать изменений, изменения в буфере копирования применяются к **набору записей**.  
  
 Второе понятие заключается в том, что изменения либо распространяются в источник данных, как только вы объявили работу над строкой (то есть режим *интерпретации* ), либо все изменения набора строк собираются до тех пор, пока не будет объявлена работа для завершенного набора (то есть *пакетного* режима). Свойство **LockType** определяет, когда изменения вносятся в базовый источник данных. **adLockOptimistic** или **адлоккпессимистик** указывает режим интерпретации, а **адлоккбатчоптимистик** — пакетный режим. Свойство **CursorLocation** может влиять на доступные параметры **LockType** . Например, параметр **адлоккпессимистик** не поддерживается, если свойство **CursorLocation** имеет значение **адусеклиент**.  
  
 В режиме интерпретации каждый вызов метода **Update** распространяет изменения в источник данных. В пакетном режиме каждый вызов **обновления** или перемещения текущей позицией строки сохраняет изменения в буфер копирования, но только метод **UpdateBatch** распространяет изменения в источник данных.  
  
 Этот раздел содержит следующие подразделы.  
  
-   [Обновление данных](../../../ado/guide/data/updating-data.md)  
  
-   [Сохранение данных](../../../ado/guide/data/persisting-data.md)
