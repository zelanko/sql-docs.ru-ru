---
description: Записи и предоставляемые поставщиком поля
title: Записи и поля, предоставляемые поставщиком | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- records-provided fields [ADO]
- provider-supplied fields [ADO]
ms.assetid: 77f95e0a-0cf2-411a-a792-593f77330fbd
author: rothja
ms.author: jroth
ms.openlocfilehash: 6cd737ce36a53643503a5c76dfaafe2127c93f9b
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88453006"
---
# <a name="records-and-provider-supplied-fields"></a>Записи и предоставляемые поставщиком поля
При открытии объекта [Record](../../../ado/reference/ado-api/record-object-ado.md) его источник может быть текущей строкой открытого [набора записей](../../../ado/reference/ado-api/recordset-object-ado.md), абсолютным URL-адресом или относительным URL-адресом в сочетании с открытым объектом [соединения](../../../ado/reference/ado-api/connection-object-ado.md) .  
  
 Если **запись** открыта из **набора записей**, то коллекция [полей](../../../ado/reference/ado-api/fields-collection-ado.md) объекта **записи** будет содержать все поля из **набора записей**, а также все поля, добавленные базовым поставщиком.  
  
 Поставщик может вставлять дополнительные поля, которые служат дополнительными характеристиками **записи**. В результате **запись** может иметь уникальные поля, отсутствующие в **наборе записей** , в виде целой или любой **записи** , производной от другой строки **набора записей**.  
  
 Например, все строки **набора записей** , производные от источника данных электронной почты, могут иметь такие столбцы, как from, to и subject. **Запись** , производная от этого **набора** , будет иметь те же поля. Однако **запись** может также содержать другие поля, уникальные для конкретного сообщения, представленного этой **записью**, например "вложение" и "копия" (копии).  
  
 Несмотря на то что объект **Record** и текущая строка **набора записей** имеют одинаковые поля, они отличаются, поскольку объекты **записи** и объекта **набора записей** имеют разные методы и свойства.  
  
 Поле, содержащееся в общей **записи** , и **набор записей** могут быть изменены для любого объекта. Однако поле не может быть удалено для объекта **Record** , хотя базовый поставщик может поддерживать установку поля в значение null.  
  
 После открытия **записи** можно программно добавлять поля. Можно также удалить поля, добавленные, но нельзя удалить поля из исходного **набора записей**.  
  
 Можно также открыть объект **записи** непосредственно из URL-адреса. В этом случае поля, добавляемые в **запись** , зависят от базового поставщика. В настоящее время большинство поставщиков добавляют набор полей, описывающих сущность, представленную **записью**. Если сущность состоит из потока байтов, например простого файла, то объект [потока](../../../ado/reference/ado-api/stream-object-ado.md) обычно можно открыть из **записи**.  
  
## <a name="special-fields-for-document-source-providers"></a>Специальные поля для поставщиков источников документов  
 Особый класс поставщиков, называемый *поставщиками источников документов*, управляет папками и документами. Если объект **Record** представляет документ или объект **Recordset** представляет папку документов, поставщик источника документов заполняет эти объекты уникальным набором полей, описывающих характеристики документа, а не собственно документ. Как правило, одно поле содержит ссылку на **поток** , представляющий документ.  
  
 Эти поля составляют **запись** ресурса или **набор записей** и указываются для конкретных поставщиков, которые их поддерживают в [приложении a: поставщики](../../../ado/guide/appendixes/appendix-a-providers.md).  
  
 Две константы индексируют коллекцию **полей** **записи** ресурса или **набора записей** для получения пары часто используемых полей. Свойство [значение](../../../ado/reference/ado-api/value-property-ado.md) объекта **field** возвращает нужное содержимое.  
  
-   Поле, к которому обращается константа **аддефаултстреам** , содержит поток по умолчанию, связанный с **записью** или объектом **Recordset** . Поставщик назначает поток по умолчанию объекту.  
  
-   Поле, к которому обращается константа **адрекордурл** , содержит абсолютный URL-адрес, идентифицирующий документ.  
  
 Поставщик источника документов не поддерживает коллекцию [свойств](../../../ado/reference/ado-api/properties-collection-ado.md) объектов **Record** и **field** . Для таких объектов содержимое коллекции **свойств** равно null.  
  
 Поставщик источника документов может добавить зависящее от поставщика свойство, например **Тип DataSource** , чтобы определить, является ли он поставщиком источника документа. Дополнительные сведения о том, как определить тип поставщика, см. в документации поставщика.  
  
## <a name="resource-recordset-columns"></a>Столбцы набора записей ресурса  
 *Набор записей ресурсов* состоит из следующих столбцов.  
  
|Имя столбца|Тип|Описание|  
|-----------------|----------|-----------------|  
|RESOURCE_PARSENAME|адварвчар|Только для чтения. Указывает URL-адрес ресурса.|  
|RESOURCE_PARENTNAME|адварвчар|Только для чтения. Указывает абсолютный URL-адрес родительской записи.|  
|RESOURCE_ABSOLUTEPARSENAME|адварвчар|Только для чтения. Указывает абсолютный URL-адрес ресурса, который представляет собой объединение PARENTNAME и PARSENAME.|  
|RESOURCE_ISHIDDEN|адбулеан|Значение true, если ресурс скрыт. Ни одна строка не будет возвращена, если команда, создающая набор строк, явно не выберет строки, где RESOURCE_ISHIDDEN имеет значение true.|  
|RESOURCE_ISREADONLY|адбулеан|Значение true, если ресурс доступен только для чтения. Пытается открыть этот ресурс с DBBINDFLAG_WRITE и будет завершаться с DB_E_READONLY. Это свойство можно изменить, даже если ресурс открыт только для чтения.|  
|RESOURCE_CONTENTTYPE|адварвчар|Указывает на вероятное использование документа, например, адвокатом. Это может соответствовать шаблону Office, который использовался для создания документа.|  
|RESOURCE_CONTENTCLASS|адварвчар|Указывает тип MIME документа, указывая формат, например " `text/html` ".|  
|RESOURCE_CONTENTLANGUAGE|адварвчар|Указывает язык, на котором хранится содержимое.|  
|RESOURCE_CREATIONTIME|adFileTime|Только для чтения. Указывает структуру FILETIME, которая содержит время создания ресурса. Время указывается в формате UTC.|  
|RESOURCE_LASTACCESSTIME|адфилетиме|Только для чтения. Указывает структуру FILETIME, которая содержит время последнего обращения к ресурсу. Время указано в формате UTC. Элементы FILETIME равны нулю, если поставщик не поддерживает этот элемент времени.|  
|RESOURCE_LASTWRITETIME|адфилетиме|Только для чтения. Указывает структуру FILETIME, которая содержит время последней запись ресурса. Время указано в формате UTC. Элементы FILETIME равны нулю, если поставщик не поддерживает этот элемент времени.|  
|RESOURCE_STREAMSIZE|асунсигнедбигинт|Только для чтения. Указывает размер потока по умолчанию ресурса в байтах.|  
|RESOURCE_ISCOLLECTION|адбулеан|Только для чтения. Значение true, если ресурс является коллекцией, например каталогом. Значение false, если ресурс является простым файлом.|  
|RESOURCE_ISSTRUCTUREDDOCUMENT|адбулеан|Значение true, если ресурс является структурированным документом. Значение false, если ресурс не является структурированным документом. Это может быть коллекция или простой файл.|  
|DEFAULT_DOCUMENT|адварвчар|Только для чтения. Указывает, что этот ресурс содержит URL-адрес простого документа по умолчанию папки или структурированного документа. Используется при запросе потока по умолчанию от ресурса. Это свойство является пустым для простого файла.|  
|CHAPTERED_CHILDREN|адчаптер|Только для чтения. Необязательный параметр. Указывает главу набора строк, который содержит дочерние элементы ресурса. ( *Поставщик OLE DB для публикации в Интернете* не использует этот столбец.)|  
|RESOURCE_DISPLAYNAME|адварвчар|Только для чтения. Указывает отображаемое имя ресурса.|  
|RESOURCE_ISROOT|адбулеан|Только для чтения. Значение true, если ресурс является корнем коллекции или структурированного документа.|  
  
## <a name="see-also"></a>См. также  
 [Объект Record (ADO)](../../../ado/reference/ado-api/record-object-ado.md)   
 [Приложение А. Поставщики](../../../ado/guide/appendixes/appendix-a-providers.md)
