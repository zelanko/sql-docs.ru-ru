---
description: Предложение APPEND для формирования данных
title: Предложение APPEND для фигур | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- shape commands [ADO]
- data shaping [ADO], APPEND clause
- append clause [ADO]
ms.assetid: f90fcf55-6b24-401d-94e1-d65bd24bd342
author: rothja
ms.author: jroth
ms.openlocfilehash: 11d2c02d24753460f90452ddd6cc6b1e1589b80b
ms.sourcegitcommit: 18a98ea6a30d448aa6195e10ea2413be7e837e94
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2020
ms.locfileid: "88979625"
---
# <a name="shape-append-clause"></a>Предложение APPEND для формирования данных
Предложение добавления команды Shape добавляет столбец или столбцы к **набору записей**. Часто эти столбцы являются столбцами секций, которые ссылаются на дочерний **набор записей**.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
SHAPE [parent-command [[AS] parent-alias]] APPEND column-list  
```  
  
## <a name="description"></a>Описание  
 Ниже приведены части этого предложения.  
  
 *родительская команда*  
 Ноль или один из следующих элементов (можно полностью опустить *родительскую команду* ):  
  
-   Команда поставщика, заключенная в фигурные скобки (" {} "), которая возвращает объект **набора записей** . Команда выдается базовому поставщику данных, и его синтаксис зависит от требований этого поставщика. Как правило, это будет язык SQL, хотя для ADO не требуется какой бы то ни было определенного языка запросов.  
  
-   Другая команда Shape, внедренная в круглые скобки.  
  
-   Ключевое слово TABLE, за которым следует имя таблицы в поставщике данных.  
  
 *псевдоним родителя*  
 Необязательный псевдоним, ссылающийся на родительский **набор записей**.  
  
 *список столбцов*  
 Один или несколько из следующих элементов:  
  
-   Статистический столбец.  
  
-   Вычисляемый столбец.  
  
-   Новый столбец, созданный с помощью предложения NEW.  
  
-   Столбец раздела. Определение столбца раздела заключено в круглые скобки ("()"). См. следующий синтаксис.  
  
```  
SHAPE [parent-command [[AS] parent-alias]]  
   APPEND (child-recordset [ [[AS] child-alias]   
      RELATE parent-column TO child-column | PARAMETER param-number, ... ])  
   [[AS] chapter-alias]   
   [, ... ]  
```  
  
## <a name="remarks"></a>Remarks  
 *дочерний набор записей*  
 -   Команда поставщика, заключенная в фигурные скобки (" {} "), которая возвращает объект **набора записей** . Команда выдается базовому поставщику данных, и его синтаксис зависит от требований этого поставщика. Как правило, это будет язык SQL, хотя для ADO не требуется какой бы то ни было определенного языка запросов.  
  
-   Другая команда Shape, внедренная в круглые скобки.  
  
-   Имя существующего **набора записей**в форме.  
  
-   Ключевое слово TABLE, за которым следует имя таблицы в поставщике данных.  
  
 *дочерний псевдоним*  
 Псевдоним, ссылающийся на дочерний **набор записей**.  
  
 *родительский столбец*  
 Столбец в **наборе записей** , возвращенном *родительской командой.*  
  
 *дочерний столбец*  
 Столбец в **наборе записей** , возвращаемом *дочерней командой*.  
  
 *параметр-номер*  
 См. [операции с параметризованными командами](../../../ado/guide/data/operation-of-parameterized-commands.md).  
  
 *раздел — псевдоним*  
 Псевдоним, ссылающийся на столбец раздела, добавленный к родительскому элементу.  
  
> [!NOTE]
>  Предложение *«родители-столбцы* для *дочернего столбца»* фактически является списком, где каждое определенное отношение разделяется запятыми.  
  
> [!NOTE]
>  Предложение после ключевого слова APPEND на самом деле является списком, где каждое предложение отделяется запятой и определяет другой столбец, добавляемый к родительскому элементу.  
  
При создании команд поставщика на основе вводимых пользователем данных в виде команды SHAPE объект SHAPE будет рассматривать предоставляемую пользователем команду поставщика как непрозрачную строку и передавать их точно этому поставщику. Например, в следующей команде SHAPE:  
  
```  
SHAPE {select * from t1} APPEND ({select * from t2} RELATE k1 TO k2)  
```  
  
 Фигура будет выполнять две команды: `select * from t1` и ( `select * from t2 RELATE k1 TO k2)` . Если пользователь предоставляет составную команду, состоящую из нескольких команд поставщика, разделенных точкой с запятой, фигура не может отличить эту разницу. Поэтому в следующей команде SHAPE  
  
```  
SHAPE {select * from t1; drop table t1} APPEND ({select * from t2} RELATE k1 TO k2)  
```  
  
 SHAPE исполняет `select * from t1; drop table t1` и ( `select * from t2 RELATE k1 TO k2),` не понимают, что `drop table t1` является отдельным и в данном случае опасно, командой поставщика. Приложения всегда должны проверять вводимые пользователем данные, чтобы предотвратить возникновение таких потенциальных атак хакера.  
  
 Этот раздел содержит следующие подразделы.  
  
-   [Использование непараметризованных команд](../../../ado/guide/data/operation-of-non-parameterized-commands.md)  
  
-   [Использование параметризованных команд](../../../ado/guide/data/operation-of-parameterized-commands.md)  
  
-   [Гибридные команды](../../../ado/guide/data/hybrid-commands.md)  
  
-   [Предложения COMPUTE для промежуточного формирования данных](../../../ado/guide/data/intervening-shape-compute-clauses.md)  
  
## <a name="see-also"></a>См. также  
 [Пример формирования данных](../../../ado/guide/data/data-shaping-example.md)   
 [Грамматика формальной фигуры](../../../ado/guide/data/formal-shape-grammar.md)   
 [Общие сведения о командах формирования данных](../../../ado/guide/data/shape-commands-in-general.md)
