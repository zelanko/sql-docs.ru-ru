---
title: Объект Field | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Field object [ADO]
ms.assetid: 7d1c4ad5-4be3-42ab-b516-e7133ca300bc
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 80e6576b236db44452c4e89b1d8f3bb8976ab120
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "67923985"
---
# <a name="the-field-object"></a>Объект Field
Каждый объект **поля** обычно соответствует столбцу в таблице базы данных. Однако **поле** может также представлять указатель на другой **набор записей**, называемый главой. Исключения, например столбцы глав, будут рассмотрены далее в этом пошаговом окне.  
  
 Используйте свойство **value** объектов **field** , чтобы задать или вернуть данные для текущей записи. В зависимости от функциональных возможностей, предоставляемых поставщиком, некоторые коллекции, методы или свойства объекта **field** могут быть недоступны.  
  
 С помощью коллекций, методов и свойств объекта **field** можно выполнять следующие действия.  
  
-   Возврат имени поля с помощью свойства **Name** .  
  
-   Просмотр или изменение данных в поле с помощью свойства **value** . **Значение** является свойством объекта **поля** по умолчанию.  
  
-   Возвращают основные характеристики поля с помощью свойств **Type**, **Precision**и **NumericScale** .  
  
-   Возвращает объявленный размер поля с помощью свойства **DefinedSize** .  
  
-   Возврат фактического размера данных в заданном поле с помощью свойства **ActualSize** .  
  
-   Определите, какие типы функций поддерживаются для данного поля, с помощью свойства **Attributes** и коллекции **свойств** .  
  
-   Управлять значениями полей, содержащих длинные двоичные или длинные символьные данные, можно с помощью методов **AppendChunk** и методического **блока** .  
  
 Разрешать расхождения в значениях полей во время пакетного обновления с помощью свойств **originalValue** и **UnderlyingValue** , если поставщик поддерживает пакетные обновления.  
  
## <a name="describing-a-field"></a>Описание поля  
 В следующих разделах будут обсуждаться свойства объекта [field](../../../ado/reference/ado-api/field-object.md) , которые представляют сведения, описывающие объект **поля** , то есть метаданные поля. Эти сведения можно использовать для определения большей части о схеме **набора записей**. К этим свойствам относятся **Type**, **DefinedSize** и **ActualSize**, **Name**, and **NumericScale** и **Precision**.  
  
### <a name="discovering-the-data-type"></a>Обнаружение типа данных  
 Свойство **Type** указывает тип данных поля. Перечислимые константы типа данных, поддерживаемые ADO, описаны в [дататипинум](../../../ado/reference/ado-api/datatypeenum.md) в *справочнике программиста ADO*.  
  
 Для числовых типов с плавающей запятой, таких как **аднумерик**, можно получить дополнительные сведения. Свойство **NumericScale** указывает, сколько цифр справа от десятичной запятой будет использоваться для представления значений для **поля**. Свойство **Precision** определяет максимальное количество цифр, используемых для представления значений для **поля**.  
  
### <a name="determining-field-size"></a>Определение размера поля  
 Используйте свойство **DefinedSize** , чтобы определить емкость данных для объекта **поля** .  
  
 Используйте свойство **ActualSize** , чтобы вернуть фактическую длину значения объекта **поля** . Для всех полей свойство **ActualSize** доступно только для чтения. Если ADO не удается определить длину значения объекта **поля** , свойство **ActualSize** возвращает **адункновн**.  
  
 Свойства **DefinedSize** и **ActualSize** имеют разные цели. Например, рассмотрим объект **field** с объявленным типом **адварчар** и значением свойства **DefinedSize** 50, содержащим один символ. Возвращаемое значение свойства **ActualSize** — это длина в байтах одного символа.  
  
### <a name="determining-field-contents"></a>Определение содержимого поля  
 Идентификатор столбца из источника данных представлен свойством **Name** **поля**. Свойство **value** объекта **field** Возвращает или задает фактическое содержимое данных поля. Это свойство по умолчанию.  
  
 Чтобы изменить данные в поле, установите свойство **value** равным новому значению правильного типа. Тип курсора должен поддерживать обновления для изменения содержимого поля. Проверка базы данных не выполняется в пакетном режиме, поэтому при вызове **UpdateBatch** в таком случае необходимо будет проверить наличие ошибок. Некоторые поставщики также поддерживают свойства **UnderlyingValue** и **ORIGINALVALUE** объекта **поля** ADO, помогающие устранять конфликты при попытке выполнить пакетные обновления. Дополнительные сведения об устранении таких конфликтов см. в разделе [изменение данных](../../../ado/guide/data/editing-data.md).  
  
> [!NOTE]
>  Значения **полей набора записей** не могут быть заданы при присоединении новых **полей** к **набору записей**. Вместо этого новые **поля** могут быть добавлены к закрытому **набору записей**. Затем необходимо открыть **набор записей** , а затем в эти **поля**могут быть назначены только значения.  
  
### <a name="getting-more-field-information"></a>Получение дополнительных сведений о полях  
 Объекты ADO имеют два типа свойств: встроенные и динамические. К этому моменту были рассмотрены только встроенные свойства объекта **field** .  
  
 Встроенные свойства — это свойства, реализованные в ADO и немедленно доступные для любого нового объекта с использованием `MyObject.Property` синтаксиса. Они не отображаются как объекты **свойств** в коллекции **свойств** объекта.  
  
 Динамические свойства определяются базовым поставщиком данных и отображаются в коллекции **Properties** для соответствующего объекта ADO. Например, свойство, относящееся к поставщику, может указывать, поддерживает ли объект **набора записей** транзакции или обновление. Эти дополнительные свойства будут отображаться как объекты **свойств** в коллекции **свойств** объекта **набора записей** . На динамические свойства можно ссылаться только через коллекцию, используя синтаксис `MyObject.Properties(0)` или. `MyObject.Properties("Name")`  
  
 Нельзя удалить оба типа свойств.  
  
 Объект динамического **Свойства** имеет четыре встроенных свойства.  
  
-   Свойство **Name** — это строка, идентифицирующая свойство.  
  
-   Свойство **Type** — это целое число, указывающее тип данных свойства.  
  
-   Свойство **value** — это вариант, который содержит значение свойства. **Value** является свойством по умолчанию для объекта **Property** .  
  
-   Свойство **Attributes** является **длинным** значением, указывающим характеристики свойства, характерного для поставщика.  
  
 Коллекция **свойств** для объекта **field** содержит дополнительные метаданные о поле. Содержимое этой коллекции зависит от поставщика. В следующем примере кода рассматривается коллекция **свойств** образца **набора записей** , представленного в начале этого раздела. Сначала он просматривает содержимое коллекции. Этот код использует [поставщик OLE DB для SQL Server](../../../ado/guide/appendixes/microsoft-ole-db-provider-for-sql-server.md), поэтому коллекция **Properties** содержит сведения, относящиеся к этому поставщику.  
  
```  
'BeginFieldProps  
    Dim objProp As ADODB.Property  
  
    For intLoop = 0 To (objFields.Count - 1)  
        Debug.Print objFields.Item(intLoop).Name  
  
        For Each objProp In objFields(intLoop).Properties  
            Debug.Print vbTab & objProp.Name & " = " & objProp.Value  
        Next objProp  
    Next intLoop  
'EndFieldProps  
```  
  
### <a name="dealing-with-binary-data"></a>Работа с двоичными данными  
 Используйте метод [AppendChunk](../../../ado/reference/ado-api/appendchunk-method-ado.md) для объекта **field** , чтобы заполнить его длинными двоичными или символьными данными. В ситуациях, когда память системы ограничена, можно использовать метод **AppendChunk** для обработки длинных значений в частях, а не в полном объеме.  
  
 Если бит **адфлдлонг** в свойстве **Attributes** объекта **field** имеет значение **true**, для этого поля можно использовать метод **AppendChunk** .  
  
 Первый вызов **AppendChunk** для объекта **field** записывает данные в поле, перезаписывая существующие данные. Последующие вызовы **AppendChunk** вызывают добавление к существующим данным. Если вы добавляете данные в одно поле, а затем задаете или считываете значение другого поля в текущей записи, то ADO предполагает, что добавление данных к первому полю завершено. При повторном вызове метода **AppendChunk** в первом поле ADO интерпретирует вызов как новую операцию **AppendChunk** и перезаписывает существующие данные. Доступ к полям других объектов **набора записей** , которые не являются клонами первого объекта **набора записей** , не приведет к нарушению операций **AppendChunk** .  
  
 Используйте метод **GetObject** для объекта **field** , чтобы получить часть или все его длинные двоичные или символьные данные. В ситуациях, когда память системы ограничена, можно использовать метод " **блока** " для обработки длинных значений в частях, а не полностью.  
  
 Данные, возвращаемые вызовом методаического **блока** , назначаются *переменной*. Если *Размер* больше остальных данных **, метод WebMethod** возвращает только оставшиеся данные без *переменной* заполнения пустыми пробелами. Если поле пустое **, метод WebMethod** возвращает значение null.  
  
 Каждый последующий вызов методаического **блока** извлекает данные, начиная с места, в **котором предыдущий вызов** метода Left был отключен. Однако если вы получаете данные из одного поля, а затем устанавливаете или считываете значение другого поля в текущей записи, то ADO считает, что вы завершили извлечение данных из первого поля. При повторном вызове **метода WebMethod в первом** поле ADO интерпретирует вызов как новую операцию- **блок** и начинает чтение с начала данных. Доступ к полям других объектов **набора записей** , которые не являются клонами первого объекта **набора записей** , не приведет **к нарушению** операций GetObject.  
  
 Если бит **адфлдлонг** в свойстве **Attributes** объекта **field** имеет значение **true**, для этого поля можно **использовать метод GetObject** .  
  
 Если при использовании метода GetObject или **AppendChunk** в объекте **field** нет текущей записи **, то происходит** ошибка 3021 (нет текущей записи).  
  
 Пример использования этих методов для обработки двоичных данных см. в примерах [метода AppendChunk](../../../ado/reference/ado-api/appendchunk-method-ado.md) и [метода](../../../ado/reference/ado-api/getchunk-method-ado.md) *IsReference в справочнике программиста ADO*.
