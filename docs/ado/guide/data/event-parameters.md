---
description: Параметры события
title: Параметры события | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Error parameter [ADO]
- Object parameter [ADO]
- Status parameter [ADO]
- events [ADO], parameters
- Reason parameter [ADO]
- event parameters [ADO]
ms.assetid: bd5c5afa-d301-4899-acda-40f98a6afa4d
author: rothja
ms.author: jroth
ms.openlocfilehash: cc36f0ab059bb7b605b02316008a969411663a8d
ms.sourcegitcommit: 18a98ea6a30d448aa6195e10ea2413be7e837e94
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2020
ms.locfileid: "88991305"
---
# <a name="event-parameters"></a>Параметры события
Каждый обработчик событий имеет параметр status, который управляет обработчиком событий. Для полных событий этот параметр также используется для указания на успешное или неуспешное завершение операции, создавшей событие. У большинства полных событий также есть параметр ошибки для предоставления сведений об обнаруженной ошибке и один или несколько параметров объекта, которые ссылаются на объекты ADO, используемые для выполнения операции. Например, событие [ексекутекомплете](../../reference/ado-api/executecomplete-event-ado.md) включает параметры объекта для **команды**, **набора записей**и объектов **соединения** , связанных с событием. В следующем примере Microsoft® Visual Basic® можно увидеть объекты Пкомманд, Пконнектион и, которые представляют собой **команды**, **набор записей**и объекты **соединения** , используемые методом **EXECUTE** .  
  
```  
Private Sub connEvent_ExecuteComplete(ByVal RecordsAffected As Long, _  
     ByVal pError As ADODB.Error, _  
     adStatus As ADODB.EventStatusEnum, _  
     ByVal pCommand As ADODB.Command, _  
     ByVal pRecordset As ADODB.Recordset, _  
     ByVal pConnection As ADODB.Connection)  
```  
  
 За исключением объекта **Error** , в события будут передаваться те же параметры. Это позволяет исследовать все объекты, которые будут использоваться в ожидающей операции, и определять, должна ли операция завершиться.  
  
 Некоторые обработчики событий имеют параметр *Reason* , который предоставляет дополнительные сведения о причинах возникновения события. Например, события **виллмове** и **мовекомплете** могут возникать из-за того, что один из методов навигации (**MoveNext**, **MovePrevious**и т. д.) вызывается или как результат запроса.  
  
## <a name="status-parameter"></a>Параметр Status  
 При вызове подпрограммы обработчика событий для параметра *Status* задается одно из следующих значений.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**adStatusOK**|Передается обоим событиям. Это значение означает, что операция, вызвавшая событие, завершилась успешно.|  
|**adStatusErrorsOccurred**|Передается только для завершения событий. Это значение означает, что операция, вызвавшая событие, завершилась неудачно или событие будет отменено операцией. Дополнительные сведения см. в параметре *ошибки* .|  
|**адстатускантдени**|Передается только событиям. Это значение означает, что операция не может быть отменена событием. Она должна быть выполнена.|  
  
 Если вы определили в случае, если операция будет продолжена, оставьте параметр *состояния* без изменений. При условии, что входящий параметр состояния не имеет значение **адстатускантдени**, можно отменить отложенную операцию, изменив *состояние* на **адстатусканцел**. После этого для события Complete, связанного с операцией, параметр *Status* имеет значение **адстатусеррорсоккурред**. Объект **ошибки** , переданный в событие complete, будет содержать значение **адерроператионканцеллед**.  
  
 Если вы больше не хотите обрабатывать событие, можно задать для параметра *Status* значение **адстатусунвантедевент** , и ваше приложение больше не будет принимать уведомления о событии. Однако помните, что некоторые события могут вызываться по более чем одной причине. В этом случае необходимо указать **адстатусунвантедевент** для каждой возможной причины. Например, чтобы предотвратить получение уведомлений о событиях, ожидающих **рекордчанже** , необходимо задать для параметра *Status* значение **адстатусунвантедевент** для **адрснадднев**, **адрснделете**, **адрснупдате**, **адрснундаупдате**, **adRsnUndoAddNew**, **adRsnUndoDelete**и **adRsnFirstChange** по мере их появления.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**адстатусунвантедевент**|Запрос этого обработчика событий не получит уведомлений.|  
|**адстатусканцел**|Запросите отмену операции, которая будет выполнена.|  
  
## <a name="error-parameter"></a>Параметр ошибки  
 Параметр *Error* является ссылкой на объект [ошибки](../../reference/ado-api/error-object.md) ADO. Если для параметра *Status* задано значение **Адстатусеррорсоккурред**, объект **Error** содержит сведения о причине сбоя операции. Если событие, связанное с событием Complete, отменило операцию, установив для параметра *Status* значение **адстатусканцел**, то объект Error всегда будет иметь значение **адерроператионканцеллед**.  
  
## <a name="object-parameter"></a>Параметр объекта  
 Каждое событие получает один или несколько объектов, представляющих объекты, участвующие в операции. Например, событие **ексекутекомплете** получает объект **Command** , объект **Recordset** и объект **Connection** .  
  
## <a name="reason-parameter"></a>Параметр Reason  
 Параметр *Reason* , *адреасон*, предоставляет дополнительные сведения о том, почему произошло событие. События с параметром *адреасон* могут вызываться несколько раз, даже для одной и той же операции по каждой другой причине. Например, обработчик событий **виллчанжерекорд** вызывается для выполнения операций или отмены вставки, удаления или изменения записи. Если требуется обработать событие только в том случае, если оно происходит по определенной причине, можно использовать параметр *адреасон* для фильтрации ненужных экземпляров. Например, если требуется обрабатывать события изменения записей только в том случае, если они возникают из-за добавления записи, можно использовать нечто вроде следующего.  
  
```  
' BeginEventExampleVB01  
Private Sub rsTest_WillChangeRecord(ByVal adReason As ADODB.EventReasonEnum, ByVal cRecords As Long, adStatus As ADODB.EventStatusEnum, ByVal pRecordset As ADODB.Recordset)  
   If adReason = adRsnAddNew Then  
       ' Process event  
       '...  
   Else  
       ' Cancel event notification for all  
       ' other possible adReason values.  
       adStatus = adStatusUnwantedEvent  
   End If  
End Sub  
' EndEventExampleVB01  
```  
  
 В этом случае уведомление может возникать по другим причинам. Однако это будет происходить только один раз по каждой причине. После того как уведомление будет выполнено по каждой из причин, вы получите уведомление только о добавлении новой записи.  
  
 Напротив, необходимо установить *адстатус* в **адстатусунвантедевент** только один раз, чтобы запросить, чтобы обработчик событий без параметра **адреасон** не получал уведомлений о событиях.  
  
## <a name="see-also"></a>См. также  
 [Сводка по обработчику событий ADO](./ado-event-handler-summary.md)   
 [Создание экземпляра события ADO по языку](./ado-event-instantiation-by-language.md)   
 [Совместная работа обработчиков событий](./how-event-handlers-work-together.md)   
 [Типы событий](./types-of-events.md)