---
title: Что такое курсор? | Документы Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- cursors [ADO], about cursors
ms.assetid: 596eb4b6-c22f-4cde-b23f-172dd66c3161
author: rothja
ms.author: jroth
ms.openlocfilehash: e2761a716981a5d22fd7f7347f7b757013cccc5d
ms.sourcegitcommit: 6037fb1f1a5ddd933017029eda5f5c281939100c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2020
ms.locfileid: "82763005"
---
# <a name="what-is-a-cursor"></a>Что такое курсор?
Операции в реляционной базе данных выполняются над множеством строк. Набор строк, возвращаемый инструкцией SELECT, содержит все строки, которые удовлетворяют условиям, указанным в предложении WHERE инструкции. Такой полный набор строк, возвращаемых инструкцией, называется результирующим набором. Приложения, особенно интерактивные и интерактивные, не всегда эффективно работают с результирующим набором как единое целое. Им нужен механизм, позволяющий обрабатывать одну строку или небольшое их число за один раз. Курсоры являются расширением результирующих наборов, которые предоставляют такой механизм.  
  
 Курсор реализуется библиотекой курсоров. Библиотека курсоров — это программное обеспечение, которое часто реализуется как часть системы базы данных или API доступа к данным, которое используется для управления атрибутами данных, возвращаемых из источника данных (результирующий набор). Эти атрибуты включают управление параллелизмом, положение в результирующем наборе, число возвращаемых строк и возможность перемещения вперед или назад (или и то, и другое) с помощью результирующего набора (прокрутка).  
  
 Курсор отслеживает позицию в результирующем наборе и позволяет выполнять несколько операций по строкам в результирующем наборе с возвратом к исходной таблице или без него. Иными словами, курсоры основываются на концептуальном возврате результирующего набора на основе таблиц в базах данных. Курсор имеет имя, так как указывает текущую позицию в результирующем наборе, так же как курсор на экране компьютера указывает на текущую позицию.  
  
 Прежде чем перейти к изучению особенностей использования в ADO, важно ознакомиться с понятием курсоров.  
  
 С помощью курсоров можно выполнять следующие задачи:  
  
-   Укажите положение в конкретных строках результирующего набора.  
  
-   Получение одной строки или блока строк на основе текущего расположения результирующего набора.  
  
-   Изменение данных в строках в текущей позиции результирующего набора.  
  
-   Определите различные уровни чувствительности к изменениям данных, внесенным другими пользователями.  
  
 Например, рассмотрим приложение, которое отображает список доступных продуктов для потенциального покупателя. Покупатель прокручивает список, чтобы просмотреть сведения о продукте и стоимость, и, наконец, выбирает продукт для покупки. В оставшейся части списка появляется дополнительная прокрутка и выбор. С точки зрения покупателя продукты появятся по одному за раз, но приложение использует прокручиваемый курсор для просмотра результирующего набора.  
  
 Курсоры можно использовать различными способами:  
  
-   Без строк.  
  
-   С некоторыми или всеми строками в одной таблице.  
  
-   С некоторыми или всеми строками из логически соединяемых таблиц.  
  
-   Для чтения или обновления на уровне курсора или поля.  
  
-   Как однопроходные или полностью прокручиваемые.  
  
-   С набором ключей курсора, расположенным на сервере.  
  
-   Конфиденциальные изменения базовой таблицы, вызванные другими приложениями (например, членство, сортировка, вставка, обновления и удаления).  
  
-   Существующий на сервере или клиенте.  
  
 Курсоры только для чтения помогают пользователям просматривать результирующий набор, а курсоры чтения и записи могут реализовывать отдельные обновления строк. Сложные курсоры можно определять с помощью формируются, которые указывают на строки базовой таблицы. Хотя некоторые курсоры доступны только для чтения в прямом направлении, другие могут перемещаться назад и выполнять динамическое обновление результирующего набора на основе изменений, внесенных другими приложениями в базу данных.  
  
 Не все приложения должны использовать курсоры для доступа к данным и их обновления. Некоторые запросы просто не нуждаются в непосредственной обновлении строк с помощью курсора. Курсоры должны быть одним из последних методов, выбранных для получения данных, а затем следует выбирать наименьший возможный курсор. При создании результирующего набора с помощью хранимой процедуры результирующий набор не обновляется с помощью методов изменения или обновления курсора.  
  
## <a name="concurrency"></a>Параллелизм  
 В некоторых многопользовательских приложениях очень важно, чтобы данные, представляемые конечному пользователю, были как можно более актуальными. Классическим примером такой системы является система резервирования авиакомпании, где многие пользователи могут полагаться на одно и то же место на данном полете (и, следовательно, в одну запись). В таком случае проект приложения должен выполнять параллельные операции над одной записью.  
  
 В других приложениях параллелизм не так важен. В таких случаях затраты, связанные с своевременным хранением данных, не могут быть выровнены по ширине.  
  
## <a name="position"></a>Положение  
 Курсор также отслеживает текущую позицию в результирующем наборе. Можно рассматривать положение курсора как указатель на текущую запись, аналогично тому, как индекс массива указывает на значение в определенном месте в массиве.  
  
## <a name="scrollability"></a>Прокручиваемость  
 Тип курсора, используемый приложением, также влияет на возможность перемещения по строкам в результирующем наборе вперед и назад. Иногда это называется прокруткой. Возможность перемещаться вперед *и* назад по результирующему набору увеличивает сложность курсора и поэтому реализуется более затратно. По этой причине следует запрашивать курсор с этой функцией только при необходимости.
