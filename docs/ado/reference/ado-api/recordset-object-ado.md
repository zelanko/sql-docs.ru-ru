---
description: Объект Recordset (ADO)
title: Объект Recordset (ADO) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
f1_keywords:
- Recordset
helpviewer_keywords:
- Recordset object [ADO]
ms.assetid: ede1415f-c3df-4cc5-a05b-2576b2b84b60
author: rothja
ms.author: jroth
ms.openlocfilehash: d9fade9e23303c9adaa22cad9822381fd10bb513
ms.sourcegitcommit: 7345e4f05d6c06e1bcd73747a4a47873b3f3251f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/24/2020
ms.locfileid: "88772273"
---
# <a name="recordset-object-ado"></a>Объект Recordset (ADO)
Представляет весь набор записей из базовой таблицы или результаты выполненной команды. В любой момент времени объект **Recordset** ссылается только на одну запись в наборе в качестве текущей записи.  
  
## <a name="remarks"></a>Remarks  
 Объекты **набора записей** используются для управления данными от поставщика. При использовании ADO можно манипулировать данными почти полностью с помощью объектов **Recordset** . Все объекты **набора записей** состоят из записей (строк) и полей (столбцов). В зависимости от функциональности, поддерживаемой поставщиком, некоторые методы или свойства **набора записей** могут быть недоступны.  
  
 ADODB. Набор записей — это идентификатор ProgID, который следует использовать для создания объекта **набора записей** . Существующие приложения, которые ссылаются на устаревшую АДОР. Набор записей ProgID продолжит работать без перекомпиляции, но новая разработка должна ссылаться на ADODB. Записей.  
  
 В ADO определены четыре разных типа курсора:  
  
-   **Динамический курсор** Позволяет просматривать добавления, изменения и удаления других пользователей; разрешает перемещение всех типов через **набор записей** , который не зависит от закладок; и позволяет использовать закладки, если поставщик поддерживает их.  
  
-   **Курсор набора ключей** Ведет себя как динамический курсор, за исключением того, что он не позволяет просматривать записи, добавляемые другими пользователями, и запрещает доступ к записям, которые удаляются другими пользователями. Изменения данных, внесенные другими пользователями, будут по-прежнему отображаться. Он всегда поддерживает закладки и, таким образом, допускает перемещение всех типов через **набор записей**.  
  
-   **Статический курсор** Предоставляет статическую копию набора записей, которые можно использовать для поиска данных или создания отчетов. всегда разрешает закладки и, таким образом, позволяет перемещать все типы через **набор записей**. Добавление, изменение или удаление другими пользователями не будет отображаться. Это единственный тип курсора, допустимый при открытии объекта **набора записей** на стороне клиента.  
  
-   **Однонаправленный курсор** Позволяет прокручивать только вперед по **набору записей**. Добавление, изменение или удаление другими пользователями не будет отображаться. Это повышает производительность в ситуациях, когда необходимо сделать только один проход через **набор записей**.  
  
 Установите свойство [примеры CursorType](./cursortype-property-ado.md) перед открытием **набора записей** , чтобы выбрать тип курсора, или передайте аргумент *примеры CursorType* с помощью метода [Open](./open-method-ado-recordset.md) . Некоторые поставщики не поддерживают типы курсоров. Проверьте документацию для поставщика. Если не указать тип курсора, ADO по умолчанию открывает однопроходный курсор.  
  
 Если свойство [CursorLocation](./cursorlocation-property-ado.md) имеет значение **адусеклиент** , чтобы открыть **набор записей**, свойство **UnderlyingValue** для объектов [field](./field-object.md) недоступно в возвращенном объекте **набора записей** . При использовании с некоторыми поставщиками (например, поставщик Microsoft ODBC для OLE DB в сочетании с Microsoft SQL Server) можно создавать объекты **набора записей** независимо от ранее определенного объекта [соединения](./connection-object-ado.md) , передавая строку подключения с помощью метода **Open** . ADO по-прежнему создает объект [соединения](./connection-object-ado.md) , но не присваивает его объектной переменной. Однако при открытии нескольких объектов **набора записей** в одном соединении следует явно создать и открыть объект **соединения** . При этом объект **соединения** назначается объектной переменной. Если не использовать эту переменную объекта при открытии объектов **набора записей** , ADO создает новый объект **соединения** для каждого нового **набора записей**, даже если вы передали одну и ту же строку подключения.  
  
 При необходимости можно создать любое количество объектов **набора записей** .  
  
 При открытии **набора записей**текущая запись помещается в первую запись (если таковая имеется), а свойства [BOF](./bof-eof-properties-ado.md) и [EOF](./bof-eof-properties-ado.md) — в **значение false**. Если записей нет, то значения свойств **BOF** и **EOF** имеют **значение true**.  
  
 Можно использовать методы [MoveFirst](./movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**и **MovePrevious** . метод [Move](./move-method-ado.md) ; и свойства [примеры AbsolutePosition](./absoluteposition-property-ado.md), [примеры absolutepage](./absolutepage-property-ado.md)и [Filter](./filter-property.md) , чтобы изменить положение текущей записи, предполагая, что поставщик поддерживает соответствующие функции. Объекты **Recordset** только вперед поддерживают только метод [MoveNext](./movefirst-movelast-movenext-and-moveprevious-methods-ado.md) . При использовании методов **Move** для посещения каждой записи (или перечисления **набора записей**) можно использовать свойства **BOF** и **EOF** , чтобы определить, перешли ли вы за начало или конец **набора записей**.  
  
 Прежде чем использовать какие-либо функции объекта **Recordset** , необходимо **вызвать метод** Supported для объекта, чтобы убедиться, что функциональные возможности поддерживаются или доступны. Не следует использовать функциональные возможности, если метод **поддерживает** возврат значения false. Например, метод **MovePrevious** можно использовать, только если `Recordset.Supports(adMovePrevious)` возвращает **значение true**. В противном случае возникнет ошибка, так как объект **набора записей** мог быть закрыт и функции, отображаемые в экземпляре, недоступны. Если интересующая вас функция не поддерживается, то **поддерживает** также значение false. В этом случае следует избегать вызова соответствующего свойства или метода объекта **Recordset** .  
  
 Объекты **набора записей** могут поддерживать два типа обновления: медленные и пакетные. При немедленном обновлении все изменения данных немедленно записываются в базовый источник данных после вызова метода [Update](./update-method.md) . Можно также передавать массивы значений в качестве параметров с помощью методов [AddNew](./addnew-method-ado.md) и **Update** и одновременно обновлять несколько полей в записи.  
  
 Если поставщик поддерживает пакетное обновление, то можно изменить кэш поставщика на несколько записей, а затем передать их в одном вызове к базе данных с помощью метода [UpdateBatch](./updatebatch-method.md) . Это относится к изменениям, внесенным в методы **AddNew**, **Update**и [Delete](./delete-method-ado-recordset.md) . После вызова метода **UpdateBatch** можно использовать свойство [Status](./status-property-ado-recordset.md) для проверки конфликтов данных, чтобы устранить их.  
  
> [!NOTE]
>  Чтобы выполнить запрос без использования объекта [Command](./command-object-ado.md) , передайте строку запроса в метод **Open** объекта **Recordset** . Однако объект **команды** необходим, если нужно сохранить текст команды и повторно выполнить его, либо использовать параметры запроса.  
  
 Свойство [mode](./mode-property-ado.md) управляет разрешениями на доступ.  
  
 Коллекция **Fields** является элементом по умолчанию объекта **Recordset** . В результате следующие два оператора кода эквивалентны.  
  
```  
Debug.Print objRs.Fields.Item(0)  ' Both statements print   
Debug.Print objRs(0)              '  the Value of Item(0).  
```  
  
 При передаче объекта **набора записей** между процессами выполняется маршалинг только значений **набора строк** , а свойства объекта **Recordset** игнорируются. Во время распаковки **набор строк** распаковывается в созданный объект **набора записей** , который также устанавливает для его свойств значения по умолчанию.  
  
 Объект **набора записей** является надежным для сценариев.  
  
 Этот раздел содержит следующий раздел.  
  
-   [Свойства, методы и события объекта Recordset](./recordset-object-properties-methods-and-events.md)  
  
## <a name="see-also"></a>См. также  
 [Объект Connection (ADO)](./connection-object-ado.md)   
 [Коллекция Fields (ADO)](./fields-collection-ado.md)   
 [Коллекция Properties (ADO)](./properties-collection-ado.md)   
 [Приложение А. Поставщики](../../guide/appendixes/appendix-a-providers.md)