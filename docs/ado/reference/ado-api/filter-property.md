---
title: Свойство Filter | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 03/20/2018
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
f1_keywords:
- Recordset15::Filter
helpviewer_keywords:
- Filter property
ms.assetid: 80263a7a-5d21-45d1-84fc-34b7a9be4c22
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: cede9be7c484d40c2220fc891779f7dfb6e5a8df
ms.sourcegitcommit: 61381ef939415fe019285def9450d7583df1fed0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47762752"
---
# <a name="filter-property"></a>Свойство Filter
Задает фильтр для данных в [записей](../../../ado/reference/ado-api/recordset-object-ado.md).  
  
## <a name="settings-and-return-values"></a>Параметры и возвращаемые значения

Возвращает или задает **Variant** значение, которое может содержать один из следующих элементов:  
  
-   **Строка критерия:** строка состоит из одного или нескольких отдельных предложений, объединенным с **AND** или **OR** операторы.  
  
-   **Массив закладки:** массив закладки уникальных значений, указывающими на записи в **записей** объекта.  
  
-   Объект [FilterGroupEnum](../../../ado/reference/ado-api/filtergroupenum.md) значение.  
  
## <a name="remarks"></a>Примечания

Используйте **фильтра** свойство, чтобы выборочно отсеять записей в **записей** объекта. Обработанные фильтром **записей** становится текущий курсор. Другие свойства, возвращающие значения на основе текущего **курсор** затронуты, такие как [свойство примеры AbsolutePosition (ADO)](../../../ado/reference/ado-api/absoluteposition-property-ado.md), [свойство примеры AbsolutePage (ADO)](../../../ado/reference/ado-api/absolutepage-property-ado.md), [ Свойство RecordCount (ADO)](../../../ado/reference/ado-api/recordcount-property-ado.md), и [свойство PageCount (ADO)](../../../ado/reference/ado-api/pagecount-property-ado.md). Установка **фильтра** свойства определенного нового значения перемещает текущей записи к первой записи, которая удовлетворяет новое значение.
  
Строку критериев состоит из предложений в форме *FieldName-оператор-Value* (например, `"LastName = 'Smith'"`). Составные предложения можно создать путем объединения отдельных предложений с **AND** (например, `"LastName = 'Smith' AND FirstName = 'John'"`) или **OR** (например, `"LastName = 'Smith' OR LastName = 'Jones'"`). Для строки критериев следуйте приведенным ниже рекомендациям:

-   *FieldName* должно быть именем допустимого поля из **записей**. Если имя содержит пробелы, необходимо заключить имя в квадратные скобки.  
  
-   Оператор должен иметь одно из следующих: \<, >, \<=, > =, <>, =, или **как**.  
  
-   Значение является значением, с которым требуется выполнить сравнение значения полей (например, «Smith», # 8/24/95 прежних версий, 12,345 или 50,00 долларов США). Используйте одинарные кавычки со строками и знаки фунта (#) с датами. Можно использовать для чисел, десятичных запятых, знак доллара и экспоненциальное представление чисел. Если оператор **как**, значение можно использовать подстановочные знаки. Допускается только символ звездочки (*) и подстановочные знаки процента (%), и они должны быть последним символом в строке. Не может иметь значение null.  
  
> [!NOTE]
>  Чтобы включить одинарные кавычки (') в фильтре значение, используйте две одинарные кавычки для представления одного. Например, для фильтрации на O'Malley критерии строка должна быть `"col1 = 'O''Malley'"`. Чтобы включить одинарные кавычки в начале и конце значения фильтра, необходимо заключить строку с знаки фунта (#). Например, чтобы отфильтровать "1", критерии строка должна быть `"col1 = #'1'#"`.  
  
-   Имеется не очередность выполнения и и или. Предложения можно группировать в скобки. Тем не менее нельзя объединить с OR предложениях group и затем присоединиться к группе на другое предложение с предложением AND, как показано в следующем фрагменте кода:  
 `(LastName = 'Smith' OR LastName = 'Jones') AND FirstName = 'John'`  
  
-   Вместо этого можно построить этот фильтр как  
 `(LastName = 'Smith' AND FirstName = 'John') OR (LastName = 'Jones' AND FirstName = 'John')`  
  
-   В **как** предложение, можно использовать подстановочный знак в начале и в конце шаблона. Например, можно использовать `LastName Like '*mit*'`. Или с **как** подстановочного знака можно использовать только в конце шаблона. Например, `LastName Like 'Smit*'`.  
  
 Константы фильтра облегчают устранения отдельных записей конфликтов при пакетный режим обновления, позволяя просмотреть, к примеру, только те записи, были затронуты во время последней [метод UpdateBatch](../../../ado/reference/ado-api/updatebatch-method.md) вызова метода.  
  
Установка **фильтра** само свойство может завершиться ошибкой из-за конфликта с базовыми данными. Например Эта ошибка может произойти, если запись уже был удален другим пользователем. В этом случае поставщик возвращает предупреждения, чтобы [коллекции ошибок (ADO)](../../../ado/reference/ado-api/errors-collection-ado.md) коллекции, но не приостанавливает выполнение программы. Только в том случае, если есть конфликты запрошенными записями, возникает ошибка во время выполнения. Используйте [свойство Status (объект Recordset ADO)](../../../ado/reference/ado-api/status-property-ado-recordset.md) свойства для поиска записей с конфликтами.  
  
Установка **фильтра** строку нулевой длины ("») имеет тот же эффект, как с помощью **adFilterNone** константы.
  
Каждый раз, когда **фильтра** свойство задано, перемещает положение текущей записи к первой записи в отфильтрованное подмножество записей в **записей**. Аналогичным образом, когда **фильтра** очищается, перемещает положение текущей записи к первой записи в **записей**.

Предположим, что **записей** фильтруется по полю некоторого типа variant, такие как тип sql_variant. Ошибка (DISP_E_TYPEMISMATCH или 80020005) происходит, когда подтипы значений полей и фильтров, используемых в строку критериев не совпадают. Например предположим, что:

- Объект **записей** объект (rs) содержит столбец типа sql_variant (C).
- И поле этого столбца, явно назначенной значение 1, I4 типа. Имеет значение строку критериев `rs.Filter = "C='A'"` по полю.

Эта конфигурация создает ошибки во время выполнения. Тем не менее `rs.Filter = "C=2"` применены на том же поле не будет создавать ошибки. И поле, отфильтрованы из текущего набора записей.

См. в разделе [свойство закладки (ADO)](../../../ado/reference/ado-api/bookmark-property-ado.md) свойство объяснение значений закладки, из которых можно создать массив для использования со свойством фильтра.

Только для фильтров в виде строк критериям влияют на содержимое материализованный **записей**. Пример строки критериев — `OrderDate > '12/31/1999'`. Фильтры, созданные с помощью массива, закладки или с помощью значения из **FilterGroupEnum**, не влияют на содержимое сохраненного **записей**. Эти правила применяются в наборы записей, созданных с помощью курсоров на стороне клиента или на сервере.
  
> [!NOTE]
>  При применении флаг adFilterPendingRecords для фильтруемого и изменения **записей** в пакетном режиме обновления, полученный **записей** является пустым, если фильтр был основан на ключевое поле таблицы с одним ключом и изменение стало значения ключевого поля. Полученный **записей** будет пустым при выполнении одного из следующих инструкций:  
  
-   Фильтрация был основан на неключевых полей в таблице, ключом которого является одним.  
  
-   Фильтрация был основан на все поля в таблице, ключом которого является несколько.  
  
-   Для неключевых полей в таблице, ключом которого является одним были внесены изменения.  
  
-   Для всех полей в таблице, ключом которого является несколько были внесены изменения.  
  
В следующей таблице перечислены последствия **adFilterPendingRecords** в различных сочетаниях, фильтрации и изменения. В левом столбце приведены возможные изменения. Можно внести изменения на любое из полей не с ключом, на поле ключа в таблице, ключом которого является одним или на любой из ключевых полей в таблице, ключом которого является несколько. Верхняя строка показывает критерий фильтрации. Фильтрация может основываться на любое из полей не с ключом, поле ключа в таблице, ключом которого является одним или любой из ключевых полей в таблице, ключом которого является несколько. Пересекающиеся ячейки отображают результаты. Объект **+** знак «плюс» означает, что применение **adFilterPendingRecords** приводит к пустым **записей**. Объект **-** "минус" означает, что пустой **записей**.  
  
||Не ключи|Один ключ|Несколько ключей|
|-|--------------|----------------|-------------------|
|**Не ключи**|+|+|+|
|**Один ключ**|+|-|Недоступно|
|**Несколько ключей**|+|Недоступно|+|
|||||
  
## <a name="applies-to"></a>Объект применения

[Объект Recordset (ADO)](../../../ado/reference/ado-api/recordset-object-ado.md)  
  
## <a name="see-also"></a>См. также

[Filter и RecordCount свойства (Visual Basic)](../../../ado/reference/ado-api/filter-and-recordcount-properties-example-vb.md)
[Filter и RecordCount свойства (Visual C++)](../../../ado/reference/ado-api/filter-and-recordcount-properties-example-vc.md)
[метод Clear (ADO)](../../../ado/reference/ado-api/clear-method-ado.md) 
 [Optimize (динамическое свойство (ADO)](../../../ado/reference/ado-api/optimize-property-dynamic-ado.md)
