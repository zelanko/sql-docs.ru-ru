---
description: Объект Command (ADO)
title: Объект Command (ADO) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
f1_keywords:
- Command
helpviewer_keywords:
- Command object [ADO]
ms.assetid: a02c22fb-542d-465e-a629-30fd59dcbebf
author: rothja
ms.author: jroth
ms.openlocfilehash: d876be4883844790815a0640d26cee2933ca17f2
ms.sourcegitcommit: 7345e4f05d6c06e1bcd73747a4a47873b3f3251f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/24/2020
ms.locfileid: "88776163"
---
# <a name="command-object-ado"></a>Объект Command (ADO)
Определяет конкретную команду, которую необходимо выполнить для источника данных.  
  
## <a name="remarks"></a>Remarks  
 Используйте объект **Command** , чтобы запрашивать базу данных и возвращать записи в объекте [набора записей](./recordset-object-ado.md) , выполнять групповые операции или управлять структурой базы данных. В зависимости от функциональных возможностей поставщика некоторые коллекции **команд** , методы или свойства могут вызвать ошибку при ссылке.  
  
 С помощью коллекций, методов и свойств объекта **Command** можно выполнять следующие действия.  
  
-   Определите исполняемый текст команды (например, инструкцию SQL) со свойством [CommandText](./commandtext-property-ado.md) . Кроме того, для структур команд или запросов, отличных от простых строк (например, XML-запросов шаблонов), можно определить команду с помощью свойства [CommandStream](./commandstream-property-ado.md) .  
  
-   При необходимости укажите диалект команды, используемый в **CommandText** или **CommandStream** со свойством [диалекта](./dialect-property.md) .  
  
-   Определите параметризованные запросы или аргументы хранимой процедуры с объектами [параметров](./parameter-object.md) и коллекцией [Parameters](./parameters-collection-ado.md) .  
  
-   Укажите, следует ли передавать имена параметров в поставщик с помощью свойства [NamedParameters](./namedparameters-property-ado.md) .  
  
-   Выполните команду и верните объект **набора записей** , если он подходит для метода [EXECUTE](./execute-method-ado-command.md) .  
  
-   Укажите тип команды со свойством [CommandType](./commandtype-property-ado.md) перед выполнением, чтобы оптимизировать производительность.  
  
-   Контролируйте, сохраняет ли поставщик подготовленную (или скомпилированную) версию команды перед выполнением с помощью [подготовленного](./prepared-property-ado.md) свойства.  
  
-   Задайте количество секунд, в течение которых поставщик будет ожидать выполнения команды со свойством [CommandTimeout](./commandtimeout-property-ado.md) .  
  
-   Свяжите открытое соединение с объектом **Command** , задав свойство [ActiveConnection](./activeconnection-property-ado.md) .  
  
-   Задайте свойство [Name](./name-property-ado.md) , чтобы определить объект **команды** в качестве метода для связанного объекта [соединения](./connection-object-ado.md) .  
  
-   Передайте объект **Command** свойству [Source](./source-property-ado-recordset.md) **набора записей** для получения данных.  
  
-   Доступ к атрибутам, зависящим от поставщика, с коллекцией [свойств](./properties-collection-ado.md) .  
  
> [!NOTE]
>  Чтобы выполнить запрос без использования объекта **Command** , передайте строку запроса методу [EXECUTE](./execute-method-ado-connection.md) объекта **Connection** или методу [Open](./open-method-ado-recordset.md) объекта **Recordset** . Однако объект **команды** необходим, если нужно сохранить текст команды и повторно выполнить его, либо использовать параметры запроса.  
  
 Чтобы создать объект **команды** независимо от ранее определенного объекта **соединения** , задайте для его свойства **ActiveConnection** допустимую строку подключения. ADO по-прежнему создает объект **соединения** , но не присваивает его объектной переменной. Однако при связывании нескольких **командных** объектов с одним и тем же соединением следует явно создать и открыть объект **соединения** . При этом объект **соединения** назначается объектной переменной. Убедитесь, что объект **соединения** был успешно открыт, прежде чем присвоить его свойству **ActiveConnection** объекта **Command** , поскольку при назначении закрытого объекта **соединения** возникает ошибка. Если свойство **ActiveConnection** объекта **Command** не задано для этой объектной переменной, ADO создает новый объект **соединения** для каждого **командного** объекта, даже если используется та же строка подключения.  
  
 Чтобы выполнить **команду**, вызовите ее по свойству [Name](./name-property-ado.md) для связанного объекта **соединения** . Для **команды** должно быть задано свойство **ActiveConnection** объекта **Connection** . Если **команда** имеет параметры, передайте их значения в качестве аргументов в метод.  
  
 Если в одном соединении выполняются два или более **командных** объектов, а любой из этих **команд** является хранимой процедурой с выходными параметрами, возникает ошибка. Для выполнения каждого объекта **команды** используйте отдельные соединения или отключите все остальные объекты **команд** из соединения.  
  
 Коллекция **Parameters** является элементом по умолчанию для объекта **Command** . В результате следующие два оператора кода эквивалентны.  
  
```  
objCmd.Parameters.Item(0)  
objCmd(0)  
```  
  
-   Объект **Command** не является надежным для сценариев.  
  
 Этот раздел содержит следующий раздел.  
  
-   [Свойства, методы и события объекта Command](./command-object-properties-methods-and-events.md)  
  
## <a name="see-also"></a>См. также  
 [Объект Connection (ADO)](./connection-object-ado.md)   
 [Коллекция Parameters (ADO)](./parameters-collection-ado.md)   
 [Коллекция Properties (ADO)](./properties-collection-ado.md)   
 [Приложение А. Поставщики](../../guide/appendixes/appendix-a-providers.md)