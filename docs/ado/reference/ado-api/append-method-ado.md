---
description: Метод Append (ADO)
title: Метод Append (ADO) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
f1_keywords:
- _DynaCollection::Append
helpviewer_keywords:
- Append method [ADO]
ms.assetid: f8a9bbed-ba9c-4698-945d-317ad22d2e92
author: rothja
ms.author: jroth
ms.openlocfilehash: 84969b95751726579bdc7d4a61aee311b95b6108
ms.sourcegitcommit: 18a98ea6a30d448aa6195e10ea2413be7e837e94
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2020
ms.locfileid: "88976085"
---
# <a name="append-method-ado"></a>Метод Append (ADO)
Добавляет объект в коллекцию. Если коллекция является [полями](./fields-collection-ado.md), то перед добавлением в коллекцию можно создать новый объект [поля](./field-object.md) .  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
collection.Append object  
fields.Append Name, Type, DefinedSize, Attrib, FieldValue  
```  
  
#### <a name="parameters"></a>Параметры  
 *набор*  
 Объект коллекции.  
  
 *поля*  
 Коллекция **Fields** .  
  
 *object*  
 Объектная переменная, представляющая объект, который необходимо добавить.  
  
 *имя*;  
 **Строковое** значение, содержащее имя нового объекта **field** и не должно совпадать с именем любого другого объекта в *полях*.  
  
 *Тип*  
 Значение [дататипинум](./datatypeenum.md) , значение по умолчанию которого равно **адемпти**, которое указывает тип данных нового поля. Следующие типы данных не поддерживаются ADO и не должны использоваться при добавлении новых полей в [объект Recordset (ADO)](./recordset-object-ado.md): **адидиспатч**, **адиункновн**, **адвариант**.  
  
 *DefinedSize*  
 Необязательный элемент. Значение **типа Long** , представляющее определенный размер (в символах или байтах) нового поля. Значение по умолчанию для этого параметра является производным от *типа*. Поля с *DefinedSize* размером более 255 байт рассматриваются как столбцы переменной длины. Значение по умолчанию для *DefinedSize* не указано.  
  
 *Атрибуты*  
 Необязательный элемент. Значение [фиелдаттрибутинум](./fieldattributeenum.md) , для которого значение по умолчанию — **адфлддефаулт**, определяющее атрибуты для нового поля. Если это значение не указано, поле будет содержать атрибуты, производные от *типа*.  
  
 *FieldValue*  
 Необязательный элемент. **Вариант** , представляющий значение для нового поля. Если не указано, то поле добавляется со значением NULL.  
  
## <a name="remarks"></a>Remarks  
  
## <a name="parameters-collection"></a>Коллекция Parameters  
 Необходимо задать свойство [Type](./type-property-ado.md) объекта [Parameter](./parameter-object.md) , прежде чем добавлять его в коллекцию [Parameters](./parameters-collection-ado.md) . Если выбран тип данных переменной длины, необходимо также задать для свойства [size](./size-property-ado-parameter.md) значение больше нуля.  
  
 Описание параметров самостоятельно сокращает число вызовов к поставщику и, таким образом, повышает производительность при использовании хранимых процедур или параметризованных запросов. Однако необходимо иметь представление о свойствах параметров, связанных с хранимой процедурой или параметризованным запросом, которые необходимо вызвать.  
  
 Используйте метод [CreateParameter](./createparameter-method-ado.md) для создания объектов **параметров** с соответствующими параметрами свойств и используйте метод **append** , чтобы добавить их в коллекцию [Parameters](./parameters-collection-ado.md) . Это позволяет задавать и возвращать значения параметров без вызова поставщика для сведений о параметрах. При записи в поставщик, который не предоставляет сведения о параметрах, необходимо использовать этот метод, чтобы вручную заполнить коллекцию **Parameters** , чтобы использовать параметры.  
  
## <a name="fields-collection"></a>Коллекция Fields  
 Параметр *FieldValue* допустим только при добавлении объекта **поля** в объект [Record](./record-object-ado.md) , а не в объект **набора записей** . С объектом **Record** можно добавлять поля и предоставлять значения одновременно. При использовании объекта **Recordset** необходимо создать поля, пока **набор записей** будет закрыт, а затем открыть **набор записей** и присвоить значения полям.  
  
> [!NOTE]
>  Для новых объектов **field** , которые были добавлены к коллекции **Fields** объекта **Record** , необходимо задать свойство [value](./value-property-ado.md) , прежде чем можно будет указать другие свойства **поля** . Во-первых, конкретное значение свойства **value** должно быть назначено и [Обновлено](./update-method.md) в коллекции **Fields** с именем. Затем можно получить доступ к другим свойствам, например к [типу](./type-property-ado.md) или [атрибутам](./attributes-property-ado.md) . Объекты **полей** следующих типов данных (**дататипинум**) не могут быть добавлены в коллекцию **Fields** , и это приведет к ошибке: **адаррай**, **адчаптер**, **адемпти**, **адпропвариант**и **адусердефинед**. Кроме того, следующие типы данных не поддерживаются ADO: **адидиспатч**, **адиункновн**и **адивариант**. Для этих типов ошибка не будет возникать при добавлении, но использование может привести к непредсказуемым результатам, включая утечки памяти.  
  
## <a name="recordset"></a>набор записей  
 Если не задать свойство [CursorLocation](./cursorlocation-property-ado.md) перед вызовом метода **append** , **CursorLocation** будет иметь значение **адусеклиент** ( [курсорлокатионенум](./cursorlocationenum.md) Value) автоматически при вызове метода [открытия](./open-method-ado-recordset.md) объекта [Recordset](./recordset-object-ado.md) .  
  
 Если метод **append** вызывается для коллекции **полей** открытого **набора записей**или для набора **записей** , где было задано свойство [ActiveConnection](./activeconnection-property-ado.md) , возникнет ошибка времени выполнения. Поля можно добавлять только в **набор записей** , который не является открытым и еще не подключен к источнику данных. Обычно это происходит, когда объект **набора записей** создается с помощью метода [CreateRecordset](../rds-api/createrecordset-method-rds.md) или присваивается объектной переменной.  
  
## <a name="record"></a>Записей  
 Ошибка времени выполнения не возникает, если метод **append** вызывается для коллекции **полей** открытой **записи**. Новое поле будет добавлено в коллекцию **полей** объекта **Record** . Если **запись** была получена из **набора записей**, новое поле не будет отображаться в коллекции **полей** объекта **Recordset** .  
  
 Несуществующее поле может быть создано и добавлено к коллекции **Fields** путем присвоения значения объекту поля, как если бы оно уже существовало в коллекции. Назначение активирует автоматическое создание и добавление объекта **поля** , после чего назначение будет завершено.  
  
 После добавления **поля** в коллекцию **Fields** объекта **Record** вызовите метод **Update** коллекции **Fields** , чтобы сохранить изменения.  
  
## <a name="applies-to"></a>Применение  
  
- [Коллекция Fields (ADO)](./fields-collection-ado.md)  
- [Коллекция Parameters (ADO)](./parameters-collection-ado.md)  
  
## <a name="see-also"></a>См. также  
 [Примеры методов Append и CreateParameter (Visual Basic)](./append-and-createparameter-methods-example-vb.md)   
 [Пример методов Append и CreateParameter (Visual c++)](./append-and-createparameter-methods-example-vc.md)   
 [Метод CreateParameter (ADO)](./createparameter-method-ado.md)   
 [Метод Delete (коллекция полей ADO)](./delete-method-ado-fields-collection.md)   
 [Метод Delete (Коллекция параметров ADO)](./delete-method-ado-parameters-collection.md)   
 [Метод Delete (набор записей ADO)](./delete-method-ado-recordset.md)   
 [Метод Update](./update-method.md)