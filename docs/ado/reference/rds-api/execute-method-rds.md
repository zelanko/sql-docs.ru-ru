---
title: Выполнение метода (RDS) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.suite: sql
ms.tgt_pltfrm: ''
ms.topic: conceptual
apitype: COM
helpviewer_keywords:
- Execute method [ADO]
ms.assetid: 2d9c30e9-ab5b-4920-91b8-48454c2fb5d8
caps.latest.revision: 20
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 9da5eafd3533e4384a5c7e40e6e81691ede173e9
ms.sourcegitcommit: b70b99c2e412b4d697021f3bf1a92046aafcbe37
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/13/2018
ms.locfileid: "40392361"
---
# <a name="execute-method-rds"></a>Метод Execute (служба удаленных рабочих столов)
Выполняет запрос и создает набор записей ADO для использования в ADO, 2.5 и более поздних версий.  
  
> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, серверные компоненты служб удаленных рабочих СТОЛОВ, больше не включаются в операционной системе Windows (см. в разделе Windows 8 и [настольная книга по совместимости Windows Server 2012](https://www.microsoft.com/en-us/download/details.aspx?id=27416) для получения дополнительных сведений). Клиентские компоненты служб удаленных рабочих СТОЛОВ будет поддерживаться в будущих версиях Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие служб удаленных рабочих СТОЛОВ, следует перевести [WCF-сервиса данных](http://go.microsoft.com/fwlink/?LinkId=199565).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
object.Execute(ConnectionString As String, HandlerString As String, QueryString As String, lFetchOptions As Long, Properties, TableId, lExecuteOptions As Long, pParameters, [lcid As Long], [pInformation])  
```  
  
#### <a name="parameters"></a>Параметры  
 *connectionString*  
 Строка, используемая для подключения к поставщику OLE DB, куда будут отправляться запрос для выполнения. Если обработчик задается с помощью *HandlerString* его можно изменить или заменить строку подключения.  
  
 *HandlerString*  
 Двойная строка, определяющая обработчик для использования с этого выполнения. Строка состоит из двух частей. Первая часть содержит имя (ProgID) обработчика для использования. Вторая часть содержит аргументы, передаваемые обработчику. Сведения о способ интерпретации строки аргументы относятся только к каждому обработчику. Эти две части разделяются первого вхождения запятой в строку. Строка аргументов может содержать дополнительные запятые. Аргументы являются необязательными.  
  
 *Переменная строки запроса*  
 Команды в командный язык, поддерживаемые поставщиком OLE DB, указанную в строке подключения. Для поставщиков на основе SQL *QueryString* может содержать инструкцию команды Transact-SQL, но для отличных от SQL поставщиков (например, MSDataShape) это может оказаться [!INCLUDE[tsql](../../../includes/tsql-md.md)] оператора запроса.  
  
 Если используется обработчик, обработчик можно изменить или заменить значение, указанное здесь. Например, обычно заменяет обработчик *QueryString* со строкой запроса из его INI-файла. По умолчанию используется файл Msdfmap.ini.  
  
 *lFetchOptions*  
 Указывает тип асинхронной выборки.  
  
 Дополнительные сведения см. в разделе [свойство FetchOptions (RDS)](../../../ado/reference/rds-api/fetchoptions-property-rds.md).  
  
 *TableID*  
 Объект **Variant** типа VT_BSTR, либо значение VT_EMPTY. Если это значение имеет тип VT_EMPTY, он игнорируется. Если это типа VT_BSTR, набор записей создается с помощью **adCmdTableDirect** и указанное здесь значение и *QueryString* параметр учитывается.  
  
 *lExecuteOptions*  
 Битовая маска параметров выполнения:  
  
 1 =*ReadOnly* набор записей будет открыт с помощью **adLockReadOnly**.  
  
 2 =*NoBatch* набор записей будет открыт с помощью **adLockOptimistic**.  
  
 4 =*AllParamInfoSupplied* вызывающий объект гарантирует, что предоставлены сведения о параметрах для всех параметров в *pParameters*.  
  
 8 =*GetInfo* сведения о параметрах для запроса будет получен от поставщика OLE DB и возвращено в *pParameters* параметра. Запрос не выполняется и возвращается без набора записей.  
  
 16 =*GetHiddenColumns* набор записей будет открыт с помощью **adLockBatchOptimistic** и скрытые столбцы, которые будут включены в набор записей.  
  
 *Только для чтения*, *NoBatch* и *GetHiddenColumns* являются взаимоисключающими; тем не менее, не вызывает ошибку, чтобы задать более одного из них. Если несколько параметров, *GetHiddenColumns* приоритет, чем все остальные, за которым следует *ReadOnly*. Если параметры не указаны, по умолчанию открывается набор записей с помощью **adLockBatchOptimistic** и скрытые столбцы не включены в набор записей.  
  
 *pParameters*  
 Объект **Variant** , содержащий безопасный массив определений параметров. Если *GetInfo* параметр был указан в *lExecuteOptions*, этот параметр используется для возврата определения параметров, полученного от поставщика OLE DB. В противном случае этот параметр может быть пустым.  
  
 *lcid*  
 Код языка используется для построения все ошибки, возвращаемые в *pInformation*.  
  
 *pInformation*  
 Указатель на сведения ошибка, возвращенная Execute. Если значение равно NULL, возвращаются сведения об ошибке отсутствуют.  
  
## <a name="remarks"></a>Примечания  
 *HandlerString* параметр может иметь значение null. Что произойдет, в этом случае зависит от того, как настроен сервер служб удаленных рабочих СТОЛОВ. Обработчик строку «MSDFMAP.handler» указывает, что следует использовать обработчик предоставленный корпорацией Майкрософт (Msdfmap.dll). Обработчик строку «MASDFMAP.handler,sample.ini» указывает, что следует использовать обработчик Msdfmap.dll и что «sample.ini» аргумент должен передаваться обработчику. Аргумент MSDFMAP.dll интерпретирует как направление, в которых будет производиться sample.ini Проверьте строки соединения и запроса.  
  
## <a name="applies-to"></a>Объект применения  
 [Объект DataFactory (RDSServer)](../../../ado/reference/rds-api/datafactory-object-rdsserver.md)


