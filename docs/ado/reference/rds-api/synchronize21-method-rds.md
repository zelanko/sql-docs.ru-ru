---
title: Метод Synchronize21 (RDS) | Документация Майкрософт
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.prod: sql
ms.prod_service: connectivity
ms.topic: conceptual
apitype: COM
helpviewer_keywords:
- Synchronize21 method [ADO]
ms.assetid: 6b35f136-9d9a-4bdd-8144-67decfd3c4e9
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 66c3b9ecefd63cf7de1806e6fa838a0204626605
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "67963254"
---
# <a name="synchronize21-method-rds"></a>Метод Synchronize21 (служба удаленных рабочих столов)
Синхронизирует заданный набор записей с базой данных, указанной в строке подключения для использования с ADO 2,1.  
  
> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, компоненты RDS больше не включены в операционную систему Windows (Дополнительные сведения см. в статье о совместимости Windows 8 и [Windows server 2012 Cookbook](https://www.microsoft.com/download/details.aspx?id=27416) ). Клиентские компоненты RDS будут удалены в следующей версии Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие RDS, должны переноситься в [службу данных WCF](https://go.microsoft.com/fwlink/?LinkId=199565).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
object.Synchronize21(ConnectionString As String, HandlerString As String, lSynchronizeOptions As Long, ppRecordset As Object, pStatusArray)  
```  
  
#### <a name="parameters"></a>Параметры  
 *ConnectionString*  
 Строка, используемая для подключения к поставщику OLE DB, в котором будет отправлен запрос. Если используется обработчик, обработчик может изменить или заменить строку подключения.  
  
 *хандлерстринг*  
 Строка определяет обработчик, который будет использоваться с этим выполнением. Строка содержит две части. Первая часть содержит имя (ProgID) используемого обработчика. Вторая часть строки содержит аргументы, передаваемые в обработчик. Как интерпретируется строка аргументов, зависит от обработчика. Две части разделяются первым экземпляром запятой в строке. Строка arguments может содержать дополнительные запятые. Аргументы являются необязательными.  
  
 *лсинчронизеоптионс*  
 Битовая маска параметров синхронизации.  
  
 1 =*упдатетрансакт* обновления базы данных упаковываются в транзакцию. Транзакция прерывается, если какое-либо из обновлений завершилось сбоем.  
  
 2 =*рефрешвисупдате* приводит к возвращению состояний строк, если не заданы ни *Обновление* , ни *рефрешконфликтс* .  
  
 4 =*Обновить* набор записей обновляется текущими данными из базы данных. Ожидающие обновления не отправляются в базу данных. Если этот бит не установлен, набор записей не обновляется и все ожидающие обновления отправляются в базу данных.  
  
 8 =*рефрешконфликтс* . не удается обновить все строки с ожидающими изменениями. Строки, которые не удалось обновить, обновляются текущими данными из базы данных.  
  
 *ppRecordset*  
 Указатель на указатель на набор записей для синхронизации.  
  
 *пстатусаррай*  
 Вариант, используемый для возврата безопасного массива состояний строк для строк, затронутых синхронизацией. Не задается, если не задан ни один из следующих параметров синхронизации: *рефрешвисупдате*, *Refresh* и *рефрешконфликтс*.  
  
## <a name="remarks"></a>Remarks  
 Параметр *хандлерстринг* может иметь значение null. Что происходит в этом случае, зависит от настройки сервера RDS. Строка обработчика "МСДФМАП. Handler" указывает, что следует использовать предоставляемый корпорацией Майкрософт обработчик (Мсдфмап. dll). Строка обработчика "МАСДФМАП. Handler; Sample. ini" указывает, что должен использоваться обработчик Мсдфмап. dll, а аргумент "Sample. ini" должен быть передан обработчику. Мсдфмап. dll примет аргумент в качестве направления использования файла Sample. ini для проверки соединения и строк запроса.  
  
> [!NOTE]
>  Метод **Synchronize21** — это просто версия [метода Synchronize (RDS)](../../../ado/reference/rds-api/synchronize-method-rds.md). Когда необходимо использовать метод **Synchronize** для взаимодействия с ADO 2,1, вместо него можно вызвать метод **Synchronize21** . Возможности метода **Synchronize** в ADO 2,5 и более поздних версиях представляют собой надмножество возможностей, предоставляемых для того же метода в ADO 2,1.  
  
## <a name="applies-to"></a>Применяется к  
 [Объект DataFactory (RDSServer)](../../../ado/reference/rds-api/datafactory-object-rdsserver.md)


