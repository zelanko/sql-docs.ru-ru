---
title: Настройка обработки ошибок и предупреждений с помощью драйвера SQLSRV | Документы Microsoft
ms.custom: ''
ms.date: 03/26/2018
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: php
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- errors and warnings
ms.assetid: 257c6f53-9137-4619-a613-eee33d2077e8
caps.latest.revision: 20
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: f2683ec1060f6aef98aa1b51323e511f8e1d5b22
ms.sourcegitcommit: 7a6df3fd5bea9282ecdeffa94d13ea1da6def80a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="how-to-configure-error-and-warning-handling-using-the-sqlsrv-driver"></a>Практическое руководство. Настройка обработки ошибок и предупреждений с помощью драйвера SQLSRV
[!INCLUDE[Driver_PHP_Download](../../includes/driver_php_download.md)]

Эта статья описывает настройку драйвера SQLSRV для обработки ошибок и предупреждений.  
  
По умолчанию драйвер SQLSRV рассматривает предупреждения как ошибки; вызов **sqlsrv** возвращает функцию, которая создает ошибку или предупреждение **false**. Чтобы отключить такое поведение, используйте [sqlsrv_configure](../../connect/php/sqlsrv-configure.md) функции. Если включить в начало сценария, следующая строка кода **sqlsrv** функцию, которая создает только предупреждения (без ошибок) не вернет **false**:  
  
`sqlsrv_configure("WarningsReturnAsErrors", 0);`  
  
Следующая строка кода, сбрасывает поведение по умолчанию (предупреждения обрабатываются как ошибки):  
  
`sqlsrv_configure("WarningsReturnAsErrors", 1);`  
  
> [!NOTE]  
> Предупреждения, которые соответствуют значениям SQLSTATE 01000, 01001, 01003 и 01S02, никогда не обрабатываются как ошибки. Независимо от конфигурации функция **sqlsrv** , которая создает только предупреждения, соответствующие одному из этих состояний, не возвращает значение **false**.  
  
Значение для **WarningsReturnAsErrors** также можно задать в файле php.ini. Например, эта запись в `[sqlsrv]` раздел файла php.ini отключает поведение по умолчанию.  
  
`sqlsrv.WarningsReturnAsErrors = 0`  
  
Сведения об извлечении сведений об ошибках и предупреждениях см. в статьях [sqlsrv_errors](../../connect/php/sqlsrv-errors.md) и [Практическое руководство. Обработка ошибок и предупреждений](../../connect/php/how-to-handle-errors-and-warnings-using-the-sqlsrv-driver.md).  
  
## <a name="example"></a>Пример  
Следующий пример кода показывает, как отключить поведение обработки ошибок по умолчанию. Пример использует команду PRINT языка Transact-SQL для создания предупреждения. Дополнительные сведения о команде PRINT см. в разделе [PRINT (Transact-SQL)](../../t-sql/language-elements/print-transact-sql.md).  
  
Сначала пример демонстрирует поведение обработки ошибок по умолчанию путем выполнения запроса, создающего предупреждение. Это предупреждение считается ошибкой. После изменения конфигурации обработки ошибок выполняется тот же самый запрос. Предупреждение не считается ошибкой.  
  
В примере предполагается, что SQL Server установлен на локальном компьютере. При выполнении примера из командной строки все выходные данные выводятся в консоль.  
  
```  
<?php  
/* Connect to the local server using Windows Authentication. */  
$serverName = "(local)";  
$conn = sqlsrv_connect( $serverName );  
if( $conn === false )  
{  
     echo "Could not connect.\n";  
     die( print_r( sqlsrv_errors(), true));  
}  
  
/* The Transact-SQL PRINT statement can be used to return   
informational or warning messages*/  
$tsql = "PRINT 'The PRINT statement can be used ";  
$tsql .= "to return user-defined warnings.'";  
  
/* Execute the query and print any errors. */  
$stmt1 = sqlsrv_query( $conn, $tsql);  
if($stmt1 === false)  
{  
     echo "By default, warnings are treated as errors:\n";  
     /* Dump errors in the error collection. */  
     print_r(sqlsrv_errors(SQLSRV_ERR_ERRORS));  
}  
  
/* Disable warnings as errors behavior. */  
sqlsrv_configure("WarningsReturnAsErrors", 0);  
  
/* Execute the same query and print any errors. */  
$stmt2 = sqlsrv_query( $conn, $tsql);  
if($stmt2 === false)  
{  
     /* Dump errors in the error collection. */  
     /* Since the warning generated by the query is be treated as   
        an error, this block of code will not be executed. */  
     print_r(sqlsrv_errors(SQLSRV_ERR_ERRORS));  
}  
else  
{  
     echo "After calling ";  
     echo "sqlsrv_configure('WarningsReturnAsErrors', 0), ";  
     echo "warnings are not treated as errors.";  
}  
  
/*Close the connection. */  
sqlsrv_close($conn);  
?>  
```  
  
## <a name="see-also"></a>См. также  
[Ведение журнала](../../connect/php/logging-activity.md)

[Руководство по программированию для драйвера Microsoft для PHP для SQL Server](../../connect/php/programming-guide-for-php-sql-driver.md)

[Справочник по API для драйвера SQLSRV](../../connect/php/sqlsrv-driver-api-reference.md)  
  
