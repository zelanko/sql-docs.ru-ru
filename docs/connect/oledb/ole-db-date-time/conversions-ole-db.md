---
title: Привязки и преобразования (OLE DB) | Документы Microsoft
description: Привязки и преобразования (OLE DB)
ms.custom: ''
ms.date: 06/14/2018
ms.prod: sql
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.component: oledb|ole-db-date-time
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: reference
helpviewer_keywords:
- conversions [OLE DB]
- bindings [OLE DB]
- OLE DB, bindings and conversions
author: pmasl
ms.author: Pedro.Lopes
manager: craigg
ms.openlocfilehash: 8c653bc4f79e9f54b96fa86fc5c0b65756b23216
ms.sourcegitcommit: e1bc8c486680e6d6929c0f5885d97d013a537149
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2018
ms.locfileid: "35666024"
---
# <a name="conversions-ole-db"></a>Преобразования (OLE DB)
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-asdbmi-md](../../../includes/appliesto-ss-asdb-asdw-pdw-asdbmi-md.md)]

[!INCLUDE[Driver_OLEDB_Download](../../../includes/driver_oledb_download.md)]

  В этом разделе описано преобразование между **datetime** и **datetimeoffset** значения. Преобразования, описанные в этом разделе, либо уже предоставлены OLE DB, либо являются согласованным расширением OLE DB.  
  
 Формат литералов и строк для дат и времени в OLE DB обычно соответствует ISO и не зависит от локали, установленной на клиенте. Единственное исключение — DBTYPE_DATE, для которого стандартом является OLE-автоматизация. Тем не менее поскольку драйвер OLE DB для SQL Server преобразует только между типами при передаче данных в или из клиента, нет возможности для приложения, чтобы принудительно драйвер OLE DB для SQL Server для преобразования между DBTYPE_DATE и строковыми форматами. Во всех остальных случаях строки используют следующие форматы (скобками отмечены необязательные элементы).  
  
-   Формат **datetime** и **datetimeoffset** строк:  
  
     *гггг*-*мм*-*дд*[ *hh*:*мм*:*ss*[. *9999999*] [± *hh*:*мм*]]  
  
-   Формат **время** строк:  
  
     *hh*:*мм*:*ss*[. *9999999*]  
  
-   Формат **даты** строк:  
  
     *гггг*-*мм*-*дд*  
  
> [!NOTE]  
>  Предыдущие версии собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и SQLOLEDB реализовали преобразования OLE в случаях, когда стандартные преобразования возвращали ошибку. Драйвер OLE DB для SQL Server следует совпадает с поведением [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client. В результате некоторые преобразования, выполняемые драйвер OLE DB для SQL Server, отличаются от спецификации OLE DB.  
  
 Преобразования из строк обеспечивают гибкость в отношении пробелов и ширины полей. Дополнительные сведения см. в разделе «Данные форматы: строки и литералы» раздела [поддержка типов данных даты OLE DB и улучшения времени](../../oledb/ole-db-date-time/data-type-support-for-ole-db-date-and-time-improvements.md).  
  
 Далее приведены общие правила преобразования.  
  
-   При преобразовании строки в тип данных даты-времени строка сначала проходит синтаксический анализ как литерал ISO. Если анализ завершился неудачей, строка проходит синтаксический анализ как литерал даты OLE, содержащий компонент времени.  
  
-   Если время отсутствует, но получатель способен его хранить, оно устанавливается в нулевое значение. Если дата отсутствует, но принимающий объект может хранить дату, этой дате присваивается значение сегодняшней даты при использовании преобразования ISO и 30 декабря 1899 года при использовании преобразования OLE.  
  
-   Если клиент использует тип даты, в котором не указан часовой пояс, но сервер может хранить информацию о часовом поясе, предполагается, что данные клиента используют часовой пояс клиента.  
  
-   Если клиент содержит информацию о часовом поясе, но на сервере данных часового пояса нет, предполагается, что часовой пояс задан в формате UTC. Это отличается от поведения сервера.  
  
-   Если время присутствует, но получатель не способен его хранить, компонент времени пропускается.  
  
-   Если дата присутствует, но получатель не способен ее хранить, компонент даты пропускается.  
  
-   Если при преобразовании с клиента на сервер происходит усечение секунд или долей секунд, возвращается значение DB_E_ERRORSOCCURRED и устанавливается состояние DBSTATUS_E_DATAOVERFLOW.  
  
-   Если усечение секунд или долей секунд происходит при преобразовании с клиента на сервер, устанавливается состояние DBSTATUS_S_TRUNCATED.  
  
## <a name="in-this-section"></a>в этом разделе  
 [Преобразования, выполняемые при передаче от клиента к серверу](../../oledb/ole-db-date-time/conversions-performed-from-client-to-server.md)  
 Описывает преобразования даты и времени, проводимые между клиентским приложением, написанным с помощью драйвера OLE DB для SQL Server и [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] (или более поздней версии).  
  
 [Преобразования, выполняемые при передаче от сервера к клиенту](../../oledb/ole-db-date-time/conversions-performed-from-server-to-client.md)  
 Описывает преобразования даты и времени, проводимые между [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] (или более поздней версии) и клиентских приложений, написанных с помощью драйвера OLE DB для SQL Server.  
  
## <a name="see-also"></a>См. также  
 [Дата и время улучшениях &#40;OLE DB&#41;](../../oledb/ole-db-date-time/date-and-time-improvements-ole-db.md)  
  
  
