---
title: Команда INDEX | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- index command [ODBC]
ms.assetid: 694e8cf5-2f69-4001-9c1e-b735a4da3aff
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: bcb30a49cb9f11ddd4c61621116aa4bd8ddcf186
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81300034"
---
# <a name="index-command"></a>Команда INDEX
Создает индексный файл для просмотра записей таблицы и доступа к ним в логическом порядке.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
INDEX ON eExpression TO IDXFileName | TAG TagName [OF CDXFileName]  
   [FOR lExpression]  
   [COMPACT]  
   [ASCENDING | DESCENDING]  
   [UNIQUE | CANDIDATE]  
   [ADDITIVE]  
```  
  
## <a name="arguments"></a>Аргументы  
 *икспрессион*  
 Задает выражение индекса, которое может включать имя поля или поля из текущей таблицы. Ключ индекса, основанный на выражении индекса, создается в файле индекса для каждой записи в таблице. Visual FoxPro использует эти ключи для отображения и доступа к записям в таблице.  
  
> [!NOTE]  
>  Хотя это и не рекомендуется, *икспрессион* может также быть переменной памяти, элементом массива или выражением поля или поля из таблицы в другой рабочей области. Поля MEMO не могут использоваться отдельно в выражениях файла индекса; они должны сочетаться с другими символьными выражениями. При обращении к индексу, содержащему переменную или поле, которое больше не существует или не может быть найдено, Visual FoxPro выдает сообщение об ошибке.  
  
 При попытке построить индекс с ключом, который изменяется в длине, ключ будет дополнен пробелами. Ключи индекса переменной длины не поддерживаются в Visual FoxPro.  
  
 Можно создать ключ индекса с нулевой длиной. Например, ключ индекса нулевой длины создается, если выражение индекса является подстрокой пустого поля MEMO. Ключ индекса нулевой длины выдает сообщение об ошибке. Когда Visual FoxPro создает индекс, он оценивает поля первой записи в таблице. Если поле пустое, может потребоваться ввести некоторые временные данные в поле первой записи, чтобы предотвратить ключ индекса нулевой длины.  
  
 *Идксфиленаме*  
 Создает файл индекса. idx. Файлу индекса присваивается расширение по умолчанию. idx.  
  
 Тег *TagName*[of *кдксфиленаме*]  
 Создает файл составного индекса. Файл составного индекса — это один файл индекса, состоящий из любого числа отдельных тегов (записей индекса). Каждый тег идентифицируется по уникальному имени тега. Имена тегов должны начинаться с буквы или символа подчеркивания и могут состоять из любой комбинации длиной до 10 букв, цифр или знаков подчеркивания. Количество тегов в файле составного индекса ограничено только объемом доступной памяти и места на диске.  
  
 Файлы составных индексов с множественной записью всегда сжимаются. При создании файла составного индекса не обязательно включать COMPACT. Имена файлов составных индексов получают расширение CDX.  
  
 Можно создать два типа файлов составных индексов: структурная и неструктурная.  
  
 **Файлы структурных составных индексов** Можно создать файл структурного составного индекса с ТЕГОМ *TagName* , исключив необязательное предложение *кдксфиленаме* . Файл структурного составного индекса всегда имеет то же базовое имя, что и таблица, и автоматически открывается при открытии таблицы.  
  
 **Файлы неструктурного составного индекса** Можно создать файл неструктурного составного индекса, включив *кдксфиленаме* после тега *TagName*. В отличие от файла структурного составного индекса, неструктурированный файл составного индекса должен быть явно открыт с помощью предложения INDEX.  
  
 Если файл составного индекса уже создан и открыт, то при выдаче индекса с ТЕГОМ *TagName* в файл составного индекса добавляется тег.  
  
 ДЛЯ *лекспрессион*  
 Указывает условие, в котором для просмотра и доступа доступны только те записи, которые соответствуют критерию фильтра *лекспрессион* . ключи индекса создаются в файле индекса только для тех записей, которые соответствуют критерию фильтра.  
  
 Технология Рушморе в Visual FoxPro оптимизирует индекс... ДЛЯ команды *лекспрессион* , если *лекспрессион* является оптимизируемым выражением. Для лучшей производительности используйте оптимизируемое выражение в предложении FOR.  
  
 СВЕРНУТ  
 Создает файл Compact. idx.  
  
 ПО ВОЗРАСТАНИЮ  
 Задает порядок по возрастанию для файла CDX. По умолчанию теги. cdx создаются в возрастающем порядке. (В качестве напоминания о порядке файла индекса можно включить сортировку по возрастанию.) Таблицу можно индексировать в обратном порядке, включая сортировку по убыванию.  
  
 ПО УБЫВАНИЮ  
 Задает порядок убывания для CDX-файла. При создании файлов индекса. idx нельзя включать сортировку по убыванию.  
  
 UNIQUE  
 Указывает, что только первая запись, обнаруженная с определенным значением ключа индекса, включается в idx-файл или в тег. cdx. УНИКАЛЬНЫЙ можно использовать для предотвращения вывода или доступа к повторяющимся записям. Все записи, добавленные с повторяющимися ключами индекса, исключаются из файла индекса. Использование УНИКАЛЬного параметра INDEX идентично выполнению SET UNIQUE ON перед выдачей индекса или повторного ИНДЕКСИРОВАНия.  
  
 Если уникальный индекс или тег индекса активен и изменена повторяющаяся запись способом, который изменяет ключ индекса, индекс индекса или индекса обновляется. Однако следующая повторяющаяся запись с исходным ключом индекса недоступна или отображается до тех пор, пока файл не будет переиндексирован повторно.  
  
 КАНДИДАТОВ  
 Создает тег структурного индекса-кандидата. Ключевое слово CANDIDATE можно включать только при создании тега структурного индекса. в противном случае Visual FoxPro выдает сообщение об ошибке.  
  
 Тег индекса-кандидата предотвращает дублирование значений в поле или комбинации полей, указанных в выражении индекса *икспрессион*. Термин « *кандидат* » относится к типу индекса; так как индексы-кандидаты предотвращают дублирование значений, они являются «кандидатом» первичным индексом.  
  
 Visual FoxPro выдает ошибку при создании тега индекса-кандидата для поля или сочетания полей, которые уже содержат дублирующиеся значения.  
  
 АДДИТИВНЫЕ  
 Сохраняет открытые ранее открытые файлы индекса. Если опустить предложение сложения при создании файла индекса или файлов для таблицы с ИНДЕКСом, все ранее открытые файлы индекса (за исключением структурного составного индекса) будут закрыты.  
  
## <a name="remarks"></a>Remarks  
 Записи в таблице с файлом индекса отображаются и доступны в порядке, указанном выражением индекса. Физический порядок записей в таблице не изменяется файлом индекса.  
  
## <a name="index-types"></a>Типы индексов  
 Visual FoxPro позволяет создавать файлы индексов двух типов:  
  
-   Составные файлы индексов CDX, содержащие несколько записей индекса, называемых тегами  
  
-   файлы индекса. idx, содержащие одну запись индекса  
  
 Можно также создать файл структурного составного индекса, который автоматически открывается вместе с таблицей.  
  
> [!NOTE]  
>  Поскольку файлы структурного составного индекса автоматически открываются при открытии таблицы, они являются предпочтительным типом индекса.  
  
 Включите COMPACT для создания файлов индекса Compact. idx. Файлы составных индексов всегда сжимаются.  
  
## <a name="index-order-and-updating"></a>Порядок индексов и обновление  
 Только один файл индекса (главный индекс) или Tag (главный тег) управляет порядком, в котором таблица отображается или обращается к таблице. Некоторые команды (например, SEEK) используют главный файл индекса или тег для поиска записей. Однако все файлы индексов Open. idx и. cdx обновляются по мере внесения изменений в таблицу.  
  
## <a name="user-defined-functions"></a>Определяемые пользователем функции  
 Хотя выражение индекса может содержать определяемую пользователем функцию, в выражении индекса не следует использовать определяемые пользователем функции. Определяемые пользователем функции в выражении индекса увеличивают время, затрачиваемое на создание или обновление индекса. Кроме того, обновления индекса могут не происходить, если для выражения индекса используется определяемая пользователем функция.  
  
 Если в выражении индекса используется определяемая пользователем функция, то Visual FoxPro должна иметь возможность научиться определять определяемую пользователем функцию. Когда Visual FoxPro создает индекс, выражение индекса сохраняется в файле индекса, но в выражение индекса включается только ссылка на определяемую пользователем функцию.  
  
## <a name="see-also"></a>См. также:  
 [ALTER TABLE-команда SQL](../../odbc/microsoft/alter-table-sql-command.md)   
 [Команда удаления ТЕГА](../../odbc/microsoft/delete-tag-command.md)   
 [Команда SET COLLATE](../../odbc/microsoft/set-collate-command.md)   
 [Команда SET UNIQUE](../../odbc/microsoft/set-unique-command.md)
