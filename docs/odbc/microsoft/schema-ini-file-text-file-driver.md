---
title: Файл Schema.ini (драйвер для текстовых файлов) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- schema.ini file [ODBC]
- text file driver [ODBC], schema.ini file
ms.assetid: 0c4625c4-c730-4984-b430-9051b7bc0451
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 708442d30b571f165f7f9d70f346a958764316d0
ms.sourcegitcommit: 37310da0565c2792aae43b3855bd3948fd13e044
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/18/2018
ms.locfileid: "53590868"
---
# <a name="schemaini-file-text-file-driver"></a>Файл Schema.ini (драйвер для текстовых файлов)
Если используется драйвер для текстовых, формат текстового файла определяется с помощью файла сведения схемы. Файл сведений схемы всегда с именем Schema.ini и всегда остается в том же каталоге, что источник текстовых данных. В файле схемы сведения предоставляются IISAM с информацией о общий формат файла, имя столбца и сведения о типе данных и несколько других характеристик данных. Файл Schema.ini всегда является обязательным для доступа к данным фиксированной длины. Файл Schema.ini следует использовать, когда текст таблица содержит даты и времени, валюты, или данных Decimal или в любое время, что вы хотите более гибко управлять обработки данных в таблице.  
  
> [!NOTE]  
>  Текст ISAM получит начальные значения из реестра, а не с Schema.ini. Один и тот же формат файлов по умолчанию применяется для всех новых таблиц данных текста. Все файлы, которые были созданы с помощью инструкции CREATE TABLE наследуют эти же по умолчанию формат значения, которые устанавливаются путем выбора значения формата файла в **определение формата текста** диалоговое окно с \<по умолчанию > выбранным в  **Таблицы** списка. Если значения в реестре, отличаются от значений в Schema.ini, значения в реестре будут перезаписаны значениями из Schema.ini.  
  
## <a name="understanding-schemaini-files"></a>Основные сведения о файлах Schema.ini  
 Файлы Schema.ini предоставляют сведения о схеме, сведения о записях в текстовом файле. Каждая запись Schema.ini указывает один из пяти характеристикам таблиц:  
  
-   Имя текстового файла  
  
-   Формат файла  
  
-   Имена полей, значения ширины и типов  
  
-   Набор символов  
  
-   Преобразования типов данных  
  
 В следующих разделах рассматриваются эти характеристики.  
  
## <a name="specifying-the-file-name"></a>Указание имени файла  
 Первая запись в файл Schema.ini всегда представляет имя исходного файла текста, заключенная в квадратные скобки. В следующем примере демонстрируется запись для файла Sample.txt:  
  
```  
[Sample.txt]  
```  
  
## <a name="specifying-the-file-format"></a>Указание формата файла  
 **Формат** параметр в Schema.ini указывает формат текстового файла. Text IISAM способных прочитать формат автоматически из файлов, наиболее символами. Любой единичный символ, можно использовать в качестве разделителя в файле, за исключением двойных кавычек ("«). **Формат** параметр в Schema.ini переопределяет параметр в реестре Windows, файлы. В следующей таблице перечислены допустимые значения для **формат** параметр.  
  
|Описатель формата|Формат таблицы|Инструкции Schema.ini Format|  
|----------------------|------------------|---------------------------------|  
|**Разделитель-табуляция**|Поля в файле разделяются с помощью вкладок.|Формат = TabDelimited|  
|**Разделитель-запятая**|Поля в файле разделяются запятыми (значения с разделителями запятыми).|Формат = CSVDelimited|  
|**Другие разделители**|Поля в файле разделяются с помощью любой символ, выбранный для ввода в диалоговом окне. Все, за исключением двойных кавычек (""), разрешены, включая пустые.|Формат = с разделителями (*символьные*)<br /><br /> -или-<br /><br /> WITH разделитель не указан:<br /><br /> Формат с разделителями () =|  
|**Фиксированной длины**|Поля в файле имеют фиксированную длину.|Формат = FixedLength|  
  
## <a name="specifying-the-fields"></a>Задание полей  
 Имена полей можно указать в файле символами текста двумя способами:  
  
-   Включить имена полей в первой строке таблицы и указать **ColNameHeader** для **значение True.**  
  
-   Укажите каждый столбец по номеру и назначить столбцу имя и тип данных.  
  
 Необходимо указать каждый столбец по номеру и указать имя столбца, тип данных и ширины для файлов с фиксированной длиной.  
  
> [!NOTE]  
>  **ColNameHeader** параметр в переопределениях Schema.ini **FirstRowHasNames** установки в реестре Windows, файлы.  
  
 Можно также определить типы данных полей. Используйте **MaxScanRows** параметр, чтобы указать, сколько строк должны проверяться при определении типов столбцов. Если задать **MaxScanRows** 0, сканируется весь файл целиком. **MaxScanRows** параметр в Schema.ini переопределяет параметр в реестре Windows, файлы.  
  
 Следующая запись указывает, что Microsoft Jet, следует использовать данные в первой строке таблицы, чтобы определить имена полей и проверить весь файл, чтобы определить данные типы, используемые:  
  
```  
ColNameHeader=True  
MaxScanRows=0  
```  
  
 Следующей записи обозначает полей в таблице с помощью номер столбца (**Col**_n_) параметр, который является необязательным для файлов, разделенных символом и требуется для файлов с фиксированной длиной. В примере Schema.ini записи для двух полей, 10-символьный CustomerNumber текстовое поле и текстовое поле CustomerName 30 символов:  
  
```  
Col1=CustomerNumber Text Width 10  
Col2=CustomerName Text Width 30  
```  
  
 Синтаксис **Col**_n_ является:  
  
```  
  
n=ColumnNametype [#]  
```  
  
## <a name="remarks"></a>Примечания  
 В следующей таблице описаны каждой части **Col**_n_ запись.  
  
|Параметр|Описание|  
|---------------|-----------------|  
|*ColumnName*|Имя текстового столбца. Если имя столбца содержит пробелы, его необходимо заключить в двойные кавычки.|  
|*type*|Типы данных являются следующим образом:<br /><br /> **Типы данных Microsoft Jet**<br /><br /> bit<br /><br /> Byte<br /><br /> Short<br /><br /> Long<br /><br /> CURRENCY<br /><br /> Один<br /><br /> Double<br /><br /> DateTime<br /><br /> Текста<br /><br /> MEMO<br /><br /> **Типы данных ODBC** Char (то же, как текст)<br /><br /> Число с плавающей запятой (аналогично Double)<br /><br /> Целое число (аналогично Short)<br /><br /> LongChar (аналогично Memo)<br /><br /> Дата *формат даты*|  
|**Width**|Значение символьной строки `Width`. Указывает, что следующий номер обозначает ширину столбца (необязательно для файлов, разделенных символом; требуется для файлов с фиксированной длины).|  
|*#*|Целочисленное значение, которое обозначает ширину столбца (обязательно, если **ширины** указан).|  
  
## <a name="selecting-a-character-set"></a>Выбор кодировки  
 Можно выбрать один из двух наборов символов: ANSI и OEM. **CharacterSet** параметр в Schema.ini переопределяет параметр в реестре Windows, файлы. В следующем примере показано Schema.ini запись, которая задает кодировку ANSI:  
  
```  
CharacterSet=ANSI  
```  
  
## <a name="specifying-data-type-formats-and-conversions"></a>Указание форматов данных тип и преобразования  
 Файл Schema.ini содержит несколько параметров, которые можно использовать для указания, как преобразовать данные и не отображаются. Ниже перечислены эти параметры.  
  
|Параметр|Описание|  
|------------|-----------------|  
|**DateTimeFormat**|Можно задать в строку формата, который указывает значения даты и времени. Следует указать эту запись, если все поля даты и времени импорта и экспорта обрабатываются в том же формате. Все форматы Microsoft Jet, за исключением часов утра и после полудня поддерживаются. Если строка формата, используются параметры изображения и время краткий формат даты панели управления Windows.|  
|**DecimalSymbol**|Можно присвоить любому одиночному символу, который используется для разделения целой и дробной части числа.|  
|**NumberDigits**|Указывает число десятичных разрядов в дробной части числа.|  
|**NumberLeadingZeros**|Указывает, содержат ли десятичное значение меньше 1 и более 1 начальные нули; Это значение может быть либо False (без предшествующих нулей) или True.|  
|**CurrencySymbol**|Указывает символ валюты, который может использоваться для значений денежных сумм в текстовом файле. Например, знак доллара ($) и интеллектуальный анализ данных.|  
|**CurrencyPosFormat**|Может быть задан любой из следующих значений:<br /><br /> -Символ денежной единицы перед без разделения ($1)<br />-Суффикс символ валюты без разделения (1$)<br />-Currency символьный префикс с одним пробелом ($ 1)<br />-Суффикс символ валюты с одним пробелом (1 $)|  
|**CurrencyDigits**|Указывает количество цифр дробной части денежной суммы.|  
|**CurrencyNegFormat**|Может принимать одно из следующих значений:<br /><br /> -   ($1)<br />—-1 долл. США<br />-1 $<br />-$1 -<br />-   (1$)<br />--1$<br />-1$<br />-1$.<br />--1 $<br />—-1 долл. США<br />-1 $.<br />-$ 1 -<br />-$ -1<br />-1 $<br />-   ($ 1)<br />-   (1 $)<br /><br /> В этом примере показано знак доллара, но его следует заменить с соответствующим **CurrencySymbol** значение на практике.|  
|**CurrencyThousandSymbol**|Символ одного символа, который может использоваться для разделения денежных значений в текстовом файле в тысячах.|  
|**CurrencyDecimalSymbol**|Можно присвоить любому одиночному символу, который используется для разделения целой и дробной части денежной суммы.|  
  
> [!NOTE]  
>  Если запись не указан, используется значение по умолчанию в панели управления Windows.
