---
title: Функция SQLSetDescRec | Документация Майкрософт
ms.custom: ''
ms.date: 07/18/2019
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLSetDescRec
apilocation:
- sqlsrv32.dll
- odbc32.dll
apitype: dllExport
f1_keywords:
- SQLSetDescRec
helpviewer_keywords:
- SQLSetDescRec function [ODBC]
ms.assetid: bf55256c-7eb7-4e3f-97ef-b0fee09ba829
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: b29879ff7635d6eb7d5a0f7489ff3994758d4a35
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81299534"
---
# <a name="sqlsetdescrec-function"></a>Функция SQLSetDescRec
**Соответствия**  
 Представленная версия: соответствие стандартам ODBC 3,0: ISO 92  
  
 **Сводка**  
 Функция **SQLSetDescRec** задает несколько полей дескриптора, которые влияют на тип данных и буфер, привязанные к данным столбца или параметра.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLSetDescRec(  
      SQLHDESC      DescriptorHandle,  
      SQLSMALLINT   RecNumber,  
      SQLSMALLINT   Type,  
      SQLSMALLINT   SubType,  
      SQLLEN        Length,  
      SQLSMALLINT   Precision,  
      SQLSMALLINT   Scale,  
      SQLPOINTER    DataPtr,  
      SQLLEN *      StringLengthPtr,  
      SQLLEN *      IndicatorPtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *DescriptorHandle*  
 Входной Дескриптор дескриптора. Этот маркер не должен быть IRD.  
  
 *RecNumber*  
 Входной Указывает запись дескриптора, которая содержит поля, которые необходимо задать. Записи дескрипторов нумеруются с 0, а номер записи 0 — запись закладки. Этот аргумент должен быть больше или равен 0. Если *рекнумбер* больше, чем значение SQL_DESC_COUNT, SQL_DESC_COUNTis изменилось на значение *рекнумбер*.  
  
 *Type*  
 Входной Значение, для которого задается поле SQL_DESC_TYPE для записи дескриптора.  
  
 *Подтип*  
 Входной Для записей, тип которых — SQL_DATETIME или SQL_INTERVAL, это значение, для которого задается поле SQL_DESC_DATETIME_INTERVAL_CODE.  
  
 *Длина*  
 Входной Значение, для которого задается поле SQL_DESC_OCTET_LENGTH для записи дескриптора.  
  
 *Точность*  
 Входной Значение, для которого задается поле SQL_DESC_PRECISION для записи дескриптора.  
  
 *Масштабирование*  
 Входной Значение, для которого задается поле SQL_DESC_SCALE для записи дескриптора.  
  
 *датаптр*  
 [Отложенные входные или выходные данные] Значение, для которого задается поле SQL_DESC_DATA_PTR для записи дескриптора. Для *датаптр* можно задать пустой указатель.  
  
 Для аргумента *датаптр* можно задать пустой указатель, чтобы задать SQL_DESC_DATA_PTR поле равным пустому указателю. Если маркер в аргументе *дескрипторхандле* связан с АРД, то он отменяет привязку к столбцу.  
  
 *стрингленгсптр*  
 [Отложенные входные или выходные данные] Значение, для которого задается поле SQL_DESC_OCTET_LENGTH_PTR для записи дескриптора. *Стрингленгсптр* можно задать как указатель null, чтобы задать поле SQL_DESC_OCTET_LENGTH_PTR равным пустому указателю.  
  
 *индикаторптр*  
 [Отложенные входные или выходные данные] Значение, для которого задается поле SQL_DESC_INDICATOR_PTR для записи дескриптора. *Индикаторптр* можно задать как указатель null, чтобы задать поле SQL_DESC_INDICATOR_PTR равным пустому указателю.  
  
## <a name="returns"></a>Результаты  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLSetDescRec** возвращает SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанное значение SQLSTATE может быть получено путем вызова **SQLGetDiagRec** с *параметром handletype* SQL_HANDLE_DESC и *маркером* *дескрипторхандле*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые функцией **SQLSetDescRec** , и объясняется каждый из них в контексте этой функции. Нотация "(DM)" предшествует описаниям SQLSTATE, возвращаемым диспетчером драйверов. Код возврата, связанный с каждым значением SQLSTATE, имеет SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Error|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение для конкретного драйвера. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|07009|Недопустимый индекс дескриптора|Аргумент *рекнумбер* имеет значение 0, а *дескрипторхандле* ссылается на обработчик IPD.<br /><br /> Аргумент *рекнумбер* меньше 0.<br /><br /> Аргумент *рекнумбер* больше, чем максимальное число столбцов или параметров, которое может поддерживать источник данных, а аргумент *дескрипторхандле* был APD, IPD или АРД.<br /><br /> Аргумент *рекнумбер* равен 0, а аргумент *дескрипторхандле* ссылается на неявно выделенный APD. (Эта ошибка не возникает при явно выделенном дескрипторе приложения, так как неизвестно, является ли явно выделенный дескриптор приложения APD или АРД до времени выполнения.)|  
|08S01|Сбой канала связи|Канал связи между драйвером и источником данных, к которому был подключен драйвер, был неудачен до завершения обработки функции.|  
|HY000|Общая ошибка|Произошла ошибка, для которой нет определенного SQLSTATE и для которого не определен SQLSTATE для конкретной реализации. Сообщение об ошибке, возвращаемое функцией **SQLGetDiagRec** в буфере * \*MessageText* , описывает ошибку и ее причину.|  
|HY001|Ошибка выделения памяти|Драйверу не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|(DM) *дескрипторхандле* был связан с *статеменсандле* , для которого была вызвана асинхронно исполняемая функция (а не эта одна) и все еще выполнялась при вызове этой функции.<br /><br /> (DM) **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations**или **SQLSetPos** были вызваны для *статеменсандле* , с которым связан *дескрипторхандле* и возвращены SQL_NEED_DATA. Эта функция была вызвана перед отправкой данных для всех параметров или столбцов данных, выполняемых во время выполнения.<br /><br /> (DM) вызвана асинхронно исполняемая функция для маркера соединения, связанного с *дескрипторхандле*. Эта функция айнчронаус все еще выполнялась при вызове функции **SQLSetDescRec** .<br /><br /> (DM) **SQLExecute**, **SQLExecDirect**или **SQLMoreResults** были вызваны для одного из дескрипторов инструкций, связанных с *дескрипторхандле* и возвращаемых SQL_PARAM_DATA_AVAILABLE. Эта функция была вызвана до получения данных для всех потоковых параметров.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как не удалось получить доступ к базовым объектам памяти, возможно, из-за нехватки памяти.|  
|HY016|Невозможно изменить дескриптор строки реализации|Аргумент *дескрипторхандле* был связан с IRD.|  
|HY021|Непоследовательные сведения о дескрипторе|Поле *типа* или любое другое поле, связанное с SQL_DESC_TYPE полем в дескрипторе, является недопустимым или несоответствующим.<br /><br /> Сведения о дескрипторе, проверенные во время проверки согласованности, не были согласованы. (См. раздел "проверки согласованности" Далее в этом разделе.)|  
|HY090|Недопустимая длина строки или буфера|(DM) драйвер был драйвером ODBC *2. x* , дескриптор был АРД, аргумент *columnNumber* был установлен в 0, а значение, заданное для аргумента *BufferLength* , не равно 4.|  
|HY117|Подключение приостановлено из-за неизвестного состояния транзакции. Допускаются только функции отключения и только для чтения.|(DM) Дополнительные сведения о состоянии SUSPENDED см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYT01|Время ожидания подключения истекло|Время ожидания соединения истекло до ответа источника данных на запрос. Время ожидания соединения задается через **SQLSetConnectAttr**, SQL_ATTR_CONNECTION_TIMEOUT.|  
|IM001|Драйвер не поддерживает эту функцию|(DM) драйвер, связанный с *дескрипторхандле* , не поддерживает функцию.|  
  
## <a name="comments"></a>Комментарии  
 Приложение может вызвать **SQLSetDescRec** , чтобы задать следующие поля для одного столбца или параметра:  
  
-   SQL_DESC_TYPE  
  
-   SQL_DESC_DATETIME_INTERVAL_CODE (для записей, тип которых — SQL_DATETIME или SQL_INTERVAL)  
  
-   SQL_DESC_OCTET_LENGTH  
  
-   SQL_DESC_PRECISION  
  
-   SQL_DESC_SCALE  
  
-   SQL_DESC_DATA_PTR  
  
-   SQL_DESC_OCTET_LENGTH_PTR  
  
-   SQL_DESC_INDICATOR_PTR  
  
> [!NOTE]  
>  Если вызов **SQLSetDescRec** завершается неудачей, содержимое записи дескриптора, определяемой аргументом *рекнумбер* , не определено.  
  
 При привязке столбца или параметра **SQLSetDescRec** позволяет изменить несколько полей, влияющих на привязку, без вызова **SQLBindCol** или **SQLBindParameter** или выполнения нескольких вызовов **SQLSetDescField**. **SQLSetDescRec** может устанавливать поля в дескрипторе, не связанном с инструкцией. Обратите внимание, что **SQLBindParameter** устанавливает больше полей, чем **SQLSetDescRec**, может устанавливать поля для APD и IPD в одном вызове и не требует дескриптора дескриптора.  
  
> [!NOTE]  
>  Атрибут инструкции SQL_ATTR_USE_BOOKMARKS всегда должен быть задан перед вызовом **SQLSetDescRec** с аргументом *рекнумбер* , равным 0, для установки полей закладок. Хотя это и не является обязательным, настоятельно рекомендуется.  
  
## <a name="consistency-checks"></a>Проверки согласованности  
 Проверка согласованности выполняется драйвером автоматически всякий раз, когда приложение задает SQL_DESC_DATA_PTR поле APD, АРД или IPD. Если какое-либо из полей не согласуется с другими полями, **SQLSetDescRec** вернет SQLSTATE HY021 (непоследовательные сведения о дескрипторе).  
  
 Всякий раз, когда приложение задает SQL_DESC_DATA_PTR поле APD, АРД или IPD, драйвер проверяет, являются ли значения поля SQL_DESC_TYPE и значения, применимые к полю SQL_DESC_TYPE, допустимыми и согласованными. Эта проверка всегда выполняется при вызове **SQLBindParameter** или **SQLBindCol** или при вызове **SQLSetDescRec** для APD, АРД или IPD. Эта проверка согласованности включает следующие проверки полей дескриптора:  
  
-   Поле SQL_DESC_TYPE должно быть одним из допустимых типов ODBC C или SQL или зависящим от драйвера типом SQL. Поле SQL_DESC_CONCISE_TYPE должно быть одним из допустимых типов ODBC C или SQL или зависящим от драйвера типом C или SQL, включая сокращенные типы DateTime и Interval.  
  
-   Если SQL_DESC_TYPE поле записи SQL_DATETIME или SQL_INTERVAL, то поле SQL_DESC_DATETIME_INTERVAL_CODE должно быть одним из допустимых кодов DateTime или Interval. (См. Описание поля SQL_DESC_DATETIME_INTERVAL_CODE в [SQLSetDescField](../../../odbc/reference/syntax/sqlsetdescfield-function.md).)  
  
-   Если поле SQL_DESC_TYPE указывает числовой тип, поля SQL_DESC_PRECISION и SQL_DESC_SCALE проверяются как допустимые.  
  
-   Если поле SQL_DESC_CONCISE_TYPE имеет тип данных time или timestamp, тип интервала с компонентом секунд или один из типов данных интервала с компонентом времени, то SQL_DESC_PRECISION поле проверяется как допустимая точность в секундах.  
  
-   Если SQL_DESC_CONCISE_TYPE является типом данных интервала, поле SQL_DESC_DATETIME_INTERVAL_PRECISION проверяется как допустимое начальное значение точности интервала.  
  
 Поле SQL_DESC_DATA_PTR IPD обычно не задано. Однако приложение может сделать это для принудительной проверки согласованности полей IPD. Невозможно выполнить проверку согласованности для IRD. Значение поля SQL_DESC_DATA_PTR IPD, равное, не сохраняется и не может быть извлечено вызовом **SQLGetDescField** или **SQLGetDescRec**; Этот параметр устанавливается только для принудительной проверки согласованности.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Привязка столбца|[SQLBindCol, функция](../../../odbc/reference/syntax/sqlbindcol-function.md)|  
|Привязка параметра|[Функция SQLBindParameter](../../../odbc/reference/syntax/sqlbindparameter-function.md)|  
|Получение одного поля дескриптора|[Функция SQLGetDescField](../../../odbc/reference/syntax/sqlgetdescfield-function.md)|  
|Получение нескольких полей дескриптора|[Функция SQLGetDescRec](../../../odbc/reference/syntax/sqlgetdescrec-function.md)|  
|Установка одного поля дескриптора|[Функция SQLSetDescField](../../../odbc/reference/syntax/sqlsetdescfield-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
