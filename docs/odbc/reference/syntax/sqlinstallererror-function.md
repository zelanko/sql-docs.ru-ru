---
title: Функция Склинсталлереррор | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLInstallerError
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLInstallerError
helpviewer_keywords:
- SQLInstallerError [ODBC]
ms.assetid: e6474b79-4d55-458f-81ce-abfafe357f83
author: MightyPen
ms.author: genemi
ms.openlocfilehash: ab9461d87a3df2efc98c38e4c72cee4c247fee7c
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68138029"
---
# <a name="sqlinstallererror-function"></a>Функция SQLInstallerError
**Соответствия**  
 Введенная версия: ODBC 3,0  
  
 **Сводка**  
 **Склинсталлереррор** возвращает сведения об ошибке или состоянии для функций установщика ODBC.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
RETCODE SQLInstallerError(  
     WORD      iError,  
     DWORD *   pfErrorCode,  
     LPSTR     lpszErrorMsg,  
     WORD      cbErrorMsgMax,  
     WORD *    pcbErrorMsg);  
```  
  
## <a name="arguments"></a>Аргументы  
 *иеррор*  
 Входной Номер записи об ошибке. Допустимые значения: от 1 до 8.  
  
 *пферроркоде*  
 Проверки Код ошибки установщика. (Дополнительные сведения см. в разделе "Комментарии".)  
  
 *лпсзеррормсг*  
 Проверки Указатель на хранилище для текста сообщения об ошибке.  
  
 *кберрормсгмакс*  
 Входной Максимальная длина буфера *сзеррормсг* . Значение должно быть меньше или равно SQL_MAX_MESSAGE_LENGTH минус символ завершения null.  
  
 *кберрормсгмакс*  
 Входной Максимальная длина буфера *сзеррормсг* . Значение должно быть меньше или равно SQL_MAX_MESSAGE_LENGTH минус символ завершения null.  
  
 *пкберрормсг*  
 Проверки Указатель на общее число байтов (за исключением символа завершения null), доступного для возврата в *лпсзеррормсг*. Если число возвращаемых байт больше или равно значению *кберрормсгмакс*, текст сообщения об ошибке в *лпсзеррормсг* усекается до *кберрормсгмакс* минус байты символов завершения null. Аргумент *пкберрормсг* может быть пустым указателем.  
  
## <a name="returns"></a>Возвращает  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA или SQL_ERROR.  
  
## <a name="diagnostics"></a>Диагностика  
 **Склинсталлереррор** не помещать значения ошибок для самого себя. **Склинсталлереррор** возвращает SQL_NO_DATA, когда не удается получить какие-либо сведения об ошибке (в этом случае *пферроркоде* не определен). Если **склинсталлереррор** не может получить доступ к значениям ошибок по любой причине, которая обычно возвращает SQL_ERROR, **склинсталлереррор** возвращает SQL_ERROR, но не переносит никаких значений ошибок. Если длина строки предупреждения неизвестна (*лпсзеррормсг*), можно присвоить параметру *лпсзеррормсг* значение NULL и вызвать **склинсталлереррор**. **Склинсталлереррор** возвратит длину строки предупреждения в *кберрормсгмакс*. Если буфер для сообщения об ошибке слишком короткий, **склинсталлереррор** возвращает SQL_SUCCESS_WITH_INFO и возвращает правильное значение *пферроркоде* для **склинсталлереррор**.  
  
 Чтобы определить, произошло ли усечение в сообщении об ошибке, приложение может сравнить значение в аргументе *кберрормсгмакс* с фактической длиной текста сообщения, записанного в аргумент *пкберрормсг* . Если происходит усечение, необходимо выделить правильную длину буфера для *лпсзеррормсг* , и **склинсталлереррор** следует вызвать снова с соответствующей записью *иеррор* .  
  
## <a name="comments"></a>Комментарии  
 Приложение вызывает **склинсталлереррор** , когда предыдущий вызов функции установщика ODBC возвращает значение false. Функции установщика ODBC и драйвера или программы установки переводчика развернули ноль или больше ошибок только в случае сбоя функции (Возвращает значение FALSE); Таким образом, приложение вызывает **склинсталлереррор** только после сбоя функции установщика ODBC.  
  
 Очередь ошибок установщика ODBC очищается каждый раз при вызове новой функции установщика. Поэтому приложение не может получать ошибки для функций, отличных от последнего вызова функции установщика.  
  
 Чтобы получить несколько ошибок для вызова функции, приложение вызывает **склинсталлереррор** несколько раз.  
  
 Если дополнительные сведения отсутствуют, **склинсталлереррор** возвращает SQL_NO_DATA, аргумент *пферроркоде* не определен, аргумент *пкберрормсг* равен 0, а аргумент *лпсзеррормсг* содержит один символ завершения null (если только аргумент *кберрормсгмакс* не равен 0).
