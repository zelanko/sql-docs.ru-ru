---
title: Склманажедатасаурцес | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLManageDataSources
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLManageDataSources
helpviewer_keywords:
- SQLManageDataSources [ODBC]
ms.assetid: ac6d186f-b394-406c-94c4-c6331d1ca468
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 3b572a861af3479e1543be9fda9598cc7e25d36c
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81290222"
---
# <a name="sqlmanagedatasources"></a>SQLManageDataSources
**Соответствия**  
 Введенная версия: ODBC 2,0  
  
 **Сводка**  
 **Склманажедатасаурцес** отображает диалоговое окно, с помощью которого пользователи могут настраивать, добавлять и удалять источники данных в сведениях о системе.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLManageDataSources(  
     HWND     hwnd);  
```  
  
## <a name="arguments"></a>Аргументы  
 *HWND*  
 Входной Маркер родительского окна.  
  
## <a name="returns"></a>Результаты  
 **Склманажедатасаурцес** возвращает значение false, если *HWND* не является допустимым дескриптором окна. В противном случае возвращается значение TRUE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **склманажедатасаурцес** возвращает значение false, связанное * \*значение пферроркоде* может быть получено путем вызова **склинсталлереррор**. В следующей таблице перечислены значения * \*пферроркоде* , которые могут быть возвращены **склинсталлереррор** , и объясняется каждый из них в контексте этой функции.  
  
|*\*пферроркоде*|Error|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Общая ошибка установщика|Произошла ошибка, для которой не возникала конкретная ошибка установщика.|  
|ODBC_ERROR_REQUEST_FAILED|Сбой *запроса*|Сбой вызова **ConfigDSN** .|  
|ODBC_ERROR_INVALID__HWND|Недопустимый маркер окна|Аргумент *HWND* недопустим или имеет значение null.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Установщику не удалось выполнить функцию из-за нехватки памяти.|  
  
## <a name="managing-data-sources"></a>Управление источниками данных  
 **Склманажедатасаурцес** изначально отображает диалоговое окно **Администратор источников данных ODBC** , как показано на следующем рисунке.  
  
 ![Диалоговое окно администратора источника данных ODBC](../../../odbc/reference/syntax/media/ch23e.gif "CH23E")  
  
 В диалоговом окне отображаются источники данных, перечисленные в разделе системные сведения под тремя вкладками: **пользовательское имя DSN**, **системный DSN**и **Файловый DSN**. Если пользователь дважды щелкает источник данных или выбирает источник данных и нажимает кнопку " **настроить**", **склманажедатасаурцес** вызывает **ConfigDSN** в библиотеке DLL установки с параметром ODBC_CONFIG_DSN.  
  
 Если пользователь нажимает кнопку **Добавить**, **склманажедатасаурцес** отображает диалоговое окно **Создание нового источника данных** , показанное на следующем рисунке.  
  
 ![Диалоговое окно создания нового источника данных](../../../odbc/reference/syntax/media/ch23f.gif "CH23F")  
  
 В диалоговом окне отображается список установленных драйверов. Если пользователь дважды щелкает драйвер или выбирает драйвер и нажимает кнопку **ОК**, **склманажедатасаурцес** вызывает **ConfigDSN** в DLL-библиотеке установки и передает его параметру ODBC_ADD_DSN.  
  
 Если пользователь выбирает источник данных и нажимает кнопку **Удалить**, **склманажедатасаурцес** спрашивает, желаете ли пользователь удалить источник данных. Если пользователь нажмет кнопку **Да**, **склманажедатасаурцес** вызывает **ConfigDSN** в библиотеке DLL установки с параметром ODBC_REMOVE_DSN.  
  
 Диалоговое окно **Создание нового источника данных** используется для добавления или удаления источника данных пользователя, системного источника данных или файлового источника данных.  
  
## <a name="user-dsns"></a>Пользовательские DSN  
 Имена DSN, созданные для отдельных пользователей, будут называться DSN пользователя, чтобы отличать их от системных имен DSN. Пользовательские DSN регистрируются в сведениях о системе следующим образом:  
  
 `HKEY_CURRENT_USERS`  
  
 `SOFTWARE`  
  
 `ODBC`  
  
 `Odbc.ini`  
  
## <a name="system-dsns"></a>Системные имена DSN  
 Диалоговое окно **Создание нового источника данных** позволяет добавить системный источник данных на локальный компьютер или удалить его или задать конфигурацию для системного источника данных.  
  
 Источник данных, настроенный с помощью имени системного источника данных (DSN), может использоваться несколькими пользователями на одном компьютере. Он также может использоваться службой на уровне системы, которая может получить доступ к источнику данных, даже если на компьютере не вошел ни один пользователь.  
  
 Системное имя DSN регистрируется в записи HKEY_LOCAL_MACHINE в сведениях о системе, а не в записи HKEY_CURRENT_USER. Он не привязан к одному пользователю, который входит в систему с определенными именем пользователя и паролем, но может использоваться любым пользователем этого компьютера или службой автоматической службы на уровне всей системы. Однако системный DSN привязан к одному компьютеру. Он не поддерживает возможность использования удаленных имен DSN между компьютерами. Системные имена DSN регистрируются следующим образом в сведениях о системе:  
  
 HKEY_LOCAL_MACHINE по ODBC ODBC. ini  
  
## <a name="file-dsns"></a>Файловые DSN  
 Файловый источник данных не имеет имени источника данных, как и источник данных компьютера, и не зарегистрирован ни для одного пользователя или компьютера. Сведения о соединении для этого источника данных содержатся в DSN-файле, который можно скопировать на любой компьютер. Файловый источник данных может быть общим, в этом случае файл. DSN размещается в сети и может использоваться несколькими пользователями в сети при условии, что у пользователя установлен соответствующий драйвер. Файловый источник данных также может быть недоступным для совместного использования. в этом случае его можно использовать только на одном компьютере.  
  
 Дополнительные сведения о файловых источниках данных см. в разделе [подключение с помощью файловых источников данных](../../../odbc/reference/develop-app/connecting-using-file-data-sources.md)или см. [SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md).  
  
## <a name="managing-drivers"></a>Управление драйверами  
 Если пользователь нажимает на вкладку **драйверы** в диалоговом окне **Администратор источников данных ODBC** , **склманажедатасаурцес** отображает список драйверов ODBC, установленных в системе, а также сведения о драйверах. Отображается дата создания драйвера, как показано на следующем рисунке.  
  
 ![Администратор источника данных ODBC: вкладка драйверов](../../../odbc/reference/syntax/media/ch23g.gif "ch23g")  
  
## <a name="tracing-options"></a>Параметры трассировки  
 Если пользователь нажимает вкладку **Трассировка** в диалоговом окне **Администратор источников данных ODBC** , **склманажедатасаурцес** отображает параметры трассировки, как показано на следующем рисунке.  
  
 ![Администратор источника данных ODBC: вкладка трассировок](../../../odbc/reference/syntax/media/ch23h.gif "Ch23h")  
  
 Если пользователь нажмет кнопку **Начать трассировку сейчас** и нажмет кнопку **ОК**, **склманажедатасаурцес** включит трассировку вручную для всех приложений, выполняющихся на компьютере в данный момент.  
  
 Если пользователь задает имя файла трассировки в текстовом поле **путь к файлу журнала** , а затем нажимает кнопку **ОК**, **Склманажедатасаурцес** задает ключевое слово **TraceFile** в разделе [ODBC] системных сведений с указанным именем.  
  
> [!IMPORTANT]  
>  Поддержка анализатор Visual Studio была удалена начиная с Windows 8 (анализатор Visual Studio была включена только в более ранних версиях Visual Studio.) Для альтернативного механизма устранения неполадок используйте трассировку ТЕНДЕРа.  
  
 Если пользователь нажимает кнопку **пуск Анализатор Visual Studio** а затем нажимает кнопку **ОК**, анализатор Visual Studio включена. Она остается включенной, пока не будет нажата кнопка " **останавливается" Анализатор Visual Studio** .  
  
 Дополнительные сведения о трассировке см. в разделе [Трассировка](../../../odbc/reference/develop-app/tracing.md). Дополнительные сведения о ключевых словах **Trace** и **TraceFile** см. в разделе [подраздела ODBC](../../../odbc/reference/install/odbc-subkey.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Создание источников данных|[склкреатедатасаурце](../../../odbc/reference/syntax/sqlcreatedatasource-function.md)|
