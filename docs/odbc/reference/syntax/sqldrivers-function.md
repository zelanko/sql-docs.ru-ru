---
description: Функция SQLDrivers
title: Функция SQLDrivers | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLDrivers
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLDrivers
helpviewer_keywords:
- SQLDrivers function [ODBC]
ms.assetid: 6b5b7514-e9cb-4cfd-8b7a-ab51dfab9efa
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 9abe7502b7efcfba695bd58081752342504378ab
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88461166"
---
# <a name="sqldrivers-function"></a>Функция SQLDrivers
**Соответствия**  
 Представленная версия: соответствие стандартам ODBC 2,0: ODBC  
  
 **Сводка**  
 **SQLDrivers** перечисляет описания драйверов и ключевые слова атрибутов драйвера. Эта функция реализуется только диспетчером драйверов.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLDrivers(  
     SQLHENV         EnvironmentHandle,  
     SQLUSMALLINT    Direction,  
     SQLCHAR *       DriverDescription,  
     SQLSMALLINT     BufferLength1,  
     SQLSMALLINT *   DescriptionLengthPtr,  
     SQLCHAR *       DriverAttributes,  
     SQLSMALLINT     BufferLength2,  
     SQLSMALLINT *   AttributesLengthPtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *енвиронменсандле*  
 Входной Маркер среды.  
  
 *Направление*  
 Входной Определяет, извлекает ли диспетчер драйверов следующее описание драйвера в списке (SQL_FETCH_NEXT) или начинается ли поиск с начала списка (SQL_FETCH_FIRST).  
  
 *дривердескриптион*  
 Проверки Указатель на буфер, в который возвращается описание драйвера.  
  
 Если *дривердескриптион* имеет значение null, то *дескриптионленгсптр* будет возвращать общее количество символов (исключая символ завершения null для символьных данных), доступный для возврата в буфер, на который указывает *дривердескриптион*.  
  
 *BufferLength1*  
 Входной Длина буфера **дривердескриптион* в символах.  
  
 *дескриптионленгсптр*  
 Проверки Указатель на буфер, в котором возвращается общее число символов (за исключением символа завершения null), доступного для возврата в \* *дривердескриптион*. Если число возвращаемых символов больше или равно *BufferLength1*, описание драйвера в \* *Дривердескриптион* усекается до *BufferLength1* минус длину символа завершения null.  
  
 *дривераттрибутес*  
 Проверки Указатель на буфер, в котором возвращается список пар значений атрибутов драйвера (см. раздел "Комментарии").  
  
 Если *дривераттрибутес* имеет значение null, *аттрибутесленгсптр* будет возвращать общее число байтов (исключая символ завершения null для символьных данных), доступный для возврата в буфер, на который указывает *дривераттрибутес*.  
  
 *BufferLength2*  
 Входной Длина \* буфера *дривераттрибутес* в символах. Если значение * \* дривердескриптион* является строкой Юникода (при вызове **Склдриверсв**), аргумент *BufferLength* должен быть четным числом.  
  
 *аттрибутесленгсптр*  
 Проверки Указатель на буфер, в котором возвращается общее число байтов (за исключением байта завершения null), доступного для возврата в \* *дривераттрибутес*. Если число возвращаемых байт больше или равно *BufferLength2*, список пар значений атрибутов в \* *Дривераттрибутес* усекается до *BufferLength2* минус длину символа завершения null.  
  
## <a name="returns"></a>Возвращаемое значение  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Если **SQLDrivers** возвращает либо SQL_ERROR, либо SQL_SUCCESS_WITH_INFO, связанное значение SQLSTATE можно получить, вызвав **SQLGetDiagRec** с *параметром handletype* SQL_HANDLE_ENV и *маркером* *енвиронменсандле*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые функцией **SQLDrivers** , и объясняется каждый из них в контексте этой функции. Нотация "(DM)" предшествует описаниям SQLSTATE, возвращаемым диспетчером драйверов. Код возврата, связанный с каждым значением SQLSTATE, имеет SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|(DM). информационное сообщение, относящееся к диспетчеру драйверов. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|01004|Строковые данные, усеченные справа|(DM) буфер \* *дривердескриптион* недостаточно велик для возврата полного описания драйвера. Поэтому описание было усечено. Длина полного описания драйвера возвращается в \* *дескриптионленгсптр*. (Функция возвращает SQL_SUCCESS_WITH_INFO.)<br /><br /> (DM) буфер \* *дривераттрибутес* недостаточно велик, чтобы вернуть полный список пар значений атрибутов. Поэтому список был усечен. Длина неусеченного списка пар "атрибут значение" возвращается в **аттрибутесленгсптр*. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|HY000|Общая ошибка|Произошла ошибка, для которой нет определенного SQLSTATE и для которого не определен SQLSTATE для конкретной реализации. Сообщение об ошибке, возвращаемое функцией **SQLGetDiagRec** в буфере * \* MessageText* , описывает ошибку и ее причину.|  
|HY001|Ошибка выделения памяти|(DM) диспетчеру драйверов не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|(DM) **SQLExecute**, **SQLExecDirect**или **SQLMoreResults** были вызваны для *статеменсандле* и возвращены SQL_PARAM_DATA_AVAILABLE. Эта функция была вызвана до получения данных для всех потоковых параметров.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как не удалось получить доступ к базовым объектам памяти, возможно, из-за нехватки памяти.|  
|HY090|Недопустимая длина строки или буфера|(DM) значение, указанное для аргумента *BufferLength1* , было меньше 0.<br /><br /> (DM) значение, указанное для аргумента *BufferLength2* , было меньше 0 или равно 1.|  
|HY103|Недопустимый код получения|(DM) значение, указанное для *направления* аргумента, не равно SQL_FETCH_FIRST или SQL_FETCH_NEXT.|  
|HY117|Подключение приостановлено из-за неизвестного состояния транзакции. Допускаются только функции отключения и только для чтения.|(DM) Дополнительные сведения о состоянии SUSPENDED см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
  
## <a name="comments"></a>Комментарии  
 **SQLDrivers** Возвращает описание драйвера в \* буфере *дривердескриптион* . Он возвращает дополнительные сведения о драйвере в \* буфере *дривераттрибутес* в виде списка пар "ключевое слово-значение". Все ключевые слова, перечисленные в сведениях о системе для драйверов, будут возвращены для всех драйверов, за исключением **креатедсн**, который используется для запроса создания источников данных и, следовательно, необязательно. Каждая пара завершается нулевым байтом, а полный список завершается нулевым байтом (т. е. два нуль-байта отмечают конец списка). Например, файловый драйвер, использующий синтаксис C, может возвращать следующий список атрибутов ("\ 0" представляет символ null):  
  
```  
FileUsage=1\0FileExtns=*.dbf\0\0  
```  
  
 Если \* *дривераттрибутес* недостаточно велик для хранения всего списка, список усекается, **SQLDrivers** возвращает значение SQLSTATE 01004 (усечение данных), а длина списка (за исключением завершающего нулевого байта) возвращается в **аттрибутесленгсптр*.  
  
 Ключевые слова атрибута Driver добавляются из сведений о системе при установке драйвера. Дополнительные сведения см. в разделе [Установка компонентов ODBC](../../../odbc/reference/install/installing-odbc-components.md).  
  
 Приложение может вызывать **SQLDrivers** несколько раз для получения всех описаний драйверов. Диспетчер драйверов извлекает эти сведения из сведений о системе. Если больше нет описаний драйверов, **SQLDrivers** возвращает SQL_NO_DATA. Если **SQLDrivers** вызывается с SQL_FETCH_NEXT сразу после того, как он возвращает SQL_NO_DATA, возвращается первое описание драйвера. Сведения о том, как приложение использует сведения, возвращаемые **SQLDrivers**, см. [в разделе Выбор источника данных или драйвера](../../../odbc/reference/develop-app/choosing-a-data-source-or-driver.md).  
  
 Если SQL_FETCH_NEXT передается в **SQLDrivers** при первом вызове, **SQLDrivers** возвращает первое имя источника данных.  
  
 Поскольку **SQLDrivers** реализован в диспетчере драйверов, он поддерживается для всех драйверов, независимо от соответствия стандартам конкретного драйвера.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Обнаружение и перечисление значений, необходимых для подключения к источнику данных|[Функция SQLBrowseConnect](../../../odbc/reference/syntax/sqlbrowseconnect-function.md)|  
|Подключение к источнику данных|[Функция SQLConnect](../../../odbc/reference/syntax/sqlconnect-function.md)|  
|Возврат имен источников данных|[Функция SQLDataSources](../../../odbc/reference/syntax/sqldatasources-function.md)|  
|Соединение с источником данных с помощью строки подключения или диалогового окна|[Функция SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
