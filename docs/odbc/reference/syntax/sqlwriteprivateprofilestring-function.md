---
description: Функция SQLWritePrivateProfileString
title: Функция Склвритеприватепрофилестринг | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLWritePrivateProfileString
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLWritePrivateProfileString
helpviewer_keywords:
- SQLWritePrivateProfileString [ODBC]
ms.assetid: 526f36a4-92ed-4874-9725-82d27c0b86f9
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: b1110b60d6dc0ba079804ba8a9f21c06f0c1f78d
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88420958"
---
# <a name="sqlwriteprivateprofilestring-function"></a>Функция SQLWritePrivateProfileString
**Соответствия**  
 Введенная версия: ODBC 2,0  
  
 **Сводка**  
 **Склвритеприватепрофилестринг** записывает имя значения и данные в подраздел Odbc.ini системных сведений.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLWritePrivateProfileString(  
     LPCSTR     lpszSection,  
     LPCSTR     lpszEntry,  
     LPCSTR     lpszString,  
     LPCSTR     lpszFilename);  
```  
  
## <a name="arguments"></a>Аргументы  
 *лпсзсектион*  
 Входной Указывает на строку, завершающуюся нулем, содержащую имя раздела, в который будет скопирована строка. Если раздел не существует, он будет создан. Имя раздела не зависит от регистра. Строка может быть любым сочетанием прописных и строчных букв.  
  
 *лпсзентри*  
 Входной Указывает на строку с завершающим нулем, содержащую имя ключа, который должен быть связан со строкой. Если раздел не существует в указанном разделе, он будет создан. Если этот аргумент имеет значение NULL, то весь раздел, включая все записи внутри раздела, удаляется.  
  
 *лпсзстринг*  
 Входной Указывает на строку, завершающуюся нулем, для занесения в файл. Если этот аргумент имеет значение NULL, ключ, на который указывает аргумент *лпсзентри* , удаляется.  
  
 *лпсзфиленаме*  
 Проверки Указывает на строку, завершающуюся нулем, которая присваивает имя файлу инициализации.  
  
## <a name="returns"></a>Возвращаемое значение  
 Функция возвращает TRUE, если она успешна, и FALSE в случае сбоя.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **склвритеприватепрофилестринг** возвращает значение false, связанное значение * \* пферроркоде* может быть получено путем вызова **склинсталлереррор**. В следующей таблице перечислены значения * \* пферроркоде* , которые могут быть возвращены **склинсталлереррор** , и объясняется каждый из них в контексте этой функции.  
  
|*\*пферроркоде*|Ошибка|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Общая ошибка установщика|Произошла ошибка, для которой не возникала конкретная ошибка установщика.|  
|ODBC_ERROR_REQUEST_FAILED|Не удалось выполнить запрос|Не удалось записать запрошенную системную информацию.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Установщику не удалось выполнить функцию из-за нехватки памяти.|  
  
## <a name="comments"></a>Комментарии  
 **Склвритеприватепрофилестринг** предоставляется как простой способ переноса драйверов и библиотек DLL установки драйверов из Microsoft® Windows® в Microsoft Windows NT®/Виндовс 2000. Вызовы **вритеприватепрофилестринг** , которые записывают строку профиля в файл Odbc.ini, должны быть заменены вызовами **склвритеприватепрофилестринг**. **Склвритеприватепрофилестринг** вызывает функции в API Win32®, чтобы добавить имя и данные указанного значения в подраздел Odbc.ini системных сведений.  
  
 Режим конфигурации указывает, где Odbc.ini запись, в которой перечислены значения DSN, находится в системной информации. Если DSN является пользовательским именем DSN (переменная состояния — USERDSN_ONLY), функция записывает в Odbc.ini запись в HKEY_CURRENT_USER. Если DSN является системным именем DSN (SYSTEMDSN_ONLY), функция записывает в запись Odbc.ini в HKEY_LOCAL_MACHINE. Если переменная state имеет значение БОСДСН, выполняется попытка HKEY_CURRENT_USER и, если она завершается неудачей, используется HKEY_LOCAL_MACHINE.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Получение значения из сведений о системе|[SQLGetPrivateProfileString](../../../odbc/reference/syntax/sqlgetprivateprofilestring-function.md)|
