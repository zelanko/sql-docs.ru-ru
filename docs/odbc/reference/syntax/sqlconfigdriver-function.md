---
title: Функция Склконфигдривер | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLConfigDriver
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLConfigDriver
helpviewer_keywords:
- SQLConfigDriver function [ODBC]
ms.assetid: 4f681961-ac9f-4d88-b065-5258ba112642
author: MightyPen
ms.author: genemi
ms.openlocfilehash: e324b1f49bd6f8d0cad15ac2bcde73f558220330
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68121450"
---
# <a name="sqlconfigdriver-function"></a>Функция SQLConfigDriver
**Соответствия**  
 Введенная версия: ODBC 2,5  
  
 **Сводка**  
 **Склконфигдривер** загружает СООТВЕТСТВУЮЩУЮ библиотеку DLL установки драйвера и вызывает функцию **конфигдривер** .  
  
 Функциональность **склконфигдривер** также можно получить с помощью [одбкконф. EXE](../../../odbc/odbcconf-exe.md).  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLConfigDriver(  
     HWND     hwndParent,  
     WORD     fRequest,  
     LPCSTR   lpszDriver,  
     LPCSTR   lpszArgs,  
     LPSTR    lpszMsg,  
     WORD     cbMsgMax,  
     WORD *   pcbMsgOut);  
```  
  
## <a name="arguments"></a>Аргументы  
 *хвндпарент*  
 Входной Маркер родительского окна. Функция не отображает никакие диалоговые окна, если этот маркер имеет значение null.  
  
 *фрекуест*  
 Входной Тип запроса. *фрекуест* должен содержать одно из следующих значений:  
  
 ODBC_CONFIG_DRIVER: изменяет время ожидания пула соединений, используемое драйвером.  
  
 ODBC_INSTALL_DRIVER: устанавливает новый драйвер.  
  
 ODBC_REMOVE_DRIVER: удаляет существующий драйвер.  
  
 Этот параметр также может быть специфичным для драйвера, в этом случае *фрекуест* для первого параметра должен начинаться с ODBC_CONFIG_DRIVER_MAX + 1. Параметр *фрекуест* для любого дополнительного параметра также должен начинаться с значения, превышающего ODBC_CONFIG_DRIVER_MAX + 1.  
  
 *лпсздривер*  
 Входной Имя драйвера, зарегистрированное в системной информации.  
  
 *лпсзаргс*  
 Входной Строка, завершающаяся нулем, которая содержит аргументы для *фрекуест*конкретного драйвера.  
  
 *лпсзмсг*  
 Проверки Строка, завершающаяся нулем, которая содержит выходное сообщение от настройки драйвера.  
  
 *кбмсгмакс*  
 Входной Длина *лпсзмсг.*  
  
 *пкбмсгаут*  
 Проверки Общее число байт, доступных для возврата в *лпсзмсг*. Если число возвращаемых байт больше или равно *кбмсгмакс*, то выходное сообщение в *лпсзмсг* усекается до *кбмсгмакс* минус символ завершения null. Аргумент *пкбмсгаут* может быть пустым указателем.  
  
## <a name="returns"></a>Возвращает  
 Функция возвращает TRUE, если она успешна, и FALSE в случае сбоя.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **склконфигдривер** возвращает значение false, связанное * \*значение пферроркоде* может быть получено путем вызова **склинсталлереррор**. В следующей таблице перечислены значения * \*пферроркоде* , которые могут быть возвращены **склинсталлереррор** , и объясняется каждый из них в контексте этой функции.  
  
|*\*пферроркоде*|Ошибка|Description|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Общая ошибка установщика|Произошла ошибка, для которой не возникала конкретная ошибка установщика.|  
|ODBC_ERROR_INVALID_BUFF_LEN|Недопустимая длина буфера|Недопустимый аргумент *лпсзмсг* .|  
|ODBC_ERROR_INVALID_HWND|Недопустимый маркер окна|Недопустимый аргумент *хвндпарент* .|  
|ODBC_ERROR_INVALID_REQUEST_TYPE|Недопустимый тип запроса|Аргумент *фрекуест* не является одним из следующих:<br /><br /> ODBC_INSTALL_DRIVER ODBC_REMOVE_DRIVER<br /><br /> Аргумент *фрекуест* был зависящим от драйвера параметром, который меньше или равен ODBC_CONFIG_DRIVER_MAX.|  
|ODBC_ERROR_INVALID_NAME|Недопустимое имя драйвера или транслятора|Недопустимый аргумент *лпсздривер* . Не удалось найти его в реестре.|  
|ODBC_ERROR_INVALID_KEYWORD_VALUE|Недопустимые пары "ключевое слово-значение"|Аргумент *лпсзаргс* содержал синтаксическую ошибку.|  
|ODBC_ERROR_REQUEST_FAILED|Сбой *запроса*|Установщику не удалось выполнить операцию, запрошенную аргументом *фрекуест* . Сбой вызова **конфигдривер** .|  
|ODBC_ERROR_LOAD_LIBRARY_FAILED|Не удалось загрузить драйвер или библиотеку установки переводчика|Не удалось загрузить библиотеку установки драйверов.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Установщику не удалось выполнить функцию из-за нехватки памяти.|  
  
## <a name="comments"></a>Комментарии  
 **Склконфигдривер** позволяет приложению вызывать подпрограмму драйвера **конфигдривер** без необходимости знания имени и загрузки библиотеки DLL установки, относящейся к драйверу. Программа установки вызывает эту функцию после установки драйвера библиотеки DLL. Вызывающая программа должна знать, что эта функция может быть недоступна для всех драйверов. В этом случае вызывающая программа должна продолжить работу без ошибок.  
  
## <a name="driver-specific-options"></a>Параметры, относящиеся к драйверу  
 Приложение может запрашивать связанные с драйвером функции, предоставляемые драйвером, с помощью аргумента *фрекуест* . *Фрекуест* для первого параметра будет ODBC_CONFIG_DRIVER_MAX + 1, а дополнительные параметры будут увеличены на 1 из этого значения. Все аргументы, необходимые драйверу для этой функции, должны быть предоставлены в строке, завершающейся нулем, передаваемой в аргументе *лпсзаргс* . Драйверы, обеспечивающие такую функциональность, должны поддерживать таблицу параметров, относящихся к драйверу. Параметры должны быть полностью документированы в документации по драйверам. Разработчики приложений, которые используют параметры, относящиеся к драйверу, должны иметь в виду, что это позволяет сократить работоспособность приложения.  
  
## <a name="setting-connection-pooling-timeout"></a>Настройка времени ожидания для пула соединений  
 Свойства времени ожидания для пула подключений можно задать при настройке конфигурации драйвера. **Склконфигдривер** вызывается с *Фрекуест* ODBC_CONFIG_DRIVER и *лпсзаргс* имеет значение **кптимеаут**. **Кптимеаут** определяет период времени, в течение которого соединение может оставаться в пуле соединений без использования. По истечении времени ожидания соединение закрывается и удаляется из пула. Время ожидания по умолчанию — 60 секунд.  
  
 При вызове **склконфигдривер** с параметром *фрекуест* , имеющим значение ODBC_INSTALL_DRIVER или ODBC_REMOVE_DRIVER, диспетчер драйверов загружает соответствующую библиотеку DLL установки драйвера и вызывает функцию **конфигдривер** . Когда **склконфигдривер** вызывается с *фрекуест* ODBC_CONFIG_DRIVER, вся обработка выполняется в установщике ODBC, чтобы не загружать библиотеку DLL установки драйвера.  
  
## <a name="messages"></a>Сообщения  
 Подпрограмма установки драйвера может отправить текстовое сообщение в приложение как строки, заканчивающиеся нулем, в буфер *лпсзмсг* . Сообщение будет обрезано до *кбмсгмакс* минус символ завершения, равный NULL функцией **конфигдривер** , если он больше или равен *кбмсгмакс* символов.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Тема|См. следующие документы.|  
|---------------------------|---------|  
|Добавление, изменение или удаление драйвера|[Конфигдривер](../../../odbc/reference/syntax/configdriver-function.md)(в библиотеке DLL установки)|  
|Удаление источника данных по умолчанию|[склремоведефаултдатасаурце](../../../odbc/reference/syntax/sqlremovedefaultdatasource-function.md)|
