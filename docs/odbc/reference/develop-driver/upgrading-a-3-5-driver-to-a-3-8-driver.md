---
title: Обновления драйвера 3.5 до 3.8 | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: ffba36ac-d22e-40b9-911a-973fa9e10bd3
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: df2fa8df9af317bd76b2d7f10e50f7cc937e4660
ms.sourcegitcommit: 61381ef939415fe019285def9450d7583df1fed0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47731042"
---
# <a name="upgrading-a-35-driver-to-a-38-driver"></a>Обновление драйвера с версии 3.5 до 3.8
Данный раздел содержит рекомендации и замечания по обновлению драйвером ODBC 3.5 драйверу ODBC 3.8.  
  
##### <a name="version-numbers"></a>Номера версий  
 Следующие рекомендации относятся к версии:  
  
-   Драйвер SQL_OV_ODBC3_80 поддержка SQL_ATTR_ODBC_VERSION, возвращая значение SQL_ERROR для значений, отличных от SQL_OV_ODBC2 значение SQL_OV_ODBC3 и SQL_OV_ODBC3_80. Будущие версии диспетчера драйверов предполагает, что драйвер поддерживает уровень соответствия ODBC, драйвер возвращает SQL_SUCCESS из [функция SQLSetEnvAttr](../../../odbc/reference/syntax/sqlsetenvattr-function.md).  
  
-   Драйвер версии 3.8 должен возвращать 03.80 из **SQLGetInfo** при передаче SQL_DRIVER_ODBC_VER *InfoType*. Однако старые диспетчеры драйвера, которой были включены в более ранних версиях Microsoft Windows, будет считать драйвер драйвер версии 3.5 и выдает предупреждение.  
  
     В Windows 7 версия диспетчера драйверов — 03.80. В Windows 8, версия диспетчера драйверов, 03.81 через SQLGetInfo SQL_DM_VER (*InfoType* параметр). SQL_ODBC_VER сообщает версии 03.80 в Windows 7 и Windows 8.  
  
##### <a name="driver-specific-c-data-types"></a>Типы данных C специфические для драйвера  
 Драйвер можно дополнять типы данных C при работе с приложением ODBC версии 3.8. (Дополнительные сведения см. в разделе [типы данных C в ODBC](../../../odbc/reference/develop-app/c-data-types-in-odbc.md).) Тем не менее нет необходимости 3,8 драйвера для реализации любых типов C специфические для драйвера. Но драйвер должен по-прежнему выполнять проверки диапазона типов языка с; Диспетчер драйверов не сделает это за 3,8 драйверы. Чтобы упростить разработку драйверов, можно определить значение типа данных в конкретное C драйвера в следующем формате:  
  
```  
SQL_DRIVER_C_TYPE_BASE+0, SQL_DRIVER_C_TYPE_BASE+1  
```  
  
##### <a name="driver-specific-data-types-descriptor-types-information-types-diagnostic-types-and-attributes"></a>Типы данных, типы дескрипторов, типы сведений, диагностические типы и атрибуты  
 При разработке нового драйвера, следует использовать range относящиеся к драйверу для типов данных, типы дескрипторов, типы сведений, диагностические типы и атрибуты. Специфические для драйвера диапазоны и их значения базового типа рассматриваются в [типов данных драйвера, типы дескрипторов, типы сведений, диагностические типы и атрибуты](../../../odbc/reference/develop-app/driver-specific-data-types-descriptor-information-diagnostic.md).  
  
##### <a name="connection-pooling"></a>Организация пулов соединений  
 Для более эффективного управления организация пулов соединений ODBC 3.8, появился новый атрибут соединения SQL_ATTR_RESET_CONNECTION в **SQLSetConnectAttr**. SQL_RESET_CONNECTION_YES является единственным допустимым значением для этого атрибута. SQL_ATTR_RESET_CONNECTION задается непосредственно перед диспетчера драйверов помещает соединения в пуле соединений, что позволяет драйверу для сброса других атрибутах соединения к значениям по умолчанию.  
  
 Чтобы избежать ненужных связи с сервером, драйвер можно отложить атрибут соединения сбросить до следующего обмен данными с удаленным сервером после повторном использовании соединения из пула.  
  
 Обратите внимание на то, что SQL_ATTR_RESET_CONNECTION используется только при обмене данными между диспетчера драйверов и драйверов. Приложение не может напрямую установить этот атрибут. Все версии 3.8 драйверы должны реализовывать этот атрибут подключения.  
  
##### <a name="streamed-output-parameters"></a>Потоковых выходных параметров  
 Извлечение параметров вывода ODBC версии 3.8 представляет потоковых выходных параметров, более масштабируемым способом. (Дополнительные сведения см. в разделе [получение выходных параметров с помощью метода SQLGetData](../../../odbc/reference/develop-app/retrieving-output-parameters-using-sqlgetdata.md).) Для поддержки этой возможности, драйвер должен задать SQL_GD_OUTPUT_PARAMS в возвращаемом значении при SQL_GETDATA_EXTENSIONS *InfoType* в **SQLGetInfo** вызова. Поддержка тип SQL с помощью потоковых выходные параметры должны быть реализованы в драйвере. Диспетчер драйверов не будет формировать ошибку для недопустимого типа SQL. Типы SQL, поддерживающие потоковых выходных параметров определяется в драйвере.  
  
 Драйвер должен возвращать значение SQL_ERROR, если в приложении используется **SQLGetData** извлекаемого параметра, который не является таким же, как параметр, возвращаемый **SQLParamData**.  
  
##### <a name="asynchronous-execution-for-connection-operations-polling-method"></a>Асинхронное выполнение операций соединения (метод опроса)  
 Драйвер можно включить поддержку асинхронных операций для выполнения различных операций соединения.  
  
 Начиная с Windows 7, ODBC поддерживает метод опроса (Дополнительные сведения см. в разделе [асинхронное выполнение (метод опроса)](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md). Нет необходимости для драйвера ODBC версии 3.8 для реализации асинхронных операций на дескрипторов соединений. Даже если драйвер не реализует асинхронных операций в дескрипторов соединений, драйвер по-прежнему должны реализовывать SQL_ASYNC_DBC_FUNCTIONS *InfoType* и вернуть **SQL_ASYNC_DBC_NOT_CAPABLE**.  
  
 Если включены операции асинхронного подключения, время выполнения операции подключения — общее время для всех повторных вызовов. Если последний повторить вызов происходит после того как общее время превышает значение, заданное в атрибуте соединения sql_attr_connection_timeout не учитывается, и операция не была завершена, драйвер возвращает значение SQL_ERROR и заносит в журнал создается запись диагностики с кодом SQLState HYT01 и сообщения, «время ожидания подключения истекло». Что таймаут не используется, если операция завершена.  
  
##### <a name="sqlcancelhandle-function"></a>Функция SQLCancelHandle  
 Поддерживает ODBC 3.8 [функция SQLCancelHandle](../../../odbc/reference/syntax/sqlcancelhandle-function.md), который используется для отмены операции соединения и инструкции. Драйвер, который поддерживает **SQLCancelHandle** необходимо экспортировать функции. Драйвер не следует отменять любая функция синхронным или асинхронным соединения, выполняется, если приложение вызывает **SQLCancel** или **SQLCancelHandle** дескриптором инструкции. Аналогичным образом, драйвер не отменит любая функция синхронным или асинхронным инструкции, выполняется, если приложение вызывает **SQLCancelHandle** на дескриптор соединения. Кроме того, драйвер не должен отменить операцию, просмотра веб-страниц (**SQLBrowseConnect** возвращает SQL_NEED_DATA) Если приложение вызывает **SQLCancelHandle** на дескриптор соединения. В этом случае драйвер должен возвращать HY010, «ошибочная последовательность функций».  
  
 Нет необходимости для поддержки обеих **SQLCancelHandle** и операции асинхронного подключения, в то же время. Драйвер может поддерживать операции асинхронного подключения, но не **SQLCancelHandle**, или наоборот.  
  
##### <a name="suspended-connections"></a>Приостановленные подключения  
 Диспетчер драйверов ODBC 3.8 можно поместить соединение в приостановленном состоянии. Приложение будет вызывать **SQLDisconnect** для освобождения ресурсов, связанные с подключением. В этом случае драйвер следует попытаться освободить ресурсы столько можно без проверки состояния соединения. Дополнительные сведения о приостановленном состоянии, см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).  
  
##### <a name="driver-aware-connection-pooling"></a>Организация пулов соединений с учетом драйвера  
 ODBC в Windows 8 позволяет драйверы для настройки поведения пула соединений. Дополнительные сведения см. в разделе [Driver-Aware Connection Pooling](../../../odbc/reference/develop-app/driver-aware-connection-pooling.md).  
  
##### <a name="asynchronous-execution-notification-method"></a>Асинхронное выполнение (метод уведомления)  
 ODBC 3.8 поддерживает метод уведомления для асинхронных операций, появилась в Windows 8. Дополнительные сведения см. в разделе [асинхронное выполнение (метод уведомления)](../../../odbc/reference/develop-app/asynchronous-execution-notification-method.md).  
  
## <a name="see-also"></a>См. также  
 [Разработка драйвера ODBC](../../../odbc/reference/develop-driver/developing-an-odbc-driver.md)   
 [Драйверы ODBC, предоставляемые корпорацией Майкрософт](../../../odbc/microsoft/microsoft-supplied-odbc-drivers.md)   
 [Новые возможности ODBC 3.8](../../../odbc/reference/what-s-new-in-odbc-3-8.md)
