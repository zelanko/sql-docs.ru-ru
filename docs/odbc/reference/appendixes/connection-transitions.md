---
description: Переходы подключения
title: Переходы подключений | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- transitioning states [ODBC], connection
- connection transitions [ODBC]
- state transitions [ODBC], connection
ms.assetid: 6b6e1a47-4a52-41c8-bb9e-7ddeae09913e
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a5f7fecf0ad25311e9d96f4db8554c1cdbf24e91
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88339450"
---
# <a name="connection-transitions"></a>Переходы подключения
Подключения ODBC имеют следующие состояния.  
  
|Состояние|Описание|  
|-----------|-----------------|  
|C0|Нераспределенная среда, нераспределенное подключение|  
|C1|Выделенная среда, нераспределенное подключение|  
|C2|Выделенная среда, выделенное соединение|  
|C3|Функции подключения требуются данные|  
|C4|Подключенное подключение|  
|C5|Подключенное соединение, выделенная Инструкция|  
|C6|Подключенное подключение, выполняется транзакция. Возможно, соединение находится в состоянии C6 без инструкций, выделенных для соединения. Например, предположим, что соединение находится в режиме фиксации вручную и находится в состоянии C4. Если инструкция выделена, выполняется (запуск транзакции), а затем освобождается, транзакция остается активной, но в соединении нет инструкций.|  
  
 В следующих таблицах показано, как каждая функция ODBC влияет на состояние соединения.  
  
## <a name="sqlallochandle"></a>Функцию SQLAllocHandle  
  
|C0<br /><br /> Нет env.|Нераспределенное C1|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|--------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|C1 [1]|--[5]|--[5]|--[5]|--[5]|--[5]|--[5]|  
|IH открыт|C2|--[5]|--[5]|--[5]|--[5]|--[5]|  
|IH 3-5|IH|(08003)|(08003)|C5|--[5]|--[5]|  
|IH четырех|IH|(08003)|(08003)|--[5]|--[5]|--[5]|  
  
 [1] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_ENV.  
  
 [2] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_DBC.  
  
 [3] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_STMT.  
  
 [4] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_DESC.  
  
 [5] вызов **функцию SQLAllocHandle** с помощью *аутпусандлептр* , указывающий на допустимый маркер, перезаписывает этот обработчик без учета того, что предыдущее содержимое офсат Handle, и может вызвать проблемы с драйверами ODBC. Неправильное программирование приложений ODBC для вызова **функцию SQLAllocHandle** дважды с той же переменной приложения, определенной для * \* Аутпусандлептр* , без вызова **SQLFreeHandle** для освобождения обработчика перед перераспределением. Перезапись дескрипторов ODBC таким образом может привести к несогласованному поведению или ошибкам в части драйверов ODBC.  
  
## <a name="sqlbrowseconnect"></a>SQLBrowseConnect  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|C3 [d] C4 [s]|--[d] C2 [e] C4 [s]|(08002)|(08002)|(08002)|  
  
## <a name="sqlclosecursor"></a>SQLCloseCursor  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|IH|IH|IH|--|--[1] C5 [2]|  
  
 [1] соединение было запущено в режиме ручной фиксации.  
  
 [2] соединение находилось в режиме автоматической фиксации.  
  
## <a name="sqlcolumnprivileges-sqlcolumns-sqlforeignkeys-sqlgettypeinfo-sqlprimarykeys-sqlprocedurecolumns-sqlprocedures-sqlspecialcolumns-sqlstatistics-sqltableprivileges-and-sqltables"></a>SQLColumnPrivileges, SQLColumns, SQLForeignKeys, SQLGetTypeInfo, SQLPrimaryKeys, SQLProcedureColumns, SQLProcedures, SQLSpecialColumns, SQLStatistics, SQLTablePrivileges и SQLTables  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|IH|IH|IH|--[1] C6 [2]|--|  
  
 [1] соединение находилось в режиме автоматической фиксации, или источник данных не начал транзакцию.  
  
 [2] соединение находилось в режиме фиксации вручную, и источник данных начал транзакцию.  
  
## <a name="sqlconnect"></a>SQLConnect  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|C4|(08002)|(08002)|(08002)|(08002)|  
  
## <a name="sqlcopydesc-sqlgetdescfield-sqlgetdescrec-sqlsetdescfield-and-sqlsetdescrec"></a>Склкопидеск, SQLGetDescField, SQLGetDescRec, SQLSetDescField и SQLSetDescRec  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|IH|IH|--[1]|--|--|  
  
 [1] в этом состоянии единственные дескрипторы, доступные для приложения, являются явно выделенными дескрипторами.  
  
## <a name="sqldatasources-and-sqldrivers"></a>SQLDataSources и SQLDrivers  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|--|--|--|--|--|--|  
  
## <a name="sqldisconnect"></a>SQLDisconnect  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|(08003)|C2|C2|C2|25000|  
  
## <a name="sqldriverconnect"></a>SQLDriverConnect  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|C4 s--n [f]|(08002)|(08002)|(08002)|(08002)|  
  
## <a name="sqlendtran"></a>SQLEndTran  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH одного|--[3]|--[3]|--[3]|--|--|--[4] или ([5], [6] и [8]) C4 [5] и [7] C5 [5], [6] и [9]|  
|IH открыт|IH|(08003)|(08003)|--|--|C5|  
  
 [1] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_ENV.  
  
 [2] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_DBC.  
  
 [3], так как соединение не находится в подключенном состоянии, транзакция не влияет на него.  
  
 [4] не удалось выполнить фиксацию или откат соединения. Функция возвращает SQL_ERROR в этом случае.  
  
 [5] Фиксация или откат для соединения выполнен. Функция возвращает SQL_ERROR в случае сбоя фиксации или отката в другом соединении, или функция возвращает SQL_SUCCESS, если фиксация или откат успешно выполнен для всех соединений.  
  
 [6] существует хотя бы одна инструкция, выделенная для соединения.  
  
 [7] для соединения не было выделено ни одной инструкции.  
  
 [8] соединение имело по крайней мере одну инструкцию, для которой был открыт курсор, а источник данных сохраняет курсоры при фиксации или откате транзакций, в зависимости от того, применяется ли *комплетионтипе* к SQL_COMMIT или SQL_ROLLBACK). Дополнительные сведения см. в описании атрибутов SQL_CURSOR_COMMIT_BEHAVIOR и SQL_CURSOR_ROLLBACK_BEHAVIOR в [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md).  
  
 [9] Если в соединении имелись инструкции, для которых имеются открытые курсоры, то курсоры не сохранялись при фиксации или откате транзакции.  
  
## <a name="sqlexecdirect-and-sqlexecute"></a>SQLExecDirect и SQLExecute  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|IH|IH|IH|--[1] C6 [2] C6 [3]|--|  
  
 [1] соединение находилось в режиме автоматической фиксации, а выполняемая инструкция не является *спецификацией* *курсора* (например, инструкцией SELECT); или соединение было в режиме ручной фиксации, а выполнение инструкции не начинало транзакцию.  
  
 [2] соединение находилось в режиме автоматической фиксации, а выполняемая инструкция — это *Спецификация* *курсора* (например, инструкция SELECT).  
  
 [3] соединение находилось в режиме фиксации вручную, и источник данных начал транзакцию.  
  
## <a name="sqlfreehandle"></a>SQLFreeHandle  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH одного|C0|(HY010)|(HY010)|(HY010)|(HY010)|(HY010)|  
|IH открыт|IH|Тогда|(HY010)|(HY010)|(HY010)|(HY010)|  
|IH 3-5|IH|IH|IH|IH|C4 [5]--[6]|--[7] C4 [5] и [8] C5 [6] и [8]|  
|IH четырех|IH|IH|IH|--|--|--|  
  
 [1] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_ENV.  
  
 [2] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_DBC.  
  
 [3] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_STMT.  
  
 [4] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_DESC.  
  
 [5] для соединения была выделена только одна инструкция.  
  
 [6] для соединения было выделено несколько инструкций.  
  
 [7] соединение было запущено в режиме ручной фиксации.  
  
 [8] соединение находилось в режиме автоматической фиксации.  
  
## <a name="sqlfreestmt"></a>Функция SQLFreeStmt  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH одного|IH|IH|IH|IH|--|C5 [3]--[4]|  
|IH открыт|IH|IH|IH|IH|--|--|  
  
 [1] в этой строке отображаются транзакции, если аргумент *Option* имеет значение SQL_CLOSE.  
  
 [2] в этой строке отображаются транзакции, если аргумент *Option* имеет значение SQL_UNBIND или SQL_RESET_PARAMS.  
  
 [3] соединение находилось в режиме автоматической фиксации; курсоры не были открыты ни на одном из инструкций, Кроме этого.  
  
 [4] соединение находилось в режиме фиксации вручную или находилось в режиме автоматической фиксации, а курсор был открыт по крайней мере в одной другой инструкции.  
  
## <a name="sqlgetconnectattr"></a>SQLGetConnectAttr  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|--[1] 08003 [2]|HY010|--|--|--|  
  
 [1] аргумент *атрибута* был SQL_ATTR_ACCESS_MODE, SQL_ATTR_AUTOCOMMIT, SQL_ATTR_LOGIN_TIMEOUT, SQL_ATTR_ODBC_CURSORS, SQL_ATTR_TRACE или SQL_ATTR_TRACEFILE или было задано значение для атрибута соединения.  
  
 [2] аргумент *атрибута* не SQL_ATTR_ACCESS_MODE, SQL_ATTR_AUTOCOMMIT, SQL_ATTR_LOGIN_TIMEOUT, SQL_ATTR_ODBC_CURSORS, SQL_ATTR_TRACE или SQL_ATTR_TRACEFILE, а значение для атрибута Connection не было задано.  
  
## <a name="sqlgetdiagfield-and-sqlgetdiagrec"></a>SQLGetDiagField и SQLGetDiagRec  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH одного|--|--|--|--|--|--|  
|IH открыт|IH|--|--|--|--|--|  
|IH 3-5|IH|IH|IH|IH|--|--|  
|IH четырех|IH|IH|IH|--|--|--|  
  
 [1] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_ENV.  
  
 [2] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_DBC.  
  
 [3] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_STMT.  
  
 [4] в этой строке отображаются переходы, когда *параметром handletype* был SQL_HANDLE_DESC.  
  
## <a name="sqlgetenvattr"></a>SQLGetEnvAttr  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|--|--|--|--|--|--|  
  
## <a name="sqlgetfunctions"></a>SQLGetFunctions  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|HY010|HY010|--|--|--|  
  
## <a name="sqlgetinfo"></a>SQLGetInfo  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|--[1] 08003 [2]|08003|--|--|--|  
  
 [1] аргумент *инфотипе* был SQL_ODBC_VER.  
  
 [2] аргумент *инфотипе* не SQL_ODBC_VER.  
  
## <a name="sqlmoreresults"></a>SQLMoreResults  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|IH|IH|IH|--[1] C6 [2]|--[3] C5 [1]|  
  
 [1] соединение находилось в режиме автоматической фиксации, а вызов **SQLMoreResults** не инициализировал обработку результирующего набора спецификации курсора.  
  
 [2] соединение находилось в режиме автоматической фиксации, а вызов **SQLMoreResults** инициализирует обработку результирующего набора спецификации курсора.  
  
 [3] подключение выполнялось в режиме ручной фиксации.  
  
## <a name="sqlnativesql"></a>SQLNativeSql  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|(08003)|(08003)|--|--|--|  
  
## <a name="sqlprepare"></a>SQLPrepare  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|IH|IH|IH|--[1] C6 [2]|--|  
  
 [1] соединение находилось в режиме автоматической фиксации, или источник данных не начал транзакцию.  
  
 [2] соединение находилось в режиме фиксации вручную, и источник данных начал транзакцию.  
  
## <a name="sqlsetconnectattr"></a>SQLSetConnectAttr  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|--[1] 08003 [2]|HY010|--[3] 08002 [4] HY011 [5]|--[3] 08002 [4] HY011 [5]|--[3] и [6] C5 [8] 08002 [4] HY011 [5] или [7]|  
  
 [1] аргумент *атрибута* не SQL_ATTR_TRANSLATE_LIB или SQL_ATTR_TRANSLATE_OPTION.  
  
 [2] аргумент *атрибута* был SQL_ATTR_TRANSLATE_LIB или SQL_ATTR_TRANSLATE_OPTION.  
  
 [3] аргумент *атрибута* не SQL_ATTR_ODBC_CURSORS или SQL_ATTR_PACKET_SIZE.  
  
 [4] аргумент *атрибута* был SQL_ATTR_ODBC_CURSORS.  
  
 [5] аргумент *атрибута* был SQL_ATTR_PACKET_SIZE.  
  
 [6] аргумент *атрибута* не SQL_ATTR_AUTOCOMMIT, либо аргумент *атрибута* был SQL_ATTR_AUTOCOMMIT и установка этого атрибута не зафиксировала транзакцию.  
  
 [7] аргумент *атрибута* был SQL_ATTR_TXN_ISOLATION.  
  
 [8] аргумент *атрибута* был SQL_ATTR_AUTOCOMMIT, и установка этого атрибута зафиксировала транзакцию.  
  
## <a name="sqlsetenvattr"></a>SQLSetEnvAttr  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|--|--|(HY010)|--|--|--|  
  
## <a name="all-other-odbc-functions"></a>Все остальные функции ODBC  
  
|C0<br /><br /> Нет env.|C1<br /><br /> Не выделено|C2<br /><br /> Allocated|C3<br /><br /> Требуются данные|C4<br /><br /> Подключен|C5<br /><br /> .|C6<br /><br /> Транзакция|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|IH|IH|IH|IH|IH|--|--|
