---
description: Функции даты, времени и интервалов
title: Функции времени, даты и интервалов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- functions [ODBC], time functions
- functions [ODBC], date functions
- interval functions [ODBC]
- functions [ODBC], interval functions
- time functions [ODBC]
- date functions [ODBC]
ms.assetid: bdf054a0-7aba-4e99-a34a-799917376fd5
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: dcbdf9f40a9cd1f1296920e3d2ea71fcb5ce6b39
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88386380"
---
# <a name="time-date-and-interval-functions"></a>Функции даты, времени и интервалов
В следующей таблице перечислены функции даты и времени, которые включены в набор скалярных функций ODBC. Приложение может определить, какие функции времени и даты поддерживаются драйвером, вызвав **SQLGetInfo** с *типом данных* SQL_TIMEDATE_FUNCTIONS.  
  
 Аргументами, обозначенными как *timestamp_exp* , может быть имя столбца, результат другой скалярной функции или символ переключения ODBC- *времени*, *ODBC-Date-escape*или *ODBC-timestamp-escape*, где базовый тип данных можно представить как SQL_CHAR, SQL_VARCHAR, SQL_TYPE_TIME, SQL_TYPE_DATE или SQL_TYPE_TIMESTAMP.  
  
 Аргументами, обозначенными как *date_exp* , может быть имя столбца, результат другой скалярной функции, escape-последовательность *ODBC* или *ODBC-timestamp-ESC*, где базовый тип данных можно представить как SQL_CHAR, SQL_VARCHAR, SQL_TYPE_DATE или SQL_TYPE_TIMESTAMP.  
  
 Аргументами, обозначенными как *time_exp* , может быть имя столбца, результат другой скалярной функции, escape-последовательность *ODBC* или *ODBC-timestamp-escape*, где базовый тип данных можно представить как SQL_CHAR, SQL_VARCHAR, SQL_TYPE_TIME или SQL_TYPE_TIMESTAMP.  
  
 Скалярные функции CURRENT_DATE, CURRENT_TIME и CURRENT_TIMESTAMP timedate были добавлены в ODBC 3,0 для согласования с SQL-92.  
  
|Функция|Описание|  
|--------------|-----------------|  
|**CURRENT_DATE ()** (ODBC 3,0)|Возвращает текущую дату.|  
|**CURRENT_TIME [(** *время-точность* **)]** (ODBC 3,0)|Возвращает текущее время. Аргумент *времени с точностью* определяет точность возвращаемого значения в секундах.|  
|**CURRENT_TIMESTAMP**<br /> **[(** *Метка времени-точность* **)]** (ODBC 3,0)|Возвращает текущую локальную дату и местное время в виде значения timestamp. Аргумент *timestamp-Precision* определяет точность возвращаемой метки времени в секундах.|  
|**CURDATE ()** (ODBC 1,0)|Возвращает текущую дату.|  
|**Куртиме ()** (ODBC 1,0)|Возвращает текущее время.|  
|**Дайнаме (** *date_exp* **)** (ODBC 2,0)|Возвращает строку символов, содержащую зависящее от источника данных название дня (например, с воскресенья по субботу или Sun). до Sat., для источника данных, использующего английский язык, или Соннтаг через Самстаг для источника данных, использующего немецкий), в день *date_exp*.|  
|**DAYOFMONTH (** *date_exp* **)** (ODBC 1,0)|Возвращает день месяца, основанный на поле месяца, в *date_exp* как целочисленное значение в диапазоне 1-31.|  
|**DayOfWeek (** *date_exp* **)** (ODBC 1,0)|Возвращает день недели, основанный на поле Week, в *date_exp* как целочисленное значение в диапазоне 1-7, где 1 — воскресенье.|  
|**DAYOFYEAR (** *date_exp* **)** (ODBC 1,0)|Возвращает день года, основанный на поле Year, в *date_exp* как целочисленное значение в диапазоне 1-366.|  
|**Извлечение (** *извлечение поля из* *Extract-Source* **)** (ODBC 3,0)|Возвращает часть извлечения *поля* *Extract-Source*. Аргумент *Extract-Source* является выражением типа DateTime или Interval. Аргументом *извлечения поля* может быть одно из следующих ключевых слов:<br /><br /> YEAR МЕСЯЦ, ДЕНЬ СЕКУНДА, МИНУТА<br /><br /> Точность возвращаемого значения определяется реализацией. Масштаб равен 0, если не указана СЕКУНДа. в этом случае масштаб не меньше, чем точность в долях секунды поля *Extract-Source* .|  
|**Hour (** *time_exp* **)** (ODBC 1,0)|Возвращает час на основе поля часа в *time_exp* как целочисленное значение в диапазоне 0-23.|  
|**Minute (** *time_exp* **)** (ODBC 1,0)|Возвращает минуты на основе поля минуты в *time_exp* как целое значение в диапазоне 0-59.|  
|**Month (** *date_exp* **)** (ODBC 1,0)|Возвращает месяц, основанный на поле месяца, в *date_exp* как целочисленное значение в диапазоне 1-12.|  
|**MonthName (** *date_exp* **)** (ODBC 2,0)|Возвращает строку символов, содержащую имя месяца, зависящее от источника данных (например, с января по декабрь или с января по Jan.) для источника данных, использующего английский язык, или Жануар через Дезембер для источника данных, который использует немецкий язык) для части месяца *date_exp*.|  
|**Now ()** (ODBC 1,0)|Возвращает текущую дату и время в виде значения метки времени.|  
|**Quarter (** *date_exp* **)** (ODBC 1,0)|Возвращает квартал в *date_exp* как целочисленное значение в диапазоне 1-4, где 1 — 1 января до 31 марта.|  
|**Второе (** *time_exp* **)** (ODBC 1,0)|Возвращает второй набор, основанный на втором поле в *time_exp* как целочисленное значение в диапазоне 0-59.|
|**Тиместампадд (** *интервал*, *integer_exp*, *timestamp_exp* **)** (ODBC 2,0)|Возвращает отметку времени, вычисленную путем добавления *integer_exp* интервалов типа *Interval* для *timestamp_exp*. Допустимыми значениями *Interval* являются следующие ключевые слова:<br /><br /> SQL_TSI_FRAC_SECOND<br /><br /> SQL_TSI_SECOND<br /><br /> SQL_TSI_MINUTE<br /><br /> SQL_TSI_HOUR<br /><br /> SQL_TSI_DAY<br /><br /> SQL_TSI_WEEK<br /><br /> SQL_TSI_MONTH<br /><br /> SQL_TSI_QUARTER<br /><br /> SQL_TSI_YEAR<br /><br /> где доли секунды выражаются в биллионсс секунды. Например, следующая инструкция SQL возвращает имя каждого сотрудника и дату годовщины в один год:<br /><br /> `SELECT NAME, {fn  TIMESTAMPADD(SQL_TSI_YEAR, 1, HIRE_DATE)} FROM  EMPLOYEES`<br /><br /> Если *timestamp_exp* является значением времени и *интервалом* задаются дни, недели, месяцы, кварталы или годы, в качестве части даты *timestamp_exp* устанавливается текущая дата перед вычислением результирующей отметки времени.<br /><br /> Если *timestamp_exp* является значением даты, а параметр *Interval* указывает доли секунды, секунды, минуты или часы, то временной частью *timestamp_exp* присваивается значение 0 перед вычислением результирующей метки времени.<br /><br /> Приложение определяет, какие интервалы времени поддерживает источник данных, вызывая **SQLGetInfo** с параметром SQL_TIMEDATE_ADD_INTERVALS.|  
|**Тиместампдифф (** *интервал*, *timestamp_exp1*, *timestamp_exp2* **)** (ODBC 2,0)|Возвращает целое *число интервалов типа, на которое* *timestamp_exp2* больше *timestamp_exp1*. Допустимыми значениями *Interval* являются следующие ключевые слова:<br /><br /> SQL_TSI_FRAC_SECOND<br /><br /> SQL_TSI_SECOND<br /><br /> SQL_TSI_MINUTE<br /><br /> SQL_TSI_HOUR<br /><br /> SQL_TSI_DAY<br /><br /> SQL_TSI_WEEK<br /><br /> SQL_TSI_MONTH<br /><br /> SQL_TSI_QUARTER<br /><br /> SQL_TSI_YEAR<br /><br /> где доли секунды выражаются в биллионсс секунды. Например, следующая инструкция SQL возвращает имя каждого сотрудника и число лет, в течение которых он был принят на работу.<br /><br /> `SELECT NAME, {fn  TIMESTAMPDIFF(SQL_TSI_YEAR, {fn CURDATE()}, HIRE_DATE)} FROM EMPLOYEES`<br /><br /> Если выражение отметки времени имеет значение времени и *интервал* указывает дни, недели, месяцы, кварталы или годы, часть даты этой метки времени устанавливается в текущую дату перед вычислением разницы между отметками времени.<br /><br /> Если выражение отметки времени является значением даты, а *интервал* — доли секунды, секунды, минуты или часы, то временной отметкой метки времени присваивается значение 0, прежде чем будет рассчитано различие между отметками времени.<br /><br /> Приложение определяет, какие интервалы времени поддерживает источник данных, вызывая **SQLGetInfo** с параметром SQL_TIMEDATE_DIFF_INTERVALS.|  
|**Week (** *date_exp* **)** (ODBC 1,0)|Возвращает неделю года, основанную на поле Week, в *date_exp* как целочисленное значение в диапазоне 1-53.|  
|**Year (** *date_exp* **)** (ODBC 1,0)|Возвращает год, основанный на поле Year, в *date_exp* как целочисленное значение. Диапазон зависит от источника данных.|
