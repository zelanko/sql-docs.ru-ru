---
title: Выполняются инструкции позиционированного обновления и удаления | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- positioned deletes [ODBC]
- cursor library [ODBC], positioned update or delete
- positioned updates [ODBC]
- ODBC cursor library [ODBC], positioned update or delete
ms.assetid: 1d64f309-2a6e-4ad1-a6b5-e81145549c56
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 96a1aa891ef8ba26c6c239cf35e62a8f36018e65
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81307005"
---
# <a name="executing-positioned-update-and-delete-statements"></a>Выполнение инструкций позиционированного обновления и удаления
> [!IMPORTANT]  
>  Эта функция будет удалена в следующей версии Windows. Избегайте использования этой функции в новых разработках и запланируйте изменение приложений, которые в настоящее время используют эту функцию. Корпорация Майкрософт рекомендует использовать функцию курсора драйвера.  
  
 После того как приложение побирало блок данных с помощью **SQLFetchScroll**, оно может обновить или удалить данные в блоке. Для выполнения позиционированного обновления или удаления приложение:  
  
1.  Вызывает функцию **SQLSetPos** для позиционирования курсора в строке, которая должна быть обновлена или удалена.  
  
2.  Конструирует инструкцию позиционированного обновления или удаления со следующим синтаксисом:  
  
     **Обновить** *таблицу-имя*  
  
     **Задать** *идентификатор* **=** столбца {*выражение* &#124; **null**}  
  
     [**,** *столбец-Идентификатор* **=** {*выражение* &#124; **null**}]  
  
     **Где текущее** *имя курсора*  
  
     **Удалить из** *таблицы имя* **, где находится текущая часть** *имени курсора*  
  
     Самый простой способ создать предложение **Set** в позиционированной инструкции UPDATE — использовать маркеры параметров для каждого обновляемого столбца и привязать их к буферам набора строк для обновления обновляемой строки с помощью **SQLBindParameter** . В этом случае тип данных C параметра будет таким же, как и тип данных C в буфере набора строк.  
  
3.  Обновляет буферы набора строк для текущей строки, если выполняется инструкция позиционированного обновления. После успешного выполнения инструкции позиционированного обновления библиотека курсоров копирует значения из каждого столбца текущей строки в свой кэш.  
  
    > [!CAUTION]  
    >  Если приложение неправильно обновляет буферы набора строк перед выполнением инструкции позиционированного обновления, данные в кэше будут неправильными после выполнения инструкции.  
  
4.  Выполняет инструкцию позиционированного обновления или удаления, используя инструкцию, отличную от инструкции, связанной с курсором.  
  
    > [!CAUTION]  
    >  Предложение **WHERE** , созданное библиотекой курсоров для обнаружения текущей строки, может не распознать какие-либо строки, указывать другую строку или указывать более одной строки. Дополнительные сведения см. в разделе [Построение поисковых инструкций](../../../odbc/reference/appendixes/constructing-searched-statements.md).  
  
 Для всех инструкций позиционированного обновления и удаления требуется имя курсора. Чтобы указать имя курсора, приложение вызывает **SQLSetCursorName** перед открытием курсора. Чтобы использовать имя курсора, созданное драйвером, приложение вызывает **SQLGetCursorName** после открытия курсора.  
  
 После того как библиотека курсоров выполняет инструкцию позиционированного обновления или удаления, массив состояния, буферы наборов строк и кэш, обслуживаемые библиотекой курсоров, содержат значения, приведенные в следующей таблице.  
  
|Использованная Инструкция|Значение в массиве состояний строк|Значения в<br /><br /> буферы наборов строк|Значения в<br /><br /> буферы кэша|  
|--------------------|-------------------------------|----------------------------------|---------------------------------|  
|Позиционированное обновление|SQL_ROW_UPDATED|Новые значения [1]|Новые значения [1]|  
|Удаление с позиционированием|SQL_ROW_DELETED|Прежние значения|Прежние значения|  
  
 [1] приложение должно обновить значения в буферах набора строк перед выполнением инструкции позиционированного обновления. После выполнения инструкции позиционированного обновления библиотека курсоров копирует значения из буферов набора строк в свой кэш.
