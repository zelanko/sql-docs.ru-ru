---
title: Выполнение позиционированного обновления и инструкций Delete | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- positioned deletes [ODBC]
- cursor library [ODBC], positioned update or delete
- positioned updates [ODBC]
- ODBC cursor library [ODBC], positioned update or delete
ms.assetid: 1d64f309-2a6e-4ad1-a6b5-e81145549c56
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 2391c01d93c876562ab9d870ab0dba22bf74cea5
ms.sourcegitcommit: 61381ef939415fe019285def9450d7583df1fed0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47772052"
---
# <a name="executing-positioned-update-and-delete-statements"></a>Выполнение инструкций позиционированного обновления и удаления
> [!IMPORTANT]  
>  Этот компонент будет удален в будущих версиях Windows. Избегайте использования этой функции в новых разработках и запланируйте изменение приложений, которые сейчас ее используют. Корпорация Майкрософт рекомендует использовать функциональные возможности драйвера курсора.  
  
 После приложение получило блок данных с помощью **SQLFetchScroll**, его можно обновить или удалить данные в блоке. Для выполнения позиционированного обновления или удаления, приложение:  
  
1.  Вызовы **SQLSetPos** для позиционирования курсора в строке, чтобы обновить или удалить.  
  
2.  Конструкции, позиционированного обновления или инструкции delete со следующим синтаксисом:  
  
     **ОБНОВЛЕНИЕ** *имя таблицы*  
  
     **ЗАДАЙТЕ** *идентификатор столбца* **=** {*выражение* &#124; **NULL**}  
  
     [**,** *идентификатор столбца* **=** {*выражение* &#124; **NULL**}]  
  
     **WHERE CURRENT OF** *имя курсора*  
  
     **УДАЛИТЬ из** *имя таблицы* **WHERE CURRENT OF** *имя курсора*  
  
     Самый простой способ создания **ЗАДАТЬ** предложение в инструкции позиционированного обновления заключается в использовании маркеров параметров для каждого столбца и используйте **SQLBindParameter** привязать эти буферы строк для обновления строки. В этом случае тип данных C параметра будет совпадать тип данных C набора строк буфера.  
  
3.  Обновляет буферы строк для текущей строки, если он будет выполняться инструкции позиционированного обновления. После успешного выполнения инструкции позиционированного обновления, библиотека курсоров копирует значения из каждого столбца в текущей строке в свой кэш.  
  
    > [!CAUTION]  
    >  Если приложение не обновляется должным образом буферы строк перед выполнением инструкции позиционированного обновления, будет неверные данные в кэше после выполнения инструкции.  
  
4.  Выполняет позиционированного обновления или с помощью другой инструкции, а не инструкции, связанный с курсором инструкцию delete.  
  
    > [!CAUTION]  
    >  **ГДЕ** предложение, созданный библиотекой курсоров для идентификации текущей строки сможет определить все строки, определить другую строку или определить более одной строки. Дополнительные сведения см. в разделе [создав поиск инструкций](../../../odbc/reference/appendixes/constructing-searched-statements.md).  
  
 Все расположены обновления и удаления инструкций требуется имя курсора. Чтобы указать имя курсора, приложение вызывает **SQLSetCursorName** перед открытием курсора. Чтобы использовать созданное драйвером имя курсора, приложение вызывает **SQLGetCursorName** после открытия курсора.  
  
 После курсора библиотека выполняет позиционированного обновления или инструкции delete, массив состояния, буферы строк и кэш, поддерживаемый библиотекой курсоров содержат значения, показанные в следующей таблице.  
  
|Инструкция, используемая|Значение в массив статусов строк|Значения в<br /><br /> буферы строк|Значения в<br /><br /> буферы кэша|  
|--------------------|-------------------------------|----------------------------------|---------------------------------|  
|Позиционированное обновление|SQL_ROW_UPDATED|Новые значения [1]|Новые значения [1]|  
|Позиционированные delete|ЗНАЧЕНИЕ SQL_ROW_DELETED|Старые значения|Старые значения|  
  
 [1] приложения необходимо обновить значения в буферы строк перед выполнением инструкции позиционированного обновления; После выполнения инструкции позиционированного обновления, библиотека курсоров копирует значения в буферы строк в свой кэш.
