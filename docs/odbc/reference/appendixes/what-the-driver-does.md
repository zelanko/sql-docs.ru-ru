---
title: Что делает драйвер | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- scrollable cursors [ODBC]
- cursors [ODBC], backward compatibility
- compatibility [ODBC], cursors
- backward compatibility [ODBC], cursors
- block cursors [ODBC]
ms.assetid: 75dcdea6-ff6b-4ac8-aa11-a1f9edbeb8e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: c0438478f5aa625ffdd4d3bcd1c0a6f0f80d3367
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81301395"
---
# <a name="what-the-driver-does"></a>Функции драйвера
В следующей таблице перечислены функции и атрибуты инструкций, которые должен реализовать драйвер ODBC *3. x* для блочных и прокручиваемых курсоров.  
  
|Функция или<br /><br /> атрибут инструкции|Комментарии|  
|-----------------------------------------|--------------|  
|SQL_ATTR_ROW_STATUS_PTR|Задает адрес массива состояния строки, заполненный **SQLFetch** и **SQLFetchScroll**. Этот массив также заполняется функцией **SQLSetPos** , если функция **SQLSetPos** вызывается в состоянии инструкции S6. Если метод **SQLSetPos** вызывается в состоянии S7, этот массив не заполняется, но массив, на который указывает аргумент *ровстатусаррай* из **SQLExtendedFetch** , заполняется. Дополнительные сведения см. в разделе [переходы инструкций](../../../odbc/reference/appendixes/statement-transitions.md) в приложении б: таблицы переходов состояния ODBC.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Задает адрес буфера, в котором **SQLFetch** и **SQLFetchScroll** возвращают количество выбранных строк. Если вызывается **SQLExtendedFetch** , этот буфер не заполняется, но аргумент *RowCountPtr* указывает на количество выбранных строк.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Задает размер набора строк, используемого **SQLFetch** и **SQLFetchScroll**.|  
|SQL_ROWSET_SIZE|Задает размер набора строк, используемого **SQLExtendedFetch**. Драйверы ODBC *3. x* реализуют этот метод, если требуется работать с приложениями ODBC *2. x* , которые вызывают **SQLExtendedFetch** или **SQLSetPos**.|  
|**SQLBulkOperations**|Если драйвер ODBC *3. x* должен работать с приложениями ODBC *2. x* , использующими **SQLSetPos** с *операцией* SQL_ADD, драйвер должен поддерживать функцию **SQLSetPos** с *операцией* SQL_ADD в дополнение к **SQLBulkOperations** с *операцией* SQL_ADD.|  
|**SQLExtendedFetch**|Возвращает указанный набор строк. Драйверы ODBC *3. x* реализуют этот метод, если требуется работать с приложениями ODBC *2. x* , которые вызывают **SQLExtendedFetch** или **SQLSetPos**. Ниже приведены сведения о реализации.<br /><br /> — Драйвер получает размер набора строк из значения атрибута оператора SQL_ROWSET_SIZE.<br />— Драйвер получает адрес массива состояния строки из аргумента *ровстатусаррай* , а не атрибута SQL_ATTR_ROW_STATUS_PTR оператора. Аргумент *ровстатусаррай* в вызове **SQLExtendedFetch** не должен быть пустым указателем. (Обратите внимание, что в ODBC *3. x*атрибут инструкции SQL_ATTR_ROW_STATUS_PTR может быть пустым указателем.)<br />— Драйвер получает адрес буфера, извлеченного из аргумента *RowCountPtr* , а не атрибута оператора SQL_ATTR_ROWS_FETCHED_PTR.<br />— Драйвер возвращает значение SQLSTATE 01S01 (ошибка в строке), чтобы указать, что произошла ошибка, когда строки были получены вызовом **SQLExtendedFetch**. Драйвер ODBC *3. x* должен возвращать SQLSTATE 01S01 (ошибка в строке) только при вызове **SQLExtendedFetch** , а не при вызове **SQLFetch** или **SQLFetchScroll** . Чтобы сохранить обратную совместимость, когда **SQLExtendedFetch**ВОЗВРАЩАЕТ значение SQLSTATE 01S01 (ошибка в строке), диспетчер драйверов не упорядочивает записи состояния в очереди ошибок в соответствии с правилами, указанными в разделе "последовательность записей состояния" в [SQLGetDiagField](../../../odbc/reference/syntax/sqlgetdiagfield-function.md).|  
|**SQLFetch**|Возвращает следующий набор строк. Ниже приведены сведения о реализации.<br /><br /> — Драйвер получает размер набора строк из значения атрибута оператора SQL_ATTR_ROW_ARRAY_SIZE.<br />— Драйвер получает адрес массива состояния строки из атрибута SQL_ATTR_ROW_STATUS_PTR оператора.<br />— Драйвер получает адрес буфера, полученного из списка строк, из атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции.<br />— Приложение может смешивать вызовы между **SQLFetchScroll** и **SQLFetch**.<br />-   **SQLFetch** возвращает закладки, если столбец 0 привязан.<br />-   **SQLFetch** можно вызвать, чтобы вернуть более одной строки.<br />— Драйвер не возвращает SQLSTATE 01S01 (ошибка в строке), чтобы указать, что произошла ошибка, когда строки были получены вызовом **SQLFetch**.|  
|**SQLFetchScroll**|Возвращает указанный набор строк. Ниже приведены сведения о реализации.<br /><br /> — Драйвер получает размер набора строк из атрибута SQL_ATTR_ROW_ARRAY_SIZE оператора.<br />— Драйвер получает адрес массива состояния строки из атрибута SQL_ATTR_ROW_STATUS_PTR оператора.<br />— Драйвер получает адрес буфера, полученного из списка строк, из атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции.<br />— Приложение может смешивать вызовы между **SQLFetchScroll** и **SQLFetch**.<br />— Драйвер не возвращает SQLSTATE 01S01 (ошибка в строке), чтобы указать, что произошла ошибка, когда строки были получены вызовом **SQLFetchScroll**.|  
|**функция SQLSetPos;**|Выполняет различные позиционированные операции. Ниже приведены сведения о реализации.<br /><br /> — Это можно вызвать в инструкциях состояния S6 или S7. Дополнительные сведения см. в разделе [переходы инструкций](../../../odbc/reference/appendixes/statement-transitions.md) в приложении б: таблицы переходов состояния ODBC.<br />— Если этот метод вызывается в инструкции State S5 или S6, драйвер получает размер набора строк из атрибута SQL_ATTR_ROWS_FETCHED_PTRной инструкции и адреса массива состояния строки из атрибута инструкции SQL_ATTR_ROW_STATUS_PTR.<br />— Если этот метод вызывается в состоянии инструкции S7, драйвер Извлекает размер набора строк из атрибута SQL_ROWSET_SIZE инструкции и адреса массива состояния строки из аргумента *Ровстатусаррай* **SQLExtendedFetch**.<br />— Драйвер возвращает значение SQLSTATE 01S01 (ошибка в строке) только для того, чтобы указать, что при вызове функции **SQLSetPos** в ходе выполнения операции, когда функция вызывается в состоянии S7, произошла ошибка. Чтобы сохранить обратную совместимость, если функция **SQLSetPos**ВОЗВРАЩАЕТ значение SQLSTATE 01S01 (ошибка в строке), диспетчер драйверов не упорядочивает записи состояния в очереди ошибок согласно правилам, указанным в разделе "последовательность записей о состоянии" в [SQLGetDiagField](../../../odbc/reference/syntax/sqlgetdiagfield-function.md).<br />— Если драйвер должен работать с приложениями ODBC *2. x* , которые вызывают функцию **SQLSetPos** с аргументом *операции* SQL_ADD, драйвер должен поддерживать функцию **SQLSetPos** с аргументом *операции* SQL_ADD.|
