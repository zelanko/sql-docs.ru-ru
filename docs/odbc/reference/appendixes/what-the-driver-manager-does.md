---
title: Что делает диспетчер драйверов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 1c5fa421e4b0def070cc8c63dda394ebb832a9d7
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68135710"
---
# <a name="what-the-driver-manager-does"></a>Функции диспетчера драйверов
В следующей таблице показано, как диспетчер драйверов ODBC *3. x* сопоставляет вызовы с драйверами ODBC *2. x* и ODBC *3. x* .  
  
|Функция или<br /><br /> атрибут инструкции|Комментарии|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Указывает на закладку для использования с **SQLFetchScroll**. Ниже приведены сведения о реализации.<br /><br /> — Когда приложение устанавливает это в драйвере ODBC *2. x* , диспетчер драйверов ODBC *3. x* кэширует его. Он отменяет ссылку на указатель и передает значение в драйвер ODBC *2. x* в аргументе *фетчоффсет* параметра **SQLExtendedFetch** , когда **SQLFetchScroll** вызывается приложением в дальнейшем.<br />— Когда приложение устанавливает это в драйвере ODBC *3. x* , диспетчер драйверов ODBC *3. x* передает вызов драйвера.|  
|SQL_ATTR_ROW_STATUS_PTR|Указывает на массив состояний строк, заполненный **SQLFetch**, **SQLFetchScroll**, **SQLBulkOperations**и **SQLSetPos**. Ниже приведены сведения о реализации.<br /><br /> — Когда приложение устанавливает это в драйвере ODBC *2. x* , диспетчер драйверов ODBC *3. x* кэширует свое значение. Он передает это значение в драйвер ODBC *2. x* в аргументе *ровстатусаррай* параметра **SQLExtendedFetch** при вызове **SQLFetchScroll** или **SQLFetch** .<br />— Когда приложение устанавливает это в драйвере ODBC *3. x* , диспетчер драйверов ODBC *3. x* передает вызов драйвера.<br />— В состоянии S6, если приложение устанавливает SQL_ATTR_ROW_STATUS_PTR и затем вызывает **SQLBulkOperations** (с *операцией* SQL_ADD) или **SQLSetPos** без предварительного вызова **SQLFETCH** или **SQLFetchScroll**, возвращается значение SQLSTATE HY011 (атрибут не может быть задан).|  
|SQL_ATTR_ROWS_FETCHED_PTR|Указывает на буфер, в котором **SQLFetch** и **SQLFetchScroll** возвращают количество выбранных строк. Ниже приведены сведения о реализации.<br /><br /> — Когда приложение устанавливает это в драйвере ODBC *2. x* , диспетчер драйверов ODBC *3. x* кэширует свое значение. Он передает это значение в драйвер ODBC *2. x* в аргументе *RowCountPtr* параметра **SQLExtendedFetch** , когда приложение вызывает **SQLFetch** или **SQLFetchScroll** .<br />— Когда приложение устанавливает это в драйвере ODBC *3. x* , диспетчер драйверов ODBC *3. x* передает вызов драйвера.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Задает размер набора строк. Ниже приведены сведения о реализации.<br /><br /> — Когда приложение устанавливает это в драйвере ODBC *2. x* , диспетчер драйверов ODBC *3. x* сопоставляет его с атрибутом инструкции SQL_ROWSET_SIZE.<br />— Когда приложение устанавливает это в драйвере ODBC *3. x* , диспетчер драйверов ODBC *3. x* передает вызов драйвера.<br />— Когда приложение, работающее с драйвером ODBC *3. x* , вызывает **SQLSetScrollOptions**, SQL_ROWSET_SIZE задает значение в аргументе *ровсетсизе* , если базовый драйвер не поддерживает **SQLSetScrollOptions**.|  
|SQL_ROWSET_SIZE|Задает размер набора строк, используемый **SQLExtendedFetch** , когда **SQLExtendedFetch** вызывается приложением ODBC *2. x* . Ниже приведены сведения о реализации.<br /><br /> — Когда приложение устанавливает этот параметр, диспетчер драйверов ODBC *3. x* передает вызов драйвера независимо от версии драйвера.<br />— Когда приложение, работающее с драйвером ODBC *2. x* , вызывает **SQLSetScrollOptions**, SQL_ROWSET_SIZE задается значение аргумента **ровсетсизе** .|  
|**SQLBulkOperations**|Выполняет операцию вставки, обновляет, удаляет или извлекает с помощью операций с закладками. Ниже приведены сведения о реализации.<br /><br /> — Когда приложение вызывает **SQLBulkOperations** с *операцией* SQL_ADD в драйвере ODBC *2. x* , диспетчер драйверов ODBC *3. x* сопоставляет его с *операцией* SQL_ADD **** .<br />— При работе с драйвером *ODBC 2. x* , который не поддерживает **SQLSetPos** с *операцией* SQL_ADD, диспетчер драйверов ODBC *3. x* не сопоставляет **SQLSetPos** с *операцией* SQL_ADD **SQLBulkOperations** с *операцией* SQL_ADD. Это связано с тем, что **SQLBulkOperations** нельзя вызывать в состоянии S7, который в ODBC *2. x* был единственным состоянием, в котором может быть вызван режим **SQLSetPos** .<br />— Если приложение вызывает **SQLBulkOperations** с *операцией* SQL_ADD в драйвере ODBC *2. x* перед вызовом **SQLFetchScroll**, диспетчер драйверов ODBC *3. x* возвращает ошибку.|  
|**SQLExtendedFetch**|Возвращает указанный набор строк. За исключением упомянутого выше ограничения, диспетчер драйверов ODBC *3. x* передает вызовы к драйверу **SQLExtendedFetch** независимо от версии драйвера.|  
|**SQLFetch**|Возвращает следующий набор строк. Ниже приведены сведения о реализации.<br /><br /> — Когда приложение вызывает **SQLFetch** в драйвере ODBC *2. x* , диспетчер драйверов ODBC *3. x* сопоставляет его с **SQLExtendedFetch**. Аргумент *Фетчориентатион* **SQLExtendedFetch** имеет значение SQL_FETCH_NEXT. Диспетчер драйверов использует кэшированное значение атрибута SQL_ATTR_ROW_STATUS_PTR инструкции для аргумента *ровстатусаррай* и кэшированное значение атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции для аргумента *RowCountPtr* .<br />— Приложение ODBC *3. x* может смешивать вызовы **SQLFetch** и **SQLFetchScroll** в драйвере ODBC *2. x* , так как диспетчер драйверов ODBC *3. x* сопоставляет **SQLFETCH** с **SQLExtendedFetch** , когда приложение вызывает его в драйвере ODBC *2. x* .<br />— Если драйвер ODBC *2. x* не поддерживает **SQLExtendedFetch**, диспетчер драйверов ODBC *3. x* не сопоставляет **SQLFetch** или **SQLFetchScroll** с **SQLExtendedFetch** , когда приложение вызывает его в этом драйвере. Если приложение пытается установить SQL_ATTR_ROW_ARRAY_SIZE значение больше 1, возвращается HYC00 SQLSTATE (Необязательная функция не реализована).<br />— За исключением указанных ограничений, диспетчер драйверов ODBC *3. x* передает вызовы к драйверу **SQLFetch** независимо от версии драйвера.|  
|**SQLFetchScroll**|Возвращает указанный набор строк. Ниже приведены сведения о реализации.<br /><br /> — Когда приложение вызывает **SQLFetchScroll** в драйвере ODBC *2. x* , диспетчер драйверов ODBC *3. x* сопоставляет его с **SQLExtendedFetch**. Он использует кэшированное значение атрибута SQL_ATTR_ROW_STATUS_PTR инструкции для аргумента *ровстатусаррай* и кэшированное значение атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции для аргумента *RowCountPtr* . Если аргумент *фетчориентатион* в **SQLFetchScroll** имеет SQL_FETCH_BOOKMARK, то он использует кэшированное значение атрибута SQL_ATTR_FETCH_BOOKMARK_PTR инструкции для аргумента *фетчоффсет* и возвращает ошибку, если аргумент *фетчоффсет* **SQLFetchScroll** не равен 0.<br />— Когда приложение вызывает это в драйвере ODBC *3. x* , диспетчер драйверов ODBC *3. x* передает вызов драйвера.|  
|**функция SQLSetPos;**|Выполняет различные позиционированные операции. Диспетчер драйверов ODBC *3. x* передает вызовы функции **SQLSetPos** в драйвер независимо от версии драйвера.|  
|**SQLSetScrollOptions**|Когда диспетчер драйверов сопоставляет **SQLSetScrollOptions** для приложения, работающего с драйвером ODBC *3. x* , который не поддерживает **SQLSetScrollOptions**, диспетчер драйверов устанавливает параметр инструкции SQL_ROWSET_SIZE, а не атрибут SQL_ATTR_ROW_ARRAY_SIZE инструкции, в аргумент *ровсетсизе* в **склсетскроллоптион**. В результате **SQLSetScrollOptions** не может использоваться приложением при выборке нескольких строк путем вызова **SQLFetch** или **SQLFetchScroll**. Его можно использовать только при выборке нескольких строк путем вызова **SQLExtendedFetch**.|
