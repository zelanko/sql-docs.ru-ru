---
title: Подключение с использованием файловых источников данных | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to driver [ODBC], file data sources
- SQLDriverConnect function [ODBC], connecting using file data sources
- connecting to data source [ODBC], SQLDriverConnect
- connecting to driver [ODBC], SQLDriverConnect
- connecting to data source [ODBC], file data sources
- file data sources [ODBC]
ms.assetid: 3003f8c2-8be6-41cc-8d9c-612e9bd0f3ae
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 8c752fc3b09c06c68dcc216cacac63744dc3101b
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81287414"
---
# <a name="connecting-using-file-data-sources"></a>Подключение с использованием файловых источников данных
Сведения о соединении для файлового источника данных хранятся в DSN-файле. В результате строка подключения может многократно использоваться одним пользователем или совместно несколькими пользователями, если у них установлен соответствующий драйвер. Файл содержит имя драйвера (или другое имя источника данных в случае недоступного файлового источника данных) и (необязательно) строку подключения, которая может использоваться **SQLDriverConnect**. Диспетчер драйверов создает строку подключения для вызова **SQLDriverConnect** из ключевых слов в DSN – файле.  
  
 Файловый источник данных позволяет приложению указывать параметры соединения без необходимости создания строки подключения для использования с **SQLDriverConnect**. Файловый источник данных обычно создается путем указания ключевого слова **SaveFile** , в результате чего диспетчер драйверов сохраняет выходную строку подключения, созданную путем вызова **SQLDriverConnect** , в DSN-файл. Эту строку подключения можно многократно использовать путем вызова **SQLDriverConnect** с ключевым словом **FILEDSN** . Это упрощает процесс подключения и предоставляет постоянный источник строки подключения.  
  
 Файловые источники данных также можно создать путем вызова **склкреатедатасаурце** в библиотеке DLL установщика. Сведения можно записать в DSN, вызвав **склвритефиледсн**и прочесть из DSN – файла путем вызова **склреадфиледсн**; Обе эти функции также находятся в библиотеке DLL установщика. Дополнительные сведения о библиотеке DLL установщика см. в разделе [Настройка источников данных](../../../odbc/reference/install/configuring-data-sources.md).  
  
 Ключевые слова, используемые для сведений о соединении, находятся в разделе [ODBC] файла. DSN. Минимальная информация, которую файл DSN может иметь в разделе [ODBC], является ключевым словом DRIVER:  
  
```  
DRIVER = SQL Server  
```  
  
 Файл с общим доступом (DSN) обычно содержит строку подключения следующим образом:  
  
```  
DRIVER = SQL Server  
UID = Larry  
DATABASE = MyDB  
```  
  
 Если файловый источник данных недоступен, файл DSN содержит только ключевое слово **DSN** . Когда диспетчер драйверов отправляет сведения в источнике данных, который не является общим, он подключается по мере необходимости к источнику данных, указанному ключевым словом **DSN** . Файл DSN с необщим доступом должен содержать следующее ключевое слово:  
  
```  
DSN = MyDataSource  
```  
  
 Строка подключения, используемая для файлового источника данных, представляет собой объединение ключевых слов, указанных в DSN-файле, и ключевых слов, указанных в строке подключения в вызове **SQLDriverConnect**. Если какое бы то ни было ключевое слово в DSN конфликтует с ключевыми словами в строке подключения, диспетчер драйверов определяет, какое значение должно использоваться. Дополнительные сведения см. в разделе [SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md).  
  
## <a name="see-also"></a>См. также:  
 [https://support.microsoft.com/kb/165866](https://support.microsoft.com/kb/165866)
