---
title: Привязка столбцов результирующего набора | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- result sets [ODBC], binding columns
- binding columns [ODBC]
ms.assetid: 4bc9c30f-83ae-4766-a746-032953c187ad
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: b92f317d72410a5dff56652dd9de1e3b2ba5c9cb
ms.sourcegitcommit: 61381ef939415fe019285def9450d7583df1fed0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47725912"
---
# <a name="binding-result-set-columns"></a>Привязка столбцов результирующего набора
Приложения можно привязать как количество столбцов результирующего набора, по своему выбору, включая привязки вообще нет столбцов. При выборке строки данных, драйвер возвращает данные для столбцов с привязкой к приложению. Является ли приложение выполняет привязку всех столбцов в результирующем наборе зависит от приложения. Например приложений, создающих отчеты обычно у фиксированного формата; такие приложения создает результирующий набор, содержащий все столбцы, используемые в отчете и затем привязать и получения данных для всех этих столбцов. Приложения, отображающие экраны данными, иногда пользователи могут решить, какие столбцы для отображения; такие приложения создать результирующий набор, содержащий все столбцы, пользователь может требуется, но привязать и извлекать данные только для тех столбцов, указанные пользователем.  
  
 Данные могут быть получены из непривязанные столбцы, вызвав **SQLGetData**. Это часто вызывается для получения длинных данных, которые часто превышает длину в один буфер и должна быть получена из частей.  
  
 Столбцы могут быть привязаны в любое время, даже после выбранных строк. Тем не менее новые привязки не вступают в силу до выполнения следующей выборке строки; они не применяются к данным из строк, которые уже были получены ранее.  
  
 Переменной остается привязанным к столбцу, пока другой переменной, привязанное к столбцу, пока не является привязка столбца путем вызова **SQLBindCol** с указателем null, как адрес переменной, пока все столбцы являются несвязанных путем вызова **SQLFreeStmt** с параметром SQL_UNBIND, или до снятия инструкцию. По этой причине приложения необходимо убедиться в том, что все связанные переменные остаются действительными до тех пор, пока они привязаны. Дополнительные сведения см. в разделе [распределение и освобождение буферов](../../../odbc/reference/develop-app/allocating-and-freeing-buffers.md).  
  
 Поскольку привязок к столбцам только информации, связанные с этой структурой инструкции, их можно задать в любом порядке. Они также не зависят от результирующего набора. Например предположим, что приложение выполняет привязку столбцов результирующего набора, формируемого следующую инструкцию SQL:  
  
```  
SELECT * FROM Orders  
```  
  
 Если приложение выполняет инструкцию SQL  
  
```  
SELECT * FROM Lines  
```  
  
 на том же дескрипторе инструкции привязок к столбцу для первого результирующего набора, остается в силе, так как привязки, хранящиеся в структуре инструкции. В большинстве случаев это является плохим стилем программирования и следует избегать. Вместо этого приложение должно вызвать **SQLFreeStmt** с параметром SQL_UNBIND, чтобы отменить привязку всех старых столбцах, а затем привязать новые.
