---
title: Несколько результатов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLMoreResults function [ODBC], multiple results
- row counts [ODBC]
- multiple results [ODBC]
- result sets [ODBC], multiple results
- SQLGetInfo function [ODBC], multiple results
ms.assetid: a3c32e4b-8fe7-4a33-ae39-ae664001f315
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 47e1250a92b78aefdc1611fd88e0ee9b0f772ad0
ms.sourcegitcommit: 2429fbcdb751211313bd655a4825ffb33354bda3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2018
ms.locfileid: "52539902"
---
# <a name="multiple-results"></a>Множественные результаты
Объект *результат* что-то возвращается в источнике данных после выполнения инструкции. ODBC имеет два типа результатов: результирующие наборы и количества строк. *Счетчики строк* , количество строк, затронутых при операции обновления, удаления или вставки инструкции. Разделы, описанные в [пакеты инструкций SQL](../../../odbc/reference/develop-app/batches-of-sql-statements.md), можно создать несколько результатов.  
  
 В следующей таблице перечислены **SQLGetInfo** параметры, приложение использует, чтобы определить, возвращает ли источник данных несколько результатов для каждого типа пакета. В частности источник данных может возвращать количество строк, один для обработки всего пакета инструкций или количество отдельных строк для каждой инструкции в пакете. В случае результат формирования набора инструкцию с массив параметров источник данных может возвращать единый результирующий набор для всех наборов параметров или отдельных результирующих наборов для каждого набора параметров.  
  
|Тип пакета|Количество строк|Результирующие наборы|  
|----------------|----------------|-----------------|  
|Явные пакетной службы|SQL_BATCH_ROW_COUNT [a]|--[b].|  
|Процедура|SQL_BATCH_ROW_COUNT [a]|--[b].|  
|Массивы параметров|SQL_PARAM_ARRAYS_ROW_COUNTS|SQL_PARAM_ARRAYS_SELECTS|  
  
 [] строки генерирующими число инструкций в пакете могут поддерживаться, но возвращаемое количество строк не поддерживается. Параметр SQL_BATCH_SUPPORT в **SQLGetInfo** указывает, следует ли инструкции создания число строк допускаются в пакетах; параметр SQL_BATCH_ROW_COUNTS указывает, возвращаются ли эти числа строк в приложение.  
  
 [b] явные пакеты и процедуры всегда возвращают несколько результирующих наборов, если они содержат несколько результат формирования набора инструкций.  
  
> [!NOTE]  
>  Вариант SQL_MULT_RESULT_SETS, представленный в ODBC 1.0 содержит только общие сведения о ли могут возвращаться несколько результирующих наборов. В частности он имеет значение «Y» Если биты SQL_BS_SELECT_EXPLICIT или SQL_BS_SELECT_PROC возвращаются для SQL_BATCH_SUPPORT или SQL_PAS_BATCH возвращается для SQL_PARAM_ARRAYS_SELECT.  
  
 Для обработки нескольких результатов, приложение вызывает **SQLMoreResults**. Эта функция отменяет текущий результат и делает следующий результат доступным. Он вернет значение SQL_NO_DATA, если больше нет результатов недоступны. Например предположим, что следующие инструкции выполняются в пакетном режиме:  
  
```  
SELECT * FROM Parts WHERE Price > 100.00;  
UPDATE Parts SET Price = 0.9 * Price WHERE Price > 100.00  
```  
  
 После выполнения этих инструкций приложение производит выборку строк из результирующего набора, созданные **ВЫБЕРИТЕ** инструкции. По завершении выборка строк, он вызывает **SQLMoreResults** для предоставления число частей, которые были repriced. При необходимости **SQLMoreResults** отбрасывает строки строками и закрывает курсор. Затем приложение вызывает **SQLRowCount** для определения, сколько частей были repriced по **обновления** инструкции.  
  
 Это специфические для драйвера ли выполняется инструкция весь пакет, прежде чем результаты будут доступны. В некоторых реализациях это так. в других случаях, вызов **SQLMoreResults** вызывает выполнение следующей инструкции в пакете.  
  
 При сбое одной из инструкций в пакете, **SQLMoreResults** вернет значение SQL_ERROR или SQL_SUCCESS_WITH_INFO. Если пакет был прерван, когда инструкции завершилось с ошибкой или сбоя оператор был последней инструкцией в пакете, **SQLMoreResults** вернет значение SQL_ERROR. Если пакет не был прерван, когда выполнение инструкции завершилось ошибкой и сбоя оператор не последней инструкцией в пакете, **SQLMoreResults** возвращает SQL_SUCCESS_WITH_INFO. SQL_SUCCESS_WITH_INFO указывает, что создано по крайней мере один результирующий набор или count и что пакет не был отменен.
