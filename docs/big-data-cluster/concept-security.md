---
title: Основные понятия безопасности
titleSuffix: SQL Server big data clusters
description: В этой статье рассматриваются основные понятия безопасности для работы с кластерами больших данных SQL Server. В этом содержимом описываются конечные точки кластера и процесс проверки подлинности кластера.
author: nelgson
ms.author: negust
ms.reviewer: mikeray
ms.date: 06/22/2020
ms.topic: conceptual
ms.prod: sql
ms.technology: big-data-cluster
ms.openlocfilehash: f0d19589c057df0af9ffea711edd8963bc381e2d
ms.sourcegitcommit: da88320c474c1c9124574f90d549c50ee3387b4c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2020
ms.locfileid: "85730676"
---
# <a name="security-concepts-for-big-data-clusters-2019"></a>Основные понятия безопасности для работы с [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ss-nover.md)]

[!INCLUDE[SQL Server 2019](../includes/applies-to-version/sqlserver2019.md)]

В этой статье рассматриваются основные понятия, связанные с обеспечением безопасности в кластере больших данных.

[!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ss-nover.md)] обеспечивают согласованную и последовательную процедуру авторизации и проверки подлинности. Кластер больших данных можно интегрировать с Active Directory (AD) путем полностью автоматизированного развертывания, которое настраивает интеграцию доменных служб AD с существующим доменом. После настройки в кластере больших данных интеграции с AD можно использовать существующие удостоверения и группы пользователей для единого доступа во всех конечных точках. Кроме того, после создания внешних таблиц в SQL Server можно управлять доступом к источникам данных путем предоставления доступа к внешним таблицам пользователям и группам AD, что позволяет централизовать политики доступа к данным в одном расположении.

В этом 14-минутном видео содержится обзор безопасности кластера больших данных:

> [!VIDEO https://channel9.msdn.com/Shows/Data-Exposed/Overview-Big-Data-Cluster-Security/player?WT.mc_id=dataexposed-c9-niner]


## <a name="authentication"></a>Аутентификация

Конечные точки внешнего кластера поддерживают проверку подлинности AD. Используйте удостоверение AD для проверки подлинности в кластере больших данных.

### <a name="cluster-endpoints"></a>Конечные точки кластера

В кластере больших данных имеется пять точек входа.

* Главный экземпляр — конечная точка TDS для доступа к главному экземпляру SQL Server в кластере, используемая приложениями и инструментами баз данных, такими как SSMS или Azure Data Studio. При использовании команд SQL Server или HDFS из azdata средство будет подключаться к другим конечным точкам в зависимости от операции.

* Шлюз для доступа к файлам HDFS, Spark (Knox) — конечная точка HTTPS для доступа к таким службам, как webHDFS и Spark.

* Конечная точка службы управления кластером (контроллера) — служба управления кластером больших данных, которая предоставляет REST API для управления кластером. Инструменту azdata требуется подключение к этой конечной точке.

* Прокси-сервер управления — для доступа к панели мониторинга поиска по журналам и панели мониторинга метрик.

* Прокси-сервер приложений — конечная точка для управления приложениями, развернутыми в кластере больших данных.

![Конечные точки кластера](media/concept-security/cluster_endpoints.png)

В настоящее время невозможно открыть дополнительные порты для доступа к кластеру извне.

## <a name="authorization"></a>Авторизация

Интегрированная система безопасности между различными компонентами во всем кластере позволяет передавать удостоверение исходного пользователя при выдаче запросов из Spark и SQL Server вплоть до HDFS. Как упоминалось выше, различные конечные точки внешнего кластера поддерживают проверку подлинности Active Directory.

Существует два уровня проверки авторизации в кластере для управления доступом к данным. Авторизация в контексте больших данных выполняется в SQL Server с использованием традиционных разрешений SQL Server для объектов и в HDFS с использованием списков управления доступом (ACL), которые связывают удостоверения пользователей с конкретными разрешениями.

Защищенный кластер больших данных свидетельствует о согласованной поддержке сценариев проверки подлинности и авторизации как в SQL Server, так и в HDFS/Spark. Проверка подлинности — это процесс проверки удостоверения пользователя или службы и гарантия того, кем или чем они являются в действительности. Авторизация используется для предоставления или запрета доступа к определенным ресурсам на основе удостоверения запрашивающего доступ пользователя. Она выполняется после идентификации пользователя с помощью проверки подлинности.

Авторизация в контексте больших данных обычно проводится на основе списков управления доступом (ACL), которые связывают удостоверения пользователей с конкретными разрешениями. HDFS поддерживает авторизацию, ограничивая доступ к API-интерфейсам служб, файлам HDFS и выполнению заданий.

## <a name="encryption-and-other-security-mechanisms"></a>Шифрование и другие механизмы обеспечения безопасности

Шифрование взаимодействия между клиентами и внешними конечными точками, а также между компонентами внутри кластера обеспечивается с помощью TLS/SSL с использованием сертификатов.

Все взаимодействие SQL Server с SQL Server, такое как взаимодействие главного экземпляра SQL с пулом данных, защищается с помощью учетных данных SQL.

> [!IMPORTANT]
>  Кластеры больших данных используют etcd для хранения учетных данных. Рекомендуется настроить кластер Kubernetes для шифрования неактивных данных с помощью etcd. По умолчанию секреты, хранящиеся в etcd, не шифруются. Сведения об этой административной задаче содержатся в документации по Kubernetes: https://kubernetes.io/docs/tasks/administer-cluster/kms-provider/ и https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/.


## <a name="basic-administrator-login"></a>Базовые учетные данные администратора

Кластер можно развернуть либо в режиме AD, либо с использованием только базовых учетных данных администратора. Режим безопасности с использованием только базовых учетных данных администратора не поддерживается в рабочей среде и предназначен для ознакомления с продуктом.

Даже если выбран режим Active Directory, для администратора кластера будут созданы базовые учетные данные. Эта функция обеспечивает альтернативный доступ при невозможности подключения к AD.

При развертывании этим базовым учетным данным будут предоставлены разрешения администратора в кластере. Вошедший пользователь будет системным администратором в главном экземпляре SQL Server и администратором в контроллере кластера.
Компоненты Hadoop не поддерживают смешанный режим проверки подлинности. Это означает, что базовые учетные данные администратора нельзя использовать для проверки подлинности в шлюзе (Knox).

Эти учетные данные для входа необходимо определить при развертывании.

Имя пользователя администратора кластера:

 + `AZDATA_USERNAME=<username>`

Пароль администратора кластера:  
 + `AZDATA_PASSWORD=<password>`

> [!NOTE]
> Обратите внимание, что в режиме, отличном от AD, для проверки подлинности в шлюзе для доступа к HDFS/Spark необходимо указывать имя пользователя в сочетании с приведенным выше паролем. До выпуска накопительного пакета обновления 5 для SQL Server 2019 имя пользователя имело значение `root`.
> 
> [!INCLUDE [big-data-cluster-root-user](../includes/big-data-cluster-root-user.md)]

## <a name="next-steps"></a>Дальнейшие действия

[Что такое [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ver15.md)]?](big-data-cluster-overview.md)

[Семинар. Архитектура [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ss-nover.md)] Майкрософт](https://github.com/Microsoft/sqlworkshops/tree/master/sqlserver2019bigdataclusters)

[Kubernetes RBAC](kubernetes-rbac.md)
