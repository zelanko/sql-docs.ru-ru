---
title: "Выражения используются в отчетах (построитель отчетов и службы SSRS) | Документы Microsoft"
ms.custom: 
ms.date: 03/14/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- reporting-services-sharepoint
- reporting-services-native
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- expressions [Reporting Services], about expressions
ms.assetid: 76b9ed31-5aec-40fc-bb88-a1c1b0ab3fc3
caps.latest.revision: 59
author: maggiesMSFT
ms.author: maggies
manager: erikre
ms.translationtype: HT
ms.sourcegitcommit: f3481fcc2bb74eaf93182e6cc58f5a06666e10f4
ms.openlocfilehash: 546817a006d06b1acbea5962cc1a3230867e111e
ms.contentlocale: ru-ru
ms.lasthandoff: 08/09/2017

---
# <a name="expression-uses-in-reports-report-builder-and-ssrs"></a>Использование выражений в отчетах (построитель отчетов и службы SSRS)
В отчетах [!INCLUDE[ssRSnoversion_md](../../includes/ssrsnoversion-md.md)] с разбиением на страницы выражения используются в определении отчета для указания или вычисления значений параметров, запросов, фильтров, свойств элементов отчета, группирования и сортировки определений, свойств текстовых полей, закладок, схем документов, динамического содержимого верхних и нижних колонтитулов страницы, изображений и динамических определений источников данных. В данном разделе приводится множество примеров использования выражений для внесения разнообразия в содержимое или внешний вид отчета. Этот список не является исчерпывающим. Выражение для любого свойства можно задать в диалоговом окне, отображающий выражение (**fx**) кнопку или в раскрывающемся списке, отображающего  **\<выражение... >**.  
  
 Выражения бывают простыми и сложными. *Простое выражение* содержит ссылку на одно поле набора данных, параметр или встроенное поле. Сложные выражения могут содержать несколько встроенных ссылок, операторов и вызовов функций. Например, сложное выражение может включать функцию Sum, применяемую к полю Sales.  
  
 Выражения создаются на языке [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]. Выражение начинается со знака равенства (=), за которым следует сочетание ссылок на встроенные коллекции, например поля набора данных, параметры, константы, операторы и функции.  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="Simple"></a> Использование простых выражений  
 Простые выражения в области конструктора и в диалоговых окнах заключены в скобки; например, поле набора данных имеет вид `[ProductID]`. Простые выражения создаются системой автоматически, при перетаскивании поля из набора данных в текстовое поле. Создается заполнитель, и выражение определяет содержащееся в нем значение. Выражения можно также вводить непосредственно в текстовое поле или ячейку области данных, в области конструктора или диалоговом окне (например, `[ProductID]`).  
  
 В следующей таблице приведены примеры использования простых выражений. В таблице описана функциональность, задаваемое свойство, диалоговое окно, в котором оно обычно задается, и значение свойства. Простые выражения можно вводить непосредственно в области конструктора, в диалоговом окне или на панели свойств, а также, как любые другие выражения, изменять в диалоговом окне «Выражение».  
  
|Функциональность|Свойство, контекст и диалоговое окно|Значение свойства|  
|-------------------|---------------------------------------|--------------------|  
|Задать поле набора данных для отображения в текстовом поле.|Значение свойства для заполнителя в текстовом поле. Используйте диалоговое окно **Свойства заполнителя — Общие**.|`[Sales]`|  
|Агрегатные значения для группы.|Значение свойства для заполнителя в строке, связанной с группой табликса. Используйте диалоговое окно **Свойства текстового поля**.|`[Sum(Sales)]`|  
|Включить номер страницы.|Значение свойства для заполнителя в текстовом поле, расположенном в верхнем колонтитуле страницы. Используйте диалоговое окно **Свойства текстового поля — Общие**.|`[&PageNumber]`|  
|Отобразить значение выбранного параметра.|Значение свойства для заполнителя в текстовом поле в области конструктора. Используйте диалоговое окно **Свойства текстового поля — Общие**.|`[@SalesThreshold]`|  
|Задать определение группы для области данных.|Выражение группы для группы табликса. Используйте диалоговое окно **Свойства группы табликса — Общие**.|`[Category]`|  
|Исключить из таблицы значение конкретного поля.|Уравнение фильтра для табликса. Используйте диалоговое окно **Свойства табликса — Фильтры**.|В качестве типа данных выберите **Integer**.<br /><br /> `[Quantity]`<br /><br /> `>`<br /><br /> `100`|  
|Включить только конкретное значение для фильтра группирования.|Уравнение фильтра для группы табликса. Используйте диалоговое окно **Свойства группы табликса — Фильтры**.|`[Category]`<br /><br /> `=`<br /><br /> `Clothing`|  
|Исключить из набора данных конкретные значения нескольких полей.|Уравнение фильтра для группы в табликсе. Используйте диалоговое окно **Свойства табликса — Фильтры**.|`=[Color]`<br /><br /> `<>`<br /><br /> `Red`<br /><br /> `=[Color]`<br /><br /> `<>`<br /><br /> `Blue`|  
|Задать порядок сортировки по существующему полю таблицы.|Выражение сортировки для табликса. Используйте диалоговое окно **Свойства табликса — Сортировка**.|`[SizeSortOrder]`|  
|Связать параметр запроса с параметром отчета.|Коллекция параметров набора данных. Используйте диалоговое окно **Свойства набора данных — Параметры**.|`[@Category]`<br /><br /> `[@Category]`|  
|Передать параметр из родительского отчета во вложенный.|Коллекция параметров вложенного отчета. Используйте диалоговое окно **Свойства вложенного отчета — Параметры**.|`[@Category]`<br /><br /> `[@Category]`|  
  
##  <a name="Complex"></a> Использование сложных выражений  
 Сложные выражения содержат несколько ссылок на встроенные объекты, операторов и вызовов функций. Они выводятся в области конструктора в следующем виде: `<<Expr>>`. Чтобы просмотреть или изменить текст выражения, нужно открыть диалоговое окно **Выражение** или ввести выражение непосредственно в панели свойств. В приведенной ниже таблице описаны типичные примеры применения сложных выражений для вывода или организации данных и для изменения внешнего вида отчета. Указаны задаваемое свойство, диалоговое окно, в котором оно обычно задается, и значение свойства. Выражение можно ввести непосредственно в диалоговом окне, в области конструктора или в панели свойств.  
  
|Функциональность|Свойство, контекст и диалоговое окно|Значение свойства|  
|-------------------|---------------------------------------|--------------------|  
|Агрегатные вычисления значений в наборе данных.|Значение свойства для заполнителя в текстовом поле. Используйте диалоговое окно **Свойства заполнителя — Общие**.|`=First(Fields!Sales.Value,"DataSet1")`|  
|Объединить текст и выражения в одном текстовом поле.|Значение для заполнителя в текстовом поле, расположенном в верхнем или нижнем колонтитуле страницы. Используйте диалоговое окно **Свойства заполнителя — Общие**.|`="This report began processing at " & Globals!ExecutionTime`|  
|Агрегатные вычисления значений в наборе данных для другой области действия.|Значение для заполнителя в текстовом поле, помещаемом в группу табликса. Используйте диалоговое окно **Свойства заполнителя — Общие**.|`=Max(Fields!Total.Value,"DataSet2)`|  
|Форматировать данные в текстовом поле в зависимости от их значения.|Цвет для заполнителя в текстовом поле, помещаемом в строку детализации для табликса. Используйте диалоговое окно **Свойства текстового поля — Шрифт**.|`=IIF(Fields!TotalDue.Value < 10000,"Red","Black")`|  
|Вычислить значение один раз для использования в любом месте отчета.|Значение для переменной отчета. Используйте диалоговое окно **Свойства отчета — Переменные**.|`=Variables!MyCalculation.Value`|  
|Включить в набор данных конкретные значения нескольких полей.|Уравнение фильтра для группы в табликсе. Используйте диалоговое окно **Свойства табликса — Фильтры**.|В качестве типа данных выберите **Boolean**.<br /><br /> `=IIF(InStr(Fields!Subcat.Value,"Shorts")=0 AND (Fields!Size.Value="M" OR Fields!Size.Value="S"),TRUE, FALSE)`<br /><br /> `=`<br /><br /> `TRUE`|  
|Спрятать текстовое поле в области конструктора, переключая его видимость с помощью параметра логического типа с именем *Show*.|Hiddenproperty для текстового поля. Используйте диалоговое окно **Свойства текстового поля — Видимость**.|`=Not Parameters!`*Показать\<логического параметра >*`.Value`|  
|Динамически задать содержимое верхнего или нижнего колонтитулов страницы.|Значение для заполнителя в текстовом поле, расположенном в верхнем или нижнем колонтитуле страницы.|`="Page " & Globals!PageNumber & " of "  & Globals!TotalPages`|  
|Динамически задать источник данных с помощью параметра.|Строка подключения источника данных. Используйте диалоговое окно **Свойства источника данных — Общие**.|`="Data Source=" & Parameters!ServerName.Value & ";initial catalog=AdventureWorks2012"`|  
|Задать все значения для многозначного параметра, выбранного пользователем.|Значение для заполнителя в текстовом поле. Используйте диалоговое окно **Свойства табликса — Фильтры**.|`=Join(Parameters!MyMultivalueParameter.Value,", ")`|  
|Указать разрывы страниц через каждые 20 строк в табликсе, не содержащем других групп.|Выражение группы для группы в табликсе. Используйте диалоговое окно **Свойства группы табликса — Разрывы страниц**. Установите параметр **Между всеми экземплярами группы**.|`=Ceiling(RowNumber(Nothing)/20)`|  
|Задать условную видимость в зависимости от значения параметра.|Скрытое свойство для табликса. Используйте диалоговое окно **Свойства табликса — Видимость**.|`=Not Parameters!<` *boolean parameter* `>.Value`|  
|Задать форматирование данных для определенной культуры.|Значение для заполнителя в текстовом поле, расположенном в области данных. Используйте диалоговое окно **Свойства текстового поля — Общие**.|`=Fields!OrderDate.Value.ToString(System.Globalization.CultureInfo.CreateSpecificCulture("de-DE"))`|  
|Объединить строку с числом в формате процента с двумя десятичными разрядами.|Значение для заполнителя в текстовом поле, расположенном в области данных. Используйте диалоговое окно **Свойства текстового поля — Общие**.|`="Growth Percent: " & Format(Fields!Growth.Value,"p2")`|  
  
## <a name="see-also"></a>См. также  
 [Выражения &#40; Построитель отчетов и службы SSRS &#41;](../../reporting-services/report-design/expressions-report-builder-and-ssrs.md)   
 [Примеры выражений &#40; Построитель отчетов и службы SSRS &#41;](../../reporting-services/report-design/expression-examples-report-builder-and-ssrs.md)   
 [Параметры отчета &#40; Построитель отчетов и конструктор отчетов &#41;](../../reporting-services/report-design/report-parameters-report-builder-and-report-designer.md)   
 [Примеры уравнений фильтра &#40; Построитель отчетов и службы SSRS &#41;](../../reporting-services/report-design/filter-equation-examples-report-builder-and-ssrs.md)   
 [Фильтр, группы и сортировка данных &#40; Построитель отчетов и службы SSRS &#41;](../../reporting-services/report-design/filter-group-and-sort-data-report-builder-and-ssrs.md)   
 [Верхние и нижние колонтитулы &#40; Построитель отчетов и службы SSRS &#41;](../../reporting-services/report-design/page-headers-and-footers-report-builder-and-ssrs.md)   
 [Форматирование текста и заполнителей &#40; Построитель отчетов и службы SSRS &#41;](../../reporting-services/report-design/formatting-text-and-placeholders-report-builder-and-ssrs.md)   
 [Скрыть элемент &#40; Построитель отчетов и службы SSRS &#41;](../../reporting-services/report-builder/hide-an-item-report-builder-and-ssrs.md)  
  
  
