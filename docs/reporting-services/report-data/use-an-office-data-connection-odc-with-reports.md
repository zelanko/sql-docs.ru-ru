---
title: "Использование подключения данных Office (ODC) в отчетах | Документы Microsoft"
ms.custom: 
ms.date: 03/14/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- reporting-services-sharepoint
- reporting-services-native
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Office Data Connection (.odc) files
- SharePoint integration [Reporting Services], shared data sources
- .odc files
ms.assetid: e8d6896d-f886-4390-8b5d-96f0a50c250c
caps.latest.revision: 13
author: guyinacube
ms.author: asaxton
manager: erikre
ms.translationtype: HT
ms.sourcegitcommit: 0eb007a5207ceb0b023952d5d9ef6d95986092ac
ms.openlocfilehash: 7df29304e469a78f64a8b81198d7991f956953fe
ms.contentlocale: ru-ru
ms.lasthandoff: 08/09/2017

---
# <a name="use-an-office-data-connection-odc-with-reports"></a>использовать в отчетах ODC-файл подключения к данным Office
  В некоторых случаях для предоставления в отчет служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] сведений о соединении можно использовать существующий ODC-файл. ODC-файл может быть использован вместо RSDS-файла при создании общего источника данных. Сервер отчетов использует ODC-файл так же, как и RSDS-файлы. Он считывает из файла тип источника данных, строку соединения и сведения об учетных данных.  
  
 Не все ODC-файлы могут быть использованы в отчете служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] . Модуль обработки данных и характеристики отчета и ODC-файла определяют, можно ли использовать ODC-файл.  
  
-   Отчет должен быть сконструирован для работы с поставщиком данных OLE DB или ODBC. Если при создании отчета использовался другой модуль обработки данных, то отчет и входящие в него запросы могут включать возможности, не поддерживаемые поставщиками данных OLE DB или ODBC.  
  
-   Используемый ODC-файл должен включать в себя необходимые элементы и иметь определенную структуру. Чтобы сервер отчетов мог считать параметры поставщика данных и учетные данные, их необходимо указывать в файле в явном виде. Лучший способ указания этих значений — экспорт ODC-файла перед передачей его в библиотеку SharePoint.  
  
-   ODC-файл должен содержать сведения о типе соединения OLE DB или ODBC.  
  
-   ODC-файл должен содержать строку соединения.  
  
-   Учетные данные могут принимать значение **None**, **Stored**или **Integrated**. Если для учетных данных указан метод **Stored**, то сервер отчетов предлагает ввести их вместо использования сохраненных учетных данных. Сервер отчетов не может использовать сохраненные учетные данные, как определено в ODC-файле.  
  
-   Схема источника данных должна совпадать со схемой, используемой при создании отчета. Если структуры данных различны, то отчет не будет выполняться.  
  
-   ODC-файл должен быть создан в [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office 2007 (предыдущие версии ODC-файла не совместимы с файлами определений отчетов).  
  
 ODC-файлы нельзя использовать для указания соединений с источниками данных, которые не поддерживаются сервером отчетов, даже в тех случаях, когда типы данных, указанные в данных файлах, близки к поддерживаемым типам. В частности, если ODC-файл был создан с помощью Microsoft Excel 2007, получающего данные из СУБД Microsoft Access, веб-узла или текстового файла, его нельзя использовать для предоставления данных в отчет.  
  
 Отчеты и модели построителя отчетов не поддерживают работу с ODC-файлами. ODC-файл не может быть использован для создания модели. В свою очередь, нельзя настраивать модель для использования общего источника данных, ссылающегося на ODC-файл.  
  
 Представленные ниже инструкции могут быть использованы при создании и экспорте ODC-файлов. Одним из простых способов создания ODC-файла для источника данных OLE DB является применение Excel 2007 и мастера подключений к данным. Заметим, что мастер не создает источник данных; необходим внешний источник данных, который уже определен.  
  
 Существующий ODC-файл должен использоваться только в том случае, если он является полностью совместимым с отчетом и запросами. При возникновении ошибок, требующих серьезных изменений отчета или ODC-файла, необходимо создать для указанного отчета новый RSDS-файл. Дополнительные сведения о создании общего источника данных, использующего RSDS-файла см. в разделе [Создание и управление общие источники данных &#40; Службы Reporting Services в SharePoint интегрированная режим &#41; ](http://msdn.microsoft.com/library/2d3428e4-a810-4e66-a287-ff18e57fad76).  
  
### <a name="to-create-and-export-an-odc-file"></a>Создание и экспорт ODC-файла  
  
1.  Запустите Excel 2007.  
  
2.  На вкладке **Данные** в группе **Получение внешних данных** выберите **От других источников**, затем **От мастера подключения к данным**.  
  
3.  Выберите **Другое/Дополнительно**и нажмите кнопку **Далее**.  
  
4.  Выберите **Поставщик Microsoft OLE DB для SQL Server**, затем нажмите кнопку **Далее**.  
  
5.  Введите имя сервера (по умолчанию используется сетевое имя компьютера) и учетную запись пользователя, имеющего верное имя входа и разрешения на доступ к базе данных. Нажмите кнопку **Далее**.  
  
6.  Выберите базу данных, затем нажмите кнопку **ОК** , чтобы закрыть диалоговое окно **Связь данных** .  
  
7.  По умолчанию флажок **Подключение к заданной таблице** установлен. Этот параметр используется для получения данных из заданной таблицы. Сервер отчетов не обрабатывает запросы в ODC-файле. Поэтому состояние флажка не влияет на его работу. Запросы, получающие данные для отчета, необходимо включать в файл определения отчета, а не во внешние файлы.  
  
8.  При открытом соединении можно изменять его параметры, а также экспортировать соединение. На вкладке **Данные** в группе **Соединения** выберите **Свойства**, затем нажмите кнопку **Свойства соединения** , расположенную рядом с именем соединения.  
  
9. На вкладке **Определение** нажмите кнопку **Экспорт файла соединения**.  
  
10. Введите имя файла и нажмите кнопку **Сохранить**. Закройте приложение и все открытые файлы.  
  
### <a name="to-upload-and-use-an-odc-file"></a>Передача и использование ODC-файла  
  
1.  Откройте библиотеку, в которую необходимо передать файл соединения.  
  
2.  В меню **Передача** выберите команду **Передать документ**.  
  
3.  Нажмите кнопку **Обзор**.  
  
4.  Выделите созданный ранее ODC-файл. По умолчанию ODC-файл хранится в папке «Мои документы\Мои источники данных».  
  
5.  Чтобы выбрать файл, нажмите кнопку **Открыть** , затем нажмите кнопку **ОК** для сохранения файла. Автоматически откроется страница свойств нового элемента.  
  
6.  На вкладке «Тип содержимого» выберите **Источник данных отчета**и нажмите кнопку **ОК**.  
  
7.  Укажите отчет.  
  
8.  Нажмите кнопку со стрелкой вниз и выберите **Управление источниками данных**.  
  
9. Щелкните имя источника данных.  
  
10. Если в отчете используются данные пользовательского источника данных, выберите **Общий**.  
  
11. В окне **Связь с источниками данных**нажмите кнопку обзора (**...**).  
  
12. Выделите только что переданный ODC-файл.  
  
13. Чтобы выбрать файл и сохранить изменения, дважды нажмите кнопку **[!INCLUDE[ssISnoversion](../Token/ssISnoversion_md.md)]** ОК **** .  
  
     Если представленные выше шаги применяются к образцу базы данных [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] , необходимо иметь в виду, что полной совместимостью с ODC-файлом обладает только отчет Company Sales. Другие образцы отчетов включают в себя параметры и функции запросов, не совместимые с поставщиком OLE DB. Однако указанные отчеты можно преобразовать с помощью конструктора отчетов, после чего их можно будет использовать с поставщиком OLE DB.  
  
## <a name="see-also"></a>См. также  
 [Создание, изменение и удаление общих источников данных (службы SSRS)](../../reporting-services/report-data/create-modify-and-delete-shared-data-sources-ssrs.md)  
  
  
