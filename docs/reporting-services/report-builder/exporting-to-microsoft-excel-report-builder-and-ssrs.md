---
title: Экспорт в Microsoft Excel (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.date: 01/09/2017
ms.prod: reporting-services
ms.prod_service: reporting-services-sharepoint, reporting-services-native
ms.technology: report-builder
ms.topic: conceptual
ms.assetid: 74f726fc-2167-47af-9093-1644e03ef01f
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: d1e0f1af0b3dff47607960d8c2d37af84f4b00fc
ms.sourcegitcommit: 61381ef939415fe019285def9450d7583df1fed0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47663122"
---
# <a name="exporting-to-microsoft-excel-report-builder-and-ssrs"></a>Экспорт в Microsoft Excel (построитель отчетов и службы SSRS)
  Модуль подготовки отчетов [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Excel подготавливает отчет [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] с разбиением на страницы в формате [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] (XLSX). Благодаря модулю для подготовки отчетов, ширина столбцов в Excel более аккуратно отражает ширину столбцов в отчете.  
  
 Используется формат Office Open XML. Содержимое файлов, создаваемых этим модулем подготовки, имеет тип **application/vnd.openxmlformats-officedocument.spreadsheetml.sheet** , а имена файлов имеют расширение XLSX.  
  
 Некоторые параметры по умолчанию для этого модуля подготовки отчетов можно изменить через настройку сведений об устройстве. Дополнительные сведения см. в статье [Excel Device Information Settings](../../reporting-services/excel-device-information-settings.md).  
  
 Дополнительные сведения об экспорте в Excel см. в разделе [Экспорт отчетов (построитель отчетов и службы SSRS)](../../reporting-services/report-builder/export-reports-report-builder-and-ssrs.md).  
  
> [!IMPORTANT]  
>  При определении параметра типа **String**пользователю предоставляется текстовое поле, в которое можно ввести любое значение. Если параметр отчета не привязан к параметру запроса, но значения этого параметра включены в отчет, пользователь может ввести в качестве значения этого параметра синтаксическое выражение, скрипт или URL-адрес и подготовить отчет к просмотру в приложении Excel. Если затем другой пользователь при просмотре отчета щелкнет содержимое параметра, он может неумышленно выполнить вредоносный скрипт или перейти по ссылке.  
>   
>  Чтобы снизить риск неумышленного запуска вредоносных скриптов, открывайте отчеты, готовые для просмотра, только из проверенных источников. Дополнительные сведения о защите отчетов см. в разделе [Обеспечение безопасности отчетов и ресурсов](../../reporting-services/security/secure-reports-and-resources.md).  
  
##  <a name="ExcelLimitations"></a> Ограничения Excel  
 [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] накладывает ограничения на экспортированные отчеты в связи с функциями Excel и форматом его файлов. Наиболее значительны из них следующие.  
  
-   Максимальная ширина столбца — 255 символов или 1726,5 пунктов. Модуль подготовки отчетов не производит проверку превышения ширины столбца.  
  
-   Максимальное количество символов в ячейке — 32 767. При превышении этого количества в модуле подготовки отчетов отображается сообщение об ошибке.  
  
-   Максимальная высота строки — 409 пунктов. Если содержимое строки приводит к увеличению ее высоты до более 409 пунктов, в ячейке Excel отображается частичный объем текста размером до 409 пунктов. Остальная часть содержимого ячейки по-прежнему будет находиться в ячейке (до максимального количества символов, составляющего 32 767).

-  Так как максимальная высота строки равна 409 пунктам, то если определенная высота ячейки в отчете превышает 409 пунктов, Excel разделяет содержимое ячейки на несколько строк.
  
-   В Excel не задано ограничение максимального числа листов, однако внешние факторы, такие как недостаток памяти или места на диске, могут сыграть роль таких ограничений.  
  
-   В структурах Excel допускается до 7 уровней вложенности.  
  
-   Если элемент отчета, управляющий переключением другого элемента, не находится в соседней с ним строке или столбце, то структура отключается.  
  
 Дополнительные сведения об ограничениях Excel см. в разделе [Спецификации и ограничения приложения Excel](https://support.office.com/article/Excel-specifications-and-limits-CA36E2DC-1F09-4620-B726-67C00B05040F).  
  
### <a name="sizes-of-excel-2003-xls-files"></a>Размеры файлов Excel 2003 (XLS)  
  
> [!IMPORTANT]  
>  Модуль подготовки отчетов [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] 2003 устарел. Дополнительные сведения см. в разделе [Нерекомендуемые функции служб SQL Server Reporting Services в SQL Server 2016](../../reporting-services/deprecated-features-in-sql-server-reporting-services-ssrs.md).  
  
 Когда отчеты в первый раз экспортируются и сохраняются в Excel 2003, для них не выполняется оптимизация файлов, автоматически применяемая в Excel к XLS-файлам книг. Увеличение размеров файлов может стать причиной проблем при работе с подписками и вложениями электронной почты. Чтобы уменьшить размер файлов \*.xls экспортируемых отчетов, откройте файлы \*.xls и сохраните эти книги повторно. Повторное сохранение книг обычно приводит к уменьшению размеров файлов на 40–50 %.  
  
> [!NOTE]  
>  В Excel 2003 в одной ячейке листа может быть отображено приблизительно 1000 символов, однако в строке формул можно работать с максимальным количеством символов. Это ограничение не применимо к текущим файлам Excel (XLSX).  
  
### <a name="text-boxes-and-text"></a>Текстовые поля и текст  
 Следующие ограничения относятся к текстовым полям и тексту.  
  
-   Значения текстового поля, являющиеся выражениями, не преобразуются в формулы Excel. Значения всех текстовых полей вычисляются во время обработки отчета. Вычисляемые выражения экспортируются в виде содержимого каждой из ячеек Excel.  
  
-   Текстовые поля подготавливаются к просмотру в виде отдельной ячейки Excel. Единственным видом форматирования, поддерживаемым для отдельного текста в ячейке Excel, является размер и тип шрифта, оформление и стиль.  
  
-   Текстовый эффект «Надчеркивание» в Excel не поддерживается.  
  
-   Excel добавляет отступы с левой и правой стороны ячейки, по умолчанию равные 3,75 пункта. Если в настройках полей установлено значение меньше 3,75 пунктов и места едва хватает для размещения текста, это может вызвать перенос по словам.  
  
    > [!NOTE]  
    >  Эту проблему можно обойти, увеличив ширину текстового поля в отчете.  
  
### <a name="images"></a>Изображения  
 Следующие ограничения применяются к изображениям.  
  
-   Фоновые изображения для элементов отчетов не учитываются, поскольку в Excel не поддерживаются фоновые изображения для отдельных ячеек.  
  
-   Модуль подготовки отчетов Excel поддерживает фоновые изображения только для текста отчета. Если фоновое изображение текста отчета отображается в отчете, то оно будет преобразовано в фоновое изображение листа.  
  
### <a name="rectangles"></a>Прямоугольники  
 Следующее ограничение применяется к прямоугольникам.  
  
-   Прямоугольники в нижних колонтитулах отчетов не экспортируются в Excel. Однако прямоугольники в тексте отчета, ячейки табликсов и т. д. преобразуются в диапазоны ячеек Excel.  
  
### <a name="report-headers-and-footers"></a>Верхние и нижние колонтитулы отчета  
 К верхним и нижним колонтитулам отчетов применяются следующие ограничения.  
  
-   В верхних и нижних колонтитулах Excel поддерживаются значения с максимальной длиной в 256 символов, включая разметку. Модуль подготовки отчетов производит усечение строки после 256 символов.  
  
-   [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] не поддерживают обрамляющие поля в верхних и нижних колонтитулах отчетов. При экспорте в Excel значения ширины этих полей устанавливаются равными нулю, а у любых верхних и нижних колонтитулов, состоящих из нескольких строк данных, на печать могут быть выведены не все строки, в зависимости от параметров принтера.  
  
-   У текстовых полей в верхних и нижних колонтитулах при экспорте в Excel сохраняется форматирование, но не выравнивание. Это происходит потому, что при выводе отчета в формате Excel начальные и конечные пробелы удаляются.  
  
### <a name="merging-cells"></a>Объединение ячеек  
 К объединению ячеек применяется следующее ограничение.  
  
-   Если ячейки объединены, то не будет правильно работать перенос по словам. Если в строке есть объединенные ячейки, а при подготовке к просмотру текстового поля этой строки было включено свойство AutoSize, то автоматическое масштабирование не будет работать.  
  
 Модуль подготовки отчетов Excel является главным образом модулем подготовки макетов. Его задача — воспроизвести макет подготовленного к просмотру отчета в листе Excel как можно точнее, поэтому для сохранения макета отчета ячейки могут объединяться. Объединенные ячейки могут вызывать проблемы, так как для правильной работы функций сортировки в Excel ячейки необходимо объединять только строго определенным способом. Например, для сортировки объединенных ячеек в Excel необходимо, чтобы их диапазоны имели одинаковый размер.  
  
 Если важно иметь возможность сортировки экспортируемых в Excel отчетов, можно выполнить следующие действия, чтобы уменьшить количество объединяемых в листах Excel ячеек, которые часто вызывают проблемы при сортировке в Excel.  
  
-   Основная причина объединения ячеек — отсутствие выравнивания по правому и левому краям. Убедитесь, что все элементы отчета выровнены между собой по правому и левому краям. Выравнивание элементов и использование одинаковой ширины в большинстве случаев решает проблему.  
  
-   В некоторых редких случаях столбцы все равно объединяются несмотря на то, что все элементы точно выровнены. Это может быть вызвано внутренним преобразованием единиц измерения и округлением во время подготовки листа Excel к просмотру. На языке определения отчетов (RDL) положения и размеры могут указываться в различных единицах измерения, таких как дюймы, пиксели, сантиметры и пункты. Для внутренних расчетов Excel использует пункты. Чтобы минимизировать выполняемые преобразования и возможную неточность округления при преобразовании дюймов и сантиметров в пункты, следует рассмотреть возможность непосредственного указания всех размеров в пунктах. Один дюйм равен 72 пунктам.  
  
### <a name="report-row-groups-and-column-groups"></a>Группы строк и группы столбцов отчета  
 Отчеты, включающие группы строк или группы столбцов, после экспорта в Excel содержат пустые ячейки. Представьте себе отчет, группирующий строки по расстоянию до работы. Каждое расстояние до работы может содержать нескольких клиентов. Отчет изображен на следующем рисунке.  
  
 ![Отчет на веб-портале служб Reporting Services](../../reporting-services/report-builder/media/ssrb-excelexportssrs.png "Отчет на веб-портале служб Reporting Services")  
  
 Когда отчет экспортируется в Excel, расстояние до работы отображается только в одной ячейке столбца расстояния до работы. В зависимости от выравнивания текста в отчете (по верху, по центру или по низу), это значение отображается в первой, средней или последней ячейке. Другие ячейки остаются пустыми. Столбец имени, содержащий названия клиентов, не содержит пустых ячеек. На следующем рисунке изображен тот же отчет после экспорта в Excel. Красные границы ячеек были добавлены, чтобы подчеркнуть суть происходящего. Серые блоки представляют пустые ячейки. (Ни красные линии, ни серые блоки не являются частью экспортируемого отчета.)  
  
 ![Отчет, экспортированный в Excel, со строками](../../reporting-services/report-builder/media/ssrb-exportedexcellines.png "Отчет, экспортированный в Excel, со строками")  
  
 Это означает, что отчеты со сгруппированными столбцами или строками требуют модификации после экспорта в Excel и перед отображением экспортированных данных в сводной таблице. Необходимо добавить групповое значение в ячейки, в которых оно отсутствует, чтобы лист превратился в плоскую таблицу со значениями во всех ячейках. На следующем рисунке показан обновленный лист.  
  
 ![Отчет, экспортированный в Excel, преобразованный в плоскую структуру](../../reporting-services/report-builder/media/ssrb-excelexportnomatrix.png "Отчет, экспортированный в Excel, преобразованный в плоскую структуру")  
  
 Итак, если отчет создается специально для экспорта в Excel для последующего анализа данных отчета, в нем не рекомендуется группировать строки или столбцы.  
  
## <a name="excel-renderer"></a>Модуль подготовки отчетов Excel  
  
### <a name="current-xlsx-excel-file-renderer"></a>Текущий модуль подготовки отчетов Excel (XLSX)  
 В службах [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]модуль подготовки отчетов Excel по умолчанию имеет версию, совместимую с текущими (XLSX) файлами [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] . Это параметр **Excel** , содержащийся в меню **Экспорт** не веб-портале [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] и в списке SharePoint.  
  
 Когда вы по умолчанию используете модуль подготовки отчетов Excel вместо раннего модуля Excel 2003 (XLS), вы можете установить пакет обеспечения совместимости Microsoft Office для Word, Excel и PowerPoint, чтобы позволить ранним версиям Excel открывать экспортируемые файлы.  
  
### <a name="excel-2003-xls-renderer"></a>Модуль подготовки отчетов Excel 2003 (XLS)  
  
> [!IMPORTANT]  
>  Модуль подготовки отчетов [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] 2003 устарел. Дополнительные сведения см. в разделе [Нерекомендуемые функции служб SQL Server Reporting Services в SQL Server 2016](../../reporting-services/deprecated-features-in-sql-server-reporting-services-ssrs.md).  
  
 Ранняя версия модуля подготовки отчетов Excel, совместимая с Excel 2003, теперь называется Excel 2003 и включена в меню под этим именем. Этот модуль подготовки создает содержимое файлов типа **application/vnd.ms-excel** , а имена файлов имеют расширение XLS.  
  
 По умолчанию, параметр меню **Excel 2003** не отображается. Администратор может сделать его видимым при определенных обстоятельствах, обновив файл конфигурации RSReportServer. Для экспорта отчетов из среды [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] с помощью модуля подготовки отчетов Excel 2003 необходимо обновить файл конфигурации RSReportDesigner.  
  
 Пункт меню **Excel 2003** не отображается в следующих случаях.  
  
-   Построитель отчетов работает в отключенном режиме и используется для предварительного просмотра отчетов. Поскольку файл конфигурации RSReportServer хранится на сервере отчетов, для обеспечения возможности чтения файла конфигурации средства и продукты, хранящиеся в целевом местоположении экспорта отчетов, должны быть подключены к серверу отчетов.  
  
-   Веб-часть средства просмотра отчетов работает в локальном режиме, а ферма SharePoint не интегрирована с сервером отчетов служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] . Дополнительные сведения см. в разделе [Отчеты, созданные в локальном режиме и Отчеты, созданные в подключенном режиме, в средстве просмотра отчетов &#40;службы Reporting Services в режиме интеграции с SharePoint&#41;](../../reporting-services/report-server-sharepoint/local-mode-vs-connected-mode-reports-in-the-report-viewer.md)  
  
 Если пункт меню модуля подготовки отчетов **Excel 2003** видим, то в следующих сценариях будут доступны параметры Excel 2003 и Excel:  
  
-   [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Веб-портал в основном режиме.  
  
-   Сайт SharePoint, если службы Reporting Services установлены в режиме интеграции с SharePoint.  
  
-   [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] и вы просматриваете отчеты.  
  
-   Построитель отчетов подключен к серверу отчетов.  
  
-   Веб-часть средства просмотра отчетов в удаленном режиме.  
  
 Элементы для двух модулей подготовки отчетов Excel в файлах конфигурации RSReportServer и RSReportDesigner показаны в следующем коде XML:  
  
 `<Extension Name="EXCELOPENXML" Type="Microsoft.ReportingServices.Rendering.ExcelOpenXmlRenderer.ExcelOpenXmlRenderer,Microsoft.ReportingServices.ExcelRendering"/>`  
  
 `<Extension Name="EXCEL" Type="Microsoft.ReportingServices.Rendering.ExcelRenderer.ExcelRenderer,Microsoft.ReportingServices.ExcelRendering" Visible="false"/>`  
  
 Расширение EXCELOPENXML определяет модуль подготовки отчетов Excel для текущих файлов Excel (XLSX). Расширение EXCEL определяет версию Excel 2003. `Visible = “false”` указывает, что модуль подготовки отчетов Excel 2003 скрыт. Дополнительные сведения см. в разделах [Файл конфигурации RsReportServer.config](../../reporting-services/report-server/rsreportserver-config-configuration-file.md) и [Файл конфигурации RSReportDesigner](../../reporting-services/report-server/rsreportdesigner-configuration-file.md).  
  
### <a name="differences-between-the-current-xlsx-excel-and-excel-2003-renderers"></a>Различия между модулями подготовки Excel (XLSX) и Excel 2003  
 Отчеты, подготовленные с использованием модулей подготовки Excel (XLSX) или Excel 2003, обычно совпадают, различия между двумя форматами можно заметить только в нескольких случаях. Следующая таблица сравнивает модули подготовки отчетов Excel и Excel 2003.  
  
|Свойство|Excel 2003|Текущий Excel|  
|--------------|----------------|-------------------|  
|Максимальное число столбцов на листе|256|16 384|  
|Максимальное число строк на листе|65 536|1 048 576|  
|Количество цветов, допустимых на листе|56 (палитра)<br /><br /> Если в отчете используется более 56 цветов, модуль подготовки отчетов подбирает требуемый цвет к одному из 56 цветов, которые уже доступны в пользовательской палитре.|Приблизительно 16 миллионов (24-разрядный цвет)|  
|Сжатые файлы в формате ZIP|None|Сжатие в формате ZIP|  
|Семейство шрифтов по умолчанию|Arial|Calibri|  
|Размер шрифта по умолчанию|10 пт|11 пт|  
|Высота строки по умолчанию|12,75 пт|15 пт|  
  
 Поскольку в отчете явно задана высота строки, то значение строк по умолчанию применяется только к строкам, размер которых настраивается автоматически при экспорте в Excel.  
  
##  <a name="ReportItemsExcel"></a> Элементы отчета в Excel  
 Прямоугольники, вложенные отчеты, текст отчета и области данных преобразуются в диапазон ячеек Excel. Текстовые поля, изображения, диаграммы, гистограммы, инфокривые, датчики и индикаторы должны быть помещены в одну ячейку Excel; в зависимости от особенностей макета отчета ячейки могут быть объединены.  
  
 Изображения, диаграммы, инфокривые, гистограммы, карты, датчики, индикаторы и линии располагаются в пределах одной ячейки Excel, однако они располагаются поверх сетки ячеек. Линии отображаются как границы ячеек.  
  
 Диаграммы, инфокривые, гистограммы, карты, датчики и индикаторы экспортируются как изображения. Отображаемые ими данные, такие как метки значений и элементов на диаграмме, не экспортируются вместе с ними и не приводятся в книге Excel, кроме случаев, когда такие данные включены в столбец или строку в области данных внутри отчета.  
  
 Если требуется работать с данными диаграмм, спарклайнов, гистограмм, карт, датчиков и индикаторов, экспортируйте отчет в файл CSV или сформируйте Atom-совместимые потоки данных из отчета. Дополнительные сведения см. в разделах [Экспорт в CSV-файл (построитель отчетов и службы SSRS)](../../reporting-services/report-builder/exporting-to-a-csv-file-report-builder-and-ssrs.md) и [Формирование веб-каналов данных из отчетов (построитель отчетов и службы SSRS)](../../reporting-services/report-builder/generating-data-feeds-from-reports-report-builder-and-ssrs.md).  
  
## <a name="page-sizing"></a>Изменение размера страницы  
 Модуль подготовки отчетов в формате Excel использует настройки высоты и ширины страницы для определения того, какую настройку бумаги следует задать в листе Excel. Excel пытается подогнать параметры PageHeight и PageWidth под наиболее распространенные размеры бумаги.  
  
 Если это сделать не удается, Excel использует размер страницы по умолчанию для принтера. Если ширина страницы меньше, чем ее высота, то устанавливается книжная ориентация; в противном случае устанавливается альбомная ориентация.  
  
##  <a name="WorksheetTabNames"></a> Имена вкладок листа  
 При экспорте отчета в Excel страницы отчета, созданные с помощью разрывов страницы, экспортируются на другие листы. При указании имени стартовой страницы для отчета это имя по умолчанию присваивается всем листам книги Excel. Имя отображается на вкладке листа. Однако, поскольку все листы в книге должны иметь уникальное имя, к имени стартовой страницы всех дополнительных листов добавляется целое число, начинающееся с 1, с шагом 1. Например, если имя стартовой страницы — **Отчет по продажам за финансовый год**, то второй лист будет иметь имя **Отчет по продажам за финансовый год1**, третий — **Отчет по продажам за финансовый год2**и т. д.  
  
 Если все страницы отчета, созданные с помощью разрывов страниц, будут иметь новые имена, то листу будет присвоено имя связанной страницы. Однако имена этой страницы могут не быть уникальными. Если имена страницы не являются уникальными, то листам имена присваиваются аналогично именам стартовой страницы. Например, если страница двух групп имеет имя **Продажи по NW**, то первая вкладка листа будет иметь имя **Продажи по NW**, а вторая **Продажи по NW1**.  
  
 Если в отчете не указано ни имя стартовой страницы, ни имена страниц, связанных с разрывами страниц, то вкладкам листов будут присваиваться имена по умолчанию: **Лист1**, **Лист2**и т. д.  
  
 Службы Reporting Services предоставляют свойства, задаваемые для отчетов, областей данных, групп и прямоугольников, что позволяет создавать отчеты, которые можно экспортировать в Excel нужным образом. Дополнительные сведения см. в статье [Разбиение на страницы в службах Reporting Services (построитель отчетов и службы SSRS)](../../reporting-services/report-design/pagination-in-reporting-services-report-builder-and-ssrs.md).  
  
##  <a name="DocumentProperties"></a> Свойства документа  
 Модуль подготовки отчетов Excel записывает в файл Excel следующие метаданные.  
  
|Свойства элемента отчета|Description|  
|-------------------------------|-----------------|  
|Создание|Дата и время выполнения отчета со значением в формате ISO.|  
|Автор|Report.Author|  
|Описание|Report.Description|  
|LastSaved|Дата и время выполнения отчета со значением в формате ISO.|  
  
##  <a name="PageHeadersFooters"></a> Верхние и нижние колонтитулы страницы  
 В зависимости от значения параметра SimplePageHeaders в параметрах устройства, заголовок страницы может отображаться в двух вариантах: в верхней части каждой сетки ячеек листа или в актуальном разделе заголовка листа Excel. По умолчанию верхний колонтитул создается в сетке ячеек листа Excel.  
  
 Нижний колонтитул страницы всегда создается в области нижнего колонтитула листа Excel, вне зависимости от значения настройки SimplePageHeaders.  
  
 В области верхнего и нижнего колонтитулов Excel допускаются значения с максимальной длиной в 256 символов, включая разметку. Если данное максимальное число превышается, то модуль подготовки отчетов Excel сокращает общее число символов, удаляя символы разметки, начиная с конца строки верхнего и нижнего колонтитулов. Если после удаления всех символов разметки длина все еще превышает максимальную длину, то строка усекается, начиная с правого края.  
  
### <a name="simplepageheader-settings"></a>Настройки SimplePageHeaders  
 По умолчанию настройка сведений об устройстве SimplePageHeaders имеет значение **False**, поэтому колонтитулы вставляются в отчет в виде строк на лист Excel. Строки листа, содержащие верхние колонтитулы, блокируются. Эту панель можно закрепить или освободить в Excel. Если выбран параметр **Печатать заголовки** , то верхние колонтитулы будут автоматически печататься на каждой странице листа.  
  
 Если на вкладке «Параметры страницы» в Excel был выбран параметр **Печатать заголовки** , то верхний колонтитул страницы будет отображен на всех листах книги, кроме листа со схемой документа. Если параметр **Печать на первой странице** или **Печать на последней странице** в диалоговом окне «Свойства верхнего колонтитула отчета» или «Свойства нижнего колонтитула отчета» не был выбран, то соответствующий колонтитул не будет добавлен на первую или последнюю страницу.  
  
 Нижние колонтитулы отображаются в области нижних колонтитулов Excel.  
  
 В связи с ограничениями Excel единственные элементы отчета, которые могут выводиться в области верхнего или нижнего колонтитулов, — текстовые поля.  
  
##  <a name="Interactivity"></a> Интерактивность  
 В Excel поддерживаются некоторые интерактивные элементы. Ниже приведено описание особенностей поведения.  
  
### <a name="show-and-hide"></a>Показать и скрыть  
 [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] имеет ограничения по управлению скрытыми и отображаемыми элементами отчета при их экспорте. Группы, строки и столбцы, содержащие переключаемые элементы отчета, преобразуются в структуры Excel. Excel создает структуры, расширяющие или сворачивающие строки и столбцы по всей их длине, что может привести к свертыванию элементов отчета, не подлежащих свертыванию. Кроме того, символы структурирования Excel могут стать загроможденными при наличии множества перекрывающихся структур. Для решения данных проблем при использовании модуля подготовки отчетов в формате Excel применяются следующие правила структурирования.  
  
-   Переключаемый элемент отчета, расположенный в верхнем левом углу, может быть переключен в Excel. Переключаемые элементы отчета, находящиеся в одной строке или столбце с переключаемым элементом отчета, расположенным в верхнем левом углу, не могут быть переключены в Excel.  
  
-   Для определения того, будет ли возможно свертывание области данных по строкам или столбцам, производится определение расположения элемента отчета, управляющего переключением, и переключаемого элемента отчета. Если элемент, управляющий переключением, находится до переключаемого элемента, то свертка элемента по строкам возможна. В противном случае элемент может быть свернут только по столбцам. Если элемент, управляющий переключением, находится рядом или выше переключаемой области, этот элемент может быть отображен со строкой, сворачиваемой по строкам.  
  
-   Для определения места, в которое будут помещены подытоги в отчете, готовом для просмотра, модуль подготовки отчетов проверяет первый экземпляр динамического элемента. Если непосредственно над ним присутствует одноуровневый статический элемент, считается, что динамический элемент является подытогом. Структуры настраиваются на отображение данного места в качестве итоговых данных. Если у динамического элемента нет статических одноуровневых элементов, то подытогом будет первый экземпляр элемента.  
  
-   В связи с ограничениями Excel, структуры могут иметь не больше семи уровней вложения.  
  
### <a name="document-map"></a>Схема документа  
 Если в отчете существуют метки схемы документа, то происходит отображение схемы документа. Схема документа будет отображена в виде титульного листа Excel, вставленного на позицию первой вкладки в книге. Этому листу присваивается имя **Схема документа**.  
  
 Текст, отображаемый в схеме документа, определяется свойством DocumentMapLabel элемента отчета или группы. Метки схемы документа перечисляются в том порядке, в котором они появляются в отчете, начиная с первой строки в первом столбце. Каждая ячейка метки схемы документа углубляется настолько, насколько глубоко (по уровням) она расположена в отчете. При углублении на каждый последующий уровень происходит перемещение метки в следующий столбец. В Excel поддерживается до 256 уровней вложения структур.  
  
 Схема документа отображается в виде свертываемой структуры Excel. Структура совпадает с вложенной структурой схемы документа. Развернутое и свернутое состояния структуры начинаются со второго уровня.  
  
 Корневой узел схемы — это имя отчета, \<*имя_отчета*>.rdl, он не является интерактивным. В ссылках схемы документа используется шрифт Arial, 10 пт.  
  
### <a name="drillthrough-links"></a>Ссылки детализации  
 Ссылки детализации, появляющиеся в текстовых полях, преобразуются в гиперссылки Excel в ячейках, содержащих текст. Ссылки детализации для изображений и диаграмм преобразуются в гиперссылки Excel на изображение. При щелчке ссылки детализации открывается веб-браузер по умолчанию и осуществляется переход к целевому HTML-представлению.  
  
### <a name="hyperlinks"></a>Гиперссылки  
 Гиперссылки, появляющиеся в текстовых полях, преобразуются в гиперссылки Excel в ячейках, содержащих текст. Гиперссылки для изображений и диаграмм преобразуются в гиперссылки Excel на изображение. При щелчке гиперссылки открывается веб-браузер по умолчанию и осуществляется переход по целевому URL-адресу.  
  
### <a name="interactive-sorting"></a>Интерактивная сортировка  
 Excel не поддерживает интерактивную сортировку.  
  
### <a name="bookmarks"></a>Закладки  
 Ссылки закладок в текстовых полях преобразуются в гиперссылки Excel в ячейках, содержащих текст. Ссылки закладок для изображений и диаграмм преобразуются в гиперссылки Excel на изображение. При щелчке закладки выполняется переход в ячейку Excel, в которой содержится ссылаемый элемент отчета.  
  
##  <a name="ConditionalFormat"></a> Изменение отчетов во время выполнения  
 Если отчет должен обрабатываться в нескольких форматах, а создать макет отчета, отображаемый требуемым образом во всех необходимых форматах, невозможно, рассмотрите возможность использования значения во встроенном глобальном выражении RenderFormat для условного изменения вида отчета во время выполнения. Это позволит скрывать или отображать элементы отчета в зависимости от используемого модуля подготовки и, таким образом, достичь наилучших результатов при подготовке в каждом из форматов. Дополнительные сведения см. в разделе [Встроенные глобальные значения и ссылки на пользовательские поля (построитель отчетов и службы SSRS)](../../reporting-services/report-design/built-in-collections-built-in-globals-and-users-references-report-builder.md).  
  
## <a name="see-also"></a>См. также:  
 [Разбиение на страницы в службах Reporting Services (построитель отчетов и службы SSRS)](../../reporting-services/report-design/pagination-in-reporting-services-report-builder-and-ssrs.md)   
 [Поведение при подготовке к просмотру (построитель отчетов и службы SSRS)](../../reporting-services/report-design/rendering-behaviors-report-builder-and-ssrs.md)   
 [Интерактивные возможности различных модулей подготовки отчетов к просмотру (построитель отчетов и службы SSRS)](../../reporting-services/report-builder/interactive-functionality-different-report-rendering-extensions.md)   
 [Подготовка к просмотру элементов отчета (построитель отчетов и службы SSRS)](../../reporting-services/report-design/rendering-report-items-report-builder-and-ssrs.md)   
 [Таблицы, матрицы и списки (построитель отчетов и службы SSRS)](../../reporting-services/report-design/tables-matrices-and-lists-report-builder-and-ssrs.md)  
  
  
