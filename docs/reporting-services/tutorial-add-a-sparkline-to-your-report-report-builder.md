---
title: "Учебник: Добавление спарклайна в отчет (построитель отчетов) | Документы Microsoft"
ms.custom: 
ms.date: 05/30/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- reporting-services-native
ms.tgt_pltfrm: 
ms.topic: get-started-article
applies_to:
- SQL Server 2016
ms.assetid: 18c90a36-48bf-4805-a960-2d1e8f00c2dc
caps.latest.revision: 17
author: maggiesMSFT
ms.author: maggies
manager: erikre
ms.workload: Inactive
ms.translationtype: Machine Translation
ms.sourcegitcommit: 0eb007a5207ceb0b023952d5d9ef6d95986092ac
ms.openlocfilehash: c4cc42eaf9862f2154f598d6f91dafffa906c799
ms.contentlocale: ru-ru
ms.lasthandoff: 08/09/2017

---

# <a name="tutorial-add-a-sparkline-to-your-report-report-builder"></a>Учебник. Добавление спарклайна в отчет (построитель отчетов)

В этом учебнике по [!INCLUDE[ssRBnoversion_md](../includes/ssrbnoversion-md.md)]вы создадите простую таблицу со спарклайн-графиком в отчета [!INCLUDE[ssRSnoversion_md](../includes/ssrsnoversion-md.md)] с разбивкой на страницы.   
  
Спарклайны и гистограммы — это небольшие простые диаграммы, которые содержат много сведений в небольшом пространстве и часто бывают встроены в таблицы и матрицы в отчетах [!INCLUDE[ssRSnoversion_md](../includes/ssrsnoversion-md.md)] . На приведенном ниже рисунке показан отчет, похожий на тот, который будет в итоге создан.  
  
![report-builder-sparkline-final](../reporting-services/media/report-builder-sparkline-final.png)  
     
Предполагаемое время для выполнения заданий данного учебника: 30 минут.  
  
## <a name="requirements"></a>Требования  
Дополнительные сведения о требованиях см. в разделе [Предварительные условия для использования учебников (построитель отчетов)](../reporting-services/prerequisites-for-tutorials-report-builder.md).  
  
## <a name="CreateTable"></a>1. Создание табличного отчета  
  
1.  [Запустите построитель отчетов](../reporting-services/report-builder/start-report-builder.md) с компьютера, веб-портала [!INCLUDE[ssRSnoversion_md](../includes/ssrsnoversion-md.md)] или сервера в режиме интеграции с SharePoint.  
  
    Откроется диалоговое окно **Создать отчет или набор данных**.  
  
    Если диалоговое окно **Создать отчет или набор данных** не появилось, в меню **Файл** выберите пункт **Создать**.  
  
2.  Убедитесь, что на левой панели выбран **Новый отчет** .  
  
3.  На панели справа выберите **Мастер таблицы или матрицы**.  
  
4.  На странице **Выбор набора данных** выберите **Создать набор данных** > **Далее**. Откроется страница **Выберите соединение с источником данных** .  
  
    > [!NOTE]  
    > Этот учебник не требуется специальных данных; требуется только подключение к базе данных SQL Server. Если соединение с источником данных, входящим в список **Соединения с источниками данных**уже имеется, выберите его и переходите к шагу 10. Дополнительные сведения см. в разделе [Альтернативные способы создания подключения к данным (построитель отчетов)](../reporting-services/alternative-ways-to-get-a-data-connection-report-builder.md).  
  
5.  Нажмите кнопку **Создать**. Откроется диалоговое окно **Свойства источника данных** .  
  
6.  В текстовое поле **Имя**введите имя источника данных: **Продажи продукции**.  
  
7.  Убедитесь, что в поле **Выберите тип соединения**выбран тип **Microsoft SQL Server** .  
  
8.  В поле **Строка подключения**введите следующий текст:  
  
    `Data Source\=<servername>`  
  
    Выражение `<servername>`, например Report001, указывает компьютер, на котором установлен экземпляр компонента SQL Server Database Engine. Поскольку данные отчета не извлекаются из базы данных SQL Server, не нужно указывать имя базы данных. Для синтаксического анализа запроса используется база данных по умолчанию на указанном сервере.  
  
9. Нажмите кнопку **Учетные данные**. Введите учетные данные, необходимые для доступа к внешнему источнику данных.  
  
10. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
    Снова откроется страница **Выбор соединения с источником данных** .  
  
11. Нажмите кнопку **Проверить соединение**, чтобы проверить соединение с источником данных.  
  
    Отобразится сообщение «Соединение установлено успешно».  
  
12. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
13. Нажмите кнопку **Далее**.  
  
## <a name="Query"></a>2. Создание запроса и макета таблицы в мастере таблиц  
В отчете можно использовать общий набор данных со стандартным запросом или создать внедренный набор данных только для этого отчета. В этом учебнике рассматривается создание внедренного набора данных.  
  
> [!NOTE]  
> В этом учебнике запрос уже содержит значения данных, поэтому внешний источник данных не требуется. В связи с этим запрос получается весьма длинным. В рабочей среде запрос не будет содержать данные. Этот запрос содержит данные только в учебных целях.  
  
### <a name="to-create-a-query-and-table-layout-in-the-table-wizard"></a>Создание запроса и макета таблицы в мастере таблиц 
  
1.  На странице **Создание запроса** открывается конструктор реляционных запросов. В этом учебнике будет использоваться текстовый конструктор запросов.  
  
2.  Нажмите кнопку **Редактировать как текст**. Текстовый конструктор запросов отображает панель запросов и панель результатов.  
  
3.  Вставьте в поле [!INCLUDE[tsql](../includes/tsql-md.md)] Запрос **следующий запрос** .  
  
    ```  
    SELECT CAST('2015-01-04' AS date) as SalesDate, 'Accessories' as Subcategory,   
       'Carrying Case' as Product, CAST(16996.60 AS money) AS Sales, 68 as Quantity  
    UNION SELECT CAST('2015-01-05' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Carrying Case' as Product, CAST(1350.00 AS money) AS Sales, 18 as Quantity  
    UNION SELECT CAST('2015-01-10' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Carrying Case' as Product, CAST(1147.50 AS money) AS Sales, 17 as Quantity  
    UNION SELECT CAST('2015-01-04' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Budget Movie-Maker' as Product, CAST(1056.00 AS money) AS Sales, 44 as Quantity  
    UNION SELECT CAST('2015-01-05' AS date) as SalesDate,  'Accessories' as Subcategory,  
       'Slim Digital' as Product, CAST(1380.00 AS money) AS Sales, 18 as Quantity  
    UNION SELECT CAST('2015-01-05' AS date) as SalesDate,'Accessories' as Subcategory,    
       'Budget Movie-Maker' as Product, CAST(780.00 AS money) AS Sales, 26 as Quantity  
    UNION SELECT CAST('2015-01-07' AS date) as SalesDate, 'Accessories' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(3798.00 AS money) AS Sales, 9 as Quantity  
    UNION SELECT CAST('2015-01-08' AS date) as SalesDate, 'Camcorders' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(10400.00 AS money) AS Sales, 13 as Quantity  
    UNION SELECT CAST('2015-01-09' AS date) as SalesDate, 'Camcorders' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(3000.00 AS money) AS Sales, 60 as Quantity  
    UNION SELECT CAST('2015-01-10' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(7234.50 AS money) AS Sales, 39 as Quantity  
    UNION SELECT CAST('2015-01-06' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Carrying Case' as Product, CAST(10836.00 AS money) AS Sales, 84 as Quantity  
    UNION SELECT CAST('2015-01-07' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Slim Digital' as Product, CAST(2550.00 AS money) AS Sales, 17 as Quantity  
    UNION SELECT CAST('2015-01-04' AS date) as SalesDate, 'Digital' as Subcategory,   
       'Slim Digital' as Product, CAST(8357.80 AS money) AS Sales, 44 as Quantity  
    UNION SELECT CAST('2015-01-08' AS date) as SalesDate, 'Digital SLR' as Subcategory,   
       'Slim Digital' as Product, CAST(18530.00 AS money) AS Sales, 34 as Quantity  
    UNION SELECT CAST('2015-01-06' AS date) as SalesDate, 'Digital SLR' as Subcategory,   
       'Slim Digital' as Product, CAST(26576.00 AS money) AS Sales, 88 as Quantity  
    ```  
  
4.  На панели инструментов конструктора запросов нажмите кнопку "Выполнить" (**!**).  
  
    Запрос выполняется и отображает результирующий набор для полей **SalesDate**, **Subcategory**, **Product**, **Sales**и **Quantity**.  
  
5.  Нажмите кнопку **Далее**.  
  
6.  На странице **Размещение полей** перетащите поле **Sales** в область **Значения**.  
  
    Значение поля**Sales** вычисляется агрегатной функцией Sum. Значение равно [Sum(Sales)].  
  
7.  Перетащите поле **Product** в область **Группы строк**.  
  
8.  Перетащите поле **SalesDate** в область **Группы столбцов**.  

    ![report-builder-sparkline-arrange-fields](../reporting-services/media/report-builder-sparkline-arrange-fields.png)
  
9. Нажмите кнопку **Далее**.  
  
10. На странице **Выбор макета** в области **Параметры**убедитесь в том, что выбран параметр **Показать подытоги и общие итоги** .  
  
    На панели просмотра в мастере отображается таблица с тремя строками. При запуске отчета каждая строка отобразится следующим образом:  
  
    *  Первая строка отображается один раз для таблицы, в ней будут содержаться заголовки столбцов.  
  
    *  Вторая строка повторится один раз для каждого продукта и отобразит название продукта, количество заказа в день и линейный итог.  
  
    *  Третья строка отобразится один раз для таблицы и будет содержать общие итоги.  
    
    ![report-builder-sparkline-choose-layout](../reporting-services/media/report-builder-sparkline-choose-layout.png)
  
11. Нажмите кнопку **Далее**.  
  
12. Нажмите кнопку **Готово**.  
  
14. Таблица добавляется в область конструктора. Таблица содержит три столбца и три строки.  
  
    Посмотрите на панель группировки. Если панель группировки не видна, в меню **Вид** выберите пункт **Группирование**. На панели «Группы строк» показана одна группа строк: **Product**. На панели «Группы строк» показана одна группа столбцов: **SalesDate**. Подробные данные — это все данные, которые извлекаются с помощью запроса к набору данных.  
    
    ![report-builder-sparkline-grouping-pane](../reporting-services/media/report-builder-sparkline-grouping-pane.png)
  
15. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  

### <a name="FormatCurrency"></a>2a. Форматирование данных в денежном формате  
По умолчанию сводные данные поля **Sales** отображаются в виде числа с общим форматом. Отформатируйте его для представления валюты. Чтобы форматируемые текстовые поля и текст заполнителей отображался в виде образцов значений, переключайте параметр **Стили заполнителя** .  
  
1.  Щелкните **Конструктор** для переключения в режим конструктора.  
  
2.  Щелкните ячейку во второй строке (под строкой заголовков столбцов) в столбце **SalesDate** . Удерживайте нажатой клавишу CTRL, выделите все ячейки, содержащие `[Sum(Sales)]`. 

    ![report-builder-select-sum-sales](../reporting-services/media/report-builder-select-sum-sales.png) 
  
3.  На вкладке **Главная** в группе **Число** нажмите кнопку **Валюта**. Ячейки изменятся, отображая содержимое в формате валюты.  

    ![report-builder-placeholder-currency](../reporting-services/media/report-builder-placeholder-currency.png)
  
    Если в качестве региональных настроек компьютера выбран "Английский (США)", текстом по умолчанию образца будет [**$12,345.00**]. Если значение валюты не отображается, в группе **Числа** щелкните **Стили заполнителя** > **Образцы значений**.  
    
    ![report-builder-placeholder-value-button](../reporting-services/media/report-builder-placeholder-value-button.png)
   
### <a name="FormatDates"></a>2б. (Необязательно) Форматирование данных в формат даты  
По умолчанию в поле **SalesDate** отображаются дата и время. Можно отформатировать его таким образом, чтобы отображалась только дата.  
  
1.  Щелкните ячейку, содержащую `[SalesDate]`.  
  
3.  На вкладке **Главная** в группе **Число** нажмите кнопку **Дата**.  
  
    В ячейке будет содержаться пример даты **[1/31/2000]**.
     
4.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
Значения поля **SalesDate** отображаются в формате даты по умолчанию, а сводные значения поля **Sales** — в денежном формате.   
  
## <a name="Sparkline"></a>3. Добавление спарклайна    
  
1.  Щелкните **Конструктор** для возврата в режим конструктора.  
  
2.  Выберите в таблице столбец Total.  
  
3.  Щелкните правой кнопкой мыши, наведите указатель на пункт **Вставить столбец**и выберите пункт **Слева**.  

    ![report-builder-add-column-left](../reporting-services/media/report-builder-add-column-left.png)
  
4.  В новом столбце щелкните правой кнопкой мыши ячейку в строке `[Product]` и выберите пункт **Вставить** > **Спарклайн**.  

    ![report-builder-insert-sparkline](../reporting-services/media/report-builder-insert-sparkline.png)
  
5.  Убедитесь в том, что в диалоговом окне **Выбор типа спарклайн-графика** выбран первый спарклайн в строке **Столбец** , и нажмите кнопку **ОК**.  
  
6.  Щелкните спарклайн для отображения панели «Данные диаграммы».  
  
7.  Щелкните знак плюса (+) в поле "Значения" и выберите **Sales**. 

    ![report-builder-sparkline-values](../reporting-services/media/report-builder-sparkline-values.png) 
  
    Значения в поле **Sales** станут значениями спарклайна.  
  
8.  Щелкните знак плюса (+) в поле "Группы категорий" и выберите **SalesDate**.  
  
9. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
    Обратите внимание на то, что столбцы в диаграммах не соответствуют друг другу. Во второй строке данных представлено только четыре столбца, поэтому столбцы шире, чем в первой строке, в которой представлено шесть столбцов. Нельзя сравнить значения по каждому продукту в день. Их нужно выровнять.  
  
    Кроме того, для каждой строки самый высокий столбец имеет высоту строки. Это тоже неправильно, так как наибольшие значения для каждой строки не равны между собой: наибольшее значение для недорогой видеокамеры равно $10 400, а для категории Slim Digital — $26 576, то есть более чем в два раза больше. Тем не менее наибольшие столбцы в этих двух строках имеют примерно одинаковую высоту. Все спарклайны должны иметь одинаковый масштаб.  
  
     ![report-builder-sparkline-misaligned](../reporting-services/media/report-builder-sparkline-misaligned.png)
  
## <a name="AlignSparklines"></a>4. Выравнивание спарклайнов по вертикали и горизонтали  
Спарклайны неудобно читать, когда показатели в них различаются. И горизонтальные и вертикальные оси должны совпадать с остальными.  
   
1.  Щелкните **Конструктор** для возврата в режим конструктора.  
  
2.  Щелкните правой кнопкой мыши спарклайн и выберите пункт **Свойства вертикальной оси**.  
  
3.  Установите флажок **Выровнять оси в** . Tablix1 — единственный пункт в списке.  
  
     Параметр устанавливает высоту столбцов в каждом спарклайне относительно других. 
  
4.  Нажмите кнопку **ОК**.  
  
5.  Щелкните правой кнопкой мыши спарклайн и выберите пункт **Свойства горизонтальной оси**.  
  
6.  Установите флажок **Выровнять оси в** . Tablix1 — единственный пункт в списке. 
  
    Параметр устанавливает ширину столбцов в каждом спарклайне относительно других. Если некоторые из спарклайнов имеют меньше столбцов, чем другие, то на месте отсутствующих данных они будут отображать пустое пространство.  
  
7.  Нажмите кнопку **ОК**.  
  
8.  Нажмите кнопку **Выполнить** для повторного предварительного просмотра отчета.  
  
Теперь все столбцы в каждом спарклайне выровнены со столбцами в других спарклайнах, и их высота является относительной.  
  
![report-builder-sparkline-aligned](../reporting-services/media/report-builder-sparkline-aligned.png)
  
## <a name="Width"></a>7. (Необязательно) Изменение ширины столбцов  
По умолчанию в каждой ячейке таблицы есть текстовое поле. Текстовое поле расширяется вниз, чтобы вместить введенный текст при подготовке страницы к просмотру. В отчете, готовом для просмотра, каждая строка расширяется по высоте самого высокого текстового поля в строке. Высота строки в области конструктора не влияет на высоту строки в отчете, готовом для просмотра.  
  
Чтобы уменьшить высоту каждой строки, увеличьте ширину столбца, чтобы ожидаемое содержимое текстовых полей умещалось в одну строку.  
  
### <a name="to-change-the-width-of-columns"></a>Изменение ширины столбцов  
  
1.  Щелкните **Конструктор** для возврата в режим конструктора.  
  
2.  Щелкните таблицу, чтобы сбоку и сверху от нее появились серые полоски. Это маркеры столбцов и строк.
  
3.  Установите указатель на линии раздела между маркерами столбцов, чтобы курсор принял вид двойной стрелки. Перетащите столбец **Продукт** , чтобы название продукта отображалось в одной строке.  
  
4.  Нажмите кнопку **Запуск** , чтобы просмотреть отчет и проверить, достаточно ли он широк.  
  
## <a name="Title"></a>8. (Необязательно) Добавление заголовка отчета  
Заголовок отчета отображается в верхней части отчета. Можно поместить заголовок отчета в верхнем колонтитуле или, если в отчете колонтитулы не используются, в текстовом поле в верхней части текста отчета. В данном учебнике это текстовое поле автоматически размещается в верхней части текста отчета.  
  
Текст можно улучшить, применяя к отдельным символам различные стили шрифтов, размеры и цвета. Дополнительные сведения см. в разделе [Форматирование текста в текстовом поле (построитель отчетов и службы SSRS)](../reporting-services/report-design/format-text-in-a-text-box-report-builder-and-ssrs.md).  
  
### <a name="to-add-a-report-title"></a>Добавление заголовка отчета  
  
1.  В области конструктора щелкните ссылку **Щелкните, чтобы добавить заголовок**.  
  
2.  Введите фразу **Продажи по дате**и щелкните вне текстового поля.  
  
3.  Выберите текстовое поле, содержащее текст **Продажи продуктов**.  
  
4.  На вкладке "Главная" в группе **Шрифт** в поле **Цвет** выберите значение **Сине-зеленый**.  
  
7.  Выберите **Полужирное**начертание.  
  
8.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
## <a name="Save"></a>9. Сохранение отчета  
Сохраните отчет на сервере отчетов или на своем компьютере. Если не сохранить отчет на сервере отчетов, некоторые функции служб [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] , в том числе элементы отчета и вложенные отчеты, будут недоступны.  
  
### <a name="to-save-the-report-on-a-report-server"></a>Сохранение отчета на сервере отчетов  
  
1.  Нажмите кнопку **Построитель отчетов** и выберите **Сохранить как**.  
  
2.  Нажмите кнопку **Последние сайты и серверы**.  
  
3.  Выберите или введите имя сервера отчетов, для которого существует разрешение на сохранение отчетов.  
  
    Появится сообщение «Соединение с сервером отчетов». После того как соединение установлено, пользователю представляется содержимое папки, заданной администратором сервера отчетов как место по умолчанию для отчетов.  
  
4.  В поле **Имя**замените имя по умолчанию фразой **Product Sales**.  
  
5.  Нажмите кнопку **Сохранить**.  
  
Отчет будет сохранен на сервере отчетов. Имя сервера отчетов, с которым установлено соединение, будет отображено в строке состояния в нижней части окна.  
  
### <a name="to-save-the-report-on-your-computer"></a>Сохранение отчета на компьютере  
  
1.  Нажмите кнопку **Построитель отчетов** и выберите **Сохранить как**.  
  
2.  Перейдите на **Рабочий стол**, откройте папку **Мои документы**или **Мой компьютер**и перейдите в папку, в которую нужно сохранить отчет.  
  
3.  В поле **Имя**замените имя по умолчанию фразой **Product Sales**.  
  
4.  Нажмите кнопку **Сохранить**.  
  
## <a name="next-steps"></a>Следующие шаги  

На этом заканчивается учебник по созданию табличного отчета со спарклайн графиками. Дополнительные сведения о спарклайнах см. в разделе [спарклайны и гистограммы](../reporting-services/report-design/sparklines-and-data-bars-report-builder-and-ssrs.md).  
  
[Учебники по построителю отчетов](../reporting-services/report-builder-tutorials.md) 
[Построитель отчетов в SQL Server 2016](../reporting-services/report-builder/report-builder-in-sql-server-2016.md)  

Дополнительные вопросы? [Попробуйте задать вопрос на форуме служб Reporting Services](http://go.microsoft.com/fwlink/?LinkId=620231)

