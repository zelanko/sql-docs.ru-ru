---
title: Учебник. Добавление линейчатой диаграммы к отчету (построитель отчетов) | Документы Майкрософт
description: Узнайте, как создать отчет Reporting Services с разбивкой на страницы, содержащий гистограмму с рядом в виде набора вертикальных столбцов, сгруппированных по категории.
ms.date: 06/15/2016
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: reporting-services
ms.topic: conceptual
ms.assetid: 6956ebd6-0217-4087-a4fa-5cc1c3804691
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 1d650fd4b93df758ccaa39d716cf122c66adf7ab
ms.sourcegitcommit: 216f377451e53874718ae1645a2611cdb198808a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2020
ms.locfileid: "87245701"
---
# <a name="tutorial-add-a-bar-chart-to-your-report-report-builder"></a>Руководство по Добавление линейчатой диаграммы в отчет (построитель отчетов)
В этом учебнике с помощью мастера в [!INCLUDE[ssRBnoversion_md](../includes/ssrbnoversion.md)] будет создана линейчатая диаграмма в отчете [!INCLUDE[ssRSnoversion_md](../includes/ssrsnoversion-md.md)] с разбивкой на страницы. Затем вы добавите фильтр и расширите возможности диаграммы. 

В линейчатых диаграммах категории данных отображаются по горизонтали. Это может использоваться для:  
  
-   улучшения читаемости длинных имен категорий;  
-   облегчения восприятия времени, отображаемого в виде значений;   
-   сравнение относительных значений нескольких рядов.  
  
На рисунке ниже показана создаваемая линейчатая диаграмма, на которой приводятся данные продаж за 2014 и 2015 годы для пяти менеджеров по продажам с максимальными объемами продаж, которые расположены в порядке убывания объема продаж за 2015 год.  
  
![report-builder-bar-chart](../reporting-services/media/report-builder-bar-chart.png) 
  
 
> [!NOTE]  
> В этом учебнике шаги работы с мастером объединены в одну процедуру. Пошаговые инструкции по переходу к серверу отчетов, созданию набора данных и выбору источника данных см. в первом учебнике этой серии: [Учебник. Создание простого табличного отчета (построитель отчетов)](../reporting-services/tutorial-creating-a-basic-table-report-report-builder.md).  
  
На изучение этого руководства потребуется примерно 15 минут.  
  
## <a name="requirements"></a>Требования  
Дополнительные сведения о требованиях см. в разделе [Предварительные условия для использования учебников (построитель отчетов)](../reporting-services/prerequisites-for-tutorials-report-builder.md).  
  
## <a name="1-create-a-chart-report-from-the-chart-wizard"></a><a name="Chart"></a>1. Создание отчета с диаграммой с помощью мастера диаграмм  
В этом разделе вы создадите внедренный набор данных, выберете общий источник данных и создадите линейчатую диаграмму с помощью мастера диаграмм.  
  
> [!NOTE]  
> В этом учебнике запрос уже содержит значения данных, поэтому внешний источник данных не требуется. В связи с этим запрос получается весьма длинным. В рабочей среде запрос не будет содержать данные. Этот запрос содержит данные только в учебных целях.  
  
1.  [Запустите построитель отчетов](../reporting-services/report-builder/start-report-builder.md) с веб-портала [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] , сервера отчетов в режиме интеграции с SharePoint или компьютера.  
  
     Откроется диалоговое окно **Приступая к работе** .  
  
     ![Начало работы с построителем отчетов](../reporting-services/media/rb-getstarted.png "Начало работы с построителем отчетов")  
  
     Если диалоговое окно **Приступая к работе** не отображается, щелкните **Файл** >**Создать**. Диалоговое окно **Создать отчет или набор данных** содержит большую часть того же содержимого, что и диалоговое окно **Приступая к работе** . 
      
2.  Убедитесь, что на левой панели выбран **Новый отчет** .  
  
3.  На правой панели выберите **Мастер диаграмм**.  
  
4.  На странице **Выбор набора данных** нажмите кнопку **Создать набор данных**, а затем кнопку **Далее**.  
  
5.  На странице **Выбор соединения с источником данных** выберите существующий источник данных или перейдите к серверу отчетов и выберите источник данных, а затем нажмите кнопку **Далее**. Может потребоваться указать имя пользователя и пароль.  
  
    > [!NOTE]  
    > При наличии необходимых разрешений выбор источника данных не имеет существенного значения. Этот источник данных не будет использоваться для получения данных. Дополнительные сведения см. в разделе [Альтернативные способы создания подключения к данным &#40;построитель отчетов&#41;](../reporting-services/alternative-ways-to-get-a-data-connection-report-builder.md).  
  
6.  На странице **Проектирование запроса** нажмите кнопку **Изменить как текст**.  
  
7.  На панель запроса вставьте следующий запрос:  
  
    ```  
    SELECT 'Luis' as FirstName, 'Alverca' as LastName, CAST(170000.00 AS money) AS SalesYear2015, CAST(150000. AS money) AS SalesYear2014  
    UNION SELECT 'Jeffrey' as FirstName, 'Zeng' as LastName, CAST(210000. AS money) AS SalesYear2015, CAST(190000. AS money) AS SalesYear2014  
    UNION SELECT 'Houman' as FirstName, 'Pournasseh' as LastName, CAST(150000. AS money) AS SalesYear2015, CAST(180000. AS money) AS SalesYear2014  
    UNION SELECT 'Robin' as FirstName, 'Wood' as LastName, CAST(75000. AS money) AS SalesYear2015, CAST(175000. AS money) AS SalesYear2014  
    UNION SELECT 'Daniela' as FirstName, 'Guaita' as LastName,  CAST(170000. AS money) AS SalesYear2015, CAST(175000. AS money) AS SalesYear2014  
    UNION SELECT 'John' as FirstName, 'Yokim' as LastName, CAST(160000. AS money) AS SalesYear2015, CAST(195000. AS money) AS SalesYear2014  
    UNION SELECT 'Delphine' as FirstName, 'Ribaute' as LastName, CAST(180000. AS money) AS SalesYear2015, CAST(205000. AS money) AS SalesYear2014  
    UNION SELECT 'Robert' as FirstName, 'Hernady' as LastName, CAST(140000. AS money) AS SalesYear2015, CAST(180000. AS money) AS SalesYear2014  
    UNION SELECT 'Tanja' as FirstName, 'Plate' as LastName, CAST(150000. AS money) AS SalesYear2015, CAST(160000. AS money) AS SalesYear2014  
    UNION SELECT 'David' as FirstName, 'Bradley' as LastName, CAST(210000. AS money) AS SalesYear2015, CAST(180000. AS money) AS SalesYear2014  
    UNION SELECT 'Michal' as FirstName, 'Jaworski' as LastName, CAST(175000. AS money) AS SalesYear2015, CAST(220000. AS money) AS SalesYear2014  
    UNION SELECT 'Chris' as FirstName, 'Ashton' as LastName, CAST(195000. AS money) AS SalesYear2015, CAST(205000. AS money) AS SalesYear2014  
    UNION SELECT 'Pongsiri' as FirstName, 'Hirunyanitiwatna' as LastName, CAST(175000. AS money) AS SalesYear2015, CAST(215000. AS money) AS SalesYear2014  
    UNION SELECT 'Brian' as FirstName, 'Burke' as LastName, CAST(187000. AS money) AS SalesYear2015, CAST(207000. AS money) AS SalesYear2014  
    ```  
  
8.  Нажмите кнопку "Выполнить" ( **!** ), чтобы просмотреть данные, на основе которых будет создана диаграмма (необязательно).  
  
9. Щелкните **Далее**.  
  
## <a name="2-create-a-bar-chart"></a><a name="ChartType"></a>2. Создание линейчатой диаграммы  
 
1.  На странице **Выбор типа диаграммы** в качестве типа диаграммы по умолчанию задана гистограмма.  
  
2.  Нажмите кнопку **Линейчатая**, а затем кнопку **Далее**.  
  
    На странице **Расположение полей диаграммы** на панели **Доступные поля** есть четыре поля: FirstName, LastName, SalesYear2015 и SalesYear2014.  
  
3.  Перетащите поле «LastName» на панель «Категории».  
  
4.  Перетащите поле SalesYear2015 в область "Значения". Поле SalesYear2015 представляет объем продаж всех менеджеров по продажам за 2015 год. На панели «Значения» отображается выражение `[Sum(SalesYear2015)]` , поскольку в диаграмме отображается агрегат для каждого из продуктов.  
  
5.  Перетащите поле SalesYear2014 в область "Значения" ниже поля SalesYear2015. Поле SalesYear2014 представляет объем продаж всех менеджеров по продажам за 2014 год.  
  
6.  Щелкните **Далее**.  
  
7.  Нажмите кнопку **Готово**.  
  
    Диаграмма добавляется в область конструктора. Обратите внимание на то, что в новой линейчатой диаграмме приводится образец данных. Чтобы дать общее представление о том, как будет выглядеть отчет, в условных обозначениях указано "Фамилия А", "Фамилия Б" и т. д., а не имена людей. 
  
9. Щелкните диаграмму, чтобы отобразить ее маркеры. Перетащите правый нижний угол диаграммы вниз, чтобы увеличить ее размер. Обратите внимание, что рабочая область конструирования увеличивается при перетаскивании. 
  
10. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
На линейчатой диаграмме показаны данные продаж всех менеджеров за 2014 и 2015 годы. Длина линии на диаграмме соответствует общему значению объема продаж.  
  
## <a name="3-display-all-the-names-on-the-vertical-axis"></a><a name="AllValues"></a>3. Отображение всех имен на вертикальной оси  
По умолчанию на вертикальной оси отображаются только определенные значения. Диаграмму можно изменить для отображения всех категорий.  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Щелкните правой кнопкой мыши вертикальную ось и выберите пункт **Свойства вертикальной оси**.  
  
3.  В области **Диапазон и интервал оси**в поле **Интервал** введите значение **1**.  
  
4.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
5.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
> [!NOTE]  
> Если имена менеджеров по продажам на вертикальной оси невозможно прочесть, можно увеличить высоту диаграммы или изменить параметры форматирования для меток оси.  
  
### <a name="display-last-name-and-first-name-on-vertical-axis"></a><a name="CategoryExpression"></a>Отображение фамилии и имени на вертикальной оси  
Можно изменить выражение категории для отображения фамилии, после которой будет отображаться имя для всех менеджеров по продажам.  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Дважды щелкните диаграмму, чтобы отобразить панель **Данные диаграммы** .  
  
3.  Щелкните правой кнопкой мыши поле [LastName] в области **Группы категорий** и выберите пункт **Свойства группы категорий**.  
  
4.  В поле «Метка» нажмите кнопку «Выражение» (Fx).  
  
5.  Введите следующее выражение: `=Fields!LastName.Value & ", " & Fields!FirstName.Value`  
  
    В выражении будут объединены фамилия, запятая и имя.  
  
6.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
7.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
8.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
Если фамилии не отображаются при выполнении отчета, то данные можно обновить вручную. Оставаясь в режиме предварительного просмотра, на вкладке **Выполнить** в группе **Навигация** нажмите кнопку **Обновить**.  
  
> [!NOTE]  
> Если имена менеджеров по продажам на вертикальной оси невозможно прочесть, можно увеличить высоту диаграммы или изменить параметры форматирования для меток оси.  
  
## <a name="4-change-the-sort-order-on-the-vertical-axis"></a><a name="Sort"></a>4. Изменение порядка сортировки по вертикальной оси  
При сортировке данных на диаграмме изменяется порядок значений на осях категории.  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Дважды щелкните диаграмму, чтобы отобразить панель **Данные диаграммы** .  
  
3.  Щелкните правой кнопкой мыши поле [LastName] в области **Группы категорий** и выберите пункт **Свойства группы категорий**.  
  
4.  Щелкните **Сортировка**. На странице **Изменение параметров сортировки** отображается список выражений фильтров. По умолчанию в этом списке имеется одно выражение сортировки, идентичное исходному выражению группы категорий.  
  
5.  В поле **Сортировать по**выберите **[SalesYear2015]** .  
  
6.  В списке **Порядок** выберите **От А до Я** , чтобы имена приводились в порядке от наибольшего до наименьшего объема продаж в 2015 году.
  
7.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
10. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
Имена на горизонтальной оси сортируются в порядке от наибольшего до наименьшего объема продаж в 2015 году (первым в списке будет имя **Zeng** ).  
  
## <a name="5-move-the-legend"></a><a name="Legend"></a>5. Перемещение условных обозначений  
Чтобы улучшить читаемость значений диаграммы, можно переместить ее условные обозначения. Например, в линейчатой диаграмме, в которой столбцы отображаются горизонтально, можно изменить положение условных обозначений, чтобы они находились выше или ниже области диаграммы. В результате для столбцов выделяется больше места.  
  
#### <a name="to-display-the-legend-below-the-chart-area-of-a-bar-chart"></a>Вывод условных обозначений под областью линейчатой диаграммы  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Щелкните правой кнопкой мыши условные обозначения диаграммы.  
  
3.  Выберите **Свойства условных обозначений**.  
  
4.  Выберите другое значение для параметра **Положение условных обозначений**. Например, можно выбрать параметр, соответствующий расположению посередине в нижней части.  
  
    Если условные обозначения перемесить в верхнюю или нижнюю часть диаграммы, их макет изменится с вертикального на горизонтальный. Можно выбрать другой макет в раскрывающемся списке **Макет** .  
  
5.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
6.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
## <a name="6-title-the-chart"></a><a name="ChartTitle"></a>6. Задание заголовка для диаграммы  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  В верхней части диаграммы выделите слова **Заголовок диаграммы** и введите **Продажи в 2014 и 2015 годах**.  
  
3.  Выделив заголовок, на панели "Свойства" задайте для свойства **Цвет** значение **Черный** , а для свойства **FontSize** значение **12 пт**. 
  
4.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
## <a name="7-format-and-label-the-horizontal-axis"></a><a name="Horizontal"></a>7. Форматирование и задание меток для горизонтальной оси  
По умолчанию по горизонтальной оси отображаются значения в общем формате, который автоматически масштабируется в соответствии с размером диаграммы. Формат можно изменить на денежный.  
   
1.  Переключитесь в режим конструктора отчета.  
  
2.  Щелкните горизонтальную ось в нижней части диаграммы, чтобы выбрать ее.  
  
3.  На вкладке **Главная** в группе **Число** нажмите кнопку **Денежный**. Метки на горизонтальной оси изменятся на валюту.  
  
3.  (Необязательно) Удалите десятичные знаки. Рядом с кнопкой **Денежный** дважды нажмите кнопку **Уменьшить число десятичных разрядов** .  
  
4.  Щелкните правой кнопкой мыши горизонтальную ось и выберите пункт **Свойства горизонтальной оси**.  
  
5.  На вкладке **Число** выберите **Показывать значения в тысячах**.  
  
6.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  

8.  Щелкните правой кнопкой мыши горизонтальную ось и выберите пункт **Отобразить заголовок оси**.
  
7.  В поле **Заголовок оси** введите **Продажи в тысячах** и нажмите клавишу ВВОД.  

    >**Примечание.** В процессе ввода поле заголовка оси отображается на вертикальной оси. Однако после нажатия клавиши ВВОД оно перемещается на горизонтальную ось.
  
9. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
В отчете объем продаж отображается по горизонтальной оси в виде валюты в тысячах без десятичных знаков.  
  
## <a name="8-add-a-filter-to-display-the-top-five-values"></a><a name="Filter"></a>8. Добавление фильтра для отображения 5 максимальных значений  
К диаграмме можно добавить фильтр, чтобы выбрать данные в наборе данных для включения или исключения из диаграммы.   
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Дважды щелкните диаграмму, чтобы отобразить панель **Данные диаграммы** .  
  
3.  Щелкните правой кнопкой мыши поле [LastName] в области **Группы категорий** и выберите пункт **Свойства группы категорий**.  
  
4.  Перейдите на вкладку **Фильтры**. На странице **Изменение фильтров** может отображаться список критериев фильтров. По умолчанию этот список пустой.  
  
5.  Нажмите кнопку **Добавить**. Появится новый пустой фильтр.  
  
6.  В поле **Выражение**введите **[Sum(SalesYear2015)]** . При этом создается базовое выражение `=Sum(Fields!SalesYear2015.Value)`, которое можно просмотреть, нажав кнопку **fx** .  
  
7.  Убедитесь в том, что типом данных является **Текст**.  
  
8.  В раскрывающемся списке **Оператор**выберите вариант **Первые N** .  
  
9. В поле **Значение**введите следующее выражение: **=5**  
  
10. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
11. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
Если к результатам не применяется фильтр при выполнении отчета, данные можно обновить вручную. На вкладке **Выполнить** в группе **Навигация** нажмите кнопку **Обновить**.  
  
На диаграмме отобразятся имена пяти первых менеджеров по продажам из данных продаж за 2015 год.  
  
## <a name="9-add-a-report-title"></a><a name="Title"></a>9. Добавление заголовка отчета  
  
1.  В области конструктора щелкните ссылку **Щелкните, чтобы добавить заголовок**.  
  
2.  Введите **Линейчатая диаграмма продаж**, нажмите клавишу ВВОД и введите **Пять менеджеров по продажам с наибольшим объемом продаж за 2015 г.** , после чего он будет выглядеть следующим образом:  
  
    **Линейчатая диаграмма продаж**  
  
    **Пять менеджеров по продажам с наибольшим объемом продаж за 2015 г.**  
  
3.  Выберите **Линейчатая диаграмма продаж**и нажмите кнопку **Полужирный** .  
  
4.  Выберите **Пять менеджеров по продажам с наибольшим объемом продаж за 2015 г.** и в разделе **Шрифт** на вкладке **Главная** выберите размер шрифта **10**.  
  
5.  Может потребоваться увеличить высоту текстового поля "Заголовок" и перетащить верхний край линейчатой диаграммы ниже для соответствия размерам двух строк текста (необязательно).  
  
    Данный заголовок появится в верхней части отчета. При отсутствии верхнего колонтитула страницы элементы в верхней части текста отчета выполняют роль заголовка отчета.  
  
6.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
## <a name="10-save-the-report"></a><a name="Save"></a>10. Сохранение отчета  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Щелкните **Файл** > **Сохранить как**.  
  
3.  В поле **Имя**введите **Линейчатая диаграмма продаж**.  

    Отчет можно сохранить на своем компьютере или на сервере отчетов.
  
4.  Выберите команду **Сохранить**.   
  
## <a name="next-steps"></a>Next Steps  
Учебник «Добавление линейчатой диаграммы в отчет» успешно завершен. Дополнительные сведения о диаграммах см. в разделах [Диаграммы](../reporting-services/report-design/charts-report-builder-and-ssrs.md) и [Линейчатые диаграммы](../reporting-services/report-design/bar-charts-report-builder-and-ssrs.md).  
  
## <a name="see-also"></a>См. также:  
[Учебники по построителю отчетов](../reporting-services/report-builder-tutorials.md)  
[Построитель отчетов в SQL Server](../reporting-services/report-builder/report-builder-in-sql-server-2016.md)  
  

