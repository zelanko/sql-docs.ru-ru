---
title: "Учебник. Добавление в отчет ключевого показателя эффективности (построитель отчетов) | Документы Майкрософт"
ms.custom: 
ms.date: 06/15/2016
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.service: 
ms.component: reporting-services
ms.reviewer: 
ms.suite: pro-bi
ms.technology: 
ms.tgt_pltfrm: 
ms.topic: get-started-article
applies_to: SQL Server 2016
ms.assetid: 1bf77859-0b33-4f40-abaf-ebeeb6ebb1f8
caps.latest.revision: "13"
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.workload: Inactive
ms.openlocfilehash: 4c0e21bcd1d4695aaf7a55891c7b6d3c9231cdd7
ms.sourcegitcommit: 7e117bca721d008ab106bbfede72f649d3634993
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/09/2018
---
# <a name="tutorial-adding-a-kpi-to-your-report-report-builder"></a>Учебник. Добавление в отчет ключевого показателя эффективности (построитель отчетов)
В этом учебнике по [!INCLUDE[ssRBnoversion_md](../includes/ssrbnoversion-md.md)] вы добавите ключевой показатель эффективности к отчету [!INCLUDE[ssRSnoversion_md](../includes/ssrsnoversion-md.md)] с разбивкой на страницы.  

Ключевые показатели эффективности представляют собой измеримые значения, имеющие значимость для бизнеса. В данном случае ключевым показателем эффективности является сводка по продажам (по подкатегориям продуктов). Текущее состояние ключевого показателя эффективности отображается с помощью цветов, датчиков и индикаторов.
  
На приведенной ниже иллюстрации показан отчет, похожий на тот, который предстоит создать.  
  
![report-builder-kpi-report](../reporting-services/media/report-builder-kpi-report.png)
    
> [!NOTE]  
> В данном учебнике стадии работы мастера объединены в две процедуры: для создания набора данных и для создания таблиц. Пошаговые инструкции по переходу к серверу отчетов, выбору источника данных, созданию набора данных и запуску мастера см. в первом учебнике этой серии: [Учебник. Создание простого табличного отчета &#40;построитель отчетов&#41;](../reporting-services/tutorial-creating-a-basic-table-report-report-builder.md).  
  
Предполагаемое время для выполнения заданий этого учебника: 15 минут.  
  
## <a name="requirements"></a>Требования  
Дополнительные сведения о требованиях см. в разделе [Предварительные условия для использования учебников (построитель отчетов)](../reporting-services/prerequisites-for-tutorials-report-builder.md).  
  
## <a name="Table"></a>1. Создание табличного отчета и набора данных с помощью мастера таблицы или матрицы  
В этом разделе вы выберете общий источник данных, создадите внедренный набор данных и отобразите данные в таблице.  
 
### <a name="to-create-a-table-with-an-embedded-dataset"></a>Создание таблицы с внедренным набором данных  
  
1.  [Запустите построитель отчетов](../reporting-services/report-builder/start-report-builder.md) с компьютера, веб-портала [!INCLUDE[ssRSnoversion_md](../includes/ssrsnoversion-md.md)] или сервера в режиме интеграции с SharePoint.  
  
    Откроется диалоговое окно **Создать отчет или набор данных** .  
  
    Если диалоговое окно **Новый отчет или набор данных** не появилось, в меню **Файл** выберите команду **Создать**.  
  
2.  Убедитесь, что на левой панели выбран **Новый отчет** .  
  
3.  На панели справа выберите **Мастер таблицы или матрицы**.  
  
4.  На странице **Выбор набора данных** выберите **Создать набор данных**.  
  
5.  Нажмите кнопку **Далее**.  
  
6.  На странице **Выберите соединение с источником данных** выберите существующий источник данных или перейдите к серверу отчетов и выберите источник данных. Если отсутствуют доступные источники данных или доступ к серверу отчетов, можно воспользоваться внедренным источником данных. Дополнительные сведения см. в разделе [Учебник. Создание простого табличного отчета (построитель отчетов)](../reporting-services/tutorial-creating-a-basic-table-report-report-builder.md).  
  
7.  Нажмите кнопку **Далее**.  
  
8.  На странице **Проектирование запроса** нажмите кнопку **Изменить как текст**.  
  
9. Скопируйте и вставьте на панели запросов следующий запрос:  

    > [!NOTE]  
    > В этом учебнике запрос уже содержит значения данных, поэтому внешний источник данных не требуется. В связи с этим запрос получается весьма длинным. В рабочей среде запрос не будет содержать данные. Этот запрос содержит данные только в учебных целях.  
  
    ```  
    SELECT CAST('2015-01-05' AS date) as SalesDate, 'Accessories' as Subcategory,   
       'Carrying Case' as Product, CAST(16996.60 AS money) AS Sales, 68 as Quantity  
    UNION SELECT CAST('2015-01-06' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Tripod' as Product, CAST(1350.00 AS money) AS Sales, 18 as Quantity  
    UNION SELECT CAST('2015-01-11' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Lens Adapter' as Product, CAST(1147.50 AS money) AS Sales, 17 as Quantity  
    UNION SELECT CAST('2015-01-05' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Mini Battery Charger' as Product, CAST(1056.00 AS money) AS Sales, 44 as Quantity  
    UNION SELECT CAST('2015-01-06' AS date) as SalesDate,  'Accessories' as Subcategory,  
       'Telephoto Conversion Lens' as Product, CAST(1380.00 AS money) AS Sales, 18 as Quantity  
    UNION SELECT CAST('2015-01-06' AS date) as SalesDate,'Accessories' as Subcategory,    
       'USB Cable' as Product, CAST(780.00 AS money) AS Sales, 26 as Quantity  
    UNION SELECT CAST('2015-01-08' AS date) as SalesDate, 'Accessories' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(3798.00 AS money) AS Sales, 9 as Quantity  
    UNION SELECT CAST('2015-01-09' AS date) as SalesDate, 'Camcorders' as Subcategory,   
       'Business Videographer' as Product, CAST(10400.00 AS money) AS Sales, 13 as Quantity  
    UNION SELECT CAST('2015-01-10' AS date) as SalesDate, 'Camcorders' as Subcategory,   
       'Social Videographer' as Product, CAST(3000.00 AS money) AS Sales, 60 as Quantity  
    UNION SELECT CAST('2015-01-11' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Advanced Digital' as Product, CAST(7234.50 AS money) AS Sales, 39 as Quantity  
    UNION SELECT CAST('2015-01-07' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Compact Digital' as Product, CAST(10836.00 AS money) AS Sales, 84 as Quantity  
    UNION SELECT CAST('2015-01-08' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Consumer Digital' as Product, CAST(2550.00 AS money) AS Sales, 17 as Quantity  
    UNION SELECT CAST('2015-01-05' AS date) as SalesDate, 'Digital' as Subcategory,   
       'Slim Digital' as Product, CAST(8357.80 AS money) AS Sales, 44 as Quantity  
    UNION SELECT CAST('2015-01-09' AS date) as SalesDate, 'Digital SLR' as Subcategory,   
       'SLR Camera 35mm' as Product, CAST(18530.00 AS money) AS Sales, 34 as Quantity  
    UNION SELECT CAST('2015-01-07' AS date) as SalesDate, 'Digital SLR' as Subcategory,   
       'SLR Camera' as Product, CAST(26576.00 AS money) AS Sales, 88 as Quantity  
    ```  
  
10. На панели инструментов конструктора запросов нажмите кнопку "Выполнить" (**!**).

11. Нажмите кнопку **Далее**.  
  
## <a name="CompleteWizard"></a>2. Упорядочение данных и выбор макета в мастере  
Мастер таблиц или матриц предоставляет начальный макет для отображения данных. Панель предварительного просмотра в мастере позволяет визуализировать результат группирования данных до завершения конструирования таблицы или матрицы.  
  
### <a name="to-organize-data-into-groups-and-choose-a-layout"></a>Разбиение данных по группам и выбор макета 
  
1.  На странице "Размещение полей" перетащите поле "Продукт" в область **Значения**.  
  
2.  Перетащите поле "Количество" в область **Значения** и поместите ниже поля "Продукт".  
  
    Сводные значения для поля Quantity вычисляются с помощью функции Sum, которая является функцией по умолчанию для вычисления сводных значений числовых полей.  
  
3.  Перетащите поле "Продажи" в область **Значения** и поместите ниже поля "Количество".  
  
    Шаги 1, 2 и 3 задают данные, отображаемые в таблице.  
  
4.  Перетащите поле SalesDate в область **Группы строк**.  
  
5.  Перетащите поле "Подкатегория" в область **Группы строк** и поместите его ниже поля SalesDate.  
  
    Шаги 4 и 5 организуют значения полей сначала по дате, а потом по всем продажам для данной даты.  
  
6.  Нажмите кнопку **Далее**.  
  
    При выполнении отчета в таблице отображается каждая дата, все заказы для каждой даты и все продукты, количества и итоги по продажам для каждого заказа.  
  
7.  Убедитесь в том, что на странице "Выбор макета" в области **Параметры**выбран параметр **Показывать подытоги и общие итоги** .  
  
8.  Убедитесь в том, что выбран параметр **Заблокированный, подытог ниже** .  
  
9. Снимите флажок **Развернуть или свернуть группы**.  
  
    В описываемом здесь отчете не используется функция углубленной детализации, которая позволяет пользователю разворачивать родительскую групповую иерархию, чтобы отобразить строки дочерней группы и строки подробностей.  
  
10. Нажмите кнопку **Далее**.  
  
11. Нажмите кнопку **Готово**.  
  
      Таблица добавляется в область конструктора. Таблица содержит пять столбцов и пять строк. Панель "Группы строк" содержит три группы строк: SalesDate, Subcategory и Details. Подробные данные — это все данные, которые извлекаются с помощью запроса к набору данных. Область "Группы столбцов" пуста.  
      
      ![report-builder-kpi-row-groups](../reporting-services/media/report-builder-kpi-row-groups.png)
  
12. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
Для каждого продукта, проданного за указанную дату, в таблице отображается название этого продукта, проданное количество и сумма продаж. Данные упорядочиваются сначала по дате продажи, а потом по подкатегории. 

![report-builder-kpi-basic-table](../reporting-services/media/report-builder-kpi-basic-table.png)
    
### <a name="format-dates-and-currency"></a>Форматирование дат и денежных единиц
Давайте расширим столбцы и зададим формат для дат и денежных единиц.

1. Щелкните **Конструктор** для переключения обратно в режим конструктора.

2. Названия продуктов могут занимать больше места. Чтобы расширить столбец "Продукт", выделите всю таблицу и перетащите правый край маркера столбца в верхней части столбца "Продукт".

3. Нажмите клавишу CTRL, а затем выделите четыре ячейки, содержащие [Sum(Продажи)].

4. На вкладке **Главная** выберите **Число** > **Валюта**. Ячейки изменятся, отображая содержимое в формате валюты.

   Если в качестве региональных настроек компьютера выбран "Английский (США)", текстом по умолчанию образца будет [$12,345.00]. Если пример денежного значения не отображается, в группе **Числа** щелкните **Стили заполнителя** > **Образцы значений**.
    
    ![report-builder-placeholder-value-button](../reporting-services/media/report-builder-placeholder-value-button.png)

5. На вкладке **Главная** в группе **Число** нажмите два раза кнопку **Уменьшить разрядность** , чтобы суммы в долларах отображались без центов (необязательно).

6. Щелкните ячейку, содержащую [SalesDate].

6. В группе **Число** выберите **Дата**.

   В ячейке будет содержаться дата [1/31/2000]. 

12. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
 
![report-builder-kpi-format-numbers](../reporting-services/media/report-builder-kpi-format-numbers.png)

## <a name="BackgroundColors"></a>3. Отображение ключевого показателя эффективности с помощью цветов фона  
Цвета фона можно задавать в виде выражений, вычисляемых при запуске отчета.  
  
### <a name="to-display-the-present-state-of-a-kpi-by-using-background-colors"></a>Отображение текущего состояния ключевого показателя эффективности с помощью цвета фона  
  
1.  В таблице щелкните правой кнопкой мыши вторую ячейку `[Sum(Sales)]` (в строке промежуточных итогов, где отображаются продажи для подкатегории), и выберите **Свойства текстового поля**. 

    Чтобы появился пункт **Свойства текстового поля**, необходимо выделить саму ячейку, а не текст в ней. 
    
    ![report-builder-text-box-properties](../reporting-services/media/report-builder-text-box-properties.png)
  
2.  На вкладке **Заливка** нажмите кнопку **fx** рядом с параметром **Цвет заливки** и введите приведенное ниже выражение в поле **Задать выражение для: BackgroundColor** .  
  
    `=IIF(Sum(Fields!Sales.Value) >= 5000 ,"Lime", IIF(Sum(Fields!Sales.Value) < 2500, "Red","Yellow"))`  
  
     Цвет фона будет изменится на желто-зеленый для каждой ячейке, содержащей итоговую сумму `[Sum(Sales)]` , большую или равную 5000. Значения `[Sum(Sales)]` в диапазоне от 2500 до 5000 окрашены желтым цветом. Значения менее 2500 окрашены красным цветом.  
  
1.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
2.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
В строке промежуточных итогов, где отображаются продажи для подкатегории, цвет ячейки может быть красным, желтым или зеленым в зависимости от значения суммы продаж.  

![report-builder-kpi-colors](../reporting-services/media/report-builder-kpi-colors.png)
  
## <a name="Gauge"></a>4. Отображение ключевого показателя эффективности с помощью датчика  
Датчик показывает одно значение из набора данных. В этом учебнике используется горизонтальный линейный датчик, так как его форма и простота облегчают его чтение, даже когда он имеет небольшой размер и помещен в ячейку таблицы. Дополнительные сведения см. в разделе [Датчики (построитель отчетов и службы SSRS)](../reporting-services/report-design/gauges-report-builder-and-ssrs.md).  
  
### <a name="to-display-the-present-state-of-a-kpi-using-a-gauge"></a>Отображение текущего состояния ключевого показателя эффективности с помощью датчика  
  
1.  Вернитесь в режим конструктора.  
  
2.  В таблице щелкните правой кнопкой мыши маркер столбца "Продажи" и выберите пункт **Вставить столбец** > **Справа**. В таблицу добавится новый столбец.  

    ![report-builder-kpi-insert-column](../reporting-services/media/report-builder-kpi-insert-column.png)
  
3.  В заголовке столбца введите **Линейный ключевой показатель эффективности** .  
  
4.  На вкладке **Вставка** щелкните **Визуализации данных** > **Датчик**, а затем щелкните рабочую область конструирования вне таблицы.   
  
5.  В диалоговом окне **Выбор типа датчика** выберите первый тип линейного датчика ( **Горизонтальный**).  
  
6.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
    В область конструктора добавится датчик.  
  
7.  Из набора данных в области "Данные отчета" перетащите поле `Sales` в датчик. Откроется панель **Данные датчика** .  
  
    Когда поле `Sales` перетаскивается на датчик, выполняется переход к списку **Значения** , и значение поля вычисляется с помощью встроенной функции Sum.  
   
    ![report-builder-kpi-drag-sales-field](../reporting-services/media/report-builder-kpi-drag-sales-field.png)
   
9. На панели **Данные датчика** щелкните стрелку рядом с пунктом **LinearPointer1** > **Свойства указателя**.  
  
10. В диалоговом окне **Свойства указателя-линии** на вкладке **Параметры указателя** в поле **Тип указателя** должно быть выбрано значение **Черта**. 
 
11. Нажмите кнопку **ОК**.  
  
12. Щелкните правой кнопкой мыши шкалу датчика и выберите пункт **Свойства шкалы**.  
  
13. В диалоговом окне **Свойства линейной шкалы** на вкладке **Общие** выберите для параметра **Максимум** значение 25 000.  

    > [!NOTE]  
    > Вместо константы (например, 25 000) можно использовать выражение для динамического вычисления значения параметра **Максимум** . Оно является агрегатным выражением агрегатной функции и выглядит аналогично выражению `=Max(Sum(Fields!Sales.value), "Tablix1")`.  

14. На вкладке **Метки** установите флажок **Скрыть метки шкалы**.

15. Нажмите кнопку **ОК**.
  
14. Перетащите датчик в таблицу во вторую пустую ячейку столбца "Линейный ключевой показатель эффективности" в строке, в которой приводится подытог продаж для поля `Subcategory` (рядом с полем, в которое была добавлена формула фонового цвета).  
  
    > [!NOTE]  
    > Возможно, придется изменить размер столбца, чтобы горизонтальный линейный датчик соответствовал размеру ячейки. Чтобы изменить размер столбца, выделите таблицу и перетащите маркеры столбца. Размер рабочей области конструирования изменится в соответствии с размером таблицы.  
  
15. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
    Горизонтальная длина зеленой черты датчика изменяется в зависимости от значения ключевого показателя эффективности.  
  
![report-builder-linear-kpi](../reporting-services/media/report-builder-linear-kpi.png) 
  
## <a name="Indicator"></a>5. Отображение ключевого показателя эффективности с помощью индикатора  
Индикаторы — это небольшие простые датчики, позволяющие с первого взгляда получить представление о значениях данных. Из-за своего размера и простоты индикаторы часто используются в таблицах и матрицах. Дополнительные сведения см. в разделе [Индикаторы (построитель отчетов и службы SSRS)](../reporting-services/report-design/indicators-report-builder-and-ssrs.md).  
  
### <a name="to-display-the-present-state-of-a-kpi-using-an-indicator"></a>Отображение текущего состояния ключевого показателя эффективности с помощью индикатора  
  
1.  Переключитесь в режим конструктора.  
  
2.  В таблице щелкните правой кнопкой мыши маркер столбца "Линейный ключевой показатель эффективности", который был добавлен в последней процедуре, и выберите пункт **Вставить столбец** > **Справа**. В таблицу добавится новый столбец.  
  
3.  В заголовке столбца введите **Ключевой показатель эффективности: стоп-сигналы** .  
  
4.  Щелкните ячейку подытога для подкатегории рядом с линейным датчиком, добавленным в последней процедуре.  
  
5.  На вкладке **Вставка** в группе **Визуализации данных** дважды щелкните элемент **Индикатор**.  
  
6.  В диалоговом окне **Выбор стиля индикатора** в разделе **Фигуры**выберите первый тип фигуры **3 сигнала трафика (без обрамления)**.  
  
7.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
    Индикатор добавится в ячейку в новом столбце "Ключевой показатель эффективности: стоп-сигналы".  
  
8.  Щелкните индикатор правой кнопкой мыши и выберите пункт **Свойства индикатора**.  
  
9. На вкладке **Значения и состояния** в поле **Значение** выберите **[Sum(Значения)]**. Не изменяйте другие параметры.  
  
    По умолчанию синхронизация данных происходит в пределах области данных, а значение **Tablix1**, имя табличной области данных из отчета, отображается в поле **Область синхронизации** .  
  
    В этом отчете можно также изменить область индикатора, помещенного в ячейку подытога подкатегории, чтобы синхронизация выполнялась в поле SalesDate.  
  
11. Нажмите кнопку **ОК**.

11. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  

![report-builder-kpi-stoplight](../reporting-services/media/report-builder-kpi-stoplight.png)
  
## <a name="Title"></a>6. Добавление заголовка отчета  
Заголовок отчета отображается в верхней части отчета. Можно поместить заголовок отчета в верхнем колонтитуле или, если в отчете колонтитулы не используются, в текстовом поле в верхней части текста отчета. В этом разделе вы используете текстовое поле, которое автоматически размещается в верхней части текста отчета.  
  
Текст можно улучшить, применяя к отдельным символам различные стили, размеры и цвета шрифта. Дополнительные сведения см. в разделе [Форматирование текста в текстовом поле &#40;построитель отчетов и службы SSRS&#41;](../reporting-services/report-design/format-text-in-a-text-box-report-builder-and-ssrs.md).  
  
### <a name="to-add-a-report-title"></a>Добавление заголовка отчета  
  
1.  В области конструктора щелкните ссылку **Щелкните, чтобы добавить заголовок**.  
  
2.  Введите фразу **Ключевой показатель эффективности продаж товаров**и щелкните вне текстового поля.  
  
3.  При необходимости щелкните правой кнопкой мыши текстовое поле, содержащее фразу **Ключевой показатель эффективности продаж товаров**, выберите пункт **Свойства текстового поля**, а затем на вкладке "Шрифт" выберите нужные стили, размеры и цвета шрифта.  
  
4.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
## <a name="Save"></a>7. Сохранение отчета  
Сохраните отчет на сервере отчетов или на своем компьютере. Если не сохранить отчет на сервере отчетов, некоторые функции служб [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] , в том числе элементы отчета и вложенные отчеты, будут недоступны.  
  
### <a name="to-save-the-report-on-a-report-server"></a>Сохранение отчета на сервере отчетов  
  
1.  Нажмите кнопку **Построитель отчетов** и выберите **Сохранить как**.  
  
2.  Нажмите кнопку **Последние сайты и серверы**.  
  
3.  Выберите или введите имя сервера отчетов, для которого существует разрешение на сохранение отчетов.  
  
    Появится сообщение «Соединение с сервером отчетов». После того как соединение установлено, пользователю представляется содержимое папки, заданной администратором сервера отчетов как место по умолчанию для отчетов.  
  
4.  В поле **Имя**замените имя по умолчанию фразой **Ключевой показатель эффективности продаж товаров**.  
  
5.  Нажмите кнопку **Сохранить**.  
  
Отчет будет сохранен на сервере отчетов. Имя сервера отчетов, с которым установлено соединение, будет отображено в строке состояния в нижней части окна.  
  
### <a name="to-save-the-report-on-your-computer"></a>Сохранение отчета на компьютере  
  
1.  Нажмите кнопку **Построитель отчетов** и выберите **Сохранить как**.  
  
2.  Перейдите на **Рабочий стол**, откройте папку **Мои документы**или **Мой компьютер**и перейдите в папку, в которую нужно сохранить отчет.  
  
> [!NOTE]  
> При отсутствии доступа к серверу отчетов на **рабочем столе**откройте папку **Мои документы**или **Мой компьютер** и сохраните отчет на компьютере.  
  
1.  В поле **Имя**замените имя по умолчанию фразой **Ключевой показатель эффективности продаж товаров**.  
  
2.  Нажмите кнопку **Сохранить**.  
  
## <a name="next-steps"></a>Next Steps  
Учебник «Добавление ключевого показателя эффективности в отчет» успешно завершен. Дополнительные сведения см. в разделе:
*  [Датчики](../reporting-services/report-design/gauges-report-builder-and-ssrs.md)
* [Индикаторы](../reporting-services/report-design/indicators-report-builder-and-ssrs.md)  
  
## <a name="see-also"></a>См. также:  
* [Учебники по построителю отчетов](../reporting-services/report-builder-tutorials.md)
* [Построитель отчетов в SQL Server 2016](../reporting-services/report-builder/report-builder-in-sql-server-2016.md)  
  

