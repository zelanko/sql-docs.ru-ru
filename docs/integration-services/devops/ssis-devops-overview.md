---
title: Общие сведения о средствах DevOps для служб SQL Server Integration Services | Документация Майкрософт
description: Узнайте, как организовать непрерывную интеграцию и поставку для служб SSIS с помощью средств DevOps для служб SSIS.
ms.date: 12/06/2019
ms.topic: conceptual
ms.prod: sql
ms.prod_service: integration-services
ms.custom: ''
ms.technology: integration-services
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 619fddade48e56c28995b193776e6d13f31918ac
ms.sourcegitcommit: 48e259549f65f0433031ed6087dbd5d9c0a51398
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/07/2020
ms.locfileid: "80809717"
---
# <a name="sql-server-integration-services-ssis-devops-tools-preview"></a>Средства DevOps для служб SQL Server Integration Services (SSIS) (предварительная версия)

Расширение [Средства DevOps для служб SSIS](https://marketplace.visualstudio.com/items?itemName=SSIS.ssis-devops-tools) доступно в магазине **Azure DevOps**.

Если у вас нет организации **Azure DevOps**, сначала зарегистрируйтесь для получения [Azure Pipelines](https://docs.microsoft.com/azure/devops/pipelines/get-started/pipelines-sign-up?view=azure-devops), а затем добавьте расширение **Средства DevOps для служб SSIS** согласно [инструкциям](https://docs.microsoft.com/azure/devops/marketplace/overview?view=azure-devops&tabs=browser#add-an-extension).

**Средства DevOps для служб SSIS** включают задачу **Сборка SSIS**, задачу выпуска **Развертывание SSIS** и **задачу конфигурации каталога SSIS**.

- Задача **[Сборка SSIS](#ssis-build-task)** поддерживает сборку файлов DTPROJ с использованием модели развертывания проекта или модели развертывания пакетов.

- Задача **[Развертывание SSIS](#ssis-deploy-task)** поддерживает развертывание одного или нескольких файлов ISPAC в локальном каталоге служб SSIS и Azure-SSIS IR или файлов SSISDeploymentManifest и связанных с ними файлов в общей папке в локальной среде или Azure.

- **[Задача конфигурации каталога SSIS](#ssis-catalog-configuration-task)** поддерживает настройку папок, проектов и сред каталога SSIS с помощью файла конфигурации в формате JSON. Эта задача поддерживает следующие сценарии:
    - Папка
        - создание папки;
        - Обновление описания папки.
    - Проект
        - Настройка значения параметров (поддерживается как литеральное, так и ссылочное значение).
        - Добавление ссылок на среду.
    - Среда
        - Создание среды.
        - Изменение описания среды.
        - Создание или изменение переменной среды.

## <a name="ssis-build-task"></a>Задача сборки SSIS

![задача сборки](media/ssis-build-task.png)

### <a name="properties"></a>Свойства

#### <a name="project-path"></a>Путь к проекту

Путь к папке или файлу проекта, сборку которых необходимо выполнить. Если указан путь к папке, задача сборки SSIS рекурсивно ищет все файлы DTPROJ в этой папке и выполняют их сборку.

Путь к проекту не может быть *пустым*. Укажите **.** для построения из корневой папки репозитория.

#### <a name="project-configuration"></a>Конфигурация проекта

Имя конфигурации проекта, которую необходимо использовать для сборки. Если не указано, по умолчанию используется первая конфигурация проекта, определенная в каждом файле DTPROJ.

#### <a name="output-path"></a>Путь вывода

Путь к отдельной папке, в которой следует сохранить результаты сборки и которую можно опубликовать как артефакт сборки с помощью [задачи публикации артефактов сборки](https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/publish-build-artifacts?view=azure-devops).

### <a name="limitations-and-known-issues"></a>Ограничения и известные проблемы

- Задача сборки SSIS использует Visual Studio и конструктор служб SSIS, которые должны быть установлены на агентах сборки. Поэтому, чтобы запустить задачу сборки SSIS в конвейере, необходимо выбрать **vs2017-win2016** для агентов, размещенных в Майкрософт, или установить Visual Studio и конструктор служб SSIS (расширение Visual Studio 2017 с SSDT 2017 или Visual Studio 2019 со службами SSIS) на локальных агентах.

- Для сборки проектов служб SSIS с использованием любых готовых компонентов (включая пакет дополнительных компонентов Azure для служб SSIS и другие компоненты сторонних производителей) эти компоненты должны быть установлены на компьютере, где работает агент конвейера.  Для размещенного агента Майкрософт пользователь может добавить [задачу скрипта PowerShell](https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/powershell?view=azure-devops) или [задачу скрипта командной строки](https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/command-line?view=azure-devops), чтобы скачать и установить компоненты перед выполнением задачи сборки SSIS. Ниже приведен пример скрипта PowerShell для установки пакета дополнительных компонентов Azure. 

```powershell
wget -Uri https://download.microsoft.com/download/E/E/0/EE0CB6A0-4105-466D-A7CA-5E39FA9AB128/SsisAzureFeaturePack_2017_x86.msi -OutFile AFP.msi

start -Wait -FilePath msiexec -Args "/i AFP.msi /quiet /l* log.txt"

cat log.txt
```

- Уровни защиты **EncryptSensitiveWithPassword** и **EncryptAllWithPassword** не поддерживаются задачей сборки SSIS. Эти два уровня защиты не должны использоваться ни в одном проекте служб SSIS в базе кода, иначе задача сборки служб SSIS зависнет во время выполнения из-за истечения времени ожидания.

## <a name="ssis-deploy-task"></a>Задача развертывания SSIS

![задача развертывания](media/ssis-deploy-task.png)

### <a name="properties"></a>Свойства

#### <a name="source-path"></a>Исходный путь

Путь к исходным файлам ISPAC или SSISDeploymentManifest, которые требуется развернуть. Это может быть путь к папке или файлу.

#### <a name="destination-type"></a>Тип назначения

Тип назначения. В настоящее время задача развертывания SSIS поддерживает два типа.

- *Файловая система*: файлы SSISDeploymentManifest и связанные с ними файлы развертываются в указанной файловой системе. Поддерживается общая папка как в локальной среде, так и в Azure.
- *SSISDB*: файлы ISPAC развертываются в указанном каталоге служб SSIS, который может размещаться на локальном сервере SQL Server или в Azure-SSIS Integration Runtime.

#### <a name="destination-server"></a>Целевой сервер

Имя целевого сервера SQL. Это может быть имя локального сервера SQL Server, Базы данных SQL Azure или управляемого экземпляра Базы данных SQL Azure. Это свойство является видимым, только если выбран тип назначения SSISDB.

#### <a name="destination-path"></a>Конечный путь

Путь к конечной папке, в которой будет развернут исходный файл. Пример:

- /SSISDB/\<имяПапки\>
- \\\\\<имяКомпьютера\>\\\<имяОбщейПапки\>\\\<необязательноеИмяВложеннойПапки\>

Задача развертывания SSIS создаст папку и вложенную папку, если они не существуют.

#### <a name="authentication-type"></a>Authentication type (Тип проверки подлинности)

Тип проверки подлинности для доступа к указанному целевому серверу. Это свойство является видимым, только если выбран тип назначения SSISDB. Как правило, поддерживаются следующие типы проверки подлинности:

- Проверка подлинности Windows
- Проверка подлинности SQL Server
- "Active Directory — пароль";
- "Active Directory — встроенная".

Однако поддержка конкретного типа проверки подлинности зависит от типов целевого сервера и агента. Ниже приведена подробная матрица поддержки.

| |Размещенный агент Майкрософт|Локальный агент|
|---------|---------|---------|
|Локальный сервер или виртуальная машина SQL Server |Недоступно|Проверка подлинности Windows|
|Azure SQL|Проверка подлинности SQL Server <br> "Active Directory — пароль";|Проверка подлинности SQL Server <br> "Active Directory — пароль"; <br> "Active Directory — встроенная".|

#### <a name="domain-name"></a>Доменное имя

Доменное имя для доступа к указанной файловой системе. Это свойство является видимым, только если выбран тип назначения "Файловая система".
Его можно оставить пустым, если учетной записи пользователя для запуска локального агента предоставлен доступ к указанному конечному пути с правами на чтение и запись.

#### <a name="username"></a>Имя пользователя

Имя пользователя для доступа к указанной файловой системе или SSISDB. Это свойство является видимым, если выбран тип назначения "Файловая система" либо тип проверки подлинности "Проверка подлинности SQL Server" или "Active Directory — пароль".
Его можно оставить пустым, если выбран тип назначения "Файловая система", а учетной записи пользователя для запуска локального агента предоставлен доступ к указанному конечному пути с правами на чтение и запись.

#### <a name="password"></a>Пароль

Пароль для доступа к указанной файловой системе или SSISDB. Это свойство является видимым, если выбран тип назначения "Файловая система" либо тип проверки подлинности "Проверка подлинности SQL Server" или "Active Directory — пароль".
Его можно оставить пустым, если выбран тип назначения "Файловая система", а учетной записи пользователя для запуска локального агента предоставлен доступ к указанному конечному пути с правами на чтение и запись.

#### <a name="overwrite-existing-projects-or-ssisdeploymentmanifest-files-of-the-same-names"></a>Перезаписать существующие проекты или файлы SSISDeploymentManifest с совпадающими именами

Укажите, следует ли перезаписать существующие проекты или файлы SSISDeploymentManifest с совпадающими именами. Если выбрано значение "Нет", задача развертывания SSIS не будет развертывать эти проекты или файлы.

#### <a name="continue-deployment-when-error-occurs"></a>Продолжить развертывание при возникновении ошибки

Укажите, будет ли продолжаться развертывание оставшихся проектов или файлов при возникновении ошибки. Если выбрано значение "Нет", задача развертывания SSIS завершится немедленно при возникновении ошибки.

### <a name="limitations-and-known-issues"></a>Ограничения и известные проблемы

Задача развертывания SSIS в настоящее время не поддерживает следующие сценарии:

- настройка среды в каталоге служб SSIS;
- развертывание файла ISPAC на сервере SQL Server в Azure или в Управляемом экземпляре SQL Azure, допускающем только многофакторную проверку подлинности (MFA);
- развертывание пакетов в хранилище пакетов MSDB или SSIS.

## <a name="ssis-catalog-configuration-task"></a>Задача конфигурации каталога SSIS

![Задача конфигурации каталога](media/ssis-catalog-configuation-task.png)

### <a name="properties"></a>Свойства

#### <a name="configuration-file-source"></a>Источник файла конфигурации

Источник файла конфигурации JSON каталога SSIS. Он может быть встроенным или представлять собой путь к файлу.

Узнайте больше о том, как [определить конфигурацию JSON](#define-configuration-json):

- См. [пример встроенной конфигурации JSON](#a-sample-inline-configuration-json).
- Проверьте [схему JSON](#json-schema).

#### <a name="configuration-json-file-path"></a>Путь файла конфигурации JSON

Путь файла конфигурации JSON каталога SSIS. Это свойство отображается только при выборе варианта "Путь к файлу" в качестве источника файла конфигурации.

Чтобы использовать [переменные конвейера](/azure/devops/pipelines/process/variables) в файле конфигурации JSON, необходимо добавить [задачу преобразования файлов](https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/file-transform?view=azure-devops) до этой задачи, чтобы заменить значения конфигурации переменными конвейера. Дополнительные сведения см. в разделе [Подстановка переменных JSON](https://docs.microsoft.com/azure/devops/pipelines/tasks/transforms-variable-substitution?view=azure-devops&tabs=Classic#json-variable-substitution).

#### <a name="inline-configuration-json"></a>Встроенная конфигурация JSON

Встроенный файл JSON конфигурации каталога SSIS. Это свойство отображается только при выборе варианта "Встроенный" в качестве источника файла конфигурации. Переменные конвейера можно использовать напрямую.

#### <a name="roll-back-configuration-when-error-occurs"></a>Откат конфигурации при возникновении ошибки

Следует ли откатить конфигурацию, выполненную этой задачей, при возникновении ошибки.

#### <a name="target-server"></a>Целевой сервер

Имя целевого сервера SQL Server. Это может быть имя локального сервера SQL Server, Базы данных SQL Azure или управляемого экземпляра Базы данных SQL Azure.

#### <a name="authentication-type"></a>Authentication type (Тип проверки подлинности)

Тип проверки подлинности для доступа к указанному целевому серверу. Как правило, поддерживаются следующие типы проверки подлинности:

- Проверка подлинности Windows
- Проверка подлинности SQL Server
- "Active Directory — пароль";
- "Active Directory — встроенная".

Однако поддержка конкретного типа проверки подлинности зависит от типов целевого сервера и агента. Ниже приведена подробная матрица поддержки.

| |Размещенный агент Майкрософт|Локальный агент|
|---------|---------|---------|
|Локальный сервер или виртуальная машина SQL Server |Недоступно|Проверка подлинности Windows|
|Azure SQL|Проверка подлинности SQL Server <br> "Active Directory — пароль";|Проверка подлинности SQL Server <br> "Active Directory — пароль"; <br> "Active Directory — встроенная".|

#### <a name="username"></a>Имя пользователя

Имя пользователя для доступа к целевому SQL Server. Это свойство является видимым, если выбран тип проверки подлинности "Проверка подлинности SQL Server" или "Active Directory — пароль".

#### <a name="password"></a>Пароль

Пароль для доступа к целевому SQL Server. Это свойство является видимым, если выбран тип проверки подлинности "Проверка подлинности SQL Server" или "Active Directory — пароль".

### <a name="define-configuration-json"></a>Определение конфигурации JSON

Схема конфигурации JSON имеет три уровня:

- catalog
- folder
- проект и среда.

![схема конфигурации каталога](media/catalog-configuration-schema.png)

#### <a name="a-sample-inline-configuration-json"></a>Пример встроенной конфигурации JSON

```json
{
  "folders": [
    {
      "name": "devopsdemo",
      "description": "devops demo folder",
      "projects": [
        {
          "name": "catalog devops",
          "parameters": [
            {
              "name": "password",
              "container": "Package.dtsx",
              "value": "passwd",
              "valueType": "referenced"
            },
            {
              "name": "serverName",
              "container": "catalog devops",
              "value": "localhost",
              "valueType": "literal"
            }
          ],
          "references": [
            {
              "environmentName": "test",
              "environmentFolder": "devopsdemo"
            },
            {
              "environmentName": "test",
              "environmentFolder": "."
            }
          ]
        }
      ],
      "environments": [
        {
          "name": "test",
          "description": "test",
          "variables": [
            {
              "name": "passwd",
              "type": "string",
              "description": "",
              "value": "$(SSISDBServerAdminPassword)",
              "sensitive": true
            },
            {
              "name": "serverName",
              "type": "string",
              "description": "",
              "value": "$(TargetServerName)",
              "sensitive": false
            }
          ]
        }
      ]
    }
  ]
}
```

#### <a name="json-schema"></a>Схема JSON

##### <a name="catalog-attributes"></a>Атрибуты каталога

|Свойство  |Описание  |Примечания  |
|---------|---------|---------|
|папки  |Массив объектов папки. Каждый объект содержит сведения о конфигурации для папки каталога.|Схему объекта папки см. в разделе *Атрибуты папки*.|

##### <a name="folder-attributes"></a>Атрибуты папки

|Свойство  |Описание  |Примечания  |
|---------|---------|---------|
|name  |Имя папки каталога.|Папка будет создана, если она еще не существует.|
|description|Описание папки каталога.|Значение *NULL* будет пропущено.|
|projects|Массив объектов проекта. Каждый объект содержит сведения о конфигурации для проекта.|Схему объекта проекта см. в разделе *Атрибуты проекта*.|
|environments|Массив объектов среды. Каждый объект содержит сведения о конфигурации для среды.|Схему объекта среды см. в разделе *Атрибуты среды*.|

##### <a name="project-attributes"></a>Атрибуты проекта

|Свойство  |Описание  |Примечания  |
|---------|---------|---------|
|name|Имя проекта. |Объект проекта будет пропущен, если проект не существует в родительской папке.|
|параметры|Массив объектов параметров. Каждый объект содержит сведения о конфигурации для параметра.|Схему объекта параметра см. в разделе *Атрибуты параметра*.|
|Ссылки|Массив объектов ссылки. Каждый объект представляет ссылку на среду для целевого проекта.|Схему объекта ссылки см. в разделе *Атрибуты ссылки*.|

##### <a name="parameter-attributes"></a>Атрибуты параметра

|Свойство  |Описание  |Примечания  |
|---------|---------|---------|
|name|Имя параметра.|Параметр может быть *параметром проекта* или *параметром пакета*. <br> Параметр будет пропущен, если он не существует в родительском проекте.|
|контейнер|Контейнер параметра.|<li>Если параметр является параметром проекта, *контейнер* должен быть именем проекта. <li>Если это параметр пакета, *контейнер* должен быть именем пакета с расширением **DTSX**. <li> Если параметр является свойством диспетчера подключений, имя должно иметь следующий формат: **CM.\<имя диспетчера подключений>.\<имя свойства>** .|
|value|Значение параметра.|<li>Если *valueType* имеет значение *referenced*: Значение является ссылкой на переменную среды в типе *string*. <li> Если *valueType* имеет значение *literal*: Этот атрибут поддерживает любые допустимые значения JSON типа *boolean*, *number* и *string*. <br> Значение будет преобразовано в тип целевого параметра. Если преобразование невозможно, произойдет ошибка.<li> Значение *NULL* является недопустимым. Задача пропустит этот объект параметра и выдаст предупреждение.|
|valueType|Тип значения параметра.|Допустимые типы: <br> *literal*: атрибут *value* представляет литеральное значение. <br> *referenced*: атрибут *value* представляет ссылку на переменную среды.|

##### <a name="reference-attributes"></a>Ссылочные атрибуты

|Свойство  |Описание  |Примечания  |
|---------|---------|---------|
|environmentFolder|Имя папки среды.|Папка будет создана, если она еще не существует. <br> Может иметь значение ".", представляющее родительскую папку проекта, которая ссылается на среду.|
|EnvironmentName|Имя среды, на которую указывает ссылка.|Указанная среда будет создана, если она не существует.|

##### <a name="environment-attributes"></a>Атрибуты среды

|Свойство  |Описание  |Примечания  |
|---------|---------|---------|
|name|Имя среды.|Среда будет создана, если она не существует.|
|description|Описание среды.|Значение *NULL* будет пропущено.|
|variables|Массив объектов переменных.|Каждый объект содержит сведения о конфигурации для переменной среды. Схему объекта переменной см. в разделе *Атрибуты переменной*.|

##### <a name="variable-attributes"></a>Атрибуты переменной

|Свойство  |Описание  |Примечания  |
|---------|---------|---------|
|name|Имя переменной среды.|Переменная среды будет создана, если она не существует.|
|type|Тип данных переменной среды.|Допустимые типы: <br> *boolean* <br> *byte* <br> *datetime* <br> Decimal <br> *double* <br> *int16* <br> *int32* <br> *int64* <br> *sbyte* <br> *single* <br> *строка* <br> *uint32* <br> *uint64*|
|description|Описание переменной среды.|Значение *NULL* будет пропущено.|
|value|Значение переменной среды.|Этот атрибут поддерживает любые допустимые значения JSON типа boolean, number и string.<br> Значение будет преобразовано в тип, заданный атрибутом **type**. Если преобразование выполнить не удается, возникнет ошибка.<br>Значение *NULL* является недопустимым. Задача пропустит этот объект переменной среды и выдаст предупреждение.|
|sensitive|Является ли значение переменной среды конфиденциальным.|Допустимые входные значения: <br> *true* <br> *false*|

## <a name="release-notes"></a>Заметки о выпуске

### <a name="version-020-preview"></a>Версия 0.2.0, предварительная версия

Дата выпуска: 31 марта 2020 г.

- Добавление задачи конфигурации каталога SSIS.

### <a name="version-013-preview"></a>Предварительная версия 0.1.3

Дата выпуска: 19 января 2020 г.

- Исправлена проблема, препятствующая развертыванию ISPAC, если исходное имя файла было изменено.

### <a name="version-012-preview"></a>Версия 0.1.2 — предварительная версия

Дата выпуска: 13 января 2020 г.

- В журнал задач развертывания служб SSIS добавляются более подробные сведения об исключении, если целевой тип — SSISDB.
- Исправлен пример целевого пути в тексте справки для свойства целевого пути у задачи развертывания служб SSIS.

### <a name="version-011-preview"></a>Предварительная версия 0.1.1

Дата выпуска: 6 января 2020 г.

- Добавлено требование минимальной версии агента. В настоящее время минимальная версия агента для этого продукта — 2.144.0.
- Исправлен неверный текст, отображаемый для задачи развертывания SSIS.
- Уточнены некоторые сообщения об ошибках.

### <a name="version-010-preview"></a>Предварительная версия 0.1.0

Дата выпуска: 5 декабря 2019 г.

Начальный выпуск средств DevOps для служб SSIS. Это предварительный выпуск.

## <a name="next-steps"></a>Дальнейшие действия

- Получите [расширение DevOps для служб SSIS](https://marketplace.visualstudio.com/items?itemName=SSIS.ssis-devops-tools)
