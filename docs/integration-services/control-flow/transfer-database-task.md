---
title: Задача "Передача базы данных" | Документы Майкрософт
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql13.dts.designer.transferdatabasetask.f1
- sql13.dts.designer.transferdatabasetask.general.f1
- sql13.dts.designer.transferdatabasetask.database.f1
- sql13.dts.designer.transferdatabasetask.sourcedbfiles.f1
- sql13.dts.designer.transferdatabasetask.destdbfiles.f1
helpviewer_keywords:
- Transfer Database task [Integration Services]
ms.assetid: b9a2e460-cdbc-458f-8df8-06b8b2de3d67
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 9aafd57717c2ac90757393ae8d0d75e569b88942
ms.sourcegitcommit: c8e1553ff3fdf295e8dc6ce30d1c454d6fde8088
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/22/2020
ms.locfileid: "86914002"
---
# <a name="transfer-database-task"></a>Задача «Передача базы данных»

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


  Задача «Передача базы данных» передает базу данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] между двумя экземплярами [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. В отличие от других задач, передающих объекты [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] только путем копирования, задача «Передача базы данных» может копировать или перемещать базу данных. Эту задачу можно также использовать для копирования базы данных в пределах того же сервера.  
  
## <a name="offline-and-online-modes"></a>Режимы «вне сети» и «в сети»  
 База данных может быть передана в режимах «в сети» или «вне сети». В режиме «в сети» база данных остается присоединенной и передается с помощью SQL Management Objects (SMO) для копирования объектов. В режиме «вне сети» база данных отсоединяется, файлы базы данных перемещаются или копируются и база данных прикрепляется на назначении после того, как передача успешно завершена. При копировании база данных повторно присоединяется к источнику автоматически, если копирование прошло успешно. В режиме «вне сети» копирование базы данных происходит быстрее, но во время передачи база данных недоступна для пользователей.  
  
 В режиме «вне сети» требуется указать общие папки на исходном и целевом серверах, которые содержат файлы базы данных. Ссылка на общую сетевую папку, доступную пользователю, может иметь синтаксис \\\имя_компьютера\Program Files\моя_папка\\. В противном случае необходимо использовать синтаксис \\\имя_компьютера\c$\Program Files\моя_папка\\. Для использования последнего варианта синтаксиса пользователь должен иметь разрешения на запись в общие сетевые ресурсы источника и назначения.  
  
## <a name="transfer-of-databases-between-versions-of-sql-server"></a>Передача баз данных между разными версиями SQL Server  
 Задача «Передача базы данных» может передавать базу данных между экземплярами различных версий [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
## <a name="events"></a>События  
 Задача «Передача базы данных» не создает отчет об ошибках в процессе передачи, сообщая только о начале и полном выполнении задачи.  
  
## <a name="execution-value"></a>Значение выполнения  
 Значение выполнения, заданное в свойстве **ExecutionValue** задачи, возвращает значение 1, поскольку в отличие от других задач передачи, задача «Передача базы данных» может передавать только одну базу данных.  
  
 С помощью выделения пользовательской переменной для свойства **ExecValueVariable** задачи "Передача базы данных" сведения об ошибках передачи становятся доступными для других объектов пакета. Дополнительные сведения см. в разделах [Переменные в службах Integration Services (SSIS)](../../integration-services/integration-services-ssis-variables.md) и [Использование переменных в пакетах](https://msdn.microsoft.com/library/7742e92d-46c5-4cc4-b9a3-45b688ddb787).  
  
## <a name="log-entries"></a>Записи журнала  
 Задача «Передача базы данных» содержит следующие пользовательские записи в журнале.  
  
-   SourceSQLServer    Запись журнала содержит имя исходного сервера.  
  
-   DestSQLServer    Запись журнала содержит имя целевого сервера.  
  
-   SourceDB    Запись журнала содержит имя передаваемой базы данных.  
  
 Дополнительно при перезаписывании целевой базы данных делается запись журнала для события **OnInformation** .  
  
## <a name="security-and-permissions"></a>Безопасность и разрешения  
 Для передачи базы данных в режиме вне сети пользователь, запускающий выполнение пакета, должен быть членом роли сервера sysadmin.  
  
 Для передачи базы данных в режиме в сети пользователь, запускающий выполнение пакета, должен быть членом роли сервера sysadmin или владельцем выбранной базы данных (dbo).  
  
## <a name="configuration-of-the-transfer-database-task"></a>Настройка задачи «Передача базы данных»  
 Можно отдельно указать, следует ли повторно подсоединять базу данных-источник, если во время передачи базы данных произошел сбой.  
  
 Задача «Передача базы данных» может быть настроена таким образом, чтобы разрешать перезапись целевой базы данных с таким же именем, замещая ее.  
  
 База данных-источник может быть переименована в процессе передачи. Если требуется передать базу данных на экземпляр назначения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , где уже содержится база данных с таким именем, переименование базы данных-источника позволяет это сделать. Тем не менее, имена файлов баз данных должны различаться, поскольку если файлы базы данных с таким именем уже существуют на назначении, при выполнении задачи происходит сбой.  
  
 При создании копии базы данных база данных не может быть меньше по размеру, чем база данных **модели** на целевом сервере. Можно либо увеличить размер копии базы данных, либо уменьшить размер **модели**.  
  
 Во время выполнения задача «Передача базы данных» подключается к исходному и целевому серверам с помощью одного или двух диспетчеров соединений SMO. При создании копии базы данных на том же сервере требуется только один диспетчер соединений SMO. Диспетчеры соединений SMO настраиваются отдельно, после чего задача «Передача базы данных» ссылается на них. Диспетчеры соединений SMO указывают сервер и режим проверки подлинности, который будет использоваться при доступе задачи к указанному серверу. Дополнительные сведения см. в статье [SMO Connection Manager](../../integration-services/connection-manager/smo-connection-manager.md).  
  
 Значения свойств можно задавать с помощью конструктора [!INCLUDE[ssIS](../../includes/ssis-md.md)] или программными средствами.  
  
 Дополнительные сведения о свойствах, которые можно задать в конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] , см. в следующем разделе:  
  
-   [Страница «Выражения»](../../integration-services/expressions/expressions-page.md)  
  
 Дополнительные сведения об установке этих свойств в конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] см. в следующем разделе:  
  
-   [Задание свойств задач или контейнеров](https://msdn.microsoft.com/library/52d47ca4-fb8c-493d-8b2b-48bb269f859b)  
  
## <a name="programmatic-configuration-of-the-transfer-database-task"></a>Настройка задачи «Передача базы данных» с помощью программных средств  
 Дополнительные сведения об установке этих свойств программными средствами см. в следующем разделе.  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.TransferDatabaseTask.TransferDatabaseTask>  
  
## <a name="transfer-database-task-editor-general-page"></a>Редактор задачи «Передача базы данных» (страница «Общие»)
  Страница **Общие** диалогового окна **Редактор задачи «Передача базы данных»** позволяет дать имя и описание задачи передачи базы данных. Задача «Передача базы данных» копирует или перемещает базу данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] между двумя экземплярами [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Эту задачу можно также использовать для копирования базы данных в пределах того же сервера.   
  
### <a name="options"></a>Параметры  
 **Название**  
 Введите уникальное имя для задачи передачи базы данных. Это имя используется в качестве метки для значка задачи.  
  
> [!NOTE]  
>  Имена задач в пределах пакета должны быть уникальными.  
  
 **Описание**  
 Введите описание задачи передачи базы данных.  
  
## <a name="transfer-database-task-editor-databases-page"></a>Редактор задачи «Передача базы данных» (страница «Базы данных»)
  Используйте страницу **Базы данных** в диалоговом окне **Редактор задачи «Передача базы данных»** , чтобы указать свойства для базы данных-источника и целевой базы данных, участвующих в задаче «Передача базы данных». Задача «Передача базы данных» копирует или перемещает базу данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] между двумя экземплярами [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Эту задачу можно также использовать для копирования базы данных в пределах того же сервера.  
  
### <a name="options"></a>Параметры  
 **SourceConnection**  
 Выберите из списка диспетчер подключений SMO или нажмите кнопку **\<New connection...>** , чтобы создать новое подключение к исходному серверу.  
  
 **DestinationConnection**  
 Выберите из списка диспетчер подключений SMO или нажмите кнопку **\<New connection...>** , чтобы создать новое подключение к целевому серверу.  
  
 **DestinationDatabaseName**  
 Укажите имя базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на целевом сервере.  
  
 Чтобы автоматически заполнить это поле именем базы данных-источника, укажите сначала **SourceConnection** и **SourceDatabaseName** .  
  
 Чтобы переименовать базу данных на целевом сервере, введите новое имя в этом поле.  
  
 **DestinationDatabaseFiles**  
 Указывает имена и местоположения файлов базы данных на целевом сервере.  
  
 Чтобы автоматически заполнить это поле именами и местоположениями файлов базы данных-источника, укажите сначала **SourceConnection**, **SourceDatabaseName**и **SourceDatabaseFiles** .  
  
 Чтобы переименовать файлы базы данных или указать новые местоположения на целевом сервере, заполните это поле сведениями о базе данных-источнике, а затем нажмите кнопку обзора. В диалоговом окне **Файлы целевой базы данных** измените пункты **Файл назначения**, **Целевая папка**или **Сетевая общая папка**.  
  
> [!NOTE]  
>  В случае выбора файлов базы данных с помощью кнопки обзора расположение файла вводится с использованием обозначения локального диска, например c:\\. Необходимо заменить это значение на путь к сетевому ресурсу, в который входит имя компьютера и имя общей папки. Если используется административная общая папка по умолчанию, необходимо использовать обозначение с символом $ и иметь административный доступ к общей папке.  
  
 **DestinationOverwrite**  
 Укажите, может ли база данных на целевом сервере быть перезаписана.  
  
 Параметры этого свойства приведены в следующей таблице.  
  
|Значение|Description|  
|-----------|-----------------|  
|**True**|Перезаписать базу данных целевого сервера.|  
|**False**|Не перезаписывать базу данных целевого сервера.|  
  
> [!CAUTION]  
>  Данные в базе данных целевого сервера будут перезаписаны, если для параметра **DestinationOverwrite** будет указано значение **True**, что может привести к потере данных. Чтобы избежать этого, создайте резервную копию базы данных целевого сервера в другом местоположении, прежде чем приступить к выполнению задачи «Передача базы данных».  
  
 **Действие**  
 Укажите, следует ли при выполнении задачи **Копировать** или **Переместить** базу данных на целевой сервер.  
  
 **Метод**  
 Укажите, будет ли при выполнении задачи база данных на исходном сервере работать в сети или вне сети.  
  
 Для передачи базы данных с использованием режима вне сети пользователь, выполняющий пакет, должен быть членом предопределенной роли сервера **sysadmin** .  
  
 Для передачи базы данных с использованием режима в сети пользователь, выполняющий пакет, должен быть членом предопределенной роли сервера **sysadmin** или владельцем выбранной базы данных (**dbo**).  
  
 **SourceDatabaseName**  
 Выберите имя базы данных, подлежащей копированию или перемещению.  
  
 **SourceDatabaseFiles**  
 Нажмите кнопку обзора, чтобы выбрать файлы базы данных.  
  
 **ReattachSourceDatabase**  
 Укажите, должна ли задача предпринять попытку повторно присоединить базу данных-источник при возникновении сбоя.  
  
 Параметры этого свойства приведены в следующей таблице.  
  
|Значение|Description|  
|-----------|-----------------|  
|**True**|Присоединить повторно базу данных-источник.|  
|**False**|Не присоединять повторно базу данных-источник.|  

## <a name="source-database-files"></a>Файлы базы данных-источника
  Диалоговое окно **Файлы базы данных-источника** используется для просмотра имен файлов базы данных и их размещения на исходном сервере, а также для указания общей сетевой папки в задаче «Передача базы данных».   
  
 Чтобы наполнить диалоговое окно именами файлов базы данных и ресурсов исходного сервера, сначала укажите параметры **SourceConnection** (Подключение к источнику) и **SourceDatabaseName** (Имя базы данных-источника) на странице **Базы данных** диалогового окна **Редактор задачи «Передача базы данных»** .  
  
### <a name="options"></a>Параметры  
 **Исходный файл**  
 Имена файлов базы данных на исходном сервере, которые будут перенесены. Параметр**Исходный файл** доступен только для чтения.  
  
 **Исходная папка**  
 Папка на исходном сервере, в которой хранятся файлы базы данных, подлежащей переносу. Параметр**Исходная папка** доступен только для чтения.  
  
 **Сетевая общая папка**  
 Сетевая общая папка на исходном сервере, из которой будут перенесены файлы базы данных. Параметр **Сетевая общая папка** используется при переносе базы данных в режиме вне сети путем задания значения **DatabaseOffline** (Автономный режим базы данных) параметру **Метод** на странице **Базы данных** диалогового окна **Редактор задачи «Передача базы данных»** .  
  
 Введите путь к общей сетевой папке или нажмите кнопку обзора **(...)** , чтобы найти эту папку.  
  
 При переносе базы данных в режиме вне сети файлы базы данных копируются в заданную параметром **Сетевая общая папка** папку на исходном сервере, прежде чем они будут перенесены на целевой сервер.  

## <a name="destination-database-files"></a>Файлы базы данных-назначения
  Используйте диалоговое окно **Файлы целевой базы данных** для просмотра или изменения имен файлов базы данных и местоположений на целевом сервере, или для определения положения в сети файла для задачи «Передача базы данных».  
  
 Для автоматического заполнения этого диалогового окна именами файлов базы данных и положений на исходном сервере сначала укажите **SourceConnection**, **SourceDatabaseName**и **SourceDatabaseFiles** на странице **Базы данных** диалогового окна **Редактор задачи «Передача базы данных»** .  
  
### <a name="options"></a>Параметры  
 **Целевой файл**  
 Имена переданных файлов базы данных на целевом сервере.  
  
 Введите имя файла или нажмите имя файла для редактирования.  
  
 **Целевая папка**  
 Папка на целевом сервере, куда должны быть переданы файлы базы данных.  
  
 Введите путь к папке, нажмите путь к папке для редактирования или нажмите кнопку обзора для указания папки, куда необходимо передать файлы базы данных на целевом сервере.  
  
 **Сетевая общая папка**  
 Общая сетевая папка на целевом сервере, куда должны быть переданы файлы базы данных. Используйте **Сетевую общую папку** для передачи базы данных в режиме вне сети, указав значение **DatabaseOffline** параметра **Метод** на странице **Базы данных** диалогового окна **Редактор задачи «Передача базы данных»** .  
  
 Введите размещение сетевой общей папки или нажмите кнопку обзора для ее указания.  
  
 При передаче базы данных в режиме вне сети файлы базы данных копируются в **Сетевую общую папку** перед тем, как они переданы в расположение **Целевая папка** .  
