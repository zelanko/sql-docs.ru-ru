---
title: "Редактор задачи &#171;Выполнение CDC&#187; | Microsoft Docs"
ms.custom: ""
ms.date: "03/14/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "integration-services"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "sql13.ssis.designer.cdccontroltask.config.f1"
ms.assetid: 4f09d040-9ec8-4aaa-b684-f632d571f0a8
caps.latest.revision: 10
author: "douglaslMS"
ms.author: "douglasl"
manager: "jhubbard"
caps.handback.revision: 10
---
# Редактор задачи &#171;Выполнение CDC&#187;
  Диалоговое окно **Редактор задачи «Управление CDC»** служит для настройки задачи «Управление CDC». В процессе настройки задачи «Управление CDC» определяется соединение с базой данных CDC, операция задачи CDC и сведения об управлении состояниями.  
  
 Дополнительные сведения о задаче «Управление CDC» см. в разделе [CDC Control Task](../../integration-services/control-flow/cdc-control-task.md).  
  
 **Открытие редактора задачи «Управление CDC»**  
  
1.  В среде [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]откройте пакет служб [!INCLUDE[ssISCurrent](../../includes/ssiscurrent-md.md)] , содержащий задачу «Управление CDC».  
  
2.  На вкладке **Поток управления** дважды щелкните задачу "Управление CDC".  
  
## Параметры  
 **Диспетчер соединений ADO.NET базы данных SQL Server CDC**  
 Выберите из списка существующий диспетчер соединений или нажмите кнопку **Создать**, чтобы создать новое соединение. Соединение должно быть установлено с базой данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которая включена для CDC и в которой находится выбранная таблица изменений.  
  
 **Операция управления CDC**  
 Выберите операцию для выполнения этой задачи. Все операции используют переменную состояния, которая хранится в переменной пакета служб SSIS и содержит состояние, которое передается между различными компонентами пакета.  
  
-   **Отметить начало начальной загрузки**. Эта операция используется при выполнении начальной загрузки из активной базы данных без моментального снимка. Он вызывается в начале пакета начальной загрузки для записи текущего номера LSN в базу данных-источник перед тем, как пакет начальной загрузки начинает читать исходные таблицы. Для этого необходимо соединение с базой данных-источником.  
  
     Если выбрать операцию **Отметить начало начальной загрузки** при работе в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (не Oracle), то пользователь, указанный в диспетчере соединений, должен входить в роль **db_owner** или **sysadmin**.  
  
-   **Отметить конец начальной загрузки**. Эта операция используется при выполнении начальной загрузки из активной базы данных без моментального снимка. Она вызывается в конце пакета начальной загрузки для записи текущего номера LSN в базу данных-источник после того, как пакет начальной нагрузки завершит чтение исходных таблиц. Номер LSN определяется путем записи текущего времени при осуществлении данной операции и последующего запроса таблицы сопоставления `cdc.lsn_time_`в базе данных CDC для поиска любого изменения, которое произошло в последующее время.  
  
     Если выбрать операцию **Отметить конец начальной загрузки** при работе в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (не Oracle), то пользователь, указанный в диспетчере соединений, должен входить в роль **db_owner** или **sysadmin**.  
  
-   **Отменить начало CDC**. Эта операция используется, если затем выполняется начальная загрузка из базы данных моментальных снимков или из замороженной базы данных. Она вызывается в любом месте в пакете начальной загрузки. Операция принимает параметр, которым может быть номер LSN моментального снимка или имя базы данных моментальных снимков (из которого автоматически получается номер LSN моментального снимка). Параметр также можно оставить пустым, и тогда текущий номер LSN базы данных будет служить начальным номером LSN для пакета обработки изменений.  
  
     Эта операция используется вместо операций «Отметить начало/конец начальной загрузки».  
  
     Если выбрать операцию **Отметить начало CDC** при работе в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (не Oracle), то пользователь, указанный в диспетчере соединений, должен входить в роль **db_owner** или **sysadmin**.  
  
-   **Получить диапазон обработки**. Эта операция используется в пакете обработки изменений перед вызовом потока данных, в котором применяется поток исходных данных CDC. Операция устанавливает диапазон номеров LSN, считываемый потоком исходных данных CDC при вызове. Этот диапазон хранится в переменной пакета служб SSIS, которая используется источником CDC во время обработки потока данных.  
  
     Дополнительные сведения о возможных состояниях CDC, которые хранятся, см. в разделе [Определение переменной состояния](../../integration-services/data-flow/define-a-state-variable.md).  
  
-   **Отметить обработанный диапазон**. Эта операция выполняется в пакете обработки изменений после каждого запуска CDC (после успешного завершения потока данных CDC) для записи последнего номера LSN, который был полностью обработан в текущем запуске CDC. При следующем вызове `GetProcessingRange` на выполнение эта позиция определяет начало следующего диапазона обработки.  
  
-   **Сбросить состояние CDC**. Эта операция используется для сброса хранимого состояния CDC, связанного с текущим контекстом CDC. После выполнения этой операции текущий максимальный номер LSN из таблицы LSN-timestamp `sys.fn_cdc_get_max_lsn` становится началом следующего диапазона обработки. Эта операция требует создания соединения с базой данных-источником.  
  
     Примером использования этой операции является случай, когда нужно обработать только недавно созданные записи об изменениях, пропуская все старые записи об изменениях.  
  
 **Переменная, содержащая состояние CDC**  
 Выберите переменную пакета служб SSIS, в которой хранятся сведения о состоянии для операции задачи. Переменную необходимо определить перед началом работы. Если выбрать параметр **Автоматическое сохранение состояния**, то переменная состояния загружается и сохраняется автоматически.  
  
 Дополнительные сведения об определении переменной состояния см. в разделе [Определение переменной состояния](../../integration-services/data-flow/define-a-state-variable.md).  
  
 **Номер LSN SQL Server для начала CDC/имя моментального снимка:**  
 введите текущий номер LSN базы данных-источника или имя базы данных моментальных снимков, из которой выполняется начальная загрузка, чтобы определить начало CDC. Этот параметр доступен только в том случае, если параметр **Операция управления CDC** имеет значение **Отметить начало CDC**.  
  
 Дополнительные сведения об этих операциях см. в разделе [CDC Control Task](../../integration-services/control-flow/cdc-control-task.md).  
  
 **Автоматически сохранять состояние в таблице базы данных**  
 Установите этот флажок для задачи «Управление CDC», чтобы автоматически обрабатывать загрузку и сохранение состояния CDC в таблице состояния, содержащейся в указанной базе данных. Если этот флажок не установлен, то разработчик должен загружать состояние CDC при запуске пакета и сохранять его при изменении состояния CDC.  
  
 **Диспетчер соединений для базы данных, где хранится состояние**  
 Выберите из списка существующий диспетчер соединений ADO.NET или нажмите кнопку «Создать», чтобы создать новое соединение. Это соединение с базой данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , содержащей таблицу состояния. Таблица состояния содержит сведения о состоянии.  
  
 Этот параметр доступен только в том случае, если выбран параметр **Автоматическое сохранение состояния** , и является обязательным.  
  
 **Таблица для хранения состояния**  
 Введите имя таблицы состояния, используемой для хранения состояния CDC. Указанная таблица должна содержать два столбца с именами **name** и **state**. Оба столбца должны иметь тип данных **varchar (256)**.  
  
 Также можно выбрать вариант **Создать** , чтобы получить скрипт SQL, выполняющий построение новой таблицы состояния с необходимыми столбцами (необязательно). Если выбран параметр **Автоматическое сохранение состояния** , то разработчик должен создать таблицу состояния, соответствующую указанным выше требованиям.  
  
 Этот параметр доступен только в том случае, если выбран параметр **Автоматическое сохранение состояния** , и является обязательным.  
  
 **Имя состояния**  
 Введите имя, связанное с сохраняемым состоянием CDC. В пакетах полной загрузки и пакетах CDC, работающих в одном контексте CDC, будет указываться общее имя состояния. Это имя используется для подстановки строки состояния в таблице состояния  
  
## См. также  
 [Пользовательские свойства задач управления CDC](../../integration-services/control-flow/cdc-control-task-custom-properties.md)  
  
  