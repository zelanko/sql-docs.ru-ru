---
description: Экспорт инвентаризации доступа (Акцесстоскл)
title: Экспорт инвентаризации доступа (Акцесстоскл) | Документация Майкрософт
ms.prod: sql
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.technology: ssma
ms.topic: conceptual
helpviewer_keywords:
- Access databases
- Access databases, exporting metadata
- exporting
- exporting Access metadata
- exporting, Access metadata
- exporting, querying exported metadata
- inventories of Access databases
- querying exported metadata
ms.assetid: 7e1941fb-3d14-4265-aff6-c77a4026d0ed
author: nahk-ivanov
ms.author: alexiva
ms.openlocfilehash: 112452e9e6c31810dbf26d9aa1e7b36959c192d5
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88488337"
---
# <a name="exporting-an-access-inventory-accesstosql"></a>Экспорт инвентаризации доступа (Акцесстоскл)
Если у вас есть несколько баз данных Access и вы не уверены, какие из них нужно перенести [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , можно экспортировать учет всех баз данных Access в проекте. Затем можно просматривать и запрашивать метаданные инвентаризации, чтобы определить, какие базы данных и объекты в этих базах данных нужно перенести. Эта Инвентаризация позволяет быстро находить ответы на вопросы, например следующие:  
  
-   Каковы самые большие базы данных?  
  
-   Кто владеет большинством баз данных?  
  
-   Какие базы данных содержат одни и те же таблицы?  
  
-   Какие базы данных не были изменены за последние шесть месяцев?  
  
-   Какие базы данных содержат частные данные?  
  
Примеры запросов, которые используются для ответа на эти вопросы, приведены в конце этого раздела.  
  
## <a name="exported-metadata"></a>Экспортированные метаданные  
SSMA экспортирует метаданные о базах данных Access, таблицах, столбцах, индексах, внешних ключах, запросах, отчетах, формах, макросах и модулях. Метаданные каждой из этих категорий элементов экспортируются в отдельную таблицу. Схемы этих таблиц см. в разделе [доступ к схемам инвентаризации](access-inventory-schemas-accesstosql.md).  
  
## <a name="exporting-inventory-data"></a>Экспорт данных инвентаризации  
Чтобы экспортировать инвентаризацию доступа, необходимо сначала открыть или создать проект SSMA, а затем добавить базу данных Access, которую требуется проанализировать. После добавления баз данных в проект SSMA вы экспортируете метаданные об этих базах данных в указанную [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] базу данных и схему. При необходимости SSMA создает таблицы для хранения метаданных. Затем SSMA добавляет метаданные о базах данных Access в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] базу данных.  
  
> [!NOTE]  
> Базу данных Access можно разделить на несколько файлов: серверную базу данных, которая содержит таблицы и клиентские базы данных, содержащие запросы, формы, отчеты, макросы, модули и ярлыки. Если требуется выполнить миграцию разделенной базы данных в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , добавьте ее интерфейсную базу данных в SSMA.  
  
Следующие инструкции описывают создание проекта, Добавление баз данных в проект, подключение [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и экспорт данных инвентаризации.  
  
**Создание проекта**  
  
1.  Откройте SSMA для доступа.  
  
2.  В меню **Файл** выберите пункт **Создать проект**.  
  
    Откроется диалоговое окно **Создание проекта** .  
  
3.  В поле **Name** введите имя проекта.  
  
4.  В поле **Расположение** введите или выберите папку для проекта.  
  
5.  В поле **Перейти к** полю со списком выберите целевую версию, до которой необходимо выполнить миграцию, и нажмите кнопку **ОК**.  
  
Дополнительные сведения о создании проектов см. в разделе [Создание проектов и управление ими](creating-and-managing-projects-accesstosql.md).  
  
**Поиск и Добавление баз данных**  
  
1.  В меню **файл** выберите пункт **найти базы данных**.  
  
2.  В мастере поиска баз данных введите диск, путь к файлу или UNC-путь, который требуется найти. Также можно нажать кнопку **Обзор** , чтобы выбрать диск или сетевую папку.  
  
3.  Нажмите кнопку **Добавить** , чтобы добавить расположение в список.  
  
    Повторите предыдущие два шага, чтобы добавить дополнительные расположения для поиска.  
  
4.  При необходимости добавьте условие поиска для уточнения списка возвращаемых баз данных.  
  
    > [!IMPORTANT]  
    > В текстовом поле **все или часть имени файла** не поддерживаются подстановочные знаки.  
  
5.  Нажмите кнопку **Проверить**.  
  
    Откроется страница Scan (сканирование). Отобразятся найденные базы данных и ход выполнения поиска. Чтобы прерывать Поиск, нажмите кнопку " **Закрыть**".  
  
6.  На странице Выбор файлов выберите каждую базу данных, которую необходимо добавить в проект.  
  
    Можно использовать кнопки **выбрать все** и **Очистить все** в верхней части списка, чтобы выбрать или очистить все базы данных. Можно также нажать клавишу CTRL, чтобы выбрать несколько строк, или удерживать нажатой клавишу SHIFT, чтобы выбрать диапазон строк.  
  
7.  Нажмите кнопку **Далее**.  
  
8.  На странице Проверка нажмите кнопку **Готово**.  
  
Дополнительные сведения о добавлении баз данных в проекты см. в разделе [Добавление и удаление файлов базы данных Access](adding-and-removing-access-database-files-accesstosql.md).  
  
**Подключение SQL Server**  
  
1.  В меню **файл** выберите **подключиться к SQL Server**.  
  
2.  В диалоговом окне Соединение введите или выберите имя экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
    -   При подключении к экземпляру по умолчанию на локальном компьютере можно ввести **localhost** или точку (**.**).  
  
    -   При подключении к экземпляру по умолчанию на другом компьютере введите имя компьютера.  
  
    -   При подключении к именованному экземпляру введите имя компьютера, обратную косую черту и имя экземпляра. Например: Мисервер\минстанце.  
  
3.  В поле **база данных** введите имя целевой базы данных для экспортированных метаданных.  
  
4.  Если экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] настроен для приема подключений по нестандартному порту, введите номер порта, используемый для [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] соединений, в поле **порт сервера** . Для экземпляра по умолчанию [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] номер порта по умолчанию — 1433. Для именованных экземпляров SSMA пытается получить номер порта из [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] службы браузера.  
  
5.  В раскрывающемся меню **Проверка подлинности** выберите тип проверки подлинности, который будет использоваться для соединения. Чтобы использовать текущую учетную запись Windows, выберите **Проверка подлинности Windows**. Чтобы использовать имя [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] входа, выберите **SQL Server проверка подлинности**, а затем укажите имя пользователя и пароль.  
  
Дополнительные сведения о подключении к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] см. [в разделе подключение к SQL Server &#40;акцесстоскл&#41;](../../ssma/access/connecting-to-sql-server-accesstosql.md).  
  
**Экспорт данных инвентаризации**  
  
1.  В обозревателе метаданных Access разверните узел **доступ — метабаза**.  
  
2.  Установите флажок рядом с пунктом **базы данных**.  
  
    Чтобы опустить отдельные базы данных или объекты базы данных, разверните папку **базы данных** , а затем снимите флажок рядом с базой данных или объектом базы данных.  
  
3.  Щелкните правой кнопкой мыши **базы данных** и выберите пункт **экспортировать схему**.  
  
4.  В диалоговом окне **Выбор схемы для экспорта** выберите целевую схему для экспортируемых метаданных и нажмите кнопку **ОК**.  
  
Каждый раз при экспорте метаданных SSMA добавляет данные в инвентаризацию. Существующие данные инвентаризации не обновляются или не удаляются.  
  
## <a name="querying-the-exported-metadata"></a>Запрос экспортированных метаданных  
После экспорта метаданных о базах данных Access можно запрашивать метаданные. Следующие инструкции описывают использование окна редактора запросов в [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] для выполнения запросов.  
  
**Запрос метаданных**  
  
1.  В меню **Пуск** укажите пункт **все программы**, выберите **Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 2005** или **Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 2008** или **Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 2012**, а затем щелкните **SQL Server Management Studio**.  
  
2.  В диалоговом окне **соединение с сервером** проверьте параметры и нажмите кнопку **подключить**.  
  
3.  На панели инструментов Management Studio нажмите кнопку **создать запрос** , чтобы открыть редактор запросов.  
  
4.  В окне редактора запросов введите запрос. Некоторые примеры приведены в следующем разделе.  
  
5.  Нажмите клавишу F5, чтобы выполнить запрос.  
  
## <a name="query-examples"></a>Примеры запросов  
Перед выполнением любого из следующих запросов следует выполнить запрос USE *database_name* , чтобы убедиться, что запросы выполняются для базы данных, содержащей экспортированные метаданные. Например, если вы экспортировали метаданные в базу данных с именем Мякцессметадата, добавьте в начало [!INCLUDE[tsql](../../includes/tsql-md.md)] кода следующее:  
  
```  
USE MyAccessMetadata;  
GO  
```  
В следующих примерах используется схема **dbo** . Если вы экспортировали метаданные в другую схему, не забудьте изменить схему при выполнении этих запросов.  
  
### <a name="what-tables-and-columns-are-in-these-databases"></a>Какие таблицы и столбцы находятся в этих базах данных?  
Следующий запрос соединяет таблицы, содержащие метаданные столбца, таблицы и базы данных, а затем возвращает имена всех баз данных, таблиц и столбцов, отсортированных по имени столбца:  
  
```  
SELECT DatabaseName, TableName, ColumnName   
FROM dbo.SSMA_Access_InventoryColumns C  
JOIN dbo.SSMA_Access_InventoryTables T  
ON C.TableId = T.TableId  
JOIN dbo.SSMA_Access_InventoryDatabases D  
ON T.DatabaseId = D.DatabaseId  
ORDER BY ColumnName;  
```  
  
### <a name="what-are-the-largest-databases"></a>Каковы самые большие базы данных?  
Следующий запрос возвращает имя базы данных, размер файла и число таблиц в каждой базе данных Access, отсортированных по размеру файла:  
  
```  
SELECT DatabaseName, FileSize, TablesCount  
FROM dbo.SSMA_Access_InventoryDatabases  
ORDER BY FileSize DESC;  
```  
  
### <a name="who-is-the-owner-of-most-of-the-databases"></a>Кто является владельцем большинства баз данных?  
Следующий запрос возвращает имя базы данных и владельца каждой базы данных Access, отсортированные по владельцу.  
  
```  
SELECT DatabaseName, FileOwner  
FROM dbo.SSMA_Access_InventoryDatabases  
ORDER BY FileOwner;  
```  
  
### <a name="which-databases-contain-the-same-tables"></a>Какие базы данных содержат одни и те же таблицы?  
Следующий запрос использует вложенный запрос для поиска всех имен таблиц, которые появляются несколько раз в списке таблиц, а затем использует этот список таблиц для получения имени базы данных. Результаты возвращаются в виде имени базы данных, а затем имени таблицы и сортируются по имени таблицы.  
  
```  
SELECT DatabaseName, TableName   
FROM dbo.SSMA_Access_InventoryTables T  
JOIN dbo.SSMA_Access_InventoryDatabases D  
ON D.DatabaseId = T.DatabaseId  
WHERE TableName IN (  
SELECT TableName   
FROM dbo.SSMA_Access_InventoryTables  
GROUP BY TableName   
HAVING count(*)>1  
)  
ORDER BY TableName;  
```  
  
### <a name="which-databases-were-not-modified-in-the-last-six-months"></a>Какие базы данных не были изменены за последние шесть месяцев?  
Следующий запрос возвращает текущую дату, возвращает значение месяца для шести месяцев назад, а затем возвращает список баз данных с измененной датой более шести месяцев назад.  
  
```  
SELECT DatabaseName, DateModified  
FROM dbo.SSMA_Access_InventoryDatabases  
WHERE DATEDIFF(month, DateModified, GETDATE()) > 6  
ORDER BY DateModified;  
```  
  
### <a name="which-databases-contain-private-information"></a>Какие базы данных содержат частные данные?  
Базы данных Access могут содержать конфиденциальные или персональные данные. Может потребоваться переместить эти базы данных в, чтобы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] воспользоваться преимуществами функций безопасности. Если известно, что столбцы, содержащие конфиденциальные данные, имеют определенное имя или содержат определенные символы, можно использовать запрос для поиска всех столбцов, содержащих эти данные. Например, можно найти все столбцы, включающие строку «оклад».  Затем запрос возвращает имя базы данных, имя таблицы и имя столбца.  
  
```  
SELECT DatabaseName, TableName, ColumnName   
FROM dbo.SSMA_Access_InventoryColumns C  
JOIN dbo.SSMA_Access_InventoryTables T  
ON C.TableId = T.TableId  
JOIN dbo.SSMA_Access_InventoryDatabases D  
ON T.DatabaseId = D. DatabaseId  
WHERE ColumnName LIKE '%salary%';  
```  
Если имя столбца неизвестно, можно написать запрос, возвращающий все столбцы. Для этого удалите предложение WHERE из предыдущего запроса.  
  
## <a name="see-also"></a>См. также:  
[Подготовка баз данных Access к миграции](preparing-access-databases-for-migration-accesstosql.md)  
  
