---
title: Разрешения GRANT-DENY-REVOKE
titleSuffix: Azure SQL Data Warehouse
ms.custom: seo-lt-2019
ms.date: 08/10/2017
ms.prod: sql
ms.prod_service: sql-data-warehouse, pdw
ms.reviewer: ''
ms.technology: t-sql
ms.topic: language-reference
dev_langs:
- TSQL
ms.assetid: 5a3b7424-408e-4cb0-8957-667ebf4596fc
author: VanMSFT
ms.author: vanto
monikerRange: '>= aps-pdw-2016 || = azure-sqldw-latest || = sqlallproducts-allversions'
ms.openlocfilehash: c8d19d21b7bcd1e9ab72732dab439355da1794e0
ms.sourcegitcommit: 01297f2487fe017760adcc6db5d1df2c1234abb4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/09/2020
ms.locfileid: "86197427"
---
# <a name="permissions-grant-deny-revoke-azure-sql-data-warehouse-parallel-data-warehouse"></a>Разрешения: Разрешения: GRANT, DENY, REVOKE (хранилище данных SQL Azure, Parallel Data Warehouse)
[!INCLUDE[applies-to-version/asa-pdw](../../includes/applies-to-version/asa-pdw.md)]

  Используйте инструкции [!INCLUDE[ssSDW](../../includes/sssdw-md.md)] или [!INCLUDE[ssPDW](../../includes/sspdw-md.md)]**GRANT** и **DENY**, чтобы предоставить или отклонить разрешение (например, **UPDATE**) для защищаемого объекта (базы данных, таблицы, представления и т. д.) субъекту безопасности (имя входа, пользователь базы данных или роль базы данных). Используйте **REVOKE**, чтобы удалить или отклонить разрешение.  
  
 Разрешения уровня сервера применяются к именам входа. Разрешения уровня базы данных применяются к пользователям и ролям базы данных.  
  
 Чтобы увидеть, какие разрешения были предоставлены и отклонены, воспользуйтесь запросами к представлениям sys.server_permissions и sys.database_permissions. Разрешения субъекта безопасности, которые не были явно предоставлены или отклонены, могут наследоваться с помощью членства в роли, у которой есть разрешения. Разрешения предопределенных ролей базы данных не могут быть изменены и не отображаются в представлениях sys.server_permissions и sys.database_permissions.  
  
-   **GRANT** явным образом предоставляет одно или несколько разрешений.  
  
-   **DENY** явным образом отклоняет одно или несколько разрешений для субъекта.  
  
-   **REVOKE** удаляет существующие разрешения **GRANT** или **DENY**.  
  
 ![Значок ссылки на раздел](../../database-engine/configure-windows/media/topic-link.gif "Значок ссылки на раздел") [Синтаксические обозначения в Transact-SQL &#40;Transact-SQL&#41;](../../t-sql/language-elements/transact-sql-syntax-conventions-transact-sql.md)  
  
## <a name="syntax"></a>Синтаксис  
  
```syntaxsql
-- Azure SQL Data Warehouse and Parallel Data Warehouse  
GRANT   
    <permission> [ ,...n ]  
    [ ON [ <class_type> :: ] securable ]   
    TO principal [ ,...n ]  
    [ WITH GRANT OPTION ]  
[;]  
  
DENY   
    <permission> [ ,...n ]  
    [ ON [ <class_type> :: ] securable ]   
    TO principal [ ,...n ]  
    [ CASCADE ]  
[;]  
  
REVOKE   
    <permission> [ ,...n ]  
    [ ON [ <class_type> :: ] securable ]   
    [ FROM | TO ] principal [ ,...n ]  
    [ CASCADE ]  
[;]  
  
<permission> ::=  
{ see the tables below }  
  
<class_type> ::=  
{  
      LOGIN  
    | DATABASE  
    | OBJECT  
    | ROLE  
    | SCHEMA  
    | USER  
}  
```  
  
## <a name="arguments"></a>Аргументы  
 \<permission>[ **,** ...*n* ]  
 Одно или несколько разрешений для предоставления, запрета или отмены.  
  
 ON [ \<class_type> :: ] *защищаемый _объект* Предложение **ON** указывает защищаемый параметр для предоставления, запрета или отзыва разрешений.  
  
 \<class_type> Тип класса защищаемого объекта. Это может быть один из следующих типов: **LOGIN**, **DATABASE**, **OBJECT**, **SCHEMA**, **ROLE** и **USER**. Разрешения также могут предоставляться для типа класса **SERVER**_class\_type_, но тип класса **SERVER** для этих разрешений не указывается. **DATABASE** не указывается, если разрешение включает слово **DATABASE** (например, **ALTER ANY DATABASE**). Если аргумент *тип_класса* указан и тип разрешения не ограничен классом сервера или базы данных, считается, что используется класс **OBJECT**.  
  
 *securable*  
 Имя входа, база данных, таблица, представление, схема, процедура, роль или пользователь, которым необходимо предоставить или запретить или для которых необходимо отменить разрешения. Имя объекта можно указать с использованием правил именования из трех частей, которые описаны в разделе [Синтаксические обозначения Transact-SQL (Transact-SQL)](../../t-sql/language-elements/transact-sql-syntax-conventions-transact-sql.md).  
  
 TO *principal* [ **,** ...*n* ]  
 Один или несколько субъектов, которым предоставляются или для которых отклоняются или отменяются разрешения. Субъект — это имя входа, пользователь базы данных или роль базы данных.  
  
 FROM *principal* [ **,** ...*n* ]  
 Один или несколько субъектов, для которых отменяются разрешения.  Субъект — это имя входа, пользователь базы данных или роль базы данных. **FROM** может использоваться только в инструкции **REVOKE**. **TO** может использоваться в инструкциях **GRANT**, **DENY** или **REVOKE**.  
  
 WITH GRANT OPTION  
 Показывает, что получающему разрешению будет также дана возможность предоставлять указанное разрешение другим участникам.  
  
 CASCADE  
 Обозначает, что разрешение отклоняется или отменяется для указанного субъекта и всех остальных субъектов, которым этот субъект предоставил разрешение. Требуется, если у субъекта есть разрешение с параметром **GRANT OPTION**.  
  
 GRANT OPTION FOR  
 Указывает, что возможность предоставлять указанное разрешение будет отменена. Данный аргумент необходим при использовании аргумента **CASCADE**.  
  
> [!IMPORTANT]  
>  Если субъект обладает указанным разрешением без параметра **GRANT**, будет отменено само разрешение.  
  
## <a name="permissions"></a>Разрешения  
 Чтобы предоставить разрешение, объект, предоставляющий разрешение, должен иметь либо само разрешение, выданное с помощью параметра **GRANT OPTION**, либо разрешение более высокого уровня, которое неявно включает предоставляемое разрешение.  Владельцы объектов могут предоставлять разрешения на объекты, которыми они владеют. Субъекты, имеющие разрешение **CONTROL** для защищаемого объекта, могут предоставлять разрешение для этого защищаемого объекта.  Члены предопределенных ролей базы данных **db_owner** и **db_securityadmin** могут предоставлять любые разрешения в базе данных.  
  
## <a name="general-remarks"></a>Общие замечания  
 Отклонение или отмена разрешений для субъекта не повлияет на уже выполняемые запросы, которые прошли авторизацию. Чтобы немедленно ограничить доступ, необходимо отменить активные запросы или завершить текущие сеансы.  
  
> [!NOTE]  
>  Большинство предопределенных ролей сервера не доступны в этом выпуске. Вместо этого используйте пользовательские роли базы данных. Имена входа не могут быть добавлены в предопределенную роль сервера **sysadmin**. Для предоставления разрешения **CONTROL SERVER** требуется членство в предопределенной роли сервера **sysadmin**.  
  
 Для некоторых инструкций требуется несколько разрешений. Например, чтобы создать таблицу, необходимы разрешения **CREATE TABLE** в базе данных и разрешение **ALTER SCHEMA** для таблицы, которая будет содержать таблицу.  
  
 PDW иногда выполняет хранимые процедуры для распределения действий пользователя на вычислительные узлы. Поэтому разрешение на выполнение для всей базы данных не может быть отклонено. (Например, инструкция `DENY EXECUTE ON DATABASE::<name> TO <user>;` завершится с ошибкой.) В качестве обходного решения можно отклонить разрешение на выполнение для пользовательских схем или конкретных объектов (процедур).  
  
### <a name="implicit-and-explicit-permissions"></a>Явные и неявные разрешения  
 *Явное разрешение* — это разрешение **GRANT** или **DENY**, предоставляемое субъекту с помощью инструкции **GRANT** или **DENY**.  
  
 *Неявное разрешение* — разрешение **GRANT** или **DENY**, которое субъект (имя входа, пользователь или роль базы данных) унаследовал от другой роли базы данных.  
  
 Неявное разрешение также может быть унаследовано от покрытия или родительского разрешения. Например, разрешение **UPDATE** для таблицы может быть унаследовано, если у схемы, содержащей таблицу, есть разрешение **UPDATE** или если у таблицы есть разрешение **CONTROL**.  
  
### <a name="ownership-chaining"></a>Цепочки владения  
 Если несколько объектов базы данных последовательно обращаются друг к другу, такая последовательность называется *цепочкой*. Такие цепочки не могут существовать независимо, но когда [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] проходит по звеньям цепи, то [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] проверяет разрешения составляющих объектов иначе, нежели при раздельном доступе к объектам. Цепочка владения влияет на управление безопасностью. Дополнительные сведения о цепочках владения см. в разделах [Цепочки владения](https://msdn.microsoft.com/library/ms188676\(v=sql11\).aspx) и [Руководство: цепочки владения и переключение контекста](../../relational-databases/tutorial-ownership-chains-and-context-switching.md).  
  
## <a name="permission-list"></a>Список разрешений  
  
### <a name="server-level-permissions"></a>Разрешения уровня сервера  
 Разрешения уровня сервера можно назначать, отклонять и отменять для учетных записей.  
  
 **Разрешения, которые применяются к серверам**  
  
-   CONTROL SERVER  
  
-   ADMINISTER BULK OPERATIONS  
  
-   ALTER ANY CONNECTION  
  
-   ALTER ANY DATABASE  
  
-   CREATE ANY DATABASE  
  
-   ALTER ANY EXTERNAL DATA SOURCE  
  
-   ALTER ANY EXTERNAL FILE FORMAT  
  
-   ALTER ANY LOGIN  
  
-   ALTER SERVER STATE  
  
-   CONNECT SQL  
  
-   VIEW ANY DEFINITION  
  
-   VIEW ANY DATABASE  
  
-   VIEW SERVER STATE  
  
 **Разрешения, которые применяются к именам входа**  
  
-   CONTROL ON LOGIN  
  
-   ALTER ON LOGIN  
  
-   IMPERSONATE ON LOGIN  
  
-   VIEW DEFINITION  
  
### <a name="database-level-permissions"></a>Разрешения уровня базы данных  
 Разрешения уровня базы данных могут предоставляться, отклоняться и отменяться для пользователей базы данных и пользовательских ролей базы данных.  
  
 **Разрешения, которые применяются ко всем классам базы данных**  
  
-   CONTROL  
  
-   ALTER  
  
-   VIEW DEFINITION  
  
 **Разрешения, которые применяются ко всем классам базы данных за исключением пользователей**  
  
-   TAKE OWNERSHIP  
  
 **Разрешения, которые применяются только к базам данных**  
  
-   ALTER ANY DATABASE  
  
-   ALTER ON DATABASE  
  
-   ALTER ANY DATASPACE  
  
-   ALTER ANY ROLE  
  
-   ALTER ANY SCHEMA  
  
-   ALTER ANY USER  
  
-   BACKUP DATABASE  
  
-   CONNECT ON DATABASE  
  
-   CREATE PROCEDURE  
  
-   CREATE ROLE  
  
-   CREATE SCHEMA  
  
-   CREATE TABLE  
  
-   CREATE VIEW  
  
-   SHOWPLAN  
  
 **Разрешения, которые применяются только к пользователям**  
  
-   IMPERSONATE  
  
 **Разрешения, которые применяются к базам данных, схемам и объектам**  
  
-   ALTER  
  
-   DELETE  
  
-   EXECUTE  
  
-   INSERT  
  
-   SELECT  
  
-   UPDATE  
  
-   REFERENCES  
  
 Определение каждого типа разрешений см. в разделе [Разрешения (ядро СУБД)](https://msdn.microsoft.com/library/ms191291.aspx).  
  
### <a name="chart-of-permissions"></a>Диаграмма разрешений  
 На этой диаграмме графически представлены все разрешения. Это самый простой способ просмотра вложенной иерархии разрешений. Например, разрешение **ALTER ON LOGIN** можно предоставить само по себе, но оно также включается, если имени входа предоставляется разрешение **CONTROL** или **ALTER ANY LOGIN**.  
  
 ![Плакат о разрешениях безопасности APS](../../t-sql/statements/media/aps-security-perms-poster.png "Плакат о разрешениях безопасности APS")  
  
 Полноразмерную версию этой диаграммы можно скачать в разделе [Разрешения SQL Server PDW](https://go.microsoft.com/fwlink/?LinkId=244249) в разделе "Файлы" на сайте APS Yammer (или запросить ее по электронной почте **apsdoc\@microsoft.com**).  
  
## <a name="default-permissions"></a>Разрешения по умолчанию  
 Разрешения по умолчанию приведены в следующем списке:  
  
-   При создании имени входа с помощью инструкции **CREATE LOGIN** новое имя входа получает разрешение **CONNECT SQL**.  
  
-   Все имена входа являются участниками роли сервера **public** и не могут быть удалены из роли **public**.  
  
-   При создании пользователя базы данных с разрешением **CREATE USER** пользователь базы данных получает разрешение **CONNECT** в базе данных.  
  
-   Все субъекты, включая роль **public**, по умолчанию не имеют явных или неявных разрешений.  
  
-   Если имя входа и пользователь становятся владельцами базы данных или объекта, у имени входа или пользователя всегда есть разрешения для базы данных или объекта. Разрешения владельца не могут быть изменены и не отображаются как явные разрешения. Инструкции **GRANT**, **DENY** и **REVOKE** не оказывают влияния на владельцев.  
  
-   У имени входа **sa** есть все разрешения на устройстве. Как и разрешения владельца, разрешения **sa** не могут быть изменены и не отображаются как явные разрешения. Инструкции **GRANT**, **DENY** и **REVOKE** не оказывают влияния на имя входа **sa**. Имя входа **sa** не может быть переименовано.  
  
-   Для использования инструкции **USE** не требуются разрешения. Любой субъект может выполнить инструкцию **USE** с любой базой данных.  
  
##  <a name="examples-sssdw-and-sspdw"></a><a name="Examples"></a> Примеры: [!INCLUDE[ssSDW](../../includes/sssdw-md.md)] и [!INCLUDE[ssPDW](../../includes/sspdw-md.md)]  
  
### <a name="a-granting-a-server-level-permission-to-a-login"></a>A. Предоставление разрешения уровня сервера для имени входа  
 Две следующие инструкции предоставляют разрешение уровня сервера для имени входа.  
  
```  
GRANT CONTROL SERVER TO [Ted];  
```  
  
```  
GRANT ALTER ANY DATABASE TO Mary;  
```  
  
### <a name="b-granting-a-server-level-permission-to-a-login"></a>Б. Предоставление разрешения уровня сервера для имени входа  
 В следующем примере разрешение уровня сервера для имени входа предоставляется субъекту сервера (другому имени входа).  
  
```  
GRANT  VIEW DEFINITION ON LOGIN::Ted TO Mary;  
```  
  
### <a name="c-granting-a-database-level-permission-to-a-user"></a>В. Предоставление разрешения уровня базы данных пользователю  
 В следующем примере разрешение уровня базы данных для пользователя предоставляется субъекту базы данных (другому пользователю).  
  
```  
GRANT VIEW DEFINITION ON USER::[Ted] TO Mary;  
```  
  
### <a name="d-granting-denying-and-revoking-a-schema-permission"></a>Г. Предоставление, отклонение и отмена разрешения схемы  
 Следующая инструкция **GRANT** предоставляет Yuen возможность выбора данных из любой таблицы или представления в схеме dbo.  
  
```  
GRANT SELECT ON SCHEMA::dbo TO [Yuen];  
```  
  
 Следующая инструкция **DENY** запрещает Yuen выбирать данные из всех таблиц и представлений в схеме dbo. Пользователь Yuen не сможет считать данные, даже если у него есть разрешение, полученное другим способом, например через членство в роли.  
  
```  
DENY SELECT ON SCHEMA::dbo TO [Yuen];  
```  
  
 Следующая инструкция **REVOKE** удаляет разрешение **DENY**. Теперь явные разрешения пользователя Yuen нейтральны. Yuen может выбирать данные из любой таблицы с помощью неявных разрешений, например, членства в роли.  
  
```  
REVOKE SELECT ON SCHEMA::dbo TO [Yuen];  
```  
  
### <a name="e-demonstrating-the-optional-object-clause"></a>Д. Демонстрация необязательного предложения OBJECT::  
 Поскольку OBJECT является классом по умолчанию для разрешения инструкции, следующие две инструкции одинаковы. Предложение **OBJECT::** является необязательным.  
  
```  
GRANT UPDATE ON OBJECT::dbo.StatusTable TO [Ted];  
```  
  
```  
GRANT UPDATE ON dbo.StatusTable TO [Ted];  
```  
  
  

