---
title: Каталог базы данных WideWorldImporters OLTP-SQL | Документация Майкрософт
description: Изучите схемы, таблицы, хранимые процедуры и рекомендации по проектированию для образца каталога базы данных WideWorldImporters.
ms.prod: sql
ms.prod_service: sql
ms.technology: samples
ms.custom: ''
ms.date: 04/04/2018
ms.reviewer: ''
ms.topic: conceptual
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: d4502a64a3822741c1928fcf6faee69d80d893d5
ms.sourcegitcommit: 59c09dbe29882cbed539229a9bc1de381a5a4471
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/11/2020
ms.locfileid: "79112402"
---
# <a name="wideworldimporters-database-catalog"></a>Каталог базы данных WideWorldImporters
[!INCLUDE[appliesto-ss-asdb-xxxx-xxx-md](../includes/appliesto-ss-asdb-xxxx-xxx-md.md)]
База данных WideWorldImporters содержит всю информацию о транзакциях и ежедневные данные по продажам и покупкам, а также данные датчиков для транспортных средств и холодных помещений.

## <a name="schemas"></a>Схемы

WideWorldImporters использует схемы для различных целей, например для хранения данных, определения способа доступа пользователей к данным и предоставления объектов для разработки и интеграции хранилища данных.

### <a name="data-schemas"></a>схемы данных;

Эти схемы содержат данные. Некоторые таблицы необходимы для всех других схем и находятся в схеме приложения.

|схема|Описание|
|-----------------------------|---------------------|
|Приложение|Пользователи, контакты и параметры уровня приложения. Он также содержит ссылочные таблицы с данными, которые используются в нескольких схемах.|
|Приобретение|Товары на покупку от поставщиков и сведения о поставщиках.|  
|Sales|Продажа номенклатуры розничным клиентам и сведения о клиентах и продавцах. |  
|Warehouse|Инвентаризация и проводки по запасам товаров.|  

### <a name="secure-access-schemas"></a>Схемы безопасного доступа

Эти схемы используются для внешних приложений, которым запрещен доступ к таблицам данных напрямую. Они содержат представления и хранимые процедуры, используемые внешними приложениями.

|схема|Описание|
|-----------------------------|---------------------|
|Веб-сайт|Весь доступ к базе данных с веб-сайта компании осуществляется с помощью этой схемы.|
|Отчеты|Все доступ к базе данных из Reporting Services отчетов осуществляется с помощью этой схемы.|
|PowerBI|Все доступ к базе данных с панелей мониторинга Power BI через корпоративный шлюз осуществляется с помощью этой схемы.|

Обратите внимание, что в первоначальном выпуске образца базы данных не используются схемы Reports и PowerBI. Однако все примеры Reporting Services и Power BI, созданные на базе этой базы данных, рекомендуется использовать в этих схемах.

### <a name="development-schemas"></a>Схемы разработки

Специализированные схемы

|схема|Описание|
|-----------------------------|---------------------|
|Интеграция|Объекты и процедуры, необходимые для интеграции хранилища данных (т. е. Миграция данных в базу данных WideWorldImportersDW).|
|Последовательности;|Содержит последовательности, используемые всеми таблицами в приложении.|

## <a name="tables"></a>Таблицы

Все таблицы в базе данных находятся в схемах данных.

### <a name="application-schema"></a>Схема приложения

Сведения о параметрах и людях (пользователи и контакты), а также общие справочные таблицы (общие для нескольких других схем).

|Таблица|Описание|
|-----------------------------|---------------------|
|SystemParameters|Содержит настраиваемые параметры для всей системы.|
|Люди|Содержит имена пользователей, контактные данные, для всех, кто использует приложение, а также для лиц, с которыми сталкиваются универсальные импортери в организациях клиентов. Сюда входят сотрудники, клиенты, поставщики и другие контакты. Для пользователей, которым предоставлено разрешение на использование системы или веб-сайта, информация содержит сведения об имени входа.|
|Городов|Существует множество адресов, хранящихся в системе, для людей, адресов доставки Организации клиентов, адресов подбора у поставщиков и т. д. При каждом хранении адреса в этой таблице есть ссылка на город. Также существует пространственное расположение для каждого города.|
|статепровинцес|Города являются частью Штатов или провинции. Эта таблица содержит подробные сведения о них, включая пространственные данные, описывающие границы каждого штата или Республики.|
|Страны|Штаты или провинции являются частью стран. Эта таблица содержит подробные сведения о них, включая пространственные данные, описывающие границы каждой страны.|
|деливеримесодс|Варианты доставки товаров на бирже (например, грузовик/Van, POST, подбор, Courier и т. д.).|
|пайментмесодс|Варианты оплаты (например, денежные средства, платежные деньги, EFT и т. д.)|
|трансактионтипес|Типы операций клиента, поставщика или акции (например, счета, кредит-нота и т. д.).|

### <a name="purchasing-schema"></a>Схема приобретения

Сведения о поставщиках и покупках номенклатур запасов.

|Таблица|Описание|
|-----------------------------|---------------------|
|Suppliers|Таблица основных сущностей для поставщиков (организации)|
|супплиеркатегориес|Категории поставщиков (например, новелтиес, Toys, одежда, Упаковка и т. д.)|
|супплиертрансактионс|Все финансовые транзакции, связанные с поставщиками (счета, платежи)|
|PurchaseOrders|Сведения о заказах на покупку поставщика|
|пурчасеордерлинес|Строки сведений от заказов на покупку поставщика|

 
### <a name="sales-schema"></a>Схема продаж

Сведения о клиентах, продавцах и продаже номенклатуры запасов.

|Таблица|Описание|
|-----------------------------|---------------------|
|Клиенты|Таблицы основных сущностей для клиентов (организаций или отдельных лиц)|
|кустомеркатегориес|Категории для клиентов (новизна Stores, Супермаркетс и т. д.)|
|буйингграупс|Организации клиентов могут быть частью групп, которые в большей степени покупают энергию.|
|кустомертрансактионс|Все финансовые операции, связанные с клиентом (счета, платежи)|
|спеЦиалдеалс|Специальные цены. Это может быть фиксированная цена, скидка в долларах или процент скидки.|
|Заказы|Сведения о заказах клиентов|
|OrderLines|Строки детализации из заказов клиентов|
|Счета|Сведения о счетах клиента|
|инвоицелинес|Строки сведений из счетов клиентов|

### <a name="warehouse-schema"></a>Схема хранилища

Сведения об элементах запасов, их удержаниях и транзакциях.

|Таблица|Описание|
|-----------------------------|---------------------|
|стоккитемс|Таблица основных сущностей для номенклатур запасов|
|стоккитемхолдингс|Нетемпоральный столбец для номенклатур запасов. Это часто обновляемые столбцы.|
|стоккграупс|Группы для категоризации элементов акции (например, новелтиес, Toys, едибле новелтиес и т. д.)|
|стоккитемстоккграупс|Какие номенклатуры запасов в каких складских группах (многие ко многим)|
|Цвета|Элементы акции могут (при необходимости) иметь цвета|
|Элемента packagetypes|Способы упаковки номенклатуры запасов (например, Box, коробки, палеты, кг и т. д.)|
|стоккитемтрансактионс|Транзакции, охватывающие все перемещения всех элементов запасов (получение, продажа, списание)|
|вехиклетемпературес|Регулярно записанные температуры автомобиля холодильниками|
|колдрумтемпературес|Часто записываются температуры холодного помещения холодильниками|


## <a name="design-considerations"></a>Рекомендации по проектированию

Проектирование базы данных является субъективным, и не существует правильного или неправильного способа разработки базы данных. Схемы и таблицы в этой базе данных показывают идеи по проектированию собственной базы данных.

### <a name="schema-design"></a>Структура схемы

WideWorldImporters использует небольшое количество схем, чтобы легко понять систему баз данных и продемонстрировать принципы работы с базами данных.  

Везде, где это возможно, база данных объединяет таблицы, которые обычно запрашиваются, в одну и ту же схему для снижения сложности объединения.

Схема базы данных сформирована кодом на основе ряда таблиц метаданных в другой базе данных WWI_Preparation. Это дает WideWorldImporters очень высокую степень согласованности проектирования, согласованности имен и полноты. Дополнительные сведения о создании схемы см. в разделе исходный код: широкие средства [импорта/WWI-Database-Scripts](https://github.com/Microsoft/sql-server-samples/tree/master/samples/databases/wide-world-importers/sample-scripts) .

### <a name="table-design"></a>конструктору таблиц;

- Все таблицы имеют первичные ключи одного столбца для простоты объединения.
- Все схемы, таблицы, столбцы, индексы и проверочные ограничения имеют расширенное свойство Description, которое может быть использовано для того, чтобы определить назначение объекта или столбца. Таблицы, оптимизированные для памяти, являются исключением из-за того, что в настоящее время они не поддерживают расширенные свойства.
- Все внешние ключи индексируются автоматически, если нет другого некластеризованного индекса с тем же левым компонентом.
- Автоматическая нумерация в таблицах основана на последовательностях. Эти последовательности проще работать с другими связанными серверами и аналогичными средами, чем столбцы ИДЕНТИФИКАТОРов. В таблицах, оптимизированных для памяти, используются столбцы ИДЕНТИФИКАТОРов, так как они не поддерживаются в SQL Server 2016.
- Для этих таблиц используется одна последовательность (ИД транзакции): Кустомертрансактионс, Супплиертрансактионс и Стоккитемтрансактионс. Это показывает, как набор таблиц может иметь одну последовательность.
- Некоторые столбцы имеют соответствующие значения по умолчанию.

### <a name="security-schemas"></a>Схемы безопасности

В целях безопасности WideWorldImporters не позволяет внешним приложениям напрямую обращаться к схемам данных. Для изоляции доступа WideWorldImporters использует схемы доступа к безопасности, которые не содержат данных, но содержат представления и хранимые процедуры. Внешние приложения используют схемы безопасности для получения данных, которые они могут просматривать.  Таким образом, пользователи могут запускать только представления и хранимые процедуры в схемах безопасного доступа.

Например, этот пример включает Power BI панели мониторинга. Внешнее приложение обращается к этим Power BI панелям мониторинга из шлюза Power BI как пользователь, имеющий разрешение только на чтение схемы PowerBI.  Для разрешения только для чтения пользователю требуется только разрешение SELECT и EXECUTE для схемы PowerBI. Администратор базы данных в WWI назначает эти разрешения по мере необходимости.

## <a name="stored-procedures"></a>Хранимые процедуры

Хранимые процедуры организованы в схемы. Большая часть схем используется для настройки или целей выборки.

`Website` Схема содержит хранимые процедуры, которые могут использоваться внешним веб-интерфейсом.

Схемы `Reports` и `PowerBI` предназначены для служб Reporting Services и PowerBI. Для создания отчетов рекомендуется использовать эти схемы в качестве расширений образца.

### <a name="website-schema"></a>Схема веб-сайта

Это процедуры, используемые клиентским приложением, например внешним веб-интерфейсом.

|Процедура|Назначение|
|-----------------------------|---------------------|
|активатевебсителогон|Разрешает пользователю (от `Application.People`) доступ к веб-сайту.|
|ChangePassword;|Изменяет пароль пользователя (для пользователей, не использующих внешние механизмы проверки подлинности).|
|инсерткустомерордерс|Позволяет вставить один или несколько заказов клиентов (включая строки заказа).|
|инвоицекустомерордерс|Принимает список заказов для выставления счетов и обрабатывает счета.|
|рекордколдрумтемпературес|Принимает список данных датчика в качестве возвращающего табличное значение параметра (TVP) и применяет данные к `Warehouse.ColdRoomTemperatures` темпоральной таблице.|
|рекордвехиклетемпературе|Принимает массив JSON и использует его для обновления `Warehouse.VehicleTemperatures`.|
|сеарчфоркустомерс|Поиск клиентов по имени или части имени (название компании или имя пользователя).|
|сеарчфорпеопле|Поиск людей по имени или части имени.|
|сеарчфорстоккитемс|Поиск по названию стандартных элементов по имени или части имени или маркетинговых комментариев.|
|сеарчфорстоккитемсбитагс|Выполняет поиск элементов акции по тегам.|
|сеарчфорсупплиерс|Поиск поставщиков по имени или части имени (название компании или имя пользователя).|

### <a name="integration-schema"></a>Схема интеграции

Хранимые процедуры в этой схеме используются процессом ETL. Они получают данные, необходимые из различных таблиц, в течение времени, необходимого для [пакета ETL](wide-world-importers-perform-etl.md).

### <a name="dataloadsimulation-schema"></a>Схема Даталоадсимулатион

Имитирует рабочую нагрузку, которая вставляет продажи и покупки. Основной хранимой процедурой `PopulateDataToCurrentDate`является, которая используется для вставки образца данных вплоть до текущей даты.

|Процедура|Назначение|
|-----------------------------|---------------------|
|Configuration_ApplyDataLoadSimulationProcedures|Повторно создает процедуры, необходимые для моделирования загрузки данных. Это необходимо для переноса данных на текущую дату.|
|Configuration_RemoveDataLoadSimulationProcedures|После завершения имитации данных процедуры снова удаляются.|
|деактиватетемпоралтаблесбефоредаталоад|Удаляет временную природу всех временных таблиц и, если это применимо, применяет триггер, чтобы изменения могли быть сделаны, как если бы они были применены в более ранней дате, чем разрешено для таблиц sys-темпоральной.|
|популатедататокуррентдате|Используется для переноса данных на текущую дату. Следует запускать перед любыми другими параметрами конфигурации после восстановления базы данных из первоначальной резервной копии.|
|реактиватетемпоралтаблесафтердаталоад|Повторно устанавливает временные таблицы, включая проверку согласованности данных. (Удаляет связанные триггеры).|


### <a name="application-schema"></a>Схема приложения

Эти процедуры используются для настройки образца. Они используются для применения функций Enterprise Edition к стандартной версии образца, а также для добавления аудита и полнотекстового индексирования.

|Процедура|Назначение|
|-----------------------------|---------------------|
|аддролемемберифнонексистант|Добавляет элемент в роль, если элемент еще не находится в роли|
|Configuration_ApplyAuditing|Добавляет аудит. Аудит сервера применяется к базам данных Standard Edition. в выпуск Enterprise Edition добавлен дополнительный аудит базы данных.|
|Configuration_ApplyColumnstoreIndexing|Применяет индексацию columnstore к `Sales.OrderLines` соответствующим образом и `Sales.InvoiceLines` повторно индексирует их.|
|Configuration_ApplyFullTextIndexing|Применяет полнотекстовые `Application.People`индексы `Purchasing.Suppliers`к, `Warehouse.StockItems` `Sales.Customers`, и. Заменяет `Website.SearchForPeople`, `Website.SearchForSuppliers`, `Website.SearchForCustomers`, `Website.SearchForStockItems`, `Website.SearchForStockItemsByTags` процедуры замены, использующие полнотекстовое индексирование.|
|Configuration_ApplyPartitioning|Применяет секционирование `Sales.CustomerTransactions` таблиц `Purchasing.SupplierTransactions`к и, а также упорядочивает индексы в соответствии с ними.|
|Configuration_ApplyRowLevelSecurity|Применяет безопасность на уровне строк для фильтрации клиентов по ролям продаж, связанным с территорией.|
|Configuration_ConfigureForEnterpriseEdition|Применяет индексацию columnstore, полный текст, в памяти, polybase и секционирование.|
|Configuration_EnableInMemory|Добавляет оптимизированную для памяти файловую группу (если не работает в Azure) `Warehouse.ColdRoomTemperatures`, `Warehouse.VehicleTemperatures` заменяет, с помощью эквивалентов в памяти и переносит данные, повторно `Website.OrderIDList`создает типы, `Website.OrderList`, `Website.OrderLineList`, `Website.SensorDataList` таблицы с оптимизированными для памяти эквивалентами, удаляет и повторно создает процедуры `Website.InvoiceCustomerOrders`, `Website.InsertCustomerOrders`и `Website.RecordColdRoomTemperatures` использует эти табличные типы.|
|Configuration_RemoveAuditing|Удаляет конфигурацию аудита.|
|Configuration_RemoveRowLevelSecurity|Удаляет конфигурацию безопасности на уровне строк (это необходимо для изменений в связанных таблицах).|
|креатеролеифнонексистант|Создает роль базы данных, если она еще не существует.|


### <a name="sequences-schema"></a>Схема последовательностей

Процедуры для настройки последовательностей в базе данных.

|Процедура|Назначение|
|-----------------------------|---------------------|
|ресидаллсекуенцес|Вызывает процедуру Ресидсекуенцебэйондтаблевалуе для всех последовательностей.|
|ресидсекуенцебэйондтаблевалуе|Используется для перемещения следующего значения последовательности после значения в любой таблице, использующей ту же последовательность. (Например, DBCC CHECKIDENT для столбцов идентификаторов, эквивалентных для последовательностей, но в потенциально нескольких таблицах).|
