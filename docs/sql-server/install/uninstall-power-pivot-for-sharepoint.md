---
title: Удаление Power Pivot для SharePoint | Документация Майкрософт
ms.custom: ''
ms.date: 03/01/2017
ms.prod: sql
ms.reviewer: ''
ms.suite: sql
ms.technology: install
ms.tgt_pltfrm: ''
ms.topic: conceptual
ms.assetid: 3941a2f0-0d0c-4d1a-8618-7a6a7751beac
author: markingmyname
ms.author: maghan
manager: kfile
ms.openlocfilehash: 49f29fe95801b792444dcd69edfc630b78fe580b
ms.sourcegitcommit: abd71294ebc39695d403e341c4f77829cb4166a8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "36926985"
---
# <a name="uninstall-power-pivot-for-sharepoint"></a>Удаление Power Pivot для SharePoint
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

  Удаление установки [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] — это многоэтапная процедура, состоящая из подготовки к удалению, удаления компонентов и решений из фермы и удаления файлов программ и параметров реестра.  
  
 **[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013 | SharePoint 2010  
  
 **В этой статье:**  
  
-   [Предварительные требования](#prereq)  
  
-   [Шаг 1. Контрольный список действий перед удалением](#bkmk_before)  
  
-   [Шаг 2. Удаление функций и решений из SharePoint](#bkmk_remove)  
  
-   [Шаг 3. Запуск программы установки SQL Server для удаления программ с локального компьютера](#bkmk_uninstall)  
  
-   [Шаг 4. Удаление надстройки Power Pivot для SharePoint](#bkmk_addin)  
  
-   [Шаг 5. Проверка удаления](#verify)  
  
-   [Шаг 6. Контрольный список действий после удаления](#bkmk_post)  
  
##  <a name="prereq"></a> Предварительные требования  
  
-   Для удаления функций и решений из фермы необходимо обладать правами администратора фермы SharePoint или администратора служебного приложения.  
  
-   Если также требуется удалить компонент Database Engine, то необходимо быть системным администратором SQL Server и членом локальной группы администраторов.  
  
-   Для удаления служб Analysis Services и [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]необходимо быть администратором служб Analysis Services и членом локальной группы администраторов.  
  
##  <a name="bkmk_before"></a> Шаг 1. Контрольный список действий перед удалением  
 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . В качестве первого шага необходимо предварительно удалить файлы и библиотеки, работа с которыми далее будет невозможна. Это позволит решить все проблемы «отсутствия данных» перед началом удаления программного обеспечения.  
  
1.  Удалите все книги, документы и библиотеки [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , которые связаны с установкой [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint. После удаления ПО эти библиотеки и документы перестанут работать.  
  
    -   [Удаление коллекции Power Pivot](../../analysis-services/power-pivot-sharepoint/delete-power-pivot-gallery.md)  
  
    -   [Удаление библиотеки веб-каналов данных Power Pivot](../../analysis-services/power-pivot-sharepoint/delete-a-power-pivot-data-feed-library.md)  
  
2.  Удалите книги Excel и отчеты служб Reporting Services в других библиотеках, которые содержат ссылки на данные [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
3.  Удалите все веб-части на панели мониторинга PerformancePoint, которые ссылаются на данные [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
4.  Просмотрите разрешения SharePoint на существующих сайтах и библиотеках, чтобы определить, нуждаются ли они в изменении. Для некоторых сценариев доступа к [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , например для вспомогательного доступа к данным [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] в другой книге через строку подключения по URL-адресу, требуется разрешение для чтения, уровень которого выше разрешения на просмотр, обычно назначаемого пользователям SharePoint, которые только заходят на сайт. Если разрешение на чтение больше не нужно, его можно соответствующим образом понизить.  
  
5.  Можно также остановить службы и подождать несколько дней, а затем переустановить ПО. Этот шаг не является необходимым для удаления, но он позволяет возобновить обслуживание на время, необходимое для выполнения миграции данных или решения технических проблем, которые еще не решены.  
  
##  <a name="bkmk_remove"></a> Шаг 2. Удаление функций и решений из SharePoint  
 Используйте средство настройки [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для удаления служб и приложений [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] из SharePoint.  
  
-   Пользователь должен быть администратором фермы, администратором сервера в экземпляре служб Analysis Services и членом роли **db_owner** в базе данных конфигурации фермы.  
  
-   Используйте версию средства настройки, соответствующую версии SharePoint. Не используйте ни одно из них для [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] .  
  
-   Убедитесь, что служба администрирования SharePoint запущена.  
  
1.  **Запустите средство настройки** . Обратите внимание, что средства настройки отображаются только в том случае, когда [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] установлен на локальном сервере. В меню **Пуск** последовательно выберите **Все программы**, [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], **Средства настройки**, а затем один из следующих вариантов.  
  
    -   **[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint 2013**  
  
    -   **[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] Средство настройки**  
  
2.  Выберите **Удаление компонентов, служб, приложений и решений** и нажмите кнопку **ОК**.  
  
3.  Либо разверните окно в полный размер. Внизу окна должна появиться строка кнопок с командами **Проверить**, **Выполнить**и **Завершить работу** .  
  
4.  Просмотрите каждое действие в списке задач, чтобы понять, что каждое из них делает.  
  
     В диалоговом окне **Удаление приложений служб [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]** можно выбрать вариант удаления данных приложения, связанных с приложением служб. Данные приложения — это база данных SQL Server, которая была создана вместе с приложением служб с целью хранения расписаний обновления данных, информации об экземплярах баз данных, данных об использовании и других данных, используемых [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint. Данные приложения не хранят пользовательские файлы, такие как книги [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Если нет особых причин сохранения данных приложения (например, если реализуется политика сохранения данных, связанная с обновлением данных и доступом к ним), базу данных приложения можно удалить без удаления файлов, созданных или сохраненных пользователями SharePoint.  
  
     Чтобы удалить базу данных, выберите **Удаление приложений служб [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]**, а затем **Удаление данных приложения, связанных с этим приложением службы**.  
  
5.  При необходимости просмотрите подробную информацию на вкладке **Вывод** или **Скрипт** .  
  
     Вкладка «Вывод» содержит краткое описание действий, которые будут выполнены средством. Эти сведения сохраняются в файлах журналов, расположенных в:  
  
     `C:\Program Files\Microsoft SQL Server\130\Tools\PowerPivotTools\SPAddinConfiguration\Log`  
  
     Вкладка «Скрипт» содержит командлеты PowerShell или ссылки на файлы скриптов PowerShell, которые будут выполнены средством.  
  
6.  Нажмите кнопку **Проверка** , чтобы убедиться, что каждое действие является допустимым. Если кнопка **Проверка** недоступна, значит, все действия являются допустимыми.  
  
7.  Нажмите кнопку **Запуск** , чтобы выполнить все действия, которые являются допустимыми для данной задачи. Кнопка**Запуск** становится доступной только после прохождения проверки. При нажатии кнопки **Запуск**появится предупреждение о том, что действия обрабатываются в пакетном режиме: «Все параметры конфигурации, помеченные средством как действительные, будут применены к ферме SharePoint. Продолжить?»  
  
8.  Чтобы продолжить, нажмите кнопку **Да** .  
  
 **Устранение ошибок**  
  
 В средстве настройки на панели «Параметры» можно просмотреть сведения об ошибке для каждого действия. Для решения проблем, связанных с развертыванием или откатом решения, убедитесь, что запущена служба администрирования SharePoint. Эта служба запускает задания таймера, которые вызывают изменения конфигурации фермы. Если служба не запущена, развертывание или откат решения будет невозможен. Повторяющиеся ошибки указывают на то, что существующее задание развертывания или отката уже поставлено в очередь и происходит блокирование дальнейших действий средства настройки. Чтобы удостовериться в том, что служба запущена, можно выполнить следующую команду PowerShell.  
  
```  
Get-Service | where {$_.displayname -like "*sharepoint* administration*"}  
```  
  
 Чтобы найти и удалить задание развертывания или отката, уже поставленное в очередь, выполните следующие действия.  
  
1.  Сведения о других ошибках см. в журналах ULS. Дополнительные сведения см. в разделе [Настройка и просмотр файлов журнала SharePoint и журнала диагностики (Power Pivot для SharePoint)](~/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging.md).  
  
2.  Запустите консоль управления SharePoint с учетной записью администратора и выполните следующую команду для просмотра заданий, поставленных в очередь:  
  
    ```  
    Stsadm –o enumdeployments  
    ```  
  
3.  Просмотрите существующие развертывания для уточнения следующих сведений: **Тип** — откат или развертывание, **Файл** — powerpivotwebapp.wsp или powerpivotfarm.wsp.  
  
4.  Для развертываний или откатов, связанных с решениями [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , копируйте значение GUID для **JobId** и вставьте его в следующую команду (воспользуйтесь командами "Пометить", "Копировать" и "Вставить" в меню правки Shell, чтобы копировать GUID):  
  
    ```  
    Stsadm –o canceldeployment –id “<GUID>”  
    ```  
  
5.  Повторите задачу в средстве настройки, нажав кнопку **Проверка** , а затем кнопку **Запуск**.  
  
 Кроме того, для удаления функций и решений можно воспользоваться PowerShell. Дополнительные сведения см. в разделе [Справочник по PowerShell для Power Pivot для SharePoint](../../analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint.md).  
  
##  <a name="bkmk_uninstall"></a> Шаг 3. Запуск программы установки SQL Server для удаления программ с локального компьютера  
 Для удаления программных файлов необходимо запустить программу установки SQL Server в режиме удаления ПО. При этом будут удалены файлы и записи в реестре, созданные в процессе установки. Для удаления ПО можно использовать страницу «Программы и компоненты». [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] является компонентом установки SQL Server.  
  
 Частично удалить установленные компоненты можно, не затрагивая другие уже установленные экземпляры SQL Server (или функции в том же экземпляре). Например, можно удалить [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint и оставить другие компоненты, например службы [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] или ядро СУБД.  
  
1.  Выберите в списке программ **Microsoft SQL Server 2014 (64-разрядная)** .  
  
2.  Нажмите кнопку **Удалить/изменить**.  
  
3.  Щелкните **Удалить**. Запустится программа установки SQL Server.  
  
     В программе установки можно выбрать экземпляр **[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]** , а затем установить флажки **Службы Analysis Services** и **Интеграция служб Analysis Services с SharePoint** , чтобы удалить только эти компоненты, оставив все остальные.  
  
##  <a name="bkmk_addin"></a> Шаг 4. Удаление надстройки Power Pivot для SharePoint  
 Если развертывание служб [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] имеет два или более сервера и установлена надстройка служб [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , то, чтобы полностью удалить все файлы [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , удалите надстройку служб [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] на каждом сервере, где она установлена. Дополнительные сведения см. в разделе [Установка или удаление надстройки Power Pivot для SharePoint (SharePoint 2013)](../../analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md)необходимо быть администратором служб Analysis Services и членом локальной группы администраторов.  
  
##  <a name="verify"></a> Шаг 5. Проверка удаления  
  
1.  В центре администрирования в окне **Управление службами на сервере**установите соединение с сервером, с которого удалена надстройка [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint.  
  
2.  -   Если вы удалили [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013, убедитесь в том, что в списке отсутствует элемент **Системная служба SQL Server [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]**.  
  
    -   Если вы удалили [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010, убедитесь в том, что в списке отсутствуют элементы **Службы SQL Server Analysis Services** и **Системная служба SQL Server [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]**.  
  
3.  После удаления последнего сервера [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint из фермы выполните следующие действия.  
  
    1.  В окне "Управление приложениями" в разделе **Управление приложениями службы**убедитесь, что в списке отсутствует приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
    2.  В окне "Системные параметры" в разделе **Управление возможностями фермы**убедитесь, что на странице отсутствует функция интеграции с [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . В разделе **Управление решениями фермы**убедитесь, что на странице отсутствуют решения [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
    3.  В окне "Мониторинг" в разделах **Настройка средств сбора данных диагностики** и **Настройка сбора данных об использовании и исправности**убедитесь, что отсутствуют события и категории событий [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
    4.  В окне "Общие параметры приложения" убедитесь в том, что на странице отсутствует **Панель мониторинга управления [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]**.  
  
##  <a name="bkmk_post"></a> Шаг 6. Контрольный список действий после удаления  
 Используйте следующий список, чтобы удалить программное обеспечение и файлы, которые не были удалены в процессе отмены установки.  
  
1.  Удалите все файлы данных и вложенные папки из `C:\Program Files\Microsoft SQL Server\MSAS13.PowerPivot`, а затем удалите эту папку. На этом шаге также будут удалены все ранее кэшированные файлы в каталоге DATA.  
  
2.  Удалите все книги, документы и библиотеки [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , если это еще не сделано.  
  
    -   [Удаление коллекции Power Pivot](../../analysis-services/power-pivot-sharepoint/delete-power-pivot-gallery.md)  
  
    -   [Удаление библиотеки веб-каналов данных Power Pivot](../../analysis-services/power-pivot-sharepoint/delete-a-power-pivot-data-feed-library.md)  
  
3.  В службе Secure Store удалите все целевые приложения, которые содержат сохраненные учетные данные, которые используются в [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint. Некоторые, но не все записи в службе Secure Store стираются при удалении [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint. Целевые приложения, созданные для учетной записи автоматического обновления данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , а также все целевые приложения, созданные для обновления данных, еще существуют и должны быть удалены вручную.  
  
     В отличие от них, отдельные целевые приложения, созданные автоматически системной службой [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , удаляются автоматически при удалении [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
4.  На панели управления щелкните **Программы**, а затем **Удалить программу** . Удалите все клиентские библиотеки служб Analysis Services, которые больше не используются. Объекты ADOMD.NET и управляющие объекты Microsoft SQL Server Analysis Services при удалении [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint не удаляются. Поскольку эти библиотеки могут использоваться другими программами, работающими с данными служб Analysis Services, программа установки SQL Server не удаляет их автоматически. Клиентские библиотеки, которые больше не нужны, необходимо удалять по отдельности.  
  
     Не удаляйте надстройку служб SQL Server Reporting Services для SharePoint 2010, если далее не содержится инструкций по устранению неполадок или по установке, которые явным образом предписывают их удалить. Надстройка служб Reporting Services используется службами доступа. Они устанавливаются программой подготовки установки продуктов SharePoint и могут остаться в системе для поддержки функций, которые необходимы SharePoint.  
  
     Не удаляйте поставщик OLE DB для служб Analysis Services. SharePoint устанавливает поставщик OLE DB как предварительное требование для книг Excel, которые устанавливают соединение с базами данных служб Analysis Services. [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] устанавливает новую версию, но эта версия обратно совместима, поэтому ее лучше оставить в системе, чтобы впоследствии избежать проблем при подключении к данным.  
  
## <a name="see-also"></a>См. также:  
 [Установка или удаление надстройки Power Pivot для SharePoint (SharePoint 2013)](../../analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md)   
 [Средства настройки PowerPivot](../../analysis-services/power-pivot-sharepoint/power-pivot-configuration-tools.md)  
  
  
