---
title: Большие таблицы журнала резервного копирования или восстановления делают обновление неотвечающим | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- backup history tables
- history tables
ms.assetid: f88d86ec-324b-4518-b6d7-1af7e7265812
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: 918c20f58c00c535d8ed41d887e9671f5e821a17
ms.sourcegitcommit: 57f1d15c67113bbadd40861b886d6929aacd3467
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/18/2020
ms.locfileid: "85059223"
---
# <a name="large-backup-or-restore-history-tables-make-upgrade-appear-to-not-respond"></a>Резервное копирование или восстановление больших таблиц журналов может привести к кажущемуся отсутствию ответа от процесса обновления
  В [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] в некоторые таблицы журнала резервного копирования и восстановления были добавлены новые столбцы. При обновлении этих таблиц требуется изменить их для добавления новых столбцов. Если одна или несколько из этих таблиц содержит большое количество строк, обновление задержится на длительное время на инструкции ALTER TABLE, которая добавляет столбцы в эту таблицу.  
  
## <a name="component"></a>Компонент  
 [!INCLUDE[ssDE](../../includes/ssde-md.md)]  
  
## <a name="description"></a>Описание  
 Обновление может перестать отвечать, если любая из следующих таблиц резервного копирования или восстановления содержит большое количество строк:  
  
-   **backupfile;**  
  
-   **backupmediafamily;**  
  
-   **backupmediaset;**  
  
-   **backupset;**  
  
-   **restorefile;**  
  
-   **restorefilegroup;**  
  
-   **restorehistory.**  
  
 Если любая из этих таблиц содержит 10 000 или более строк, то помощник по обновлению сообщает об ошибке несоответствия. Не сообщается, какая таблица превысила разрешенное число строк. Первая таблица, число строк в которой превышает 10 000, вызывает ошибку.  
  
## <a name="corrective-action"></a>Действие по исправлению  
 Если какая-либо таблица содержит более 10 000 строк, то, прежде чем обновить базу данных, рекомендуется уменьшить число строк так, чтобы оно стало меньше 10 000. Чтобы сократить количество строк во всех этих таблицах, можно запустить хранимую процедуру **sp_delete_backuphistory** . Эта процедура удаляет из всех таблиц журнала резервного копирования и восстановления записи, относящиеся к резервным наборам данных, которые старше указанной даты. Дополнительные сведения см. в разделе [sp_delete_backuphistory (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-delete-backuphistory-transact-sql).  
  
> [!NOTE]  
>  Можно обновить базу данных, таблицы журнала резервного копирования и восстановления которой содержат более 10 000 строк. Однако при изменении больших таблиц может показаться, что процесс обновления остановился. Чем больше таблица, тем больше времени требуется для завершения программы установки.  
  
## <a name="see-also"></a>См. также:  
 [Проблемы обновления ядро СУБД](../../../2014/sql-server/install/database-engine-upgrade-issues.md)   
 [Советник по переходу SQL Server 2014 &#91;New&#93;](sql-server-2014-upgrade-advisor.md)  
  
  
