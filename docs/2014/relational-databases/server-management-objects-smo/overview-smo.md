---
title: Общие сведения об SMO | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
ms.assetid: e988f9e8-6801-41d1-8069-726f487244d5
author: stevestein
ms.author: sstein
manager: craigg
ms.openlocfilehash: b66a0c9efc94d648eba2f4d4f8cff779def413fe
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "63131808"
---
# <a name="overview-smo"></a>Общие сведения об SMO
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Управляющие объекты (SMO) представляют собой объекты, разработанные для программного управления [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Объекты SMO можно использовать для создания специализированных приложений управления [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Хотя среда [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] является мощным и универсальным приложением для управления [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], иногда удобнее работать с приложением SMO.  
  
 К примеру, для удовлетворения потребностей новых пользователей, а также с целью сокращения издержек на подготовку персонала может возникнуть необходимость упрощения пользовательских приложений, выполняющих задачи управления [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Может возникнуть необходимость в создании специализированных баз данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или в создании приложения для формирования индексов и наблюдения за их эффективностью. Кроме того, приложение SMO можно использовать для бесшовной интеграции аппаратных или программных компонентов от независимых поставщиков в приложение управления базами данных.  
  
 Модель объектов SMO расширяет и замещает модель объектов DMO (SQL-DMO). По сравнению с моделью объектов SQL-DMO модель SMO повышает производительность, управляемость и облегчает использование. Почти все функциональные возможности SQL-DMO включены в модель объектов SMO, и, кроме того, в этой модели реализованы различные новые классы, поддерживающие новые возможности в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Объектная модель интуитивно понятна: там, где это возможно, в ней применяется терминология SQL-DMO, что дает возможность использовать имеющиеся навыки.  
  
 Поскольку модель объектов SMO совместима с [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и более поздними версиями, облегчается работа с продуктами различных версий.  
  
 К новым возможностям, реализованным в модели объектов SMO, относятся следующие.  
  
-   Модель кэшированных объектов и оптимизированная процедура создания экземпляров объектов. Объекты загружаются только тогда, когда на них производится ссылка. Свойства объекта загружаются при создании объекта лишь частично. Остальные объекты и свойства загружаются, когда на них делается прямая ссылка.  
  
-   Пакетное выполнение инструкций [!INCLUDE[tsql](../../includes/tsql-md.md)] . Инструкции передаются пакетами для повышения производительности сети.  
  
-   Сбор инструкций [!INCLUDE[tsql](../../includes/tsql-md.md)] . Позволяет помещать любую операцию в скрипт. В среде [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] эта возможность используется для создания скрипта для операции вместо непосредственного ее выполнения.  
  
-   Управление службами [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с помощью поставщика WMI. Службы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] можно запускать, а также прекращать и приостанавливать их работу программными средствами.  
  
-   Дополнительные возможности скриптов. Можно формировать скрипты [!INCLUDE[tsql](../../includes/tsql-md.md)] для повторного создания объектов [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], которые описывают связи с другими объектами экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
-   Использование уникальных имен ресурсов (URN). URN позволяет создавать экземпляры объектов SMO и ссылаться на такие объекты.  
  
 В модели объектов SMO в виде новых объектов и свойств представлены многие функции и компоненты, введенные в [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]. В число этих новых функций и компонентов включены следующие.  
  
-   Секционирование таблиц и индексов для хранения данных в схеме секционирования. Дополнительные сведения см. в разделе [Partitioned Tables and Indexes](../partitions/partitioned-tables-and-indexes.md).  
  
-   Конечные точки HTTP для управления SOAP-запросами. Дополнительные сведения см. в разделе [Implementing Endpoints](tasks/implementing-endpoints.md).  
  
-   Изоляция моментальных снимков и управление версиями на уровне строк для повышения параллелизма. Дополнительные сведения см. в разделе [Working with Snapshot Isolation](../native-client/features/working-with-snapshot-isolation.md).  
  
-   Коллекции схем XML, XML-индексы и типы данных XML, обеспечивающие проверку и хранение XML-данных. Дополнительные сведения см. в разделе [коллекции XML-схем &#40;SQL Server&#41; ](../xml/xml-schema-collections-sql-server.md) и [Using XML Schemas](tasks/using-xml-schemas.md).  
  
-   Базы данных моментальных снимков, позволяющие создавать копии баз данных только для чтения.  
  
-   Поддержка компонентом [!INCLUDE[ssSB](../../includes/sssb-md.md)] обмена информацией на основе сообщений. Дополнительные сведения см. в разделе [SQL Server Service Broker](../../database-engine/configure-windows/sql-server-service-broker.md).  
  
-   Поддержка синонимов для множества имен объектов баз данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Дополнительные сведения см. в разделе [синонимы &#40;СУБД&#41;](../synonyms/synonyms-database-engine.md).  
  
-   Управление компонентом Database Mail, которое позволяет создавать серверы электронной почты, профили электронной почты и учетные записи электронной почты в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Дополнительные сведения см. в разделе [Database Mail](../database-mail/database-mail.md).  
  
-   Поддержка зарегистрированных серверов для регистрации сведений о соединении. Дополнительные сведения см. в разделе [Register Servers](../../ssms/register-servers/register-servers.md).  
  
-   Трассировка и воспроизведение событий [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Дополнительные сведения см. в разделах [SQL Server Profiler](../../tools/sql-server-profiler/sql-server-profiler.md), [SQL Trace](../sql-trace/sql-trace.md), [SQL Server Distributed Replay](../../tools/distributed-replay/sql-server-distributed-replay.md)и [Extended Events](../extended-events/extended-events.md).  
  
-   Поддержка сертификатов и ключей для управления безопасностью. Дополнительные сведения см. в разделе [Encryption Hierarchy](../security/encryption/encryption-hierarchy.md).  
  
-   Триггеры DDL, обеспечивающие дополнительные функции при возникновении DDL-событий. Дополнительные сведения см. в разделе [DDL Triggers](../triggers/ddl-triggers.md).  
  
 Пространство имен объектов SMO — <xref:Microsoft.SqlServer.Management.Smo>. Объекты SMO реализованы в виде сборки [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)]. Это означает, что перед использованием объектов SMO нужно установить среду CLR из [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] 2.0. Сборки объектов SMO по умолчанию устанавливаются в глобальный кэш сборок с параметром пакета SDK [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Эти сборки размещаются в [!INCLUDE[ssSampPathSDK](../../includes/sssamppathsdk-md.md)]. Дополнительные сведения см. в разделе [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] документации.  
  
## <a name="smo-classes"></a>Классы модели объектов SMO  
 Классы модели объектов SMO подразделяются на две категории: классы экземпляров и служебные классы.  
  
 **Классы экземпляров**  
  
 Классы экземпляров представляют объекты [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , такие как серверы, базы данных, таблицы, триггеры и хранимые процедуры. Класс <xref:Microsoft.SqlServer.Management.Common.ServerConnection> используется для установления соединения с экземпляром [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и для управления режимом сбора направляемых ему команд.  
  
 Объекты экземпляра модели SMO образуют иерархию, которая представляет иерархию сервера баз данных. Вверху размещаются экземпляры [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], под ними располагаются базы данных, а далее — таблицы, столбцы, триггеры и т. д. Если логика допускает возможность существования связи «один родитель ко многим потомкам», например в таблице с одним или несколькими столбцами, тогда потомок представляется коллекцией объектов. В других случаях потомок представляется одним объектом.  
  
 **Служебные классы**  
  
 Служебные классы — это группа объектов, созданных явным образом для выполнения конкретных задач. В соответствии со своими функциями они разделяются на различные иерархии объектов.  
  
-   Класс Transfer. Используется для передачи другой базе данных схемы и данных.  
  
-   Классы Backup и Restore. Используются для создания резервной копии и восстановления баз данных.  
  
-   Класс Scripter. Используется для формирования файлов скриптов, предназначенных для повторного создания объектов и их зависимостей.  
  
## <a name="new-smo-features"></a>Новые возможности объектов SMO  
 **Оптимизированная производительность**  
  
 При использовании объектов SQL-DMO для перечисления объектов необходимо, чтобы каждый объект в коллекции был полностью создан. Это неэффективно с точки зрения использования памяти и сетевых каналов связи. Во многих случаях для создания объекта не обязательно явно ссылаться на большинство его свойств.  
  
 С точки зрения использования памяти архитектура модели объектов SMO более эффективна, потому что на первом этапе объекты создаются лишь частично и от сервера требуются минимальные сведения по их свойствам. Полное создание объектов откладывается до того времени, когда выполняется явная ссылка на объект. Объект полностью создается тогда, когда требуется свойство, не входящее в набор изначально полученных свойств, или когда вызывается метод, требующий такое свойство. Переход от частично полностью созданных объектов к полностью созданным незаметен для пользователя. Кроме того, некоторые свойства, использующие большие объемы памяти, так и не считываются — если только не выполняется явное обращение к подобному свойству. Примером сказанному может служить свойство <xref:Microsoft.SqlServer.Management.Smo.Database.Size%2A> свойства объекта <xref:Microsoft.SqlServer.Management.Smo.Database>. Однако при частичном создании объектов возникает большее количество обменов данными через сеть, и потому с точки зрения производительности этот метод не обязательно будет наиболее эффективным для приложения.  
  
 Созданием экземпляров объектов можно управлять в соответствии с особенностями системной среды. При использовании метода отложенного создания экземпляров объем памяти, необходимый для работы приложения, сводится к минимуму, но на этапе обращения к свойствам может возникнуть большое число запросов к серверу.  
  
 Классы экземпляров (объекты, представляющие реальные объекты баз данных) могут существовать на трех уровнях создания. Эти уровни: минимальный экземпляр (лишь минимально необходимые свойства считываются в одном блоке), частично созданный экземпляр (все свойства, использующие относительно большие объемы памяти, считываются в одном блоке) и полностью созданный экземпляр. Традиционные состояния создания экземпляров — несозданный и полностью созданный. Состояние «частично созданный» повышает эффективность, так как частично созданный объект не содержит значений для полного набора свойств объекта. Состояние «частично созданный» применяется по умолчанию для объектов, на которые нет непосредственных ссылок. При обращении к одному из этих свойств возникает ошибка, которая инициирует создание полного экземпляра объекта.  
  
 **Выполнение после сбора**  
  
 Обычным методом выполнения является непосредственное выполнение. Инструкции передаются экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] непосредственно по получении. Выполнение после сбора является альтернативным методом.  
  
 Выполнение после сбора дает возможность собирать пакеты [!INCLUDE[tsql](../../includes/tsql-md.md)] , которые обычно выполняются. В результате программист модели объектов SMO может отложить скрипт, сохранить его для выполнения в более поздний период или выполнить предварительный просмотр скрипта для конечного пользователя. Так, инструкции `create database`, `create table` и `create index` могут быть переданы в одном пакете и затем выполнены как три последовательных шага. Этой функцией управляет пользователь с помощью объекта <xref:Microsoft.SqlServer.Management.Smo.Server.%23ctor%2A>.  
  
 **Поставщик WMI**  
  
 Объекты поставщика WMI помещаются в объекты SMO. В результате программист модели SMO получает простую модель объектов, весьма напоминающую классы SMO. Однако в этом случае программист не должен понимать модель программирования, представленную пространством имен, и особенности организации поставщика WMI [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Поставщик WMI позволяет конфигурировать службы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , псевдонимы, а также сетевые библиотеки клиентов и серверов.  
  
 **Создание скриптов**  
  
 В модели объектов SMO средства для работы со скриптами были улучшены и переданы в класс `Scripter`. `Scripter` Класс может находить зависимости, выявлять связи между объектами и осуществлять манипуляции с иерархией зависимостей. Главным объектом, обеспечивающим работу со скриптами, является объект `Scripter`. Существует несколько поддерживающих объектов, которые осуществляют обработку зависимостей, а также реагируют на события состояния и на события ошибок.  
  
 Объект `Scripter` поддерживает следующие дополнительные параметры создания скриптов:  
  
-   простой однофазный метод (скрипт создается за один этап);  
  
-   усовершенствованный трехфазный метод (обнаружение зависимостей, формирование списков, создание скрипта);  
  
-   двусторонний поиск зависимостей (позволяет выявлять зависимости, или зависимые элементы);  
  
-   реагирование на события состояния;  
  
-   реагирование на события ошибок.  
  
 **Уникальные имена ресурсов**  
  
 Ключевая концепция при использовании библиотеки объектов SMO — уникальные имена ресурсов (URN). Синтаксис URN напоминает синтаксис XPath. XPath — это путь иерархии, используемый для указания объекта, в котором каждый уровень имеет квалификаторы и функции. В модели объектов SMO URN имеет два элемента — путь, а также именование атрибутов, обладающее ограниченными функциональными возможностями. Путь используется для указания местоположения объекта, тогда как именование атрибутов дает возможность осуществлять частичную фильтрацию.  
  
 Пример URN для базы данных:  
  
```  
/Server/Database[@Name='Adventureworks2012']  
```  
  
 URN объекта может быть получен с помощью ссылки на его свойство URN. Объект Scripter тоже использует имена URN в качестве параметров, которые передают ссылки на объект методу объекта `Scripter`. Кроме того, URN можно указывать для **GetSmoObject** метод `Server` объекта. Это делается для того, чтобы создать экземпляр объекта SMO.  
  
## <a name="new-sql-server-features-represented-in-smo"></a>Новые возможности SQL Server, реализованные в объектах SMO  
 **Секционирование таблиц и индексов**  
  
 Секционирование таблицы индексов дает возможность управлять распределением данных в таблицах и индексах по файловым группам. Эта новая функция представлена в объектах SMO.  
  
 **Конечные точки**  
  
 Запросы SOAP, а также запросы на зеркальное отображение баз данных обрабатываются конечными точками с использованием объекта <xref:Microsoft.SqlServer.Management.Smo.Endpoint>.  
  
 **Моментальный снимок управление версиями на уровне изоляции и строк**  
  
 Уровень изоляции моментального снимка (управление версиями на уровне строк) представлены свойствами нового объекта <xref:Microsoft.SqlServer.Management.Smo.Database>.  
  
 **Пространство имен схемы XML, XML-индексы и тип данных XML**  
  
 Пространства имен схемы XML представлены в модели объектов SMO коллекцией объектов. XML-индексы представлены в модели SMO свойством объекта `Index`.  
  
 **Расширенные возможности полнотекстового поиска**  
  
 В модели объектов SMO реализованы новые объекты, представляющие расширенные возможности полнотекстового поиска.  
  
 **Проверка страниц**  
  
 Объект <xref:Microsoft.SqlServer.Management.Smo.DatabaseOptions.PageVerify%2A> представляет параметры проверки страниц баз данных.  
  
 **Моментальный снимок базы данных**  
  
 База данных моментальных снимков — это предназначенная только для чтения копия указанной базы данных, снятая в указанный момент времени. База данных моментальных снимков может быть определена с помощью свойства <xref:Microsoft.SqlServer.Management.Smo.Database.IsDatabaseSnapshot%2A> объекта <xref:Microsoft.SqlServer.Management.Smo.Database>.  
  
 **Компонент Service Broker**  
  
 Компонент [!INCLUDE[ssSB](../../includes/sssb-md.md)] и его функциональные возможности представлены группой объектов  
  
 **Улучшенные возможности индексов**  
  
 Улучшенные возможности индексов [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] представлены новыми свойствами объекта <xref:Microsoft.SqlServer.Management.Smo.Index>.  
  
## <a name="smo-and-sql-dmo"></a>Модели объектов SMO и SQL-DMO  
 Объектная модель SMO замещает и заменяет модель SQL-DMO. Объекты SMO поддерживаются в [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и более поздних версиях. Эта модель поддерживает большее число задач управления [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и включает в себя множество новых средств [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Модель SMO предназначена для того, чтобы обеспечить более высокую эффективность и предоставить дополнительные возможности управления.  
  
 Библиотека DMO представляет собой объектную модель COM, тогда как модель SMO реализована в виде сборки [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] . Компоненты COM — это библиотеки, которые предоставляют пригодные для повторного использования средства приложениям и в программировании неуправляемых приложений. Сборки [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] предоставляют пригодные для повторного использования средства для [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] с целью написания приложений с управляемым кодом.  
  
 При переходе к использованию технологии [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] можно применять приложения, написанные частично с помощью управляемого, а частично — неуправляемого кода. [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] дает возможность взаимодействовать с компонентами COM, для чего требуется основная сборка взаимодействия. Для объекта SQL-DMO требуется оболочка среды выполнения, чтобы к нему можно было обращаться из приложения на базе платформы [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)].  
  
## <a name="see-also"></a>См. также  
 [Основные понятия объектов RMO](../replication/concepts/replication-management-objects-concepts.md)  
  
  
