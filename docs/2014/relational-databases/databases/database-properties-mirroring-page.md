---
title: Свойства базы данных (страница "Зеркальное отображение") | Документация Майкрософт
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- database-engine
ms.topic: conceptual
f1_keywords:
- sql12.swb.databaseproperties.mirroring.f1
ms.assetid: 5bdcd20f-532d-4ee6-b2c7-18dbb7584a87
author: stevestein
ms.author: sstein
manager: craigg
ms.openlocfilehash: dc4c0179205eb027b6723f9f3ddb0d0bbd92f547
ms.sourcegitcommit: 3da2edf82763852cff6772a1a282ace3034b4936
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2018
ms.locfileid: "48058724"
---
# <a name="database-properties-mirroring-page"></a>Свойства базы данных (страница «Зеркальное отображение»)
  Откройте эту страницу из основной базы данных и используйте ее для настройки и изменения свойств зеркального отображения базы данных. Также можно использовать эту страницу для запуска мастера настройки безопасности зеркального отображения баз данных, для просмотра состояния сеанса зеркального отображения и для приостановки или удаления сеанса зеркального отображения базы данных.  
  
> [!IMPORTANT]  
>  Перед тем как начать отображение, необходимо настроить безопасность. Если зеркальное отображение еще не запущено, необходимо начать зеркальное отображение с помощью мастера. Текстовые поля страницы **Зеркальное отображение** отключены до тех пор, пока мастер не закончит свою работу.  
  
 **Настройка зеркального отображения базы данных в среде SQL Server Management Studio**  
  
-   [Создание сеанса зеркального отображения базы данных с использованием проверки подлинности Windows (среда SQL Server Management Studio)](../../database-engine/database-mirroring/establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="options"></a>Параметры  
 **Настройка безопасности**  
 Нажмите эту кнопку для запуска **Мастера настройки безопасности зеркального отображения баз данных.**  
  
 Если работа мастера завершена успешно, дальнейшие действия зависят от того, было ли уже начато зеркальное отображение.  
  
|||  
|-|-|  
|Если зеркальное отображение не началось|На странице свойств кэшируются сведения об этом соединении, а также кэшируется значение, показывающее, установлено ли для зеркальной базы данных свойство участника.<br /><br /> В конце работы мастера отображается запрос на запуск зеркального отображения базы данных, используя сетевые адреса сервера и режим работы по умолчанию. Если необходимо изменить адреса или режим работы, нажмите кнопку **Не начинать зеркальное отображение**.|  
|Если зеркальное отображение началось|Если следящий сервер был изменен в мастере, он настраивается соответствующим образом.|  
  
 **Сетевые адреса серверов**  
 Для всех экземпляров сервера предусмотрен аналогичный параметр: **Субъект**, **Зеркало**и **Свидетель**.  
  
 Сетевые адреса экземпляров сервера определяются автоматически после того, как завершится работа мастера настройки безопасности зеркального отображения баз данных. После завершения работы мастера при необходимости можно изменить сетевые адреса вручную.  
  
 Сетевой адрес сервера имеет следующий базовый синтаксис:  
  
 TCP**://***fully_qualified_domain_name***:***port*  
  
 где  
  
-   *fully_qualified_domain_name* — это сервер, н котором существует экземпляр сервера.  
  
-   *порт* является портом, назначенным в конечной точке зеркального отображения базы данных экземпляра сервера.  
  
     Для участия в зеркальном отображении базы данных серверу требуется конечная точка зеркального отображения базы данных. Если первый сеанс зеркального отображения для экземпляра сервера устанавливается с помощью мастера настройки безопасности зеркального отображения баз данных, то мастер автоматически создает конечную точку и настраивает ее для применения проверки подлинности Windows. Сведения об использовании мастера с проверкой подлинности на основе сертификатов см. в разделе [Создание сеанса зеркального отображения базы данных с использованием проверки подлинности Windows (среда SQL Server Management Studio)](../../database-engine/database-mirroring/establish-database-mirroring-session-windows-authentication.md).  
  
    > [!IMPORTANT]  
    >  Каждый экземпляр сервера должен иметь ровно одну конечную точку зеркального отображения базы данных, независимо от числа поддерживаемых сеансов зеркального отображения.  
  
 Например, для экземпляра сервера в системе с именем `DBSERVER9` , для конечной точки которого используется порт `7022`, сетевой адрес может быть таким:  
  
```  
TCP://DBSERVER9.COMPANYINFO.ADVENTURE-WORKS.COM:7022  
```  
  
 Дополнительные сведения см. в разделе [Указание сетевого адреса сервера (зеркальное отображение базы данных)](../../database-engine/database-mirroring/specify-a-server-network-address-database-mirroring.md).  
  
> [!NOTE]  
>  Во время сеанса зеркального отображения базы данных экземпляры основного и зеркального серверов изменять нельзя. Однако экземпляр следящего сервера можно изменять во время сеанса. Дополнительные сведения см. в подразделе «Примечания» далее в этом разделе.  
  
 **Начать отображение**  
 Нажмите, чтобы начать зеркальное отображение, если выполняются все перечисленные ниже условия.  
  
-   Существует зеркальная база данных.  
  
     Перед началом отображения необходимо создать зеркальную базу данных путем восстановления на зеркальном сервере последней полной резервной копии и, возможно, резервных копий журналов основной базы данных с помощью команды WITH NORECOVERY. Дополнительные сведения см. в разделе [Подготовка зеркальной базы данных к зеркальному отображению (SQL Server)](../../database-engine/database-mirroring/prepare-a-mirror-database-for-mirroring-sql-server.md).  
  
-   TCP-адреса экземпляров основного и зеркального серверов уже заданы (в разделе **Сетевые адреса серверов**).  
  
-   Если задан режим работы высокого уровня безопасности с автоматической отработкой отказа (синхронный), то также указывается TCP-адрес экземпляра зеркального сервера.  
  
-   Настройки безопасности заданы верно.  
  
 Чтобы запустить сеанс, нажмите кнопку **Начать отображение** . Компонент «Database Engine» пытается автоматически подключиться к участнику зеркального отображения, чтобы получить подтверждение, что зеркальный сервер настроен правильно, и начать сеанс зеркального отображения. Если зеркальное отображение может быть запущено, создается задание для контроля базы данных.  
  
 **Приостановить** или **Возобновить**  
 Чтобы приостановить сеанс, во время сеанса зеркального отображения базы данных нажмите кнопку **Приостановить** . Запрашивается подтверждение. Если нажать кнопку **Да**, то сеанс будет приостановлен, а кнопка изменится на **Продолжить**. Чтобы возобновить сеанс, нажмите кнопку **Продолжить**.  
  
 Дополнительные сведения о влиянии приостановки сеанса см. в разделе [Приостановка и возобновление зеркального отображения базы данных (SQL Server)](../../database-engine/database-mirroring/database-mirroring-sql-server.md).  
  
> [!IMPORTANT]  
>  После принудительного обслуживания при повторном подключении исходного основного сервера зеркальное отображение приостанавливается. Возобновление зеркального отображения в данной ситуации может привести к потере данных исходным основным сервером. Дополнительные сведения о том, как действовать при возможной потере данных, см. в разделе [Переключение ролей во время сеанса зеркального отображения базы данных (SQL Server)](../../database-engine/database-mirroring/role-switching-during-a-database-mirroring-session-sql-server.md).  
  
 **Удалить отображение**  
 На экземпляре основного сервера нажмите кнопку для остановки сеанса и удаления конфигурации зеркального отображения из баз данных. Запрашивается подтверждение. При нажатии кнопки **Да**сеанс будет остановлен, а зеркальное отображение — удалено. Дополнительные сведения о последствиях удаления зеркального отображения базы данных см. в статье [Удаление зеркального отображения базы данных (SQL Server)](../../database-engine/database-mirroring/removing-database-mirroring-sql-server.md).  
  
> [!NOTE]  
>  Если на экземпляре сервера существует только зеркальная база данных, то задание по контролю удаляется.  
  
 **Отработка отказа**  
 Нажмите для ручного перехода с основной базы данных на зеркальную.  
  
> [!NOTE]  
>  Если сеанс зеркального отображения работает в высокопроизводительном режиме, отработка отказа вручную не поддерживается. Для отработки отказа вручную сначала необходимо изменить режим работы на режим **Высокая безопасность без автоматической отработки отказа (синхронный)**. После завершения отработки отказа можно переключиться обратно на режим **Высокая производительность (асинхронный)** на экземпляре нового основного сервера.  
  
 Будет запрошено подтверждение. При нажатии кнопки **Да**будет выполнена попытка перехода отработки отказа. Основной сервер начинает работу с подключения к зеркальному серверу, используя проверку подлинности Windows. Если проверка подлинности Windows не работает, основной сервер выводит диалоговое окно **Соединение с сервером** . Если зеркальный сервер использует проверку подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , выберите вариант **Проверка подлинности SQL Server** в поле **Проверка подлинности** . Укажите в текстовом поле **Имя входа** учетную запись входа, с которой устанавливается соединения на зеркальном сервере, а в текстовом поле **Пароль** — пароль для этой учетной записи.  
  
 Если отработка отказа выполняется успешно, диалоговое окно **Свойства базы данных** закрывается. Роли основного и зеркального серверов меняются: бывшая зеркальная база данных становится основной базой данных, и наоборот. Обратите внимание, что окно **Свойства базы данных** станет недоступным для прежней основной базы данных, поскольку она теперь стала зеркальной. После отработки отказа это окно будет доступно в новой основной базе данных.  
  
 При ошибке отработки отказа отображается сообщение об ошибке, а диалоговое окно останется открытым.  
  
> [!IMPORTANT]  
>  Если нажать кнопку **Отработка отказа** после изменения свойств в окне **Свойства базы данных** эти изменения будут потеряны. Чтобы сохранить текущие изменения, нажмите кнопку **Нет** в запросе подтверждения и сохраните изменения, нажав кнопку **ОК** . Затем снова откройте окно свойств базы данных и нажмите кнопку **Отработка отказа**.  
  
 **Режим работы**  
 При необходимости можно изменить режим работы. Доступность определенных режимов работы зависит от того, задан ли TCP-адрес для следящего сервера. Существуют следующие варианты выбора.  
  
|Параметр|Следящий сервер|Объяснение|  
|------------|--------------|-----------------|  
|**Высокая производительность (асинхронный)**|NULL (при наличии не используется, но сеансу требуется кворум)|Чтобы добиться максимальной производительности, зеркальная база данных всегда отражает прошедшее состояние основной базы данных, никогда полностью не совпадая с ней. Однако разрыв между базами данных, как правило, очень мал. Потеря участника приведет к следующим последствиям.<br /><br /> Если экземпляр зеркального сервера становится недоступным, основной сервер продолжает работу.<br /><br /> Если экземпляр основного сервера становится недоступным, зеркало останавливается. Но если в сеансе отсутствует следящий сервер (как рекомендуется) или если следящий сервер подключен к зеркальному серверу, то зеркальный сервер остается доступным в режиме «горячего» резервирования. Владелец базы данных может включить принудительное обслуживание на экземпляре зеркального сервера (с возможной потерей данных).|  
|**Высокая безопасность без автоматической отработки отказа (синхронный)**|Нет|Гарантируется запись всех фиксированных транзакций на диск зеркального сервера. Отработка отказа вручную возможен, если участники соединены друг с другом. Потеря участника приведет к следующим последствиям.<br /><br /> Если экземпляр зеркального сервера становится недоступным, основной сервер продолжает работу.<br /><br /> Если экземпляр основного сервера становится недоступным, зеркальный сервер останавливается, но остается доступным в режиме «горячего» резервирования. Владелец базы данных может включить принудительное обслуживание на экземпляре зеркального сервера (с возможной потерей данных).|  
|**Высокий уровень безопасности с автоматическим переходом на другой ресурс (синхронным)**|Да (требуется)|Максимальная доступность путем включения экземпляра следящего сервера для обеспечения автоматической отработки отказа. Обратите внимание, что параметр **Высокая безопасность с автоматической отработкой отказа (синхронный)** можно выбрать только после того, как будет задан адрес следящего сервера. Отработка отказа вручную возможен, когда участники соединены друг с другом. **\*\* Важно! \*\*** Если следящий сервер отключается, для обеспечения доступности базы данных участники должны быть соединены друг с другом. Дополнительные сведения см. в разделе [Кворум: как следящий сервер влияет на доступность базы данных (зеркальное отображение базы данных)](../../database-engine/database-mirroring/quorum-how-a-witness-affects-database-availability-database-mirroring.md).<br /><br /> В синхронных режимах работы гарантируется запись всех зафиксированных транзакций на диск зеркального сервера. При наличии следящего сервера потеря участника повлечет следующие последствия:<br /><br /> Если экземпляр основного сервера становится недоступен, происходит автоматическая отработка отказа. Экземпляр зеркального сервера начинает выполнять функции основного сервера и предлагает свою базу данных как основную.<br /><br /> Если экземпляр зеркального сервера становится недоступным, основной сервер продолжает работу.<br /><br /> <br /><br /> Дополнительные сведения см. в статье [Database Mirroring Operating Modes](../../database-engine/database-mirroring/database-mirroring-operating-modes.md).|  
  
 После начала зеркального отображения можно изменить рабочий режим и сохранить изменения, нажав кнопку **ОК**.  
  
 Дополнительные сведения о рабочих режимах см. в разделе [Database Mirroring Operating Modes](../../database-engine/database-mirroring/database-mirroring-operating-modes.md).  
  
 **Состояние**  
 После начала зеркального отображения панель **Состояние** отображает состояние сеанса зеркального отображения базы данных, как при выборе страницы **Зеркальное отображение** . Для обновления панели **Состояние** нажмите кнопку **Обновить** . Возможны следующие состояния.  
  
|Состояния|Объяснение|  
|------------|-----------------|  
|**Эта база данных не настроена для создания зеркальной копии**|Не существует ни одного сеанса зеркального отображения, а сведения об активности не представлены на странице **Зеркальное отображение** .|  
|**Пауза**|Основная база данных доступна, но не отправляет никаких записей журнала на зеркальный сервер.|  
|**Нет соединения**|Экземпляр основного сервера не может подключиться к участнику.|  
|**Синхронизация**|Содержимое зеркальной базы данных отстает от содержимого основной базы данных. Экземпляр основного сервера отправляет записи журнала на экземпляр зеркального сервера, который применяет эти изменения к зеркальной базе данных для выполнения наката.<br /><br /> В начале сеанса зеркального отображения базы данных основная и зеркальная базы данных находятся в данном состоянии.|  
|**Отработка отказа**|На экземпляре основного сервера начинается отработка отказа вручную (переключение ролей), и сервер в данный момент переходит к роли зеркального сервера. В этом состоянии пользовательские соединения с основной базой данных быстро прерываются, и вскоре после этого база данных принимает роль зеркальной.|  
|**Синхронизировано**|Когда зеркальный сервер достаточно догнал основной сервер, база данных переходит в состояние **Синхронизировано**. База данных сохраняет данное состояние, пока основной сервер продолжает отправлять изменения на зеркальный сервер, который в свою очередь продолжает применять изменения к зеркальной базе данных.<br /><br /> В режиме высокого уровня безопасности возможна отработка отказа  без потери данных.<br /><br /> Но и в режиме высокого уровня безопасности всегда остается актуальной потеря некоторых данных, даже в состоянии **Синхронизировано**.|  
  
 Дополнительные сведения см. в разделе [Зеркальное отображение базы данных (SQL Server)](../../database-engine/database-mirroring/mirroring-states-sql-server.md).  
  
 **Обновить**  
 Обновляет поле **Состояние** .  
  
## <a name="remarks"></a>Примечания  
 Если вы не знакомы с зеркальным отображением базы данных, см. раздел [Зеркальное отображение базы данных (SQL Server)](../../database-engine/database-mirroring/database-mirroring-sql-server.md).  
  
### <a name="adding-a-witness-to-an-existing-session"></a>Добавление следящего сервера к существующему сеансу  
 Можно добавить следящий сервер к существующему сеансу или заменить существующий следящий сервер. Если известен сетевой адрес следящего сервера, можно ввести этот адрес в поле **Следящий сервер** вручную. Если сетевой адрес следящего сервера не известен, для настройки следящего сервера нужно использовать мастер настройки безопасности зеркального отображения баз данных. После ввода в поле адреса убедитесь, что выбран параметр **Высокая безопасность с автоматической отработкой отказа (синхронный)** .  
  
 После настройки нового следящего сервера необходимо нажать кнопку **ОК** для добавления сервера к сеансу зеркального отображения.  
  
 **Добавление следящего сервера при использовании режима проверки подлинности Windows**  
  
 [Добавление или замена следящего сервера зеркального отображения базы данных (среда SQL Server Management Studio)](../../database-engine/database-mirroring/add-or-replace-a-database-mirroring-witness-sql-server-management-studio.md)  
  
### <a name="removing-a-witness"></a>Удаление следящего сервера  
 Для удаления следящего сервера удалите сетевой адрес этого сервера из поля **Следящий сервер** . При переключении из режима высокого уровня безопасности с автоматической отработкой отказа в высокопроизводительный режим поле **Следящий** автоматически очищается.  
  
 После удаления следящего сервера необходимо нажать кнопку **ОК** , чтобы удалить сервер из сеанса зеркального отображения.  
  
### <a name="monitoring-database-mirroring"></a>Наблюдение за зеркальным отображением базы данных  
 Для наблюдения за зеркальными базами данных на экземпляре сервера можно использовать либо монитор зеркального отображения баз данных, либо системную хранимую процедуру sp_dbmmonitorresults.  
  
 **Наблюдение за зеркальными базами данных**  
  
-   [Запуск монитора зеркального отображения баз данных (среда SQL Server Management Studio)](../../database-engine/database-mirroring/start-database-mirroring-monitor-sql-server-management-studio.md)  
  
-   [sp_dbmmonitorresults (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-dbmmonitorresults-transact-sql)  
  
 Дополнительные сведения см. в разделе [Мониторинг зеркального отображения базы данных (SQL Server)](../../database-engine/database-mirroring/monitoring-database-mirroring-sql-server.md).  
  
##  <a name="RelatedTasks"></a> Связанные задачи  
  
-   [Указание сетевого адреса сервера (зеркальное отображение базы данных)](../../database-engine/database-mirroring/specify-a-server-network-address-database-mirroring.md)  
  
-   [Создание сеанса зеркального отображения базы данных с использованием проверки подлинности Windows (среда SQL Server Management Studio)](../../database-engine/database-mirroring/establish-database-mirroring-session-windows-authentication.md)  
  
-   [Запуск монитора зеркального отображения баз данных (среда SQL Server Management Studio)](../../database-engine/database-mirroring/start-database-mirroring-monitor-sql-server-management-studio.md)  
  
## <a name="see-also"></a>См. также  
 [Безопасность транспорта для зеркального отображения базы данных и групп доступности AlwaysOn &#40;SQL Server&#41;](../../database-engine/database-mirroring/transport-security-database-mirroring-always-on-availability.md)   
 [Переключение ролей во время сеанса зеркального отображения базы данных (SQL Server)](../../database-engine/database-mirroring/role-switching-during-a-database-mirroring-session-sql-server.md)   
 [Мониторинг зеркального отображения базы данных (SQL Server)](../../database-engine/database-mirroring/monitoring-database-mirroring-sql-server.md)   
 [Зеркальное отображение базы данных (SQL Server)](../../database-engine/database-mirroring/database-mirroring-sql-server.md)   
 [Приостановка и возобновление зеркального отображения базы данных (SQL Server)](../../database-engine/database-mirroring/pausing-and-resuming-database-mirroring-sql-server.md)   
 [Удаление зеркального отображения базы данных (SQL Server)](../../database-engine/database-mirroring/removing-database-mirroring-sql-server.md)   
 [Следящий сервер зеркального отображения базы данных](../../database-engine/database-mirroring/database-mirroring-witness.md)  
  
  
