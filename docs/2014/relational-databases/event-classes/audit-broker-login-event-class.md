---
title: Класс событий Audit Broker Login | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.suite: ''
ms.technology:
- database-engine
ms.tgt_pltfrm: ''
ms.topic: article
topic_type:
- apiref
helpviewer_keywords:
- Audit Broker Login event class
ms.assetid: af9b1153-2791-40ef-a95c-50923cd0cc97
caps.latest.revision: 29
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: 540c16fa077178cc3c72a963c4cc4f167e9be384
ms.sourcegitcommit: 5dd5cad0c1bbd308471d6c885f516948ad67dfcf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2018
ms.locfileid: "36094577"
---
# <a name="audit-broker-login-event-class"></a>Audit Broker Login, класс событий
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] создает событие **Audit Broker Login** для информирования о сообщениях аудита, связанных с механизмом обеспечения безопасности транспорта, реализованным в компоненте Service Broker.  
  
## <a name="audit-broker-login-event-class-data-columns"></a>Столбцы класса событий Audit Broker Login  
  
|Столбец данных|Тип|Описание|Номер столбца|Фильтруемый|  
|-----------------|----------|-----------------|-------------------|----------------|  
|**ApplicationName**|**nvarchar**|Не используется в этом классе событий.|10|Да|  
|**ClientProcessID**|**int**|Не используется в этом классе событий.|9|Да|  
|**DatabaseID**|**int**|[!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] отображает имя базы данных, если столбец данных **ServerName** захвачен при трассировке и сервер доступен. Определите значение для базы данных, используя функцию DB_ID.|3|Да|  
|**EventClass**|**int**|Тип захваченного класса событий. В случае класса событий **Audit Broker Login** это значение всегда равно **159**.|27|Нет|  
|**EventSequence**|**int**|Порядковый номер этого события.|51|Нет|  
|**EventSubClass**|**int**|Тип подкласса событий, предоставляющий дополнительные сведения о каждом классе события. Приведенная ниже таблица содержит список подклассов для данного класса событий.|21|Да|  
|**FileName**|**nvarchar**|Уровень проверки подлинности удаленного брокера. Поддерживаемый метод проверки подлинности конфигурируется на конечной точке удаленного брокера. Если доступен более чем один метод, принимающая (целевая) конечная точка определяет, какой метод использовать первым. Возможны следующие значения:<br /><br /> **Нет**. Не настроен ни один метод проверки подлинности.<br /><br /> **NTLM**. Требуется проверка подлинности NTLM.<br /><br /> **KERBEROS**. Требуется проверка подлинности Kerberos.<br /><br /> **NEGOTIATE**. Windows согласовывает метод проверки подлинности.<br /><br /> **CERTIFICATE**. Требуется сертификат, настроенный для конечной точки, который хранится в базе данных **master** .<br /><br /> **NTLM, CERTIFICATE**. Допустимы проверка подлинности NTLM или сертификат SSL.<br /><br /> **KERBEROS, CERTIFICATE**. Допустимы проверка подлинности Kerberos или сертификат конечной точки.<br /><br /> **NEGOTIATE, CERTIFICATE**. Windows согласовывает метод проверки подлинности, или же для проверки подлинности может быть использован сертификат конечной точки.<br /><br /> **CERTIFICATE, NTLM**. Допустимы сертификат конечной точки или проверка подлинности NTLM.<br /><br /> **CERTIFICATE, KERBEROS**. Допустимы сертификат конечной точки или проверка подлинности Kerberos.<br /><br /> **CERTIFICATE, NEGOTIATE**. Принимается сертификат конечной точки для проверки подлинности, или Windows согласовывает метод проверки подлинности.|36|Нет|  
|**HostName**|**nvarchar**|Не используется в этом классе событий.|8|Да|  
|**IsSystem**|**int**|Указывает, произошло событие в системном или в пользовательском процессе. 1 = системный, 0 = пользовательский.|60|Нет|  
|**LoginSid**|**image**|Идентификатор безопасности вошедшего в систему пользователя. Значение идентификатора безопасности уникально для каждого имени входа на сервере.|41|Да|  
|**NTDomainName**|**nvarchar**|Домен Windows, к которому принадлежит пользователь.|7|Да|  
|**NTUserName**|**nvarchar**|Имя пользователя, которому принадлежит соединение, создавшее это событие.|6|Да|  
|**ObjectName**|**nvarchar**|Строка соединения, использованная для этого соединения.|34|Нет|  
|**OwnerName**|**nvarchar**|Поддерживаемый метод проверки подлинности, настроенный на конечной точке удаленного брокера. Если доступен более чем один метод, принимающая (целевая) конечная точка определяет, какой метод использовать первым. Возможны следующие значения:<br /><br /> **Нет**. Не настроен ни один метод проверки подлинности.<br /><br /> **NTLM**. Требуется проверка подлинности NTLM.<br /><br /> **KERBEROS**. Требуется проверка подлинности Kerberos.<br /><br /> **NEGOTIATE**. Windows согласовывает метод проверки подлинности.<br /><br /> **CERTIFICATE**. Требуется сертификат, настроенный для конечной точки, который хранится в базе данных **master** .<br /><br /> **NTLM, CERTIFICATE**. Допустимы проверка подлинности NTLM или сертификат SSL.<br /><br /> **KERBEROS, CERTIFICATE**. Допустимы проверка подлинности Kerberos или сертификат конечной точки.<br /><br /> **NEGOTIATE, CERTIFICATE**. Windows согласовывает метод проверки подлинности, или же для проверки подлинности может быть использован сертификат конечной точки.<br /><br /> **CERTIFICATE, NTLM**. При проверке подлинности принимается сертификат конечной точки или метод NTLM.<br /><br /> **CERTIFICATE, KERBEROS**. Допустимы сертификат конечной точки или проверка подлинности Kerberos.<br /><br /> **CERTIFICATE, NEGOTIATE**. Принимается сертификат конечной точки для проверки подлинности, или Windows согласовывает метод проверки подлинности.|37|Нет|  
|**ProviderName**|**nvarchar**|Метод проверки подлинности, использованный для этого соединения.|46|Нет|  
|**RoleName**|**nvarchar**|Роль соединения. Это либо **initiator** , либо **target**.|38|Нет|  
|**ServerName**|**nvarchar**|Имя экземпляра SQL Server, который отслеживается в настоящий момент.|26|Нет|  
|**SPID**|**int**|Идентификатор процесса сервера, который SQL Server присвоил процессу, связанному с клиентом.|12|Да|  
|**StartTime**|**datetime**|Время начала события, если доступно.|14|Да|  
|**Состояние**|**int**|Указывает место в исходном коде SQL Server, которое вызвало это событие. Каждое место, которое может вызвать это событие, обозначается отдельным кодом состояния. Сотрудник службы технической поддержки Microsoft может использовать этот код состояния для обнаружения участка, выполнение которого привело к событию.|30|Нет|  
|**TargetUserName**|**nvarchar**|Состояние входа. Может принимать одно из следующих значений.<br /><br /> INITIAL<br /><br /> WAIT LOGIN NEGOTIATE<br /><br /> ONE ISC<br /><br /> ONE ASC<br /><br /> TWO ISC<br /><br /> TWO ASC<br /><br /> WAIT ISC Confirm<br /><br /> WAIT ASC Confirm<br /><br /> WAIT REJECT<br /><br /> WAIT PRE-MASTER SECRET<br /><br /> WAIT VALIDATION<br /><br /> WAIT ARBITRATION<br /><br /> ONLINE<br /><br /> Ошибка<br /><br /> **Примечание** ISC = Initiate Security Context (инициировать контекст безопасности). ASC = Accept Security Context (принять контекст безопасности).|39|Нет|  
|**TransactionID**|**bigint**|Назначенный системой идентификатор транзакции.|4|Нет|  
  
 Следующая таблица содержит список значений подклассов события для этого класса событий.  
  
|Идентификатор|Подкласс|Описание|  
|--------|--------------|-----------------|  
|1|Успешный вход|Событие Login Success (успешный вход) извещает об успешном завершении соответствующего процесса регистрации брокера.|  
|2|Ошибка входного протокола|Событие Login Protocol Error (ошибка протокола входа) извещает о том, что брокер получил синтаксически правильное, но неправильное при текущем состоянии процесса регистрации сообщение. Сообщение могло быть потеряно или отослано вне очереди.|  
|3|Ошибка формата сообщения|Событие Message Format Error (ошибка формата сообщения) уведомляет о том, что брокер получил сообщение, не соответствующее ожидаемому формату. Возможно, сообщение было повреждено или программа, отличная от SQL Server, отправляет сообщения на порт, используемый компонентом Service Broker.|  
|4|Ошибка согласования|Событие Negotiate Failure (ошибка согласования) извещает о том, что локальный и удаленный брокер поддерживают взаимоисключающие уровни проверки подлинности.|  
|5|Ошибка проверки подлинности|Событие Authentication Failure (ошибка проверки подлинности) извещает о том, что компонент Service Broker не может выполнить для соединения проверку подлинности из-за ошибки. При проверке подлинности Windows это событие свидетельствует о том, что компонент Service Broker не может использовать проверку подлинности Windows. В случае проверки подлинности на основе сертификатов это событие извещает о том, что компонент Service Broker не может получить доступ к сертификату.|  
|6|Ошибка авторизации|Событие Authorization Failure (ошибка авторизации) извещает о том, что компонент Service Broker отклонил авторизацию соединения. Для проверки подлинности Windows это событие сообщает, что идентификатор защиты соединения не совпадает с пользователем базы данных. При проверке подлинности на основе сертификатов это событие свидетельствует о том, что открытый ключ, доставленный в сообщении, не соответствует сертификату в базе данных.|  
  
## <a name="see-also"></a>См. также  
 [CREATE ENDPOINT (Transact-SQL)](/sql/t-sql/statements/create-endpoint-transact-sql)   
 [ALTER ENDPOINT (Transact-SQL)](/sql/t-sql/statements/alter-endpoint-transact-sql)   
 [SQL Server Service Broker](../../database-engine/configure-windows/sql-server-service-broker.md)  
  
  
