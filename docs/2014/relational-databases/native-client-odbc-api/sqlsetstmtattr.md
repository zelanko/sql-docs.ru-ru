---
title: SQLSetStmtAttr | Документы Microsoft
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.suite: ''
ms.technology:
- database-engine
- docset-sql-devref
ms.tgt_pltfrm: ''
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetStmtAttr function
ms.assetid: 799c80fd-c561-4912-8562-9229076dfd19
caps.latest.revision: 52
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: ba0effb0e43aecd731613e926cae4134d8577e24
ms.sourcegitcommit: 5dd5cad0c1bbd308471d6c885f516948ad67dfcf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2018
ms.locfileid: "36097500"
---
# <a name="sqlsetstmtattr"></a>SQLSetStmtAttr
  Драйвер ODBC собственного клиента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не поддерживает смешанную (динамическую и с набором ключей) модель курсора. Попытки установить размер набора ключей с помощью атрибута SQL_ATTR_KEYSET_SIZE завершатся неудачей, если задаваемое значение не равно 0.  
  
 Приложение устанавливает атрибут SQL_ATTR_ROW_ARRAY_SIZE для всех инструкций, чтобы объявить количество строк, возвращенных **SQLFetch** или [SQLFetchScroll](sqlfetchscroll.md) вызов функции. Для инструкций, задающих серверный курсор, драйвер использует атрибут SQL_ATTR_ROW_ARRAY_SIZE, чтобы задать размер блока строк, которые создаются на сервере в ответ на запрос на выборку со стороны курсора. В пределах размера блока динамического курсора членство в строке и порядок не меняются, если уровень изоляции транзакции достаточен для обеспечения повторяемого чтения фиксированных транзакций. Вне блока, задаваемого этой величиной, курсор полностью динамичен. Размер блока серверного курсора полностью динамичен и может быть изменен в любой момент в процессе обработки выборки.  
  
## <a name="sqlsetstmtattr-and-table-valued-parameters"></a>Функция SQLSetStmtAttr и возвращающие табличные значения параметры  
 Можно использовать SQLSetStmtAttr присваивающий параметру SQL_SOPT_SS_PARAM_FOCUS в дескрипторе параметра приложения (APD) до получения доступа к поля дескриптора для столбцов возвращающих табличные значения параметров.  
  
 Если попытка параметру SQL_SOPT_SS_PARAM_FOCUS порядковый номер параметра, то есть создается не табличное значение параметра, SQLSetStmtAttr возвращает значение SQL_ERROR и создается диагностическая запись с SQLSTATE = HY024 и сообщением «недопустимое значение атрибута». Если возвращается значение SQL_ERROR, то атрибут SQL_SOPT_SS_PARAM_FOCUS не меняется.  
  
 Установка атрибута SQL_SOPT_SS_PARAM_FOCUS в значение 0 восстанавливает доступ к записям дескриптора для параметров.  
  
 SQLSetStmtAttr также может использоваться для задания атрибута SQL_SOPT_SS_NAME_SCOPE. Дополнительные сведения см. в подразделе «SQL_SOPT_SS_NAME_SCOPE» далее в этом разделе.  
  
 Дополнительные сведения см. в разделе [метаданные возвращающего табличное значение параметра для подготовленных инструкций](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).  
  
 Дополнительные сведения о возвращающих табличные значения параметров см. в разделе [табличное значение параметры &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).  
  
## <a name="sqlsetstmtattr-support-for-sparse-columns"></a>Поддержка разреженных столбцов функцией SQLSetStmtAttr  
 SQLSetStmtAttr можно использовать для задания атрибута SQL_SOPT_SS_NAME_SCOPE. Дополнительные сведения см. в разделе SQL_SOPT_SS_NAME_SCOPE, далее в этом разделе. Дополнительные сведения о разреженных столбцах см. в разделе [Поддержка разреженных столбцов &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).  
  
## <a name="statement-attributes"></a>Атрибуты инструкции  
 Драйвер ODBC для собственного клиента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] поддерживает следующие атрибуты инструкций, специфичные для драйвера.  
  
### <a name="sqlsoptsscursoroptions"></a>SQL_SOPT_SS_CURSOR_OPTIONS  
 Атрибут SQL_SOPT_SS_CURSOR указывает, будет ли драйвер использовать для курсоров специфичные для данного драйвера параметры настройки производительности. [SQLGetData](sqlgetdata.md) не допускается, если эти параметры заданы. Значение по умолчанию равно SQL_CO_OFF. Значение аргумента *ValuePtr* имеет тип SQLLEN.  
  
|*ValuePtr* значение|Описание|  
|----------------------|-----------------|  
|SQL_CO_OFF|По умолчанию. Отключает быстрые однопроходные, только для чтения курсоры и автоматическую выборку, включает **SQLGetData** на курсоры однопроходный, только для чтения. Если атрибут SQL_SOPT_SS_CURSOR_OPTIONS имеет значение SQL_CO_OFF, тип курсора не изменится. То есть быстрый однопроходный курсор останется быстрым однопроходным курсором. Чтобы изменить тип курсора, приложение должно установить курсор другого типа с помощью `SQLSetStmtAttr`/SQL_ATTR_CURSOR_TYPE.|  
|SQL_CO_FFO|Обеспечивает быстрый однопроходный, только для чтения курсоры, отключает **SQLGetData** на курсоры однопроходный, только для чтения.|  
|SQL_CO_AF|Включает параметр автоматической выборки для курсора любого типа. Если этот параметр имеет значение для дескриптора инструкции **SQLExecute** или **SQLExecDirect** создадут неявный **SQLFetchScroll** (SQL_FIRST). Курсор открыт, и первый набор строк возвращен за одно обращение к серверу.|  
|SQL_CO_FFO_AF|Включает быстрые однопроходные курсоры с параметром автоматической выборки. Эквивалентно одновременному заданию SQL_CO_AF и SQL_CO_FFO.|  
  
 Если эти параметры заданы, сервер автоматически закрывает курсор, когда обнаруживает, что была получена последняя строка. Приложение по-прежнему необходимо вызвать [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) или [SQLCloseCursor](sqlclosecursor.md), но драйвер не должен отправлять уведомление о закрытии на сервер.  
  
 Если список выборки содержит **текст**, **ntext**, или **изображения** столбец, быстрый однопроходный курсор преобразуется в динамический курсор и **SQLGetData** разрешено.  
  
### <a name="sqlsoptssdeferprepare"></a>SQL_SOPT_SS_DEFER_PREPARE  
 Атрибут SQL_SOPT_SS_DEFER_PREPARE определяет подготовленных немедленно или откладывается инструкцию **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) или [SQLDescribeParam](sqldescribeparam.md) выполняется. В [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 и более ранних версиях это свойство не учитывается (подготовка не откладывается). Значение аргумента *ValuePtr* имеет тип SQLLEN.  
  
|*ValuePtr* значение|Описание|  
|----------------------|-----------------|  
|SQL_DP_ON|По умолчанию. После вызова метода [SQLPrepare, функция](http://go.microsoft.com/fwlink/?LinkId=59360), Подготовка инструкции откладывается до **SQLExecute** вызывается или операции над метасвойством (**SQLDescribeCol** или **SQLDescribeParam**) выполняется.|  
|SQL_DP_OFF|Инструкция подготавливается как можно скорее **SQLPrepare** выполняется.|  
  
### <a name="sqlsoptssregionalize"></a>SQL_SOPT_SS_REGIONALIZE  
 Атрибут SQL_SOPT_SS_REGIONALIZE используется для задания преобразования данных на уровне инструкции. Атрибут указывает драйверу, что следует использовать настройки локали на клиенте при преобразовании данных в денежном формате, формате даты и времени в символьные данные. Преобразование проводится только из собственных типов данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в строки символов.  
  
 Значение аргумента *ValuePtr* имеет тип SQLLEN.  
  
|*ValuePtr* значение|Описание|  
|----------------------|-----------------|  
|SQL_RE_OFF|По умолчанию. Драйвер ODBC не использует настройки локали на клиенте при преобразовании данных в денежном формате, формате даты и времени в строковые данные.|  
|SQL_RE_ON|Драйвер ODBC использует настройки локали на клиенте при преобразовании данных в денежном формате, формате даты и времени в символьные данные.|  
  
 Региональные параметры преобразований применяются к типам данных валюты, чисел и даты-времени. Параметры преобразований применяются только к выходным преобразованиям, когда значения валюты, числовые значения, значения даты или времени преобразуются в символьные строки.  
  
> [!NOTE]  
>  Когда атрибут инструкции SQL_SOPT_SS_REGIONALIZE включен, драйвер использует настройки локали из реестра текущего пользователя. Драйвер не учитывает языковой стандарт текущего потока, если приложение установило его, например, вызов **SetThreadLocale**.  
  
 Изменение режима работы источника данных с региональными параметрами может привести к ошибке приложения. Изменение этого значения может отрицательно повлиять на работу приложения, анализирующего строки даты и предполагающего, что строки даты будут выводиться в виде, определенном ODBC.  
  
### <a name="sqlsoptsstextptrlogging"></a>SQL_SOPT_SS_TEXTPTR_LOGGING  
 Атрибут SQL_SOPT_SS_TEXTPTR_LOGGING переключает занесение операций к столбцам, содержащим **текст** или **изображения** данные. Значение аргумента *ValuePtr* имеет тип SQLLEN.  
  
|*ValuePtr* значение|Описание|  
|----------------------|-----------------|  
|SQL_TL_OFF|Отключает ведение журнала операций с **текст** и **изображения** данные.|  
|SQL_TL_ON|По умолчанию. Ведение журнала операций с **текст** и **изображения** данные.|  
  
### <a name="sqlsoptsshiddencolumns"></a>SQL_SOPT_SS_HIDDEN_COLUMNS  
 В результирующем наборе атрибут SQL_SOPT_SS_HIDDEN_COLUMNS предоставляет столбцы, скрытые в инструкции [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE. По умолчанию драйвер не предоставляет доступ к этим столбцам. Значение аргумента *ValuePtr* имеет тип SQLLEN.  
  
|*ValuePtr* значение|Описание|  
|----------------------|-----------------|  
|SQL_HC_OFF|По умолчанию. Столбцы FOR BROWSE в результирующем наборе скрыты.|  
|SQL_HC_ON|Обеспечивает доступ к столбцам FOR BROWSE.|  
  
### <a name="sqlsoptssquerynotificationmsgtext"></a>Атрибут SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT  
 Атрибут SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT возвращает текст сообщения в ответ на запрошенное уведомление о запросе.  
  
### <a name="sqlsoptssquerynotificationoptions"></a>SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS  
 Атрибут SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS задает параметры для запроса уведомления о запросе. Эти параметры заданы в строке с конструкцией `name=value`, как показано ниже. За создание службы и считывание уведомлений из очереди отвечает приложение.  
  
 Строка параметров уведомлений запросов имеет следующий синтаксис.  
  
 `service=<service-name>[;(local database=<database>|broker instance=<broker instance>)]`  
  
 Например:  
  
 `service=mySSBService;local database=mydb`  
  
### <a name="sqlsoptssquerynotificationtimeout"></a>SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT  
 Атрибут SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT задает время в секундах, в течение которого уведомление о запросе будет активным. Значение по умолчанию составляет 432 000 секунд (5 суток). Значение аргумента *ValuePtr* имеет тип SQLLEN.  
  
### <a name="sqlsoptssparamfocus"></a>SQL_SOPT_SS_PARAM_FOCUS  
 Атрибут SQL_SOPT_SS_PARAM_FOCUS Задает фокус для последующих SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec и вызывает SQLSetDescRec.  
  
 Атрибут SQL_SOPT_SS_PARAM_FOCUS принадлежит к типу SQLULEN.  
  
 По умолчанию он имеет значение 0; это означает, что вызовы относятся к параметрам, соответствующим маркерам параметров в инструкции SQL. Если задать для атрибута значение, равное порядковому номеру возвращающего табличное значение параметра, вызовы будут относиться к столбцам этого параметра. Если задано значение, которое не является параметр с номером табличное значение параметра, вызовы будут возвращать ошибку IM020: «фокус параметра не ссылается на табличное значение параметра».  
  
### <a name="sqlsoptssnamescope"></a>SQL_SOPT_SS_NAME_SCOPE  
 Атрибут SQL_SOPT_SS_NAME_SCOPE задает область действия имени для последующих вызовов функций работы с каталогами. Результирующий набор, возвращенный SQLColumns зависит от настройки SQL_SOPT_SS_NAME_SCOPE.  
  
 Атрибут SQL_SOPT_SS_NAME_SCOPE принадлежит к типу SQLULEN.  
  
|*ValuePtr* значение|Описание|  
|----------------------|-----------------|  
|SQL_SS_NAME_SCOPE_TABLE|По умолчанию.<br /><br /> При использовании возвращающих табличное значение параметров этот атрибут указывает, что нужно возвратить метаданные реально существующих таблиц.<br /><br /> При использовании разреженных столбцах, SQLColumns будет возвращать только те столбцы, которые не являются членами разреженного `column_set`.|  
|SQL_SS_NAME_SCOPE_TABLE_TYPE|Указывает, что приложению требуются метаданные для табличного типа, а не для реально существующих таблиц (функции работы с каталогами должны возвращать метаданные для табличных типов). Затем приложение передает TYPE_NAME табличное значение параметра как *TableName* параметра.|  
|SQL_SS_NAME_SCOPE_EXTENDED|При использовании разреженных столбцах, SQLColumns возвращает все столбцы, независимо от `column_set` членства.|  
|SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET|При использовании разреженных столбцах, SQLColumns возвращает только те столбцы, которые являются членами разреженного `column_set`.|  
|SQL_SS_NAME_SCOPE_DEFAULT|Равен атрибуту SQL_SS_NAME_SCOPE_TABLE.|  
  
 SS_TYPE_CATALOG_NAME и SS_TYPE_SCHEMA_NAME используются с *CatalogName* и *SchemaName* параметров, соответственно, для определения каталога и схемы для возвращающих табличные значения параметра. Когда приложение закончит получать метаданные для возвращающего табличное значение параметра, оно должно вновь присвоить SQL_SOPT_SS_NAME_SCOPE значение по умолчанию SQL_SS_NAME_SCOPE_TABLE.  
  
 Если SQL_SOPT_SS_NAME_SCOPE имеет значение SQL_SS_NAME_SCOPE_TABLE, то запросы к связанным серверам завершаются ошибкой. Вызовы SQLColumns или SQLPrimaryKeys с каталогом, содержащим компонент сервера завершится ошибкой.  
  
 При попытке задать для атрибута SQL_SOPT_SS_NAME_SCOPE недопустимое значение будет возвращено значение SQL_ERROR и создана диагностическая запись с параметром SQLSTATE HY024 и сообщением «Недопустимое значение атрибута».  
  
 Если каталог функции других затем SQLTables, SQLColumns или SQLPrimaryKeys вызывается, когда SQL_SOPT_SS_NAME_SCOPE имеет значение, отличное от SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR возвращается. Создается диагностическая запись с параметром SQLSTATE HY010 и сообщением «Ошибочная последовательность функций (значение атрибута SQL_SOPT_SS_NAME_SCOPE не равно SQL_SS_NAME_SCOPE_TABLE)».  
  
## <a name="see-also"></a>См. также  
 [SQLGetStmtAttr, функция](http://go.microsoft.com/fwlink/?LinkId=59355)   
 [Подробные сведения о реализации API-интерфейсов ODBC](odbc-api-implementation-details.md)  
  
  