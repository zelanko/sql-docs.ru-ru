---
title: Приступая к работе с компонентом Full-Text Search | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: search
ms.topic: conceptual
helpviewer_keywords:
- full-text catalogs [SQL Server], creating
- full-text indexes [SQL Server], creating
- full-text search [SQL Server], about
- full-text search [SQL Server], setting up
ms.assetid: 1fa628ba-0ee4-4d8f-b086-c4e52962ca4a
author: MikeRayMSFT
ms.author: mikeray
manager: craigg
ms.openlocfilehash: fd5ced641ee8fc17f0be7d7b6e19aff17dcb69bd
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66011285"
---
# <a name="get-started-with-full-text-search"></a>Приступая к работе с компонентом Full-Text Search
  Базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] поддерживают полнотекстовую индексацию по умолчанию. Однако для использования полнотекстового индекса в таблице надо настроить полнотекстовое индексирование для столбцов таблиц, к которым планируется обращение при использовании средства полнотекстового поиска.  
  
##  <a name="configure"></a> Настройка базы данных для полнотекстового поиска  
 Для любого сценария для настройки столбцов таблицы базы данных для полнотекстового поиска администратор базы данных выполняет следующие шаги.  
  
1.  Создание полнотекстового каталога.  
  
2.  В каждой таблице, в которой нужно производить поиск, следует создать полнотекстовый индекс одним из приведенных ниже способов.  
  
    1.  Определить все текстовые столбцы, которые нужно включить в полнотекстовый индекс.  
  
    2.  Если данный столбец содержит документы, хранимые как двоичные данные (`varbinary(max)`, или `image` данных), необходимо указать столбец таблицы ( *столбец типа*), определяющий тип каждого документа в индексируемом столбце.  
  
    3.  Указать язык, который полнотекстовый поиск должен использовать для документов в столбце.  
  
    4.  Выбрать механизм отслеживания изменений, с помощью которого в полнотекстовом индексе будут отслеживаться изменения в базовой таблице и ее столбцах.  
  
 Полнотекстовый поиск поддерживает использование нескольких языков благодаря таким *лингвистическим компонентам*, как средства разбиения по словам и парадигматические модули, списки стоп-слов (известных также как пропускаемые слова) и файлы тезауруса. Для файлов тезауруса и в некоторых случаях для списков стоп-слов требуется настройка, выполняемая администратором базы данных. Данный файл тезауруса поддерживает все полнотекстовые индексы, которые используют соответствующий язык, а данный список стоп-слов может быть связан с любым необходимым числом полнотекстовых индексов.  
  
##  <a name="setup"></a> Создание полнотекстового каталога и индекса  
 Для этого необходимо выполнить следующие основные шаги.  
  
1.  Создание полнотекстового каталога для хранения полнотекстовых индексов.  
  
     Полнотекстовый индекс должен принадлежать к полнотекстовому каталогу. Можно либо создать отдельный текстовый каталог для каждого полнотекстового индекса, либо связать с одним каталогом несколько полнотекстовых индексов. Полнотекстовый каталог является виртуальным объектом и не входит в файловую группу. Каталог — это логическое понятие, которое ссылается на группу полнотекстовых индексов.  
  
2.  Создание полнотекстового индекса по таблице или индексированному представлению.  
  
     Полнотекстовый индекс — это специальный тип функционального индекса на основе токенов, создаваемый и используемый средством полнотекстового поиска. Чтобы полнотекстовый поиск мог быть создан для таблиц или представлений, они должны иметь уникальный индекс, который включает один столбец и не допускает значений NULL. Этот уникальный индекс необходим средству полнотекстового для сопоставления каждой строки таблицы с уникальным ключом со сжатием. Полнотекстовый индекс может включать только столбцы следующих типов: `char`, `varchar`, `nchar`, `nvarchar`, `text`, `ntext`, `image`, `xml`, `varbinary` и `varbinary(max)` Дополнительные сведения см. в разделе [Создание полнотекстовых индексов и управление ими](create-and-manage-full-text-indexes.md).  
  
 Прежде чем перейти к созданию полнотекстовых индексов, важно узнать, чем они отличаются от обычных индексов [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Эти различия приведены в следующей таблице.  
  
|Полнотекстовые индексы|Обычные индексы SQL Server|  
|------------------------|--------------------------------|  
|Для одной таблицы разрешен только один полнотекстовой индекс.|Для одной таблицы разрешено несколько обычных индексов.|  
|Добавление данных к полнотекстовым индексам (*заполнение*) может быть запрошено явно, выполняться по расписанию либо автоматически при добавлении новых данных в базу.|Обновляются автоматически при создании, вставке, обновлении или удалении данных, на которых они созданы.|  
|Группируются в той же базе данных в один или несколько полнотекстовых каталогов.|Не группируются.|  
  
  
##  <a name="options"></a> Выбор параметров для полнотекстового индекса  
 В данном разделе объясняется следующее.  
  
-   Выбор языка столбца.  
  
-   Выбор файловой группы для полнотекстового индекса.  
  
-   Назначение полнотекстового индекса для полнотекстового каталога.  
  
-   Установление связи между полнотекстовым списком стоп-слов и индексом.  
  
-   Обновление полнотекстового индекса.  
  
### <a name="choosing-the-column-language"></a>Выбор языка столбца  
 Сведения, которые следует учитывать при выборе языка столбца, см. в разделе [Выбор языка при создании полнотекстового индекса](choose-a-language-when-creating-a-full-text-index.md).  
  
### <a name="choosing-a-filegroup-for-a-full-text-index"></a>Выбор файловой группы для полнотекстового индекса  
 Процесс построения полнотекстового индекса может сильно нагружать подсистему ввода-вывода (на высоком уровне он состоит из считывания данных из [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с последующим заполнением полнотекстового индекса отфильтрованными данными). Рекомендуется размещать полнотекстовый индекс в той файловой группе базы данных, которая обеспечит максимальную производительность операций ввода-вывода, либо разместить полнотекстовые индексы в другой файловой группе на другом томе.  
  
 Если требуется обеспечить простоту управления, то табличные данные и все присоединенные полнотекстовые каталоги следует хранить в одной файловой группе. Иногда в целях увеличения производительности можно расположить табличные данные и полнотекстовый индекс в разных файловых группах, хранящихся на разных томах. Это позволит обеспечить максимальный параллелизм ввода-вывода.  
  
  
### <a name="assigning-the-full-text-index-to-a-full-text-catalog"></a>Назначение полнотекстового индекса для полнотекстового каталога  
 Важно распланировать расположение полнотекстовых индексов для таблиц в полнотекстовых каталогах.  
  
 Таблицы с одинаковыми характеристиками обновления (например, небольшим числом изменений, в противоположность большому их количеству или частым изменением таблиц в определенное время дня) рекомендуется связывать с одним полнотекстовым каталогом. Если настроить расписание заполнения полнотекстового каталога, то полнотекстовые индексы будут синхронизироваться с таблицами, почти не влияя на использование ресурсов сервером баз данных в течение периодов высокой активности.  
  
 При присвоении таблицы к полнотекстовому каталогу учитывайте следующие требования.  
  
-   Для полнотекстового уникального ключа всегда следует выбирать наименьший по размеру уникальный индекс. (Оптимален четырехбайтовый индекс на основе целочисленных значений.) Это значительно снизит потребление ресурсов, необходимых службе поиска [!INCLUDE[msCoName](../../includes/msconame-md.md)] для работы с файловой системой. Если первичный ключ велик (более 100 байт), попробуйте выбрать в таблице другой уникальный индекс (или создайте другой уникальный индекс) в качестве полнотекстового уникального ключа. В противном случае, если размер полнотекстового уникального ключа превышает максимально разрешенный размер (900 байт), выполнить полнотекстовое заполнение не удастся.  
  
-   Если индексируется таблица с миллионами строк, припишите ее к отдельному полнотекстовому каталогу.  
  
-   Учитывайте количество изменений в таблице, в которой выполняется полнотекстовое индексирование, а также количество строк в этой таблице. Если общее число изменяемых строк вместе с количеством строк в таблице на момент последнего полнотекстового заполнения исчисляется миллионами, свяжите эту таблицу с отдельным полнотекстовым каталогом.  
  
  
### <a name="associating-a-stoplist-with-the-full-text-index"></a>Установление связи между полнотекстовым списком стоп-слов и индексом.  
 В [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] были добавлены списки стоп-слов. *Список стоп-слов* — это список, в котором перечислены стоп-слова, также известные как пропускаемые слова. Список стоп-слов связывается с каждым полнотекстовым индексом. Слова в данном списке применяются к полнотекстовым запросам в данном индексе. По умолчанию с новым полнотекстовым индексом связан системный список стоп-слов. Однако пользователь может создать и использовать собственный список стоп-слов. Дополнительные сведения см. в разделе [Настройка и управление стоп-словами и списками стоп-слов для полнотекстового поиска](configure-and-manage-stopwords-and-stoplists-for-full-text-search.md).  
  
 Например, следующая [CREATE FULLTEXT STOPLIST](/sql/t-sql/statements/create-fulltext-stoplist-transact-sql) [!INCLUDE[tsql](../../../includes/tsql-md.md)] инструкция создает новый полнотекстовый список стоп-слов с именем myStoplist3 путем копирования из системы стоп-слов:  
  
```  
CREATE FULLTEXT STOPLIST myStoplist FROM SYSTEM STOPLIST;  
GO  
```  
  
 Приведенная ниже инструкция [ALTER FULLTEXT STOPLIST](/sql/t-sql/statements/alter-fulltext-stoplist-transact-sql)[!INCLUDE[tsql](../../../includes/tsql-md.md)] изменяет список стоп-слов myStoplist путем добавления слова "en" для испанского и затем французского языков:  
  
```  
ALTER FULLTEXT STOPLIST MyStoplist ADD 'en' LANGUAGE 'Spanish';  
ALTER FULLTEXT STOPLIST MyStoplist ADD 'en' LANGUAGE 'French';  
GO  
```  
  
  
### <a name="updating-a-full-text-index"></a>Обновление полнотекстового индекса  
 Аналогично обычным индексам [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] полнотекстовые индексы можно обновлять автоматически по мере изменения данных в связанных с ними таблицах. Это поведение по умолчанию. Также обновлять полнотекстовые индексы можно вручную либо по заданному расписанию. Заполнение полнотекстового индекса может потребовать значительного времени и ресурсов, вследствие чего обновление индекса обычно выполняется как асинхронный процесс в фоновом режиме, который обновляет полнотекстовый индекс после внесения изменений в базовую таблицу. Для немедленного обновления полнотекстового индекса после каждого изменения в базовой таблице может потребоваться большой объем ресурсов. Следовательно, если обновление, вставка или удаление выполняются часто, то производительность запросов может снизиться. В таком случае попробуйте выполнять обновления отслеживания изменений вручную по определенному расписанию. Это позволит обрабатывать больше изменений в определенные моменты времени, а не конкурировать за ресурсы с запросами.  
  
 Чтобы наблюдения за состоянием заполнения используется функция FULLTEXTCATALOGPROPERTY или OBJECTPROPERTYEX. Чтобы получить сведения о состоянии заполнения каталога, выполните следующую инструкцию:  
  
```  
SELECT FULLTEXTCATALOGPROPERTY('AdvWksDocFTCat', 'Populatestatus');  
```  
  
 Как правило, если выполняется полное заполнение, возвращается значение 1.  
  
  
##  <a name="example"></a> Пример. Настройка полнотекстового поиска  
 В следующем примере из двух частей в базе данных AdventureWorks создается полнотекстовый каталог с именем `AdvWksDocFTCat`, затем создается полнотекстовый индекс в таблице `Document` базы данных [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)]. Эта инструкция создает полнотекстовый каталог в папке по умолчанию, указанной во время установки, то есть папка `AdvWksDocFTCat` будет вложена в каталог по умолчанию.  
  
1.  Для создания полнотекстового каталога `AdvWksDocFTCat` в примере используется инструкция [CREATE FULLTEXT CATALOG](/sql/t-sql/statements/create-fulltext-catalog-transact-sql):  
  
    ```  
    USE AdventureWorks;  
    GO  
    CREATE FULLTEXT CATALOG AdvWksDocFTCat;  
    ```  
  
2.  Однако перед созданием полнотекстового индекса для таблицы Document следует убедиться, что в ней определен уникальный индекс с одним столбцом, не допускающий значений NULL. Следующая инструкция [CREATE INDEX](/sql/t-sql/statements/create-index-transact-sql) создает уникальный индекс `ui_ukDoc`для столбца DocumentID таблицы Document:  
  
    ```  
    CREATE UNIQUE INDEX ui_ukDoc ON Production.Document(DocumentID);  
    ```  
  
3.  После создания уникального ключа можно создать полнотекстовый индекс для таблицы `Document` с помощью следующей инструкции [CREATE FULLTEXT INDEX](/sql/t-sql/statements/create-fulltext-index-transact-sql) .  
  
    ```  
    CREATE FULLTEXT INDEX ON Production.Document  
    (  
        Document                         --Full-text index column name   
            TYPE COLUMN FileExtension    --Name of column that contains file type information  
            Language 2057                 --2057 is the LCID for British English  
    )  
    KEY INDEX ui_ukDoc ON AdvWksDocFTCat --Unique index  
    WITH CHANGE_TRACKING AUTO            --Population type;  
    GO  
  
    ```  
  
     Столбец TYPE COLUMN, определенный в этом примере, задает столбец типов в таблице, которая в каждой строке столбца «Document» (имеющего двоичный тип) содержит тип документа. Столбец типа хранит пользовательские файл расширения — «.doc», «.xls» и т. д. взятия документа в данной строке. Средство полнотекстового поиска будет использовать это расширение для вызова соответствующего фильтра, который применяется для синтаксического анализа данных в данной строке. После того как фильтр выполнит синтаксический анализ двоичных данных в строке, указанное средство разбиения по словам выполнит синтаксический анализ содержимого (в данном примере используется средство разбиения по словам для английского языка (Великобритания)). Следует отметить, что процесс фильтрации выполняется либо во время индексирования, либо при вставке или обновлении пользователем столбца в базовой таблице, если автоматическое отслеживание изменений было включено для полнотекстового индекса. Дополнительные сведения см. в разделе [Настройка фильтров для поиска и управление ими](configure-and-manage-filters-for-search.md).  
  
  
##  <a name="tasks"></a> Общие задачи  
  
### <a name="to-create-a-full-text-catalog"></a>Создание полнотекстового каталога  
  
-   [CREATE FULLTEXT CATALOG (Transact-SQL)](/sql/t-sql/statements/create-fulltext-catalog-transact-sql)  
  
-   [Создание и управление полнотекстовыми каталогами](create-and-manage-full-text-catalogs.md)  
  
### <a name="to-view-the-indexes-of-a-table-or-view"></a>Просмотр индексов таблицы (или представления)  
  
-   [sys.indexes (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-indexes-transact-sql)  
  
### <a name="to-create-a-unique-index"></a>Создание уникального индекса  
  
-   [CREATE INDEX &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-index-transact-sql)  
  
-   [Открытие конструктора таблиц (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/visual-database-tools.md)  
  
### <a name="to-create-a-full-text-index"></a>Создание полнотекстового индекса  
  
-   [CREATE FULLTEXT INDEX (Transact-SQL)](/sql/t-sql/statements/create-fulltext-index-transact-sql)  
  
-   [Создание и управление полнотекстовыми индексами](create-and-manage-full-text-indexes.md)  
  
### <a name="to-view-information-about-a-full-text-index"></a>Просмотр сведений о полнотекстовом индексе  
  
|Каталог или динамическое административное представление|Описание|  
|----------------------------------------|-----------------|  
|[sys.fulltext_index_catalog_usages (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-fulltext-index-catalog-usages-transact-sql)|Возвращает строку для каждого полнотекстового каталога, ссылающегося на полнотекстовый индекс.|  
|[sys.fulltext_index_columns (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-fulltext-index-columns-transact-sql)|Содержит по одной строке для каждого столбца, являющегося частью полнотекстового индекса.|  
|[sys.fulltext_index_fragments (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-fulltext-index-fragments-transact-sql)|Полнотекстовый индекс использует внутренние таблицы, называемые фрагментами полнотекстового индекса, для хранения данных инвертированного индекса. Это представление может использоваться для запросов к метаданным об этих фрагментах. Представление содержит строку для каждого фрагмента полнотекстового индекса в каждой таблице, содержащей полнотекстовый индекс.|  
|[sys.fulltext_indexes (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-fulltext-indexes-transact-sql)|Содержит по одной строке для каждого полнотекстового индекса табличного объекта.|  
|[sys.dm_fts_index_keywords (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-index-keywords-transact-sql)|Возвращает сведения о содержимом полнотекстового индекса для указанной таблицы.|  
|[sys.dm_fts_index_keywords_by_document (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-index-keywords-by-document-transact-sql)|Возвращает сведения о содержимом полнотекстового индекса на уровне документа для указанной таблицы. Данное ключевое слово может встречаться в нескольких документах.|  
|[sys.dm_fts_index_population (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-index-population-transact-sql)|Возвращает сведения о выполняющихся в настоящий момент процессах заполнения полнотекстовых индексов.|  
  
  
## <a name="see-also"></a>См. также  
 [CREATE FULLTEXT CATALOG (Transact-SQL)](/sql/t-sql/statements/create-fulltext-catalog-transact-sql)   
 [CREATE FULLTEXT INDEX (Transact-SQL)](/sql/t-sql/statements/create-fulltext-index-transact-sql)   
 [CREATE FULLTEXT STOPLIST (Transact-SQL)](/sql/t-sql/statements/create-fulltext-stoplist-transact-sql)   
 [CREATE TABLE (Transact-SQL)](/sql/t-sql/statements/create-table-transact-sql)   
 [Заполнение полнотекстовых индексов](populate-full-text-indexes.md)   
 [FULLTEXTCATALOGPROPERTY (Transact-SQL)](/sql/t-sql/functions/fulltextcatalogproperty-transact-sql)   
 [OBJECTPROPERTYEX (Transact-SQL)](/sql/t-sql/functions/objectproperty-transact-sql)  
  
  
