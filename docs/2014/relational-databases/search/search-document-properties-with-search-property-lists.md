---
title: Поиск свойств документа с помощью списков свойств поиска | Документация Майкрософт
ms.custom: ''
ms.date: 04/26/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: search
ms.topic: conceptual
helpviewer_keywords:
- full-text search [SQL Server], search property lists
- full-text search [SQL Server], properties
- search property lists [SQL Server]
- property searching [SQL Server], about
- full-text indexes [SQL Server], search property lists
- search property lists [SQL Server], about
- property searching [SQL Server]
ms.assetid: ffae5914-b1b2-4267-b927-37e8382e0a9e
author: MikeRayMSFT
ms.author: mikeray
manager: craigg
ms.openlocfilehash: 7a4dbc20442181ce97b060118094dfa0667803db
ms.sourcegitcommit: 6fd8c1914de4c7ac24900fe388ecc7883c740077
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2020
ms.locfileid: "66011080"
---
# <a name="search-document-properties-with-search-property-lists"></a>Поиск свойств документа с использованием списков свойств поиска
  Ранее содержимое свойств документа нельзя было отличить от содержимого текста документа. Это ограничивало полнотекстовые запросы, позволяя выполнять только поиск во всем документе. Теперь можно настроить полнотекстовый индекс для поддержки поиска по определенным свойствам, например Author и Title, для поддерживаемых типов документов в столбцах двоичных данных `varbinary`, `varbinary(max)` (включая `FILESTREAM`) или `image`. Такая форма поиска называется *поиск свойств*.  
  
 Связанный [фильтр](configure-and-manage-filters-for-search.md) (IFilter) определяет возможность поиска свойств в заданном типе документа. Для некоторых типов документов связанный фильтр IFilter извлекает часть или все свойства, определенные для этого типа документа, а также содержимое текста документа. Можно настроить полнотекстовый индекс, чтобы разрешить поиск только в свойствах, которые извлекаются фильтром IFilter во время полнотекстового индексирования. К фильтрам IFilter, извлекающим ряд свойств документа, относятся фильтры IFilter для типов документов Microsoft Office 2007 (DOCX, XLSX, PPTX и др.). С другой стороны, фильтр IFilter XML не возвращает свойства.  
  
##  <a name="how-full-text-search-works-with-search-properties"></a><a name="How_FTS_Works_with_search_properties"></a> Как работает полнотекстовый поиск со свойствами поиска  
  
### <a name="internal-property-ids"></a>Внутренние идентификаторы свойств  
 Средство полнотекстового поиска произвольным образом назначает каждому зарегистрированному свойству внутренний идентификатор свойства, который действует в пределах данного списка свойств поиска и однозначно определяет свойство в списке. Поэтому, если свойство добавлено в несколько списков свойств поиска, то его внутренний идентификатор скорее всего, будет разным в различных списках.  
  
 Когда свойство регистрируется в списке поиска, средство полнотекстового поиска произвольным образом назначает свойству *внутренний идентификатор* . Внутренний идентификатор свойства — это целое число, однозначно определяющее свойство в пределах списка свойств поиска.  
  
 На следующем рисунке показано логическое представление списка свойств поиска, в котором задано два свойства: Title и Keywords. Список свойств для Keywords имеет имя Tags. Эти свойства принадлежат одному набору с идентификатором GUID F29F85E0-4FF9-1068-AB91-08002B27B3D9. Для свойства Title используется целочисленный идентификатор 2, а для свойства Tags (Keywords) — целочисленный идентификатор 5. Средство полнотекстового поиска произвольным образом сопоставляет каждое свойство с внутренним идентификатором, который уникален в пределах списка свойств поиска. Для свойства Title используется внутренний идентификатор 1, а для свойства Tags — внутренний идентификатор 2.  
  
 ![Сопоставление списка свойств поиска с внутренней таблицей](../../database-engine/media/ifts-spl-w-title-and-keywords.gif "Сопоставление списка свойств поиска с внутренней таблицей")  
  
 Внутренний идентификатор свойства, скорее всего, будет отличаться от целочисленного идентификатора этого свойства. Если данное свойство зарегистрировано в нескольких списках свойств поиска, каждому списку свойств поиска может быть назначен отдельный внутренний идентификатор свойств. Например, в одном списке свойств поиска свойство может иметь внутренний идентификатор 4, в другом списке — идентификатор 3 и т. д. Целочисленный же идентификатор свойства, напротив, привязан к свойству и остается одинаковым независимо от места использования свойства.  
  
  
  
### <a name="indexing-of-registered-properties"></a>Индексирование зарегистрированных свойств  
 После связывания полнотекстового индекса со списком свойств поиска необходимо выполнить повторное заполнение индекса выражениями поиска, относящимися к свойствам индекса. Во время полнотекстового индексирования содержимое всех свойств сохраняется в полнотекстовом индексе вместе с другим содержимым. Однако во время индексирования выражения поиска, обнаруженного в зарегистрированном свойстве, полнотекстовый индексатор сохраняет вместе с выражением соответствующий внутренний идентификатор свойства. Если же свойство не зарегистрировано, то оно сохраняется в полнотекстовом индексе так, как если бы входило в текст документа и имело нулевое значение для внутреннего идентификатора свойства.  
  
 На следующем рисунке показано логическое представление отображения выражений поиска в полнотекстовом индексе, который связан со списком свойств поиска, представленным на предыдущем рисунке. Образец "Документ 1" содержит три свойства: Title, Author и Keywords, — а также текст документа. Для свойств Title и Keywords, которые указываются в списке свойств поиска, выражения поиска связываются с соответствующими внутренними идентификаторами свойств в полнотекстовом индексе. Содержимое свойства Author, напротив, индексируется так, как если бы оно входило в текст документа. Это означает, что регистрация свойства несколько увеличивает размер полнотекстового индекса, в зависимости от объема содержимого, хранящегося в свойстве.  
  
 ![Полнотекстовый индекс, в котором используется список свойств поиска](../../database-engine/media/ifts-spl-and-fti.gif "Полнотекстовый индекс, в котором используется список свойств поиска")  
  
 Выражения поиска в свойстве Title — Favorite, Biking и Trails — связываются с внутренним идентификатором, назначенным свойству Title для этого индекса (он равен 1). Выражения поиска в свойстве Keywords — biking и mountain — связываются с внутренним идентификатором, назначенным свойству Tags для этого индекса (он равен 2). Для выражений поиска в свойстве Author — Jane и Doe, а также выражений поиска в тексте документа внутренний идентификатор свойства имеет значение 0. Заметьте, что выражение biking встречается в свойстве Title, в свойстве Keywords (Tags) и в тексте документа. Этот документ будет включаться в результаты поиска biking в свойствах Title и Keywords (Tags). Универсальный полнотекстовый запрос выражения biking также будет возвращать этот документ, как и в случае, когда индекс не настроен для поиска в свойствах. Поиск выражения biking в свойстве Author не возвратит этот документ.  
  
 В полнотекстовом запросе по свойствам используются внутренние идентификаторы свойств, зарегистрированные в текущем списке свойств поиска для полнотекстового индекса.  
  
  
  
##  <a name="impact-of-enabling-property-searching"></a><a name="impact"></a> Эффект включения поиска свойств  
 Настройка полнотекстового индекса для поддержки поиска по одному или нескольким свойствам несколько увеличивает размер индекса в зависимости от числа свойств, указанных в списке свойств поиска, и содержимого каждого свойства.  
  
 При тестировании типичных корпусов документов Microsoft Word<sup>??</sup>, Excel<sup>??</sup>и PowerPoint<sup>??</sup> документы, мы настроили полнотекстовый индекс для индексирования стандартных свойств поиска. Индексирование таких свойств увеличивало размер полнотекстового индекса примерно на 5 %. Ожидается, что наблюдаемое увеличение размера будет характерным для большинства корпусов документов. Однако в конечном итоге увеличение размера определяется отношением объема данных свойств в заданном корпусе документов к общему объему данных.  
  
  
  
##  <a name="creating-a-search-property-list-and-enabling-property-search"></a><a name="creating"></a> Создание списка свойств поиска и включение поиска свойств  
  
###  <a name="creating-a-search-property-list"></a><a name="creating_sub"></a> Создание списка свойств поиска  
 **Создание списка свойств поиска с помощью Transact-SQL**  
  
 Используйте оператор [CREATE SEARCH PROPERTY LIST (Transact-SQL)](/sql/t-sql/statements/create-search-property-list-transact-sql), указав, как минимум, имя списка.  
  
##### <a name="to-create-a-search-property-list-in-management-studio"></a>Создание списка свойств поиска в среде Management Studio  
  
1.  В обозревателе объектов разверните узел сервера.  
  
2.  Разверните узел **Базы данных**, затем разверните базу данных, в которой нужно создать список свойств поиска.  
  
3.  Разверните узел **Хранилище**, затем щелкните правой кнопкой мыши **Списки свойств поиска**.  
  
4.  Выберите **Создать список свойств поиска**.  
  
5.  Введите имя списка свойств.  
  
6.  Дополнительно можно указать владельца списка свойств, отличного от текущего пользователя.  
  
7.  Выберите один из следующих вариантов.  
  
    -   **Создание пустого списка свойств поиска**  
  
    -   **Создание на основе существующего списка свойств поиска**  
  
     Дополнительные сведения см. в статье [New Search Property List](../../database-engine/new-search-property-list.md).  
  
8.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
 
  
###  <a name="adding-properties-to-a-search-property-list"></a><a name="adding"></a>Добавление свойств в список свойств поиска  
 Для поиска в свойствах необходимо создать *список свойств поиска* и указать одно или несколько свойств, доступных для поиска. После добавления свойства в список свойств поиска оно регистрируется для данного списка. Чтобы добавить свойство в список свойств поиска, требуются следующие значения.  
  
-   Идентификатор GUID набора свойств  
  
     Каждое свойство поиска принадлежит одному набору свойств, который содержит группу связанных свойств. Каждый набор свойств определяется идентификатором GUID.  
  
-   Целочисленный идентификатор свойства  
  
     Каждое свойство поиска обладает идентификатором, который уникален в пределах набора свойств. Учтите, что для заданного свойства идентификатором может быть целое число или строка, однако для полнотекстового поиска поддерживаются только целочисленные идентификаторы.  
  
-   Имя свойства  
  
     Это имя, которое пользователи будут указывать в полнотекстовых запросах для поиска по свойству. Имя свойства может содержать внутренние пробелы. Максимальная длина составляет 256 символов.  
  
     Именем свойства может быть любой из следующих объектов.  
  
    -   Каноническое имя Windows для свойства, например `System.Author` или `System.Contact.HomeAddress`.  
  
    -   Понятное имя, которое удобно запомнить пользователям. Некоторые свойства связанные с известными понятными именами, например «Автор» или «Домашний адрес», но можно указать имя, которое лучше всего подходит для пользователей.  
  
    > [!NOTE]  
    >  Заданное сочетание идентификатора GUID набора свойств и идентификатора свойства должно быть уникальным в пределах списка свойств поиска. Это означает, что нельзя добавить одно и то же свойство несколько раз с разными именами или описаниями.  
  
-   Описание свойства (необязательно)  
  
     При добавлении свойства поиска в список свойств поиска можно указать необязательное описание. Например, можно указать для свойства сведения, которые не очевидны по его имени, или описать набор свойств, в который входит свойство.  
  
 **Получение значений для списка свойств поиска**  
  
 См. раздел [Поиск идентификаторов GUID для наборов свойств и целочисленных идентификаторов свойств для свойств поиска](find-property-set-guids-and-property-integer-ids-for-search-properties.md).  
  
 **Добавление свойства в список свойств поиска с помощью Transact-SQL**  
  
 Используйте оператор [ALTER SEARCH PROPERTY LIST (Transact-SQL)](/sql/t-sql/statements/alter-search-property-list-transact-sql) со значениями, полученными одним из способов, описанных в разделе [Поиск идентификаторов GUID наборов свойств и целочисленных идентификаторов свойств для свойств поиска](find-property-set-guids-and-property-integer-ids-for-search-properties.md).  
  
 В следующем примере демонстрируется использование этих значений при добавлении свойства в список свойств поиска:  
  
```  
ALTER SEARCH PROPERTY LIST DocumentTablePropertyList  
   ADD 'Title'  
   WITH ( PROPERTY_SET_GUID = 'F29F85E0-4FF9-1068-AB91-08002B27B3D9', PROPERTY_INT_ID = 2,   
      PROPERTY_DESCRIPTION = 'System.Title - Title of the item.' );  
```  
  
 **Добавление свойства в список свойств поиска в среде Management Studio**  
  
 Используйте диалоговое окно **Свойства списка свойств поиска** для добавления и удаления свойств поиска. Элемент **Списки свойств поиска** находится в обозревателе объектов в узле **Хранение** соответствующей базы данных.  
  
  
  
###  <a name="associating-a-search-property-list-with-a-full-text-index"></a><a name="associating"></a> Связывание списка свойств поиска с полнотекстовым индексом  
 Для поддержки поиска по свойствам, зарегистрированным для списка свойств поиска, в полнотекстовом индексе необходимо связать список свойств поиска с индексом и выполнить повторное заполнение индекса. Во время повторного заполнения полнотекстового индекса создаются записи индекса для выражений поиска в каждом из зарегистрированных свойств.  
  
 Пока полнотекстовый индекс остается связанным с данным списком свойств поиска, в полнотекстовом запросе можно использовать параметр PROPERTY предиката CONTAINS для поиска по свойствам, которые зарегистрированы для данного списка свойств поиска.  
  
 Если изменить список свойств поиска, связанный с полнотекстовым индексом, то необходимо перестроить индекс, чтобы обеспечить согласованное состояние. Этот индекс немедленно усекается и остается пустым до запуска полного заполнения. Дополнительные сведения об условиях, при которых изменение списка свойств поиска вызывает перестроение индекса, см. в подразделе "Примечания" раздела [ALTER FULLTEXT INDEX (Transact-SQL)](/sql/t-sql/statements/alter-fulltext-index-transact-sql).  
  
 **Связывание списка свойств поиска с полнотекстовым индексом с помощью Transact-SQL**  
  
 Используйте оператор [ALTER FULLTEXT INDEX (Transact-SQL)](/sql/t-sql/statements/alter-fulltext-index-transact-sql) с предложением `SET SEARCH PROPERTY LIST = <property_list_name>`.  
  
 **Связывание списка свойств поиска с полнотекстовым индексом с помощью среды Management Studio**  
  
 Укажите значение **Список свойств поиска** на странице **Общие** диалогового окна **Свойства полнотекстового индекса** .  
  
  
  
##  <a name="querying-search-properties-with-contains"></a><a name="Ov_CONTAINS_using_PROPERTY"></a>Запрос свойств поиска с помощью CONTAINS  
 Далее представлен базовый синтаксис [CONTAINS](/sql/t-sql/queries/contains-transact-sql) для полнотекстового запроса по свойствам:  
  
```sql  
SELECT column_name FROM table_name  
  WHERE CONTAINS ( PROPERTY ( column_name, 'property_name' ), '<contains_search_condition>' )  
```  
  
 Например, следующий запрос выполняет поиск по индексированному свойству `Title`в столбце `Document` таблицы `Production.Document` в базе данных `AdventureWorks` . Запрос возвращает только те документы, свойство `Title` которых содержит строку `Maintenance` или `Repair`  
  
```  
USE AdventureWorks  
GO  
SELECT Document FROM Production.Document  
  WHERE CONTAINS ( PROPERTY ( Document, 'Title' ), 'Maintenance OR Repair')  
GO  
```  
  
 В этом примере предполагается, что фильтр IFilter для документа извлекает свойство Title, это свойство добавляется в список свойств поиска, а этот список связывается с полнотекстовым индексом.  
  
  
  
##  <a name="managing-search-property-lists"></a><a name="managing"></a> Управление списками свойств поиска  
  
###  <a name="viewing-and-changing-a-search-property-list"></a><a name="viewing"></a> Просмотр и изменение списка свойств поиска  
 **Изменение списка свойств поиска с помощью Transact-SQL**  
  
 Для добавления и удаления свойств поиска используйте оператор [ALTER SEARCH PROPERTY LIST (Transact-SQL)](/sql/t-sql/statements/alter-search-property-list-transact-sql).  
  
##### <a name="to-view-and-change-a-search-property-list-in-management-studio"></a>Просмотр и изменение списка свойств поиска в среде Management Studio  
  
1.  В обозревателе объектов разверните узел сервера.  
  
2.  Раскройте узел **Базы данных**, а затем — соответствующую базу данных.  
  
3.  Разверните **Хранилище**.  
  
4.  Разверните **Списки свойств поиска** для отображения списков свойств поиска.  
  
5.  Щелкните правой кнопкой мыши список свойств и выберите **Свойства**.  
  
6.  В диалоговом окне **Редактор списка свойств поиска** для добавления или удаления свойств поиска используйте сетку свойств:  
  
    1.  Чтобы удалить свойство документа, щелкните заголовок строки слева от свойства и нажмите клавишу DEL.  
  
    2.  Чтобы добавить свойство документа, щелкните пустую строку в нижней части списка справа от **\*** и введите значения для нового свойства.  
  
         Описание этих значений см. в разделе [Редактор списка свойств поиска](../../database-engine/search-property-list-editor.md). Сведения о способе получения этих значений для свойств, определенных корпорацией Майкрософт, см. в разделе [Поиск идентификаторов GUID наборов свойств и целочисленных идентификаторов свойств для свойств поиска](find-property-set-guids-and-property-integer-ids-for-search-properties.md). Дополнительные сведения о свойствах, определенных независимыми поставщиками программного обеспечения (ISV), см. в документации по этим поставщикам.  
  
7.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
  
  
###  <a name="deleting-a-search-property-list"></a><a name="deleting"></a> Удаление списка свойств поиска  
 Нельзя удалить из базы данных список свойств поиска, связанный с каким-либо полнотекстовым индексом.  
  
 **Удаление списка свойств поиска с помощью Transact-SQL**  
  
 Используйте оператор [DROP SEARCH PROPERTY LIST (Transact-SQL)](/sql/t-sql/statements/drop-search-property-list-transact-sql).  
  
##### <a name="to-delete-a-search-property-list-in-management-studio"></a>Удаление списка свойств поиска в среде Management Studio  
  
1.  В обозревателе объектов разверните узел сервера.  
  
2.  Раскройте узел **Базы данных**, а затем — соответствующую базу данных.  
  
3.  Разверните узел **Хранилище**, затем узел **Списки свойств поиска** .  
  
4.  Щелкните правой кнопкой мыши список свойств, который необходимо удалить, и выберите пункт **Удалить**.  
  
5.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  

  
## <a name="see-also"></a>См. также  
 [Поиск идентификаторов GUID набора свойств и целочисленных идентификаторов свойств для свойств поиска](find-property-set-guids-and-property-integer-ids-for-search-properties.md)   
 [Настройка поисковых фильтров и управление ими](configure-and-manage-filters-for-search.md)  
  
  
