---
title: распределенное воспроизведение безопасность | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: tools-other
ms.topic: conceptual
ms.assetid: 7e2e586d-947d-4fe2-86c5-f06200ebf139
author: stevestein
ms.author: sstein
manager: craigg
ms.openlocfilehash: 0c040bde90a54b9327023d1e1889efdd2930d81b
ms.sourcegitcommit: 6fd8c1914de4c7ac24900fe388ecc7883c740077
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2020
ms.locfileid: "63150351"
---
# <a name="distributed-replay-security"></a>Безопасность распределенного воспроизведения
  Перед установкой и использованием компонента распределенного воспроизведения [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ознакомьтесь с важной информацией о безопасности, представленной в этой статье. В этом разделе описываются шаги настройки мер безопасности после установки, необходимые перед началом использования распределенного воспроизведения. В этом разделе также описываются важные соображения по защите данных и важные шаги удаления.  
  
## <a name="user-and-service-accounts"></a>Учетные записи пользователей и служб  
 В следующей таблице приведены описания учетных записей, применяемых для распределенного воспроизведения. После установки распределенного воспроизведения необходимо назначить субъектов безопасности для запуска учетных записей контроллера и службы клиента распределенного воспроизведения. Таким образом, рекомендуется настроить соответствующие учетные записи пользователей домена перед установкой компонентов распределенного воспроизведения.  
  
|Учетная запись пользователя|Требования|  
|------------------|------------------|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Учетная запись службы контроллера распределенного воспроизведения|Эта учетная запись может быть учетной записью пользователя домена или учетной записью локального пользователя. Если используется учетная запись локального пользователя, средство администрирования, контроллер и клиент должны быть запущены на одном компьютере.<br /><br /> **\*\* Примечание о безопасности. \*\*** Мы рекомендуем не делать эту учетную запись членом локальной группы администраторов Windows.|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Учетная запись службы клиента распределенного воспроизведения|Эта учетная запись может быть учетной записью пользователя домена или учетной записью локального пользователя. Для использования учетной записи локального пользователя контроллер, клиент и целевой сервер SQL Server должны быть запущены на одном компьютере.<br /><br /> **\*\* Примечание о безопасности. \*\*** Мы рекомендуем не делать эту учетную запись членом локальной группы администраторов Windows.|  
|Интерактивная учетная запись пользователя, которая используется для запуска средства администрирования распределенного воспроизведения|Эта учетная запись может быть учетной записью локального пользователя или учетной записью пользователя домена. Для использования учетной записи локального пользователя средство администрирования и контроллер должны быть запущены на одном компьютере.|  
  
 **Важно**! При настройке контроллера распределенного воспроизведения можно указать одну или несколько учетных записей, которые будут использоваться для запуска служб клиента распределенного воспроизведения. Далее представлен список поддерживаемых учетных записей.  
  
-   Учетная запись пользователя домена  
  
-   Пользователь, который создал учетную запись локального пользователя  
  
-   Администратор  
  
-   Виртуальная учетная запись и управляемая учетная запись службы (MSA)  
  
-   Сетевые службы, локальные службы и система  
  
 Учетные записи групп (локальные или доменные) и другие встроенные учетные записи (например, «Все») не принимаются.  
  
 Для настройки учетных записей службы или их паролей после установки распределенного воспроизведения вы можете использовать службы Windows. Чтобы изменить учетные записи службы, связанные со службами контроллера или клиента распределенного воспроизведения, выполните следующие действия.  
  
1.  Для этого выполните одно из следующих действий в зависимости от операционной системы.  
  
    -   Нажмите кнопку **Пуск**, `services.msc` введите в поле **поиска** и нажмите клавишу ВВОД.  
  
    -   Нажмите кнопку **Пуск**, выберите команду **выполнить**, введите `services.msc`и нажмите клавишу ВВОД.  
  
2.  В диалоговом окне **Службы** щелкните правой кнопкой мыши службу, которую требуется настроить, и выберите пункт **Свойства**.  
  
3.  На вкладке **Вход в систему** выберите **Указанная учетная запись**.  
  
4.  Настройте учетную запись пользователя, которую предстоит использовать.  
  
## <a name="file-and-folder-permissions"></a>Разрешения для папок и файлов  
 После того как были заданы учетные записи службы, необходимо предоставить этим учетным записям службы необходимые разрешения для файла и папок. Настройте разрешения для файлов и папок в соответствии со следующей таблицей.  
  
|Учетная запись|Разрешения папки|  
|-------------|------------------------|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Учетная запись службы контроллера распределенного воспроизведения|`<Controller_Installation_Path>\DReplayController` (чтение, запись и удаление)<br /><br /> `DReplayServer.xml` файл (чтение, запись)|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Учетная запись службы клиента распределенного воспроизведения|`<Client_Installation_Path>\DReplayClient` (чтение, запись и удаление)<br /><br /> `DReplayClient.xml` файл (чтение, запись)<br /><br /> Рабочие и результирующие каталоги, как указано в файле конфигурации клиента элементами `WorkingDirectory` и `ResultDirectory` соответственно. (Чтение и запись)|  
  
## <a name="dcom-permissions"></a>Разрешения DCOM  
 DCOM используется для связи через удаленный вызов процедур (RPC) между контроллером и средством администрирования и между контроллером и всеми клиентами. После установки компонентов распределенного воспроизведения необходимо настроить разрешения DCOM на контроллере для компьютера и конкретных приложений на контроллере.  
  
 Чтобы настроить разрешения DCOM на контроллере, выполните следующие шаги.  
  
1.  **Откройте dcomcnfg.exe, оснастку "Службы компонентов"** : это средство, которое используется для настройки разрешений DCOM.  
  
    1.  На компьютере контроллера нажмите кнопку **Пуск**.  
  
    2.  Введите `dcomcnfg.exe` в поле **поиска** .  
  
    3.  Нажмите клавишу ВВОД.  
  
2.  **Настройте разрешения DCOM компьютера**: предоставьте соответствующие разрешения DCOM компьютера каждой учетной записи, перечисленной в следующей таблице. Дополнительные сведения о методах настройки разрешений на компьютере см. в разделе [Список задач: управление приложениями DCOM](https://go.microsoft.com/fwlink/?LinkId=185842).  
  
3.  **Настройте разрешения DCOM для конкретного предложения**: предоставьте соответствующие разрешения DCOM, связанные с конкретным приложением, каждой учетной записи, перечисленной в следующей таблице. Имя приложения DCOM для контроллера службы — **DReplayController**. Дополнительные сведения о методах настройки разрешений для конкретного приложения см. в разделе [Список задач: управление приложениями DCOM](https://go.microsoft.com/fwlink/?LinkId=185842).  
  
 В следующей таблице описаны разрешения DCOM, необходимые для интерактивной учетной записи пользователя средства администрирования и учетных записей службы клиента.  
  
|Компонент|Учетная запись|Требуемые разрешения DCOM на контроллере|  
|-------------|-------------|---------------------------------------------|  
|Средство администрирования распределенного воспроизведения|Интерактивная учетная запись пользователя|Локальный доступ<br /><br /> Удаленный доступ<br /><br /> Локальный запуск<br /><br /> Удаленный запуск<br /><br /> Локальная активация<br /><br /> Удаленная активация|  
|Клиент распределенного воспроизведения|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Учетная запись службы клиента распределенного воспроизведения|Локальный доступ<br /><br /> Удаленный доступ<br /><br /> Локальный запуск<br /><br /> Удаленный запуск<br /><br /> Локальная активация<br /><br /> Удаленная активация|  
  
> [!IMPORTANT]  
>  Для защиты от вредоносных запросов или атак типа «отказ в обслуживании» проверьте, что используется только доверенная учетная запись пользователя для учетной записи службы клиента. Эта учетная запись будет иметь возможность подключения и воспроизведения рабочей нагрузки на целевом экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
## <a name="sql-server-permissions"></a>Разрешения SQL Server  
 Учетные записи службы клиента распределенного воспроизведения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] используются для подключения к целевому экземпляру рабочей нагрузки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Для этих соединений поддерживается только режим проверки подлинности Windows.  
  
 После установки службы клиента распределенного воспроизведения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на нескольких компьютерах субъекту безопасности, используемому для этих учетных записей службы, необходимо предоставить роль сервера sysadmin в экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , в котором предстоит воспроизвести рабочую нагрузку трассировки. Этот шаг не выполняется автоматически во время установки распределенного воспроизведения.  
  
## <a name="data-protection"></a>Защита данных  
 В среде распределенного воспроизведения следующим учетным записям пользователя предоставляется полный доступ к экземпляру целевого сервера [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], входным данным трассировки и файлам результатов трассировки:  
  
-   Интерактивная учетная запись пользователя, которая используется для запуска средства администрирования.  
  
-   Учетная запись службы контроллера.  
  
-   Учетная запись службы клиента.  
  
-   Члены локальной группы администраторов на контроллере.  
  
-   Члены локальной группы администраторов на клиентах.  
  
    > [!IMPORTANT]  
    >  Эти учетные записи имеют полный доступ к любой личной информации, идентифицирующей конкретного пользователя (PII), или конфиденциальным сведениям, содержащимся в файлах данных трассировки, промежуточных данных, данных диспетчеризации или данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , использованных распределенным воспроизведением.  
  
 Рекомендуется применить следующие меры безопасности.  
  
-   Сохраните входные данные трассировки, выходные результаты трассировки и файлы базы данных в местонахождении с файловой системой NTFS и примените соответствующие списки управления доступом (ACL). При необходимости зашифруйте данные, сохраненные на компьютере [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Учтите, что списки ACL не применяются к файлам трассировки и не происходит маскирования или запутывания данных. Эти файлы следует удалить немедленно после использования.  
  
-   Примените соответствующие списки ACL и политики сохранения ко всем промежуточным файлам и файлам сообщений, которые создаются при распределенном воспроизведении.  
  
-   Используйте протокол SSL для защиты сетевого транспорта.  
  
## <a name="important-removal-steps"></a>Важные шаги удаления  
 Рекомендуется использовать распределенное воспроизведение только в тестовой среде. После завершения тестирования и перед предоставлением этих компьютеров для выполнения другого задания обязательно выполните следующие действия.  
  
-   Удалите компоненты распределенного воспроизведения и удалите соответствующие файлы конфигурации из контроллера и всех клиентов.  
  
-   Удалите все файлы трассировки, промежуточные, сообщений и базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которые использовались в ходе тестирования. Промежуточные и переданные файлы хранятся в рабочем каталоге на контроллере и клиенте соответственно.  
  
## <a name="see-also"></a>См. также:  
 [Распределенное воспроизведение SQL Server](sql-server-distributed-replay.md)   
 [Установка распределенного воспроизведения](install-distributed-replay-overview.md)  
  
  
