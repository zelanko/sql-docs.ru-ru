---
title: адаптер для облака для SQL Server | Документация Майкрософт
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- Cloud adapter
- Deploy to Azure
ms.assetid: 82ed0d0f-952d-4d49-aa36-3855a3ca9877
author: mashamsft
ms.author: mathoma
manager: craigg
ms.openlocfilehash: bf57adb31330f5b0c0f18fbcccd4d71f47d3c933
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "70176015"
---
# <a name="cloud-adapter-for-sql-server"></a>Адаптер для облака для SQL Server
  Служба адаптер для облака создается как часть [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] подготовки на виртуальной машине Azure. Служба адаптера для облака создает самозаверяющий SSL-сертификат в рамках своего первого запуска, а затем запускается от имени учетной записи **Local System** . Она создает файл конфигурации, который используется для ее настройки. Служба Cloud Adapter также создает правило брандмауэра Windows, чтобы разрешить входящие подключения TCP через порт по умолчанию 11435.  
  
 Служба Cloud Adapter — это синхронная служба без сохранения состояния, которая получает сообщения из локального экземпляра [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. Когда служба адаптера для облака останавливается, она останавливает адаптер для облака удаленного доступа, отменяет привязку SSL-сертификата и отключает правило брандмауэра Windows.  
  
## <a name="cloud-adapter-requirements"></a>Требования для адаптера для облака  
 Обратите внимание на следующие требования для установки, включения и запуска Cloud Adapter для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].  
  
-   Cloud Adapter поддерживается в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012 и более поздних версиях. В [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012 службе Cloud Adapter для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] требуются объекты SMO для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012.  
  
-   Веб-служба адаптера для облака запускается в учетной записи **Local System** и проверяет учетные данные клиента до выполнения любой задачи. Учетные данные, предоставленные клиентом, должны принадлежать учетной записи использования, которая является членом локальной группы **администраторов** на удаленном компьютере.  
  
-   Служба Cloud Adapter поддерживает только проверку подлинности [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .  
  
-   Cloud Adapter использует учетную запись администратора локальной виртуальной машины для выполнения команд на локальном компьютере, а не учетную запись sa.  
  
-   Адаптер для облака прослушивает порт TCP/IP. По умолчанию используется порт 11435.  
  
-   Адаптер для облака должен иметь разрешения на создание и изменение правил брандмауэра Windows.  
  
## <a name="cloud-adapter-configuration-settings"></a>Параметры конфигурации адаптера для облака  
 Используйте следующую конфигурацию, чтобы изменить параметры адаптера для облака.  
  
-   **Путь по умолчанию для файла конфигурации** -C:\PROGRAM Files\Microsoft SQL Server\120\Tools\CloudAdapter\  
  
-   **Параметры файла конфигурации** -  
  
    -   \<configuration>  
  
        -   \<appSettings>  
  
            -   \<добавить ключ = "Вебсервицепорт" value = ""/>  
  
            -   \<добавить ключ = "Вебсервицецертификате" value = "GUID"/>  
  
            -   \<Add Key = "ExposeExceptionDetails" value = "true"/>  
  
        -   \</Аппсеттингс>  
  
    -   \</Настройка>  
  
-   **Сведения о сертификате** . сертификат имеет следующие значения:  
  
    -   Subject-"CN = Клаудадаптер\<VMName>, dc = SQL Server, DC = Microsoft"  
  
    -   Для сертификата должно быть включено только расширенное использование ключей проверки подлинности на сервере.  
  
    -   Длина ключа сертификата — 2048.  
  
 **Значения файла конфигурации**:  
  
|Параметр|Значения|По умолчанию|Комментарии|  
|-------------|------------|-------------|--------------|  
|WebServicePort|1-65535|11435|Если не указано, используется 11435.|  
|WebServiceCertificate|Thumbprint|Empty|Если не указано, формируется новый самозаверяющий сертификат.|  
|ExposeExceptionDetails|True или False|False||  
  
## <a name="cloud-adapter-troubleshooting"></a>Устранение неполадок адаптера для облака  
 Используйте следующие сведения для устранения неполадок со службой Cloud Adapter для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].  
  
-   **Обработка ошибок и ведение журнала** — ошибки и сообщения о состоянии записываются в журнал событий приложений.  
  
-   **Трассировка, события** — все события записываются в журнал событий приложений.  
  
-   **Control, Configuration** — используйте файл конфигурации, расположенный в папке C:\PROGRAM Files\Microsoft SQL Server\120\Tools\CloudAdapter\\.  
  
|Ошибка|Идентификатор ошибки|Причина:|Разрешение|  
|-----------|--------------|-----------|----------------|  
|Возникло исключение при добавлении сертификата в хранилище сертификатов. {Текст исключения}|45560|Разрешения на доступ к хранилищу сертификатов компьютера|Убедитесь, что служба Cloud Adapter имеет разрешения на добавление сертификатов в хранилище сертификатов компьютера.|  
|Возникло исключение при попытке настройки SSL-привязки для порта {номер порта} сертификата {отпечаток}. {Исключение}.|45561|Другое приложение уже использует порт или привязало к нему сертификат.|Удалите существующие привязки или измените порт адаптера для облака в файле конфигурации.|  
|Не удалось найти SSL-сертификат [{отпечаток}] в хранилище сертификатов.|45564|Отпечаток сертификата находится в файле конфигурации, но хранилище личных сертификатов для службы не содержит сертификат.<br /><br /> Недостаточно разрешений.|Убедитесь, что сертификат находится в хранилище личных сертификатов для службы.<br /><br /> Убедитесь, что служба имеет необходимые разрешения для хранилища.|  
|Не удалось запустить веб-службу. {Текст исключения}|45570|Описано в исключении.|Включите ExposeExceptionDetails и используйте расширенные сведения из исключения.|  
|Истек срок действия сертификата [{отпечаток}].|45565|У сертификата, указанного в файле конфигурации, истек срок действия.|Добавьте действительный сертификат и добавьте в файл конфигурации его отпечаток.|  
|Ошибка веб-службы {0}:.|45571|Описано в исключении.|Включите ExposeExceptionDetails и используйте расширенные сведения из исключения.|  
  
## <a name="see-also"></a>См. также:  
 [Развертывание базы данных SQL Server в виртуальной машине Microsoft Azure](../relational-databases/databases/deploy-a-sql-server-database-to-a-microsoft-azure-virtual-machine.md)  
  
  
