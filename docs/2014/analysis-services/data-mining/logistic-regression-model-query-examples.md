---
title: Примеры запросов модели логистической регрессии | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- logistic regression [Analysis Services]
- content queries [DMX]
ms.assetid: 7c8e13a3-5c67-46c2-abfa-4881e6ef9c62
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: d156a8f015a45ca257bf4f988cf69d229eafe5f0
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66084230"
---
# <a name="logistic-regression-model-query-examples"></a>Примеры запросов модели логистической регрессии
  К модели интеллектуального анализа данных можно создать два вида запросов: запросы содержимого, возвращающие подробные сведения о закономерностях, обнаруженных при анализе, и прогнозирующие запросы, в которых используются закономерности, содержащиеся в модели, для прогнозирования на основе новых данных.  
  
 В этом разделе описывается процесс создания запросов к моделям, основанным на алгоритме логистической регрессии (Майкрософт).  
  
 **Запросы содержимого**  
  
 [Получение параметров модели с помощью набора строк схемы интеллектуального анализа данных](#bkmk_Query1)  
  
 [Поиск дополнительной информации о модели с помощью расширений интеллектуального анализа данных](#bkmk_Query2)  
  
 **Прогнозирующие запросы**  
  
 [Прогнозы для непрерывной величины](#bkmk_Query3)  
  
 [Прогнозы для дискретной величины](#bkmk_Query4)  
  
##  <a name="bkmk_top"></a> Получение сведений о модели логистической регрессии  
 Модели логистической регрессии создаются с использованием алгоритма нейронной сети (Майкрософт) с особым набором параметров; поэтому модель логистической регрессии частично содержит ту же информацию, что и модель нейронных сетей, но менее сложна. Сведения о структуре содержимого модели и информацию о том, какие сведения содержатся в узле каждого типа, см. в разделе [Mining Model Content for Logistic Regression Models &#40;Analysis Services - Data Mining&#41;](mining-model-content-for-logistic-regression-models.md).  
  
 Для выполнения этой процедуры сценариев запроса можно создать модель логистической регрессии, как описано в следующем разделе учебника по интеллектуальному анализу данных: [Занятие 5. Построение моделей логистической регрессии нейронной сети и &#40;средний уровень учебник по интеллектуальному анализу данных&#41;](../../tutorials/lesson-5-build-models-intermediate-data-mining-tutorial.md).  
  
 Можно также использовать структуру интеллектуального анализа данных (целевая рассылка для всех) из [учебника по основам интеллектуального анализа данных](../../tutorials/basic-data-mining-tutorial.md).  
  
```  
ALTER MINING STRUCTURE [Targeted Mailing]  
ADD MINING MODEL [TM_Logistic Regression]  
([Customer Key],  
[Age],  
[Bike Buyer] PREDICT,  
[Yearly Income] PREDICT,  
[Commute Distance],  
[English Education],  
Gender,  
[House Owner Flag],  
[Marital Status],  
[Number Cars Owned],  
[Number Children At Home],  
[Region],  
[Total Children]  
)  
USING Microsoft_Logistic_Regression  
```  
  
###  <a name="bkmk_Query1"></a> Образец запроса 1. Получение параметров модели с помощью набора строк схемы интеллектуального анализа данных  
 Используя запросы к набору строк схемы интеллектуального анализа данных, можно находить метаданные модели, например: время ее создания, время ее последней обработки, имя структуры интеллектуального анализа данных, на которой основана данная модель, и имя столбца, использованного в качестве прогнозируемого атрибута. Следующий пример возвращает параметры, которые использовались при создании модели, имя и тип модели и дату ее создания.  
  
```  
SELECT MODEL_NAME, SERVICE_NAME, DATE_CREATED, MINING_PARAMETERS   
FROM $system.DMSCHEMA_MINING_MODELS  
WHERE MODEL_NAME = 'Call Center_LR'  
```  
  
 Образец результатов.  
  
|MODEL_NAME|SERVICE_NAME|DATE_CREATED|MINING_PARAMETERS|  
|-----------------|-------------------|-------------------|------------------------|  
|Call Center_LR|Microsoft_Logistic_Regression|04/07/2009 20:38:33|HOLDOUT_PERCENTAGE=30, HOLDOUT_SEED=1, MAXIMUM_INPUT_ATTRIBUTES=255, MAXIMUM_OUTPUT_ATTRIBUTES=255, MAXIMUM_STATES=100, SAMPLE_SIZE=10000|  
  
###  <a name="bkmk_Query2"></a> Образец запроса 2. Поиск дополнительной информации о модели с помощью расширений интеллектуального анализа данных  
 Следующий запрос возвращает основные сведения о модели логистической регрессии. Модель логистической регрессии во многом подобна модели нейронной сети, в том числе наличием граничного статистического узла (NODE_TYPE = 24), описывающего значения входных данных. В следующем примере запроса используется модель целевой рассылки и возвращаются все входные значения, извлекаемые из вложенной таблицы NODE_DISTRIBUTION.  
  
```  
SELECT FLATTENED NODE_DISTRIBUTION AS t  
FROM [TM_Logistic Regression].CONTENT   
```  
  
 Частичные результаты:  
  
|t.ATTRIBUTE_NAME|t.ATTRIBUTE_VALUE|t.SUPPORT|t.PROBABILITY|t.VARIANCE|t.VALUETYPE|  
|-----------------------|------------------------|---------------|-------------------|----------------|-----------------|  
|Возраст|Missing|0|0|0|1|  
|Возраст|45,43491192|17484|1|126,9544114|3|  
|Покупатель велосипеда|Missing|0|0|0|1|  
|Покупатель велосипеда|0|8869|0.507263784|0|4|  
|Покупатель велосипеда|1|8615|0.492736216|0|4|  
|Расстояние до работы|Missing|0|0|0|1|  
|Расстояние до работы|5–10 км|3033|0,173472889|0|4|  
  
 Настоящий запрос вернет гораздо больше строк; однако этот образец показывает, какого типа информацию о входных значениях можно получить. Для дискретных входных данных в таблице перечислены все возможные значения. Для непрерывных входных данных, таких как Age, вывод полного списка невозможен, поэтому вывод дискретизируется с усреднением. Дополнительные сведения о том, как использовать данные в узле граничной статистики, см. в разделе [Mining Model Content for Logistic Regression Models &#40;Analysis Services - Data Mining&#41;](mining-model-content-for-logistic-regression-models.md).  
  
> [!NOTE]  
>  Результаты были приведены к плоскому виду для удобства просмотра, но можно также вернуть вложенную таблицу в виде одного столбца, если используемый поставщик поддерживает иерархические наборы строк.  
  
## <a name="prediction-queries-on-a-logistic-regression-model"></a>Прогнозирующие запросы к модели логистической регрессии  
 Функцию [Predict (DMX)](/sql/dmx/predict-dmx) можно использовать с самыми разными моделями интеллектуального анализа данных для предоставления новых данных для моделей и проведения прогнозов на основе новых значений. Можно также использовать функции для получения такой дополнительной информации о прогнозах, как вероятность, что прогноз верен. В данном разделе приводится несколько примеров прогнозирующих запросов для модели логистической регрессии.  
  
###  <a name="bkmk_Query3"></a> Образец запроса 3. Прогнозы для непрерывной величины  
 Поскольку логистическая регрессия также поддерживает непрерывные атрибуты как в качестве входных данных, так и для прогноза, легко создавать модели, вычисляющие корреляцию различных факторов в конкретных данных. Для исследования связей между этими факторами можно использовать прогнозирующие запросы.  
  
 Следующий образец запроса основан на модели центра обработки вызовов из учебника для среднего уровня и создает одноэлементный запрос, предсказывающий уровень обслуживания для утренней пятничной смены. Функция [PredictHistogram (DMX)](/sql/dmx/predicthistogram-dmx) возвращает вложенную таблицу, содержащую статистику, которая позволяет понять, насколько достоверно спрогнозированное значение.  
  
```  
SELECT  
  Predict([Call Center_LR].[Service Grade]) as Predicted ServiceGrade,  
  PredictHistogram([Call Center_LR].[Service Grade]) as [Results],  
FROM  
  [Call Center_LR]  
NATURAL PREDICTION JOIN  
(SELECT 'Friday' AS [Day Of Week],  
  'AM' AS [Shift]) AS t  
```  
  
 Образец результатов.  
  
 **Предсказать уровень обслуживания**: 0.102601830123659  
  
 **Результаты**  
  
|Service Grade|$SUPPORT|$PROBABILITY|$ADJUSTEDPROBABILITY|$VARIANCE|$STDEV|  
|-------------------|--------------|------------------|--------------------------|---------------|------------|  
|0.102601830123659|83.0232558139535|0.988372093023256|0|0.00120552660600087|0.034720694203902|  
||0.976744186046512|0.0116279069767442|0.0116279069767442|0|0|  
  
 Дополнительные сведения о вероятности, мощности несущего множества и стандартном отклонении для значений во вложенной таблице NODE_DISTRIBUTION см. в разделе [Содержимое моделей интеллектуального анализа данных для моделей логистической регрессии (службы Analysis Services — интеллектуальный анализ данных)](mining-model-content-for-logistic-regression-models.md).  
  
###  <a name="bkmk_Query4"></a> Образец запроса 4. Прогнозы для дискретной величины  
 Логистическая регрессия обычно используется в ситуациях, когда нужно анализировать факторы, влияющие на двоичные результаты. Несмотря на то, что модель, используемая в этом учебнике, предсказывает непрерывное значение **ServiceGrade**, в реальных сценариях можно настроить ее для предсказания того, достигнет ли уровень обслуживания определенного дискретизированного целевого значения. Можно также получить предсказания с использованием непрерывного значения, но позже распределить выходные значения по группам **Хорошие**, **Удовлетворительные**и **Плохие**.  
  
 Следующий образец показывает, как можно группировать прогнозируемый атрибут. Для этого создается копия структуры интеллектуального анализа данных, после чего метод дискретизации целевого столбца изменяется так, что непрерывные значения группируются.  
  
 Следующая процедура описывает порядок группирования значений Service Grade в данных центра обработки вызовов.  
  
##### <a name="to-create-a-discretized-version-of-the-call-center-mining-structure-and-models"></a>Создание дискретизированной версии структуры и моделей интеллектуального анализа данных центра обработки вызовов  
  
1.  В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]разверните узел **Структуры интеллектуального анализа данных**в обозревателе решений.  
  
2.  Щелкните Call Center.dmm правой кнопкой мыши и выберите команду **Копировать**.  
  
3.  Щелкните правой кнопкой мыши узел **Структуры интеллектуального анализа данных** и выберите команду **Вставить**. Добавляется новая структура интеллектуального анализа данных с именем Call Center 1.  
  
4.  Щелкните правой кнопкой мыши эту новую структуру интеллектуального анализа данных и выберите команду **Переименовать**. Введите новое имя, **Call Center Discretized**.  
  
5.  Дважды щелкните новую структуру интеллектуального анализа данных, чтобы открыть ее в конструкторе. Обратите внимание, что все модели интеллектуального анализа данных также скопировались, и каждая из них имеет расширение 1. Оставьте их имена без изменений.  
  
6.  На вкладке **Структура интеллектуального анализа данных** щелкните правой кнопкой мыши столбец Service Grade и выберите пункт **Свойства**.  
  
7.  Изменение `Content` свойства из **Continuous** для **Discretized**. Изменение `DiscretizationMethod` свойства **кластеров**. Для свойства Discretization BucketCount введите значение **3**.  
  
    > [!NOTE]  
    >  Эти параметры служат лишь для иллюстрации процесса, они не гарантируют получения верной модели.  
  
8.  В меню **Модель интеллектуального анализа данных** выберите команду **Обработать структуру интеллектуального анализа данных и все модели**.  
  
 Следующий образец запроса основан на дискретизированной модели и предсказывает уровень обслуживания для указанного дня недели, включая вероятности для каждого предсказанного результата.  
  
```  
SELECT  
  (PredictHistogram([Call Center_LR 1].[Service Grade])) as [Predictions]  
FROM  
  [Call Center_LR 1]  
NATURAL PREDICTION JOIN  
(SELECT 'Saturday' AS [Day Of Week]) AS t    
```  
  
 Ожидаемый результат:  
  
 **Прогнозы**  
  
|Service Grade|$SUPPORT|$PROBABILITY|$ADJUSTEDPROBABILITY|$VARIANCE|$STDEV|  
|-------------------|--------------|------------------|--------------------------|---------------|------------|  
|0.10872718383125|35.7246504770641|0.425293458060287|0.0170168360030293|0|0|  
|0.05855769230625|31.7098880800703|0.377498667619885|0.020882020060454|0|0|  
|0.170169491525|15.6109159883202|0.185844237956192|0.0661386571386049|0|0|  
||0.954545454545455|0.0113636363636364|0.0113636363636364|0|0|  
  
 Обратите внимание, что предсказанные результаты сгруппированы по трем указанным категориям. Однако это группирование основано на кластеризации реальных значений данных, а не произвольных значений, которые могли быть указаны в качестве бизнес-целей.  
  
## <a name="list-of-prediction-functions"></a>Список прогнозирующих функций  
 Все алгоритмы [!INCLUDE[msCoName](../../includes/msconame-md.md)] поддерживают общий набор функций. Однако алгоритм логистической регрессии [!INCLUDE[msCoName](../../includes/msconame-md.md)] поддерживает дополнительные функции, список которых приведен в следующей таблице:  
  
|||  
|-|-|  
|прогнозирующую функцию|Использование|  
|[IsDescendant (расширения интеллектуального анализа данных)](/sql/dmx/isdescendant-dmx)|Определяет, является ли узел дочерним для другого узла модели.|  
|[PredictAdjustedProbability (расширения интеллектуального анализа данных)](/sql/dmx/predictadjustedprobability-dmx)|Возвращает настроенную вероятность указанного состояния.|  
|[PredictHistogram (расширения интеллектуального анализа данных)](/sql/dmx/predicthistogram-dmx)|Возвращает прогнозируемое значение или набор значений для указанного столбца.|  
|[PredictProbability (расширения интеллектуального анализа данных)](/sql/dmx/predictprobability-dmx)|Возвращает вероятность для указанного состояния.|  
|[PredictStdev (расширения интеллектуального анализа данных)](/sql/dmx/predictstdev-dmx)|Возвращает стандартное отклонение для прогнозируемого значения.|  
|[PredictSupport (расширения интеллектуального анализа данных)](/sql/dmx/predictsupport-dmx)|Возвращает опорное значение для указанного состояния.|  
|[PredictVariance (расширения интеллектуального анализа данных)](/sql/dmx/predictvariance-dmx)|Возвращает дисперсию указанного столбца.|  
  
 Список функций, общих для всех алгоритмов [!INCLUDE[msCoName](../../includes/msconame-md.md)], см. в статье [Общие функции прогнозирования (расширения интеллектуального анализа данных)](/sql/dmx/general-prediction-functions-dmx). Синтаксис отдельных функций см. в статье [Справочник по функциям расширений интеллектуального анализа данных (расширения интеллектуального анализа данных)](/sql/dmx/data-mining-extensions-dmx-function-reference).  
  
> [!NOTE]  
>  Для моделей нейронной сети и логистической регрессии функция [PredictSupport (DMX)](/sql/dmx/predictsupport-dmx) возвращает единственное значение, представляющее собой размер обучающего набора для всей модели.  
  
## <a name="see-also"></a>См. также  
 [Запросы интеллектуального анализа данных](data-mining-queries.md)   
 [Алгоритм логистической регрессии (Майкрософт)](microsoft-logistic-regression-algorithm.md)   
 [Технический справочник по алгоритму логистической регрессии (Майкрософт)](microsoft-logistic-regression-algorithm-technical-reference.md)   
 [Содержимое моделей интеллектуального анализа данных для моделей логистической регрессии (службы Analysis Services — интеллектуальный анализ данных)](mining-model-content-for-logistic-regression-models.md)   
 [Занятие 5. Построение моделей логистической регрессии нейронной сети и &#40;средний уровень учебник по интеллектуальному анализу данных&#41;](../../tutorials/lesson-5-build-models-intermediate-data-mining-tutorial.md)  
  
  
