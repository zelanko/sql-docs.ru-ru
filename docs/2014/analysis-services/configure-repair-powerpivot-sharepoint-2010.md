---
title: Настройка или восстановление PowerPivot для SharePoint 2010 (средство настройки PowerPivot) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: d61f49c5-efaa-4455-98f2-8c293fa50046
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 350aadcdd44dcc4424b94792286a7421e2613b2e
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "66087385"
---
# <a name="configure-or-repair-powerpivot-for-sharepoint-2010-powerpivot-configuration-tool"></a>Настройка или восстановление PowerPivot для SharePoint 2010 (средство настройки PowerPivot)
  Использование средства настройки PowerPivot для настройки или восстановления установки [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerPivot для SharePoint 2010. Работа средства настройки начинается со сканирования системы, в результате которого возвращается список действий, необходимых для завершения или восстановления установки. Мастер установки [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] установит средства настройки PowerPivot для SharePoint 2010, а также средство настройки PowerPivot для SharePoint 2013. В этом разделе описывается средство настройки PowerPivot для SharePoint 2010. Дополнительные сведения о SharePoint 2010 см. в статье [Настройка или восстановление PowerPivot для SharePoint 2013 &#40;средства настройки PowerPivot&#41;](power-pivot-sharepoint/configure-or-repair-power-pivot-for-sharepoint-2013.md).  
  
 **[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010  
  
 
  
##  <a name="bkmk_before"></a>Перед началом работы  
 Средство настройки PowerPivot для SharePoint 2010 сканирует программные файлы, параметры реестра и доступные порты. Для максимально эффективного использования средства обратите внимание на следующее.  
  
-   Общие требования для запуска средства настройки [PowerPivot Configuration Tools](power-pivot-sharepoint/power-pivot-configuration-tools.md).  
  
-   PowerPivot для SharePoint 2010 требует, чтобы веб-приложения были настроены для использования проверки подлинности в классическом режиме. Если средство настройки PowerPivot для SharePoint 2010 создает приложение автоматически, это приложение настроено для классического режима.  
  
-   Должен быть доступен порт 80, если одна из выбранных задач требует, чтобы средство настройки создавало и настраивало веб-приложение.  
  
##  <a name="bkmk_using"></a>Использование средства настройки PowerPivot  
 На первой странице средства представлена сводка вводимых значений, используемых для настройки фермы SharePoint. В дополнение к вводимым значениям, которые указывает пользователь, для настройки системы используются значения по умолчанию. Имена по умолчанию используются для приложений служб, их баз данных и свойств.  
  
> [!TIP]  
>  Если средство настройки PowerPivot просматривает компьютер и возвращает пустой список задач на левой панели, никакие функции и настройки не требуют конфигурации. Для изменения конфигурации SharePoint и PowerPivot используйте Windows PowerShell или страницы управления в центре администрирования SharePoint. Дополнительные сведения см. [в разделе Администрирование и настройка сервера PowerPivot в центре администрирования](power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration.md).  
  
 Значения для учетных записей служб могут использоваться для нескольких служб. Например, средство настройки PowerPivot использует учетную запись по умолчанию на первой странице для настройки всех удостоверений пула приложений. Эти учетные записи можно изменить позднее, отредактировав свойства приложения службы в центре администрирования.  
  
-   Исключением из этого правила в средстве настройки PowerPivot для SharePoint 2010 является учетная запись службы Analysis Services. Эта учетная запись указывается во время установки, а пароль для этой учетной записи вводится в действии **SQL Server Analysis Services (PowerPivot на локальном сервере)** . На странице сводки нет поля для этого пароля, поэтому его необходимо ввести на странице для данного действия.  
  
 Средство предоставляет интерфейс с вкладками, где находятся значения параметров, скрипты Windows PowerShell и сообщения о состоянии.  
  
 Средство настройки PowerPivot для настройки сервера использует Windows PowerShell. Можно щелкнуть вкладку **Скрипт** , чтобы проверить сценарий Windows PowerShell на.  
  
 ![Пользовательский интерфейс средства настройки](media/ssas-pctui.gif "Пользовательский интерфейс средства настройки")  
  
##  <a name="bkmk_steps"></a>Этапы настройки  
 Ссылка в средствах настройки видна только тогда, когда PowerPivot для SharePoint 2010 установлен на локальном сервере.  
  
1.  В меню **Пуск** последовательно укажите пункты **Все программы**, щелкните [!INCLUDE[ssCurrentUI](../includes/sscurrentui-md.md)], щелкните **Средства настройки**и выберите пункт **Средство настройки PowerPivot**.  
  
2.  Щелкните **Настроить или восстановить PowerPivot для SharePoint**.  
  
3.  Разверните окно в полный размер. Внизу окна должна появиться строка кнопок с командами **Проверить**, **Выполнить**и **Завершить работу** .  
  
4.  **Учетная запись по умолчанию:** На вкладке Параметры введите учетную запись пользователя домена для **имени пользователя учетной записи по умолчанию**. Она будет использоваться для провизионирования необходимых служб, в том числе пула приложений службы PowerPivot. Не указывайте встроенную учетную запись, например Network Service или Local System. Средство блокирует конфигурации, в которых указываются встроенные учетные записи.  
  
     **Парольная фраза:** введите парольную фразу. Для новой фермы SharePoint парольная фраза используется при каждом добавлении нового сервера или приложения в ферму SharePoint. Если эта ферма уже существует, введите парольную фразу, которая позволяет добавить приложение службы в ферму.  
  
5.  **Порт:** При необходимости введите номер порта для подключения к веб-приложению центра администрирования или используйте предоставленное случайным образом сгенерированное число. Прежде чем предложить номер порта, средство настройки проверит, свободен ли он.  
  
6.  Нажмите кнопку **Register SQL Server Analysis Services (PowerPivot) на локальном сервере**.  
  
     Введите пароль учетной записи служб Analysis Services.  
  
7.  При необходимости просмотрите остальные входные значения, которые использовались для завершения каждого действия. Дополнительные сведения о каждой из них см. в подразделе [Вводимые значения для настройки сервера](#bkmk_input) в этом разделе.  
  
8.  При необходимости удалите действия, которые не нужно выполнять. Например, при дальнейшей необходимости настройки службы Secure Store щелкните **Настроить службу Secure Store**и снимите флажок **Включить данное действие в список задач**.  
  
9. Нажмите кнопку **Проверить** , чтобы проверить, имеет ли средство достаточно данных для выполнения действий в списке.  
  
    > [!NOTE]  
    >  Появление ошибок конфигурации фермы может свидетельствовать о том, что в системе не установлен пакет обновления 1 (SP1) для SharePoint 2010 Server.  
  
10. Нажмите кнопку **Выполнить** для выполнения всех действий из списка задач. Кнопка **Выполнить** включена после проверки действий. Если кнопка **Выполнить** недоступна, сначала нажмите кнопку **Проверить** .  
  
11. [Проверка установки PowerPivot для SharePoint](instances/install-windows/verify-a-power-pivot-for-sharepoint-installation.md).  
  
##  <a name="bkmk_input"></a>Входные значения, используемые для настройки сервера  
 Средство настройки PowerPivot использует сочетание вводимых значений, задаваемых пользователем, и значений по умолчанию, которые оно обнаруживает или использует автоматически.  
  
 Список действий, перечисленных в средстве настройки, зависит от текущей конфигурации фермы SharePoint. Например, если ферма SharePoint уже настроена, то никакие действия не будут перечислены в программе. Это средство можно запускать в любое время для настройки, восстановления или обнаружения ошибок конфигурации. Если в ферме не запущены необходимые службы, например службы Excel или Secure Store, средство определит отсутствующие службы и предложит варианты по их запуску. Если не требуются никакие действия, список задач будет пустым.  
  
 В следующей таблице перечислены значения, которые используются для настройки сервера.  
  
|Страница|Вводимое значение|Источник|Description|  
|----------|-----------------|------------|-----------------|  
|**Настройка или восстановление PowerPivot для SharePoint**|Учетная запись по умолчанию|Текущий пользователь|Учетной записью по умолчанию является учетная запись пользователя домена Windows, которая используется для провизионирования общих служб в ферме. Она используется для провизионирования приложения службы PowerPivot, службы Secure Store, служб Excel, удостоверения пула веб-приложений, администратора семейства сайтов и учетной записи автоматического обновления данных PowerPivot.<br /><br /> По умолчанию средство входит в учетную запись домена текущего пользователя. При настройке сервера в целях, отличных от оценки, необходимо заменить ее другой учетной записью пользователя домена.<br /><br /> Позже можно также изменить удостоверения службы в центре администрирования.<br /><br /> При необходимости в средстве настройки PowerPivot можно указать выделенные учетные записи для следующего:<br /><br /> Веб-приложение с помощью страницы **Создание веб-приложения по умолчанию** (предполагается, что средство создает веб-приложение для фермы).<br /><br /> Учетная запись автоматического обновления данных PowerPivot с использованием страницы **Создание автоматической учетной записи для обновления данных** в этом средстве.|  
||Сервер базы данных|Локальный именованный экземпляр PowerPivot (если таковой имеется)|Если экземпляр ядра СУБД установлен в виде именованного экземпляра PowerPivot, средство заполнит поле сервера базы данных именем данного экземпляра. Если ядро СУБД не установлено, это поле будет пустым. Потребуется указать экземпляр. Это может быть любая версия или выпуск SQL Server, которые поддерживаются для ферм SharePoint.|  
||Парольная фраза|Вводимые пользователем данные|При создании новой фермы указанная парольная фраза будет парольной фразой для фермы. При добавлении PowerPivot для SharePoint в существующую ферму необходимо указать парольную фразу, определенную для фермы при ее создании.|  
||Порт центра администрирования SharePoint|По умолчанию (при необходимости)|Если ферма не настроена, средство предложит варианты по ее созданию, включая конечную точку HTTP для центра администрирования. Для этого по умолчанию выбирается случайно созданный незадействованный номер порта.|  
|**Настройка новой фермы**|Сервер базы данных<br /><br /> Учетная запись фермы<br /><br /> Парольная фраза<br /><br /> Порт центра администрирования SharePoint|По умолчанию (при необходимости)|Настройки по умолчанию для данных, введенных на главной странице.|  
|**Настройка экземпляра локальных служб**|Пароль учетной записи служб Analysis Services|Вводимые пользователем данные|Необходимо ввести пароль учетной записи службы Analysis Services на странице **Register SQL Server Analysis Services (PowerPivot) на локальном сервере** .<br /><br /> Учетная запись служб была указана во время установки. Теперь необходимо ввести пароль для регистрации локального экземпляра службы в SharePoint.|  
|**Создание приложения службы PowerPivot**|Имя приложения службы PowerPivot|По умолчанию|Имя по умолчанию — «Приложение службы PowerPivot по умолчанию». В средстве можно указать другое значение.|  
||Сервер базы данных приложения службы PowerPivot|По умолчанию|Сервер базы данных, на котором создается база данных приложения службы PowerPivot. Имя сервера по умолчанию то же, что у сервера базы данных, используемого для фермы. В средстве можно указать другое значение.|  
||Имя базы данных приложения службы PowerPivot|По умолчанию|Имя базы данных по умолчанию формируется исходя из имени приложения службы, за которым следует идентификатор GUID, обеспечивающий его уникальность. В средстве можно указать другое значение.|  
||Обновить книги, чтобы получить возможность обновления данных|Вводимые пользователем данные|Обновление данных завершается ошибкой и не поддерживается для книг SQL Server 2008 R2 PowerPivot. Параметр **обновить книги для включения обновления данных** обновляет книги до SQL Server 2012 версии PowerPivot.|  
|**Создание веб-приложения по умолчанию**|Имя веб-приложения|По умолчанию (при необходимости)|Если веб-приложений не существует, то средство создаст одно веб-приложение. Веб-приложение будет настроено для проверки подлинности в классическом режиме и для прослушивания **порта 80**. Максимальный размер файла для передачи устанавливается равным 2047 МБ, что является максимально допустимым значением в SharePoint. Больший размер файла для передачи необходим для совместимости с большими файлами PowerPivot.|  
||URL-адрес|По умолчанию (при необходимости)|Средство создает URL-адрес на основании имени сервера с использованием соглашений об именах файлов, принятых в SharePoint.|  
||Пул веб-приложений|По умолчанию (при необходимости)|Средство создает пул приложений по умолчанию в службах IIS.|  
||Учетная запись и пароль пула веб-приложений|По умолчанию (при необходимости)|Учетная запись пула приложений основана на учетной записи по умолчанию, однако ее можно изменить в средстве.|  
||Сервер базы данных веб-приложения|По умолчанию (при необходимости)|Для хранения базы данных приложения автоматически выбирается экземпляр базы данных по умолчанию, однако в средстве можно выбрать другой экземпляр SQL Server.|  
||Имя базы данных веб-приложения|По умолчанию (при необходимости)|Имя базы данных соответствует соглашениям об именах файлов, принятым в SharePoint, однако можно выбрать другое имя.|  
|**Развертывание решения веб-приложения**|URL-адрес|По умолчанию (при необходимости)|URL-адрес по умолчанию берется из веб-приложения по умолчанию.|  
||Максимальный размер файла (МБ)|По умолчанию (при необходимости)|Значение по умолчанию — 2047. Библиотеки документов SharePoint также имеют максимальный размер, и параметр PowerPivot не должен превышать параметр библиотеки документов. Дополнительные сведения см. в статье [Настройка максимального размера файла для отправки &#40;PowerPivot для SharePoint&#41;](power-pivot-sharepoint/configure-maximum-file-upload-size-power-pivot-for-sharepoint.md).|  
|**Создание семейства веб-сайтов**|Администратор сайта|По умолчанию (при необходимости)|Средство использует учетную запись по умолчанию. Изменить ее можно на странице **Создание семейства веб-сайтов** .|  
||Адрес электронной почты для связи|По умолчанию (при необходимости)|Если на сервере настроена система Microsoft Outlook, средство будет использовать адрес электронной почты текущего пользователя. В противном случае будет использоваться заполнитель.|  
||URL-адрес сайта|По умолчанию (при необходимости)|Средство создает URL-адрес сайта с использованием такого же контекста именования URL-адресов, как в SharePoint.|  
||Заголовок сайта|По умолчанию (при необходимости)|В качестве заголовка по умолчанию средство использует **Сайт PowerPivot** .|  
|**Активация компонента PowerPivot в семействе веб-сайтов**|URL-адрес сайта||URL-адрес семейства веб-сайтов, для которого активируются функции PowerPivot.|  
||Включение расширенной функции для этого сайта||Включите функцию сайта SharePoint "PremiumSite".|  
|**Создание приложения службы Secure Store**|Имя приложения службы||Введите имя приложения службы Secure Store.|  
||Сервер базы данных||Введите имя сервера базы данных для приложения службы Secure Store.|  
|**Создание прокси-агента приложения службы Secure Store**|Имя приложения службы||Введите имя приложения службы Secure Store.|  
||Прокси-сервер приложения службы||Введите имя прокси-сервера приложения службы Secure Store.  Это имя появится в группе соединений (по умолчанию), которая связывает приложения с веб-приложениями содержимого SharePoint.|  
|**Обновление главного ключа службы Secure Store**|Прокси-сервер приложения службы||Введите имя прокси-сервера приложения службы Secure Store|  
||Парольная фраза||Для шифрования данных используется главный ключ. По умолчанию для формирования ключа используется та же парольная фраза, с помощью которой выполняется подготовка новых серверов в ферме. Парольную фразу по умолчанию можно заменить на уникальную парольную фразу.|  
|**Создание учетной записи автоматической установки для обновления**|Идентификатор целевого приложения||Идентификатор приложения может быть описательным текстом.|  
||Понятное имя для целевого приложения|||  
||Автоматические имя пользователя и пароль учетной записи||Введите данные учетной записи пользователя Windows, которые используются целевым приложением и для автоматического обновления данных.|  
||URL-адрес сайта||Введите URL-адрес сайта семейства сайтов, сопоставленного с целевым приложением. Для сопоставления с дополнительными семействами веб-сайтов воспользуйтесь центром администрирования SharePoint.|  
|**Создать приложение службы для служб Excel**|Имя приложения службы||Введите имя приложения службы. На сервере базы данных фермы SharePoint будет создана база данных приложения службы с тем же именем.|  
|**Добавить MSOLAP.5 в качестве доверенного поставщика**|Имя приложения службы||Службы Excel в SharePoint 2010 используют поставщик OLE DB [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] для подключения к данным [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]. На этом шаге версия поставщика OLE DB, установленного вместе с PowerPivot для SharePoint, добавляется в службы Excel в качестве доверенного поставщика.|  
||Имя сервера PowerPivot|||  
|||||  
  
 Если средство настройки PowerPivot создает ферму, то оно при этом создает необходимые базы данных на сервере баз данных с использованием контекста именования файлов, принятых в SharePoint. Изменить имя базы данных фермы нельзя.  
  
 Если средство создает семейство веб-сайтов, то создает базу данных содержимого на сервере баз данных с использованием соглашений об именах файлов, принятых в SharePoint. Изменить имя базы данных содержимого нельзя.  
  
##  <a name="bkmk_nextsteps"></a>Дальнейшие действия  
 Существует несколько дополнительных задач, которые необходимо выполнить после завершения установки сервера.  
  
-   Предоставление разрешений SharePoint пользователям и группам. Эта задача необходима для обеспечения доступа к сайтам и их содержимому.  
  
-   Изменение удостоверений пула приложений службы для запуска из другой учетной записи. Указание другого удостоверения для служб и приложений рекомендуется для повышения безопасности развертывания SharePoint.  
  
-   Создайте дополнительные надежные сайты в службах Excel, чтобы можно было устанавливать разрешения и параметры конфигурации, которые наиболее подходят для доступа к данным PowerPivot.  
  
-   Для обеспечения возможности экспорта списков SharePoint в виде веб-каналов данных необходимо установить службу ADO.NET Data Services 3.5 с пакетом обновления 1 (SP1).  
  
-   Для поддержки обновления данных на сервере установите широко применяемые поставщики данных.  
  
-   Загрузите средство разработки PowerPivot на рабочую станцию, чтобы создать книгу PowerPivot, и опубликуйте ее в SharePoint. Установка средства разработки и публикация книги PowerPivot завершает цикл установки, позволяя проверить правильность взаимодействия только что установленных серверных компонентов.  
  
### <a name="grant-sharepoint-permissions-to-workbook-users"></a>Предоставление разрешений SharePoint пользователям книги  
 Для публикации и просмотра книг пользователям требуются разрешения SharePoint. Не забудьте предоставить разрешения на **Просмотр** пользователям, которые должны просматривать опубликованные книги, и разрешения на **участие** для пользователей, которые публикуют книги или управляют ими. Для предоставления разрешений необходимо быть администратором семейства веб-сайтов.  
  
1.  На сайте щелкните **действия сайта**.  
  
2.  Щелкните **разрешения сайта**.  
  
3.  Создавайте группы по мере необходимости, если требуется набор пользователей с разрешениями **Участие** , и отдельную группу для набора пользователей только с разрешениями **Просмотр** .  
  
4.  Введите учетные записи пользователей или групп домена Windows, которые будут иметь членство в группах. Как и ранее, адреса электронной почты или группы распределения следует использовать только в том случае, если приложение настроено для классической проверки подлинности.  
  
### <a name="install-adonet-data-services-35-sp1"></a>Установка службы ADO.NET Data Services 3.5 с пакетом обновления 1 (SP1)  
 Для обеспечения возможности экспорта списков SharePoint в виде веб-каналов данных требуется служба ADO.NET Data Services. Этот компонент не входит в программу SharePoint 2010 PrerequisiteInstaller, поэтому его необходимо устанавливать вручную.  
  
1.  Перейдите к документации по требованиям к оборудованию и программному обеспечению для SharePoint 2010, [Определите требования к оборудованию и программному обеспечению (SharePoint 2010)](https://go.microsoft.com/fwlink/?LinkId=169734)  
  
2.  Найдите в разделе Установить необходимые программы ссылку на ADO.NET Data Services 3.5, соответствующую используемой операционной системе.  
  
3.  Щелкните ссылку и запустите программу установки службы.  
  
### <a name="install-data-providers-used-in-data-refresh-and-check-user-permissions"></a>Установка поставщиков данных, используемых для обновления данных, и проверка разрешений пользователя  
 Обновление данных на сервере позволяет пользователям импортировать обновленные данные в свои книги в автоматическом режиме. Для успешного обновления данных на сервере должен иметься тот же поставщик данных, который первоначально использовался для импорта данных. Кроме того, учетная запись пользователя, под которой выполняется обновление данных, часто должна иметь разрешение на чтение из внешних источников данных. Чтобы гарантировать успешное завершение операции, необходимо проверить требования для включения и настройки обновления данных. Дополнительные сведения см. [в разделе PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).  
  
### <a name="change-application-pool-and-service-identities-in-sharepoint"></a>Изменение пула приложений или идентификаторов служб в SharePoint  
 Программа настройки PowerPivot настраивает компоненты фермы, приложения и службы для работы от одной учетной записи. Это упрощает установку, однако система при этом не будет удовлетворять требованиям безопасности фермы SharePoint. Чтобы добиться более высокого уровня надежности системы, после завершения установки измените удостоверения пулов приложений и служб таким образом, чтобы они работали под разными учетными записями. Дополнительные сведения см. в разделе [Настройка учетных записей служб PowerPivot](power-pivot-sharepoint/configure-power-pivot-service-accounts.md).  
  
### <a name="create-additional-trusted-sites-in-excel-services"></a>Создание дополнительных надежных сайтов в службах Excel  
 Можно добавить надежные сайты в службы Excel, чтобы изменять разрешения и параметры конфигурации для сайтов, предоставляющих книги Excel и данные PowerPivot. Дополнительные сведения см. в разделе [Create a trusted location for PowerPivot sites in Central Administration](power-pivot-sharepoint/create-a-trusted-location-for-power-pivot-sites-in-central-administration.md).  
  
### <a name="add-servers-or-applications"></a>Добавление серверов или приложений  
 В дальнейшем, если потребуются дополнительные возможности по хранению и обработке данных, в ферму можно будет добавить второй экземпляр сервера PowerPivot для SharePoint. Инструкции см. в разделе [Контрольный список развертывания: развертывание путем добавления серверов PowerPivot в ферму SharePoint 2010](../../2014/sql-server/install/deployment-checklist-scale-out-adding-powerpivot-servers-sharepoint-2010-farm.md).  
  
## <a name="additional-resources"></a>Дополнительные ресурсы  
 ![Параметры SharePoint](media/as-sharepoint2013-settings-gear.gif "Параметры SharePoint") [отправляют отзывы и контактные данные через Microsoft SQL Server Connect](https://connect.microsoft.com/SQLServer/Feedback) (https://connect.microsoft.com/SQLServer/Feedback).  
  
## <a name="see-also"></a>См. также:  
 [Средства настройки PowerPivot](power-pivot-sharepoint/power-pivot-configuration-tools.md)   
 [Настройка и администрирование сервера PowerPivot в центре администрирования](power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration.md)  
  
  
