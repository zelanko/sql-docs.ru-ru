---
title: Сбор данных об использовании PowerPivot | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- analysis-services
ms.topic: conceptual
ms.assetid: 9057cb89-fb17-466e-a1ce-192c8ca20692
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: f9acdc193b608d42b21c69c380fb21db23ec3b89
ms.sourcegitcommit: 3da2edf82763852cff6772a1a282ace3034b4936
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2018
ms.locfileid: "48187484"
---
# <a name="powerpivot-usage-data-collection"></a>Сбор данных об использовании PowerPivot
  Сбор данных об использовании — это функция SharePoint на уровне фермы. PowerPivot для SharePoint использует и дополняет эту систему для создания встроенных отчетов на панели мониторинга PowerPivot, которые показывают, как используются данные и службы PowerPivot. В зависимости от способа установки SharePoint сбор данных об использовании для фермы может быть отключен. Администратор фермы должен включить ведение журнала использования для создания данных об использовании, которые будут отображаться на панели мониторинга PowerPivot. Дополнительные сведения о том, как включить и настроить сбор данных об использовании для PowerPivot событий см. в разделе [Настройка сбора данных об использовании &#40;PowerPivot для SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).  
  
 Сведения о данных об использовании на панели управления PowerPivot см. в разделе [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).  
  
 **В этом разделе:**  
  
 [Сбор данных об использовании и архитектура подготовки отчетов](#usagearch)  
  
 [Источники данных об использовании](#sources)  
  
 [Задания таймера и служб](#servicesjobs)  
  
 [Составление отчетов о данных об использовании](#reporting)  
  
##  <a name="usagearch"></a> Сбор данных об использовании и архитектура подготовки отчетов  
 Данные об использовании собираются, хранятся и обрабатываются при помощи набора сочетания инфраструктуры SharePoint и компонентов сервера PowerPivot. Инфраструктура SharePoint предоставляет централизованную службу использования и встроенные задания таймера. PowerPivot для SharePoint добавляет долгосрочное хранение данных об использовании PowerPivot и отчеты по операциям, которые можно просмотреть в центре администрирования SharePoint.  
  
 Данные о событиях передаются в систему сбора данных об использовании на сервере приложений или клиентском веб-интерфейсе. Данные об использовании заданием таймера из временных файлов данных на физическом сервере в постоянное хранилище на сервере базы данных. На следующей диаграмме представлены компоненты и процессы, которые перемещают данные об использовании по системе сбора данных и отчетности.  
  
 **Важно:** убедитесь, что сбор данных об использовании включен. Для этого перейдите в раздел **Наблюдение** в центре администрирования SharePoint. Дополнительные сведения см. в разделе [Настройка сбора данных об использовании &#40;PowerPivot для SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).  
  
 ![Компоненты и процессы сбора данных об использовании. ](../media/gmni-usagedata.gif "Компоненты и процессы сбора данных об использовании.")  
  
|Стадия|Описание|  
|-----------|-----------------|  
|1|Сбор данных об использовании запускается событиями, которые создаются компонентами PowerPivot и поставщиками данных [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в развертывании SharePoint. Настраиваемые события, которые могут быть включены или отключены ― это события соединения, загрузки, выгрузки и времени ответа, которые отслеживаются службой PowerPivot на сервере приложений. Остальные события управляются исключительно сервером и не могут быть отключены. Такие события включают обновление данных и события исправности сервера.<br /><br /> Изначально данные об использовании собираются и сохраняются в локальных файлах журнала средствами сбора данных системы SharePoint. Эти файлы и их расположение являются частью стандартной системы сбора данных об использовании в SharePoint. Файлы находятся в одном и том же расположении на каждом из серверов фермы. Чтобы просмотреть или изменить расположение каталога ведения журнала, откройте страницу **Наблюдение** в центре администрирования SharePoint и нажмите кнопку **Настройка сбора данных об использовании и исправности**.|  
|2|В соответствии с заданной периодичностью (по умолчанию каждый час) задание таймера «Импорт данных об использовании Microsoft SharePoint Foundation» перемещает данные об использовании из локальных файлов в базу данных приложений службы PowerPivot. Если на ферме имеется несколько приложений службы PowerPivot, то у каждой будет своя база данных. События включают внутренние сведения, которые определяют, какое приложение службы PowerPivot создает событие. Идентификаторы приложений обеспечивают привязку данных об использовании к создавшему их приложению.|  
|3|Данные копируются во внутреннюю базу данных отчетов, которая доступна на панели мониторинга управления PowerPivot в центре администрирования.|  
|4|Источник данных ― это книга PowerPivot, к которой можно обращаться для создания пользовательских отчетов в Excel. Существует только один экземпляр исходной книги. Все локализованные отчеты создаются на основе одной и той же исходной книги.|  
|5|Данные об использовании представлены в отчетах приложений службы PowerPivot для администраторов приложения службы, которые управляют производительностью и доступностью сервера. Для поддерживаемых SharePoint языков создаются локализованные экземпляры книг.<br /><br /> Дополнительные сведения см. в подразделе [Составление отчетов о данных об использовании](#reporting) в данном разделе.|  
  
##  <a name="sources"></a> Источники данных об использовании  
 Если сбор данных об использовании включен, то данные формируются для следующих событий сервера.  
  
|Событие|Описание|Настраиваемый|  
|-----------|-----------------|------------------|  
|Соединения|Соединения с сервером выполняются от имени пользователя, который запрашивает данные PowerPivot в книге Excel. События соединения идентифицируют пользователя, который открыл соединение с книгой PowerPivot. В отчетах эти данные служат для выявления наиболее активных пользователей, источников данных, к которым обращаются эти пользователи, и трендов соединений по времени.|Можно включать и отключать [Настройка сбора данных об использовании &#40;PowerPivot для SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|Время ответа на запрос|Статистика ответов на запросы, которая классифицирует запросы исходя из продолжительности их выполнения. Статистика ответов на запросы показывает закономерности длительности обработки запросов сервером.|Можно включать и отключать [Настройка сбора данных об использовании &#40;PowerPivot для SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|Загрузка данных|Операции загрузки данных [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)]. События загрузки данных помогают определить, какие источники данных чаще всего используются.|Можно включать и отключать [Настройка сбора данных об использовании &#40;PowerPivot для SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|Выгрузка данных|Операции выгрузки данных приложениями службы PowerPivot. [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] выгружает неактивные источники данных PowerPivot, если они не используются, на сервере возникла нехватка памяти или для выполнения заданий обновления данных необходима дополнительная память.|Можно включать и отключать [Настройка сбора данных об использовании &#40;PowerPivot для SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|Исправность сервера|Операции сервера, которые показывают исправность сервера, измеряемое в степени загруженности ЦП и памяти. Данные являются журнальными. Они не обеспечивают возможность просмотра текущей нагрузки на сервер в режиме реального времени.|Нет. Данные об использовании всегда собираются для этого события.|  
|Обновление данных|Операции обновления данных, инициированные службой PowerPivot для обновления данных по расписанию. Журнал использования для обновления данных собирается на уровне приложения для построения отчетов по операциям и отражается на странице «Управление обновлением данных» в каждой из книг.<br /><br /> **Примечание:** для развертываний SharePoint 2013 и [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] обновлением данных управляют службы Excel, а не сервер служб Analysis Services.|Нет. Данные об использовании обновления данных собираются всегда, если включить обновление данных для приложения службы PowerPivot.|  
  
##  <a name="servicesjobs"></a> Задания таймера и служб  
 В следующей таблице описаны службы и хранилища сбора данных в системе сбора данных об использовании. Сведения о том, как переопределить расписание заданий таймера для принудительного обновления данных работоспособности и использования сервера в панели мониторинга управления PowerPivot см. в разделе [обновление данных PowerPivot с SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md). Задания таймера можно посмотреть в центре администрирования SharePoint. Перейдите на страницу **Наблюдение**и нажмите кнопку **Проверка состояния заданий**. Нажмите кнопку **Просмотр определений заданий**.  
  
|Компонент|Расписание по умолчанию|Описание|  
|---------------|----------------------|-----------------|  
|Служба таймера SharePoint (SPTimerV4)||Данная служба Windows работает локально на каждом клиентском компьютере на ферме и обрабатывает все задания таймера, которые определяются на уровне фермы.|  
|Импорт данных об использовании Microsoft SharePoint Foundation|Каждые 30 минут в SharePoint 2010. Каждые 5 минут в SharePoint 2013.|Это задание таймера настраивается глобально на уровне фермы. Задание перемещает данные об использовании из локальных файлов журнала в централизованную базу данных сбора данных об использовании. Можно запустить это задание таймера вручную, чтобы принудительно выполнить операцию импорта данных.|  
|Задание таймера обработки данных об использовании Microsoft SharePoint Foundation|(Ежедневно в 3:00 ночи).|**(\*)** Начиная с SQL Server 2012 PowerPivot для SharePoint, это задание таймера поддерживается для сценариев обновления или миграции, где могут находиться устаревшие данные об использовании по-прежнему в базах данных об использовании SharePoint. Начиная с SQL Server 2012 PowerPivot для SharePoint, базы данных использования SharePoint не применяются в рабочем процессе сбора данных об использовании PowerPivot и панели мониторинга управления. Чтобы переместить все остальные связанные данные PowerPivot из базе данных использования SharePoint в базы данных приложения службы PowerPivot, задание времени можно запустить вручную.<br /><br /> Это задание таймера настраивается глобально на уровне фермы. Задание проверяет данные об использовании с истекшим сроком в центральной базе данных сбора данных об использовании (то есть все записи старше 30 дней). Для серверов PowerPivot в ферме это задание таймера выполняет дополнительную проверку для данных об использовании PowerPivot. Если данные об использовании PowerPivot обнаружены, то задание перемещает данные в базу данных приложения службы, находя необходимую базу данных по идентификатору приложения.<br /><br /> Это задание можно запустить вручную, чтобы принудительно выполнить проверку данных с истекшим сроком действия или импорт данных в базу данных приложения службы PowerPivot.|  
|Задание таймера «Обработка панели мониторинга управления PowerPivot»|(Ежедневно в 3:00 ночи).|Это задание таймера обновляет внутреннюю книгу PowerPivot, которая предоставляет административные данные на панель мониторинга PowerPivot. Оно возвращает обновленные данные, управляемые SharePoint, в том числе имена серверов, имена пользователей, имена приложений и имена файлов, которые отображаются в отчетах панели мониторинга или в веб-частях.|  
  
##  <a name="reporting"></a> Составление отчетов о данных об использовании  
 Просмотреть данные об использовании данных PowerPivot можно во встроенных отчетах панели мониторинга PowerPivot. Встроенные отчеты объединяют данные об использовании, которые извлекаются из структур данных отчетов в базе данных приложения службы. Поскольку базовые данные отчетов обновляются ежедневно, встроенные отчеты об использовании показывают обновленные сведения только после того, как задание таймера обработки данных об использовании Microsoft SharePoint Foundation скопирует данные в базу данных приложений службы PowerPivot. По умолчанию это производится раз в день.  
  
 Дополнительные сведения о просмотре отчетов, см. в разделе [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).  
  
## <a name="see-also"></a>См. также  
 [Панель мониторинга управления PowerPivot и данные об использовании](power-pivot-management-dashboard-and-usage-data.md)   
 [Справочник по параметрам конфигурации &#40;PowerPivot для SharePoint&#41;](configuration-setting-reference-power-pivot-for-sharepoint.md)   
 [Настройка сбора данных об использовании &#40;PowerPivot для SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md)  
  
  
