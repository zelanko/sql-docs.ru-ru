---
title: Создание и настройка приложения службы PowerPivot в центре администрирования | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b2e5693e-4af3-453f-83f3-07481ab1ac6a
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5a48211455a8ac3de9ef0f4b0c7e2fb3cba5f473
ms.sourcegitcommit: f0772f614482e0b3cde3609e178689ce62ca3a19
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84540507"
---
# <a name="create-and-configure-a-powerpivot-service-application-in-central-administration"></a>Создание и настройка приложения службы PowerPivot в центре администрирования
  Приложение службы PowerPivot — это экземпляр общей службы PowerPivot. Каждое приложение службы имеет свое удостоверение, параметры настройки, свойства и внутреннее хранилище данных.  
  
 В этом разделе содержатся следующие подразделы.  
  
 [Определение необходимости создания нового приложения службы PowerPivot](#determine)  
  
 [Создание приложения службы PowerPivot](#CreateApp)  
  
 [Настройка приложения службы PowerPivot](#ConfigApp)  
  
 [Назначение приложения службы PowerPivot веб-приложению](#AssignGSA)  
  
 [Изменение свойств приложения службы](#EditGSA)  
  
##  <a name="determine-whether-to-create-a-new-powerpivot-service-application"></a><a name="determine"></a>Определение необходимости создания нового приложения службы PowerPivot  
 Для установки PowerPivot для SharePoint на ферме должно быть как минимум одно приложение службы PowerPivot. Приложение службы создается автоматически, если при настройке сервера использовалось средство настройки PowerPivot. Иначе необходимо создать приложение службы PowerPivot вручную в центре администрирования.  
  
 Создание приложения службы открывает доступ к службе и формирует базу данных приложения службы. В зависимости от параметров, выбранных при создании приложения службы, соединение со службой PowerPivot добавляется в группу соединений служб по умолчанию. Все веб-приложения SharePoint, которые подписаны на группу соединений служб по умолчанию, автоматически получают немедленный доступ к приложению службы PowerPivot.  
  
 Может быть создано несколько приложений службы PowerPivot. Хотя одного приложения службы достаточно для большинства сценариев развертывания, может оказаться целесообразным создание дополнительного приложения службы PowerPivot при наличии следующих бизнес-требований.  
  
-   Использование разных учетных записей автоматического обновления данных PowerPivot для каждого из приложений.  
  
-   Использование разных значений времени ожидания, журналов использования и пороговых значений для отчетов об ответах на запросы.  
  
-   Делегирование прав администрирования службы другому пользователю. Администратор получает доступ к журналу обновления данных, журналу использования и другим свойствам только того приложения, которое администрирует. Если необходимо изолировать данные для разных веб-приложений SharePoint (например, для компаний, которые предлагают услуги размещения с гарантией изоляции данных для веб-приложений SharePoint разных клиентов), то для удовлетворения требований по изоляции можно создать отдельные приложения службы PowerPivot и предоставить каждому администратору в отдельности доступ только к параметрам конфигурации и свойствам того приложения, которым он управляет.  
  
 При создании дополнительных приложений службы возникают новые требования по ассоциациям управления службами. А именно, потребуется создание и использование пользовательского списка ассоциаций служб для каждого дополнительного приложения службы.  
  
 Если никаких особых причин для создания нового приложения службы PowerPivot нет, то лучше пользоваться одним приложением службы для всех веб-приложений фермы.  
  
##  <a name="create-a-powerpivot-service-application"></a><a name="CreateApp"></a>Создание приложения службы PowerPivot  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  В ленте **Приложение службы** нажмите кнопку **Создать**.  
  
3.  Выберите **SQL Server приложение службы PowerPivot**. Если этого пункта нет в списке, это означает, что PowerPivot для SharePoint не установлен или установлен неправильно.  
  
4.  На странице **Создание нового приложения службы PowerPivot** введите имя приложения. Значение по умолчанию — PowerPivotServiceApplication \<number> . При создании нескольких приложений службы PowerPivot описательное имя поможет другим администраторам понять, как используется это приложение.  
  
5.  В разделе «Пул приложений» создайте для данного приложения новый пул (рекомендуется). Выберите или создайте управляемую учетную запись для пула приложений. Обязательно укажите учетную запись домена. Учетная запись пользователя домена позволяет использовать функцию управляемой учетной записи SharePoint, с помощью которой пароли и данные учетной записи можно изменять в одном месте. Учетные записи домена также требуются, если планируется расширение развернутой системы и включение дополнительных экземпляров службы, которые будут работать под одним идентификатором.  
  
6.  В поле **Сервер базы данных**значением по умолчанию является экземпляр компонента SQL Server Database Engine, на котором размещены базы данных конфигурации фермы. Можно использовать этот сервер либо выбрать другой SQL Server.  
  
7.  В поле **имя базы данных**значение по умолчанию — PowerPivotServiceApplication1_ \<guid> . Необходимо создать уникальную базу данных для каждого приложения службы PowerPivot. Имя базы данных по умолчанию соответствует используемому по умолчанию имени приложения службы. Если было введено уникальное имя приложения службы, следуйте аналогичным соглашениях об именах при выборе имени базы данных, чтобы ими можно было управлять совместно.  
  
8.  В списке **Проверка подлинности базы данных**по умолчанию выбрано значение «Проверка подлинности Windows». Если выбран параметр **Проверка подлинности SQL**, то рекомендации по использованию этого типа проверки подлинности в развернутой системе SharePoint см. в руководстве администратора SharePoint.  
  
9. При необходимости установите флажок **Добавить прокси-сервер для этого приложения службы PowerPivot в группу прокси-серверов по умолчанию для фермы.** . При этом соединение с приложением службы будет добавлено в список группы соединений служб по умолчанию.  
  
     Этот флажок должен быть выбран при создании первого приложения службы PowerPivot. Наличие приложения службы PowerPivot в группе соединений по умолчанию необходимо для правильной работы панели управления PowerPivot.  
  
     Если группа соединений по умолчанию уже существует, то добавление в нее вновь создаваемых приложений службы PowerPivot не требуется. Добавление нескольких записей приложений службы одного типа не поддерживается, это может привести к возникновению ошибок. При создании дополнительных приложений службы не вносите их в группу соединений по умолчанию, вместо этого добавьте в пользовательские списки.  
  
     Дополнительные сведения о взаимосвязи служб см. [в разделе Подключение приложения службы PowerPivot к веб-приложению SharePoint в центре администрирования](connect-power-pivot-service-app-to-sharepoint-web-app-in-ca.md).  
  
10. Нажмите кнопку **ОК**. Эта служба появится в списке приложений служб фермы рядом с другими управляемыми службами.  
  
##  <a name="configure-powerpivot-service-application"></a><a name="ConfigApp"></a>Настройка приложения службы PowerPivot  
 Приложение службы PowerPivot создается с использованием конфигурации по умолчанию. В большинстве случаев рекомендуется использовать параметры по умолчанию. Изменять их следует только в том случае, если соединения обрываются или время ответа слишком велико, либо если для разных веб-приложений SharePoint используются различные параметры службы PowerPivot.  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
     В списке приложений служб должно отображаться только что созданное приложение службы. Приложение по умолчанию — **PowerPivotServiceApplication1**.  
  
2.  Щелкните приложение службы PowerPivot. Откроется панель управления PowerPivot.  
  
3.  В списке **Действия** (в правом верхнем углу панели мониторинга) выберите **Настройка параметров приложения службы**.  
  
4.  В поле **время ожидания загрузки базы данных**увеличьте или уменьшите значение, чтобы изменить время ожидания службой PowerPivot ответа от экземпляра SQL Server Analysis Services (PowerPivot), которому перенаправляется запрос на загрузку данных. Поскольку очень большие наборы данных требуют большого времени для передачи по каналу, должно быть установлено время, достаточное для того, чтобы экземпляр службы Powerpivot извлек книгу Excel и передал данные PowerPivot экземпляру службы Analysis Services для обработки запроса. Поскольку PowerPivot работает с особенно большими наборами данных, значение по умолчанию равно 30 минутам.  
  
5.  Измените значение в поле **Время ожидания соединения**, указав время, в течение которого неактивное подключение к данным будет оставаться открытым. Значение по умолчанию — 30 минут. В течение этого времени служба PowerPivot будет использовать неактивное подключение к данным только для запросов на чтение от одного и того же пользователя SharePoint к одним и тем же данным PowerPivot. При отсутствии других запросов к данным за указанный период соединение удаляется из пула. Допустимые значения: от 1 до 3600 секунд. Дополнительные сведения о пулах соединений см. в разделе [Справочник по параметрам конфигурации &#40;PowerPivot для SharePoint&#41;](configuration-setting-reference-power-pivot-for-sharepoint.md).  
  
6.  В поле **максимальный размер пула пользовательских соединений**увеличьте или уменьшите значение, чтобы изменить максимальное число неактивных соединений, создаваемых службой PowerPivot в отдельных пулах соединений для каждого сочетания пользователя SharePoint, набора данных PowerPivot и версии.  
  
     Значением по умолчанию является 1000 неактивных соединений. Допустимыми значениями являются -1 (не ограничено), 0 (отключает использование пулов соединений пользователя) или от 1 до 10000.  
  
     Эти пулы соединений позволяют службе более эффективно поддерживать текущие соединения к одним и тем же данным только для чтения для одного и того же пользователя. Если использование пулов соединений отключено, то каждое соединение будет создаваться заново.  
  
     Имейте в виду, что изменение ограничения на размер пула соединений, в том числе установка значения 0, не влияет на потерянные соединения. Пулы соединений используются для сокращения времени ожидания при подключении к данным. Служба PowerPivot никогда не запрещает создание соединений из-за параметров пула соединений.  
  
7.  В поле **максимальный размер пула административных соединений**увеличьте или уменьшите значение, чтобы изменить число открытых соединений в пуле соединений, созданном для подключения службы PowerPivot к Analysis Services. Каждый экземпляр службы PowerPivot открывает отдельное административное соединение с экземпляром Analysis Services, находящимся на том же компьютере. Служба PowerPivot создает отдельный пул для повторного использования административных соединений с целью проверки неактивных соединений и наблюдения за исправностью сервера. Значением по умолчанию является 200 соединений. Допустимыми значениями являются -1 (неограниченно), 0 (отключение использования пулов административных соединений) или от 1 до 10000. Если выбрано значение 0, то каждое соединение будет создаваться заново.  
  
8.  В **методе распределения**можно указать схему балансировки нагрузки, которую системная служба PowerPivot использует для выбора конкретного приложения службы PowerPivot для балансировки нагрузки исходного запроса. По умолчанию применяется режим **По исправности**, при котором запросы распределяются исходя из состояния сервера, определяемого с учетом объема доступной памяти и загрузки ЦП. Также при необходимости можно выбрать режим **Циклический перебор** , предусматривающий распределение запросов по службам в цикле в одном и том же порядке, независимо от того, занят сервер или простаивает.  
  
9. На странице «Обновление данных» в поле **Рабочие часы**можно указать диапазон часов, определяющих рабочий день. Обновление данных по расписанию может быть запущено после окончания бизнес-дня для заведения данных транзакций, созданных в течение рабочих часов.  
  
10. В **учетной записи автоматического обновления данных PowerPivot**можно указать предопределенное служба Secure Store целевое приложение, в котором хранится предопределенная учетная запись для выполнения заданий обновления данных PowerPivot. Следует указывать имя, а не идентификатор целевого приложения. Целевое приложение для автоматического обновления данных создается автоматически, если при установке PowerPivot для SharePoint в программе установки SQL Server был выбран параметр «Новый сервер». В противном случае целевое приложение необходимо создать вручную. Инструкции по настройке учетной записи см. в статье [Настройка учетной записи автоматического обновления данных PowerPivot &#40;PowerPivot для SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).  
  
11. В разделе **Разрешить пользователям вводить пользовательские учетные данные Windows**можно установить или снять флажок, указывающий, могут ли владельцы расписания вводить произвольные учетные данные Windows для запуска обновления данных по расписанию. Если этот флажок установлен, то приложение службы PowerPivot создает и обслуживает целевое приложение для каждого набора этих сохраненных учетных данных. Дополнительные сведения см. в разделе [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).  
  
12. В поле **Максимальный размер журнала обработки**можно указать время, в течение которого исторические записи о процессе обновления данных будут сохраняться. Эта информация отображается на страницах истории обновления данных, содержащихся в каждой книге с обновленными данными. Также отображается на панели управления PowerPivot.  
  
13. На странице «Сбор данных об использовании» в поле **Интервал отчетов о запросах**задайте интервал времени для сбора статистики в отчете о запросах. Статистика о запросах передается в виде одиночного события, позволяя свести к минимуму обмен данными между серверами.  
  
14. В поле «Журнал данных об использовании» укажите время, в течение которого должны храниться записи данных об использовании. Сведения об использовании отображаются на панели управления PowerPivot. Эффективность этих отчетов будет невелика, если для журнала данных об использовании указано слишком низкое значение.  
  
15. На странице «Сбор данных об использовании» для каждого порогового значения ответа укажите верхнее ограничение, определяющее, когда заканчивается одна категория и начинается другая. Эти категории устанавливают базовый уровень, по которому оценивается запрос. Эти категории могут быть использованы для наблюдения за трендом продолжительности обработки запросов системой. Эти сведения также отображаются на панели управления PowerPivot.  
  
16. Нажмите кнопку **ОК**, чтобы сохранить изменения.  
  
     Изменения времени ожидания загрузки или метода распределения применяются только для новых входящих запросов. Для запросов, которые уже обрабатываются, применяются те значения, которые были установлены при получении запроса.  
  
##  <a name="assign-a-powerpivot-service-application-to-a-web-application"></a><a name="AssignGSA"></a>Назначение приложения службы PowerPivot веб-приложению  
 После настройки приложения службы PowerPivot можно назначить ее веб-приложению путем добавления в список соединений приложений служб для этого веб-приложения. Это можно сделать двумя способами.  
  
-   Добавьте его в группу соединения **По умолчанию** . *Группа соединений по умолчанию* — это набор соединений с приложениями служб, которые доступны любому веб-приложению, ссылающемуся на них. В этот список необходимо добавить приложение службы PowerPivot.  
  
-   Создайте **пользовательский** список соединений для веб-приложения. Если было создано несколько приложений службы PowerPivot, то для использования необходимо выбрать одно, добавив его в пользовательский список.  
  
 Группа соединений по умолчанию может принимать более одного приложения службы одного типа. Имейте в виду, что добавление нескольких приложений службы PowerPivot в этот список не поддерживается.  
  
1.  В разделе **Управление приложениями**центра администрирования выберите **Управление веб-приложениями**.  
  
2.  Выберите приложение, которому должно быть назначено соединение (например, SharePoint-80).  
  
3.  Нажмите **Соединения службы**.  
  
4.  В поле **изменить следующую группу ассоциаций**выберите **значение по умолчанию** или **[пользовательский]**.  
  
5.  Для **[Custom]** установите флажок рядом с каждым подключением приложения службы, которое вы хотите использовать. Если есть несколько приложений службы PowerPivot (обозначены типом `PowerPivot Service Application Proxy`), то должно быть выбрано только одно.  
  
6.  Нажмите кнопку **ОК**.  
  
##  <a name="edit-service-application-properties"></a><a name="EditGSA"></a> Изменение свойств приложения службы  
 Повторное открытие страницы свойств, на которой указаны имя приложения службы, пул приложений, параметры базы данных и взаимосвязи служб, производится следующим образом.  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Выделите, но не щелкайте ссылку на приложение службы PowerPivot. Чтобы выбрать строку целиком можно щелкнуть имя типа.  
  
3.  На ленте нажмите **Свойства** .  
  
## <a name="see-also"></a>См. также:  
 [Настройка и администрирование сервера PowerPivot в центре администрирования](power-pivot-server-administration-and-configuration-in-central-administration.md)  
  
  
