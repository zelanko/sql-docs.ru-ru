---
title: Правила определения исправности Справочник (PowerPivot для SharePoint) | Документация Майкрософт
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- analysis-services
ms.topic: conceptual
ms.assetid: 47ae04ce-7b9d-49c2-8dbc-bafcb73d4603
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 90a968aa93da4b2f5c5056101e4e2596ac568e72
ms.sourcegitcommit: 334cae1925fa5ac6c140e0b2c38c844c477e3ffb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/13/2018
ms.locfileid: "53363566"
---
# <a name="health-rules-reference-powerpivot-for-sharepoint"></a>Справочник по правилам для определения исправности (PowerPivot для SharePoint)
  В этом справочном разделе описываются правила исправности SharePoint, которые добавляются приложением PowerPivot для SharePoint. Эти правила служат для сообщения о проблемах с работоспособностью сервера, доступностью или конфигурацией приложения службы [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] или связанного с ним экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .  
  
 В следующей таблице правила перечислены в порядке, соответствующем порядку правил на странице «Определения правил анализатора исправности» в центре администрирования SharePoint. Настраиваемыми называются правила, для которых можно изменять пороговые значения, вызывающие срабатывание правила. Дополнительные сведения см. в разделе [правила определения исправности PowerPivot — Настройка](configure-power-pivot-health-rules.md). В столбце «Автоматическое восстановление» показано, существует ли встроенное решение проблемы, доступное со страницы «Отчеты о проблемах».  
  
||  
|-|  
|**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013 #124; SharePoint 2010|  
  
 **Примечание** [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] устанавливает разные наборы правил определения работоспособности для разных версий SharePoint. См. в столбце «версия» в таблице ниже, или можно выполнить следующую команду Windows PowerShell для отображения списка установленных правил.  
  
```  
Get-SPHealthAnalysisRule | select name, enabled, summary | where {$_.summary -like "*power*"}  | format-table -property * -autosize | out-default  
```  
  
|Правило|Настраиваемый|Автоматическое восстановление|Версия|Описание|  
|----------|------------------|-----------------|-------------|-----------------|  
|PowerPivot: На этом компьютере не установлен поставщик OLE DB для служб Analysis Services.|Нет|Нет|SharePoint 2010|Поставщик OLE DB для служб Analysis Services не установлен на сервере или имеет неправильную версию. Это правило появляется, если в ферму SharePoint входят экземпляры служб Excel на серверах приложений, где не установлено приложение PowerPivot для SharePoint. Это правило предупреждает о том, что не установлен поставщик OLE DB для служб Analysis Services, который используется службами Excel для подключения к данным PowerPivot. Чтобы устранить эту проблему, установите поставщик OLE DB на каждом сервере служб Excel, где не установлен поставщик OLE DB для служб Analysis Services. Поставщик OLE DB для служб Analysis Services можно загрузить и установить из Центра загрузки Майкрософт. Дополнительные сведения см. в статье [Установка поставщика OLE DB служб Analysis Services на серверах SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).|  
|PowerPivot: Параметры реестра для библиотеки Microsoft.AnalysisServices.ChannelTransport.dll не являются допустимыми после установки на данном компьютере версии поставщика MSOLAP, предназначенной для SQL Server 2008 R2.|Нет|Да|SharePoint 2010|Это проблема конфигурации сервера. Скорее всего, файл ChannelTransport.dll не зарегистрирован в глобальной сборке. Запустите автоматическое восстановление для данного правила, чтобы зарегистрировать DLL-файл на каждом сервере, где установлен экземпляр PowerPivot для SharePoint. Также можно вручную запустить программу regasm.exe, чтобы зарегистрировать этот файл. Если служба таймера SharePoint не запущена от имени локального администратора, может понадобиться регистрация вручную. Невозможность обновить параметры реестра вызывает замедление связи между службами Excel и системной службой PowerPivot, а в некоторых конфигурациях безопасности может привести к ошибкам соединения.|  
|PowerPivot: Приложение службы PowerPivot не имеет разрешения на выполнение операции.|Нет|Нет|SharePoint 2010|Это правило проверяет, является ли удостоверение приложения службы PowerPivot владельцем базы данных приложений на сервере PowerPivot и имеет ли оно разрешения администратора в локальном экземпляре служб SQL Server Analysis Services. Эти разрешения автоматически предоставляются во время установки и развертывания, но если этот шаг не был выполнен, то срабатывает данное правило исправности.|  
|PowerPivot: Удостоверение приложения службы PowerPivot не должно входить в локальную группу «Администраторы».|Нет|Нет|SharePoint 2010|Выполнение этой рекомендации повышает общую безопасность среды. Если приложение службы PowerPivot настроено для работы с учетной записью, входящей в локальную группу администраторов, то следует изменить учетную запись службы на запись, не входящую в эту группу. Рекомендуется использовать для каждой службы выделенную учетную запись, обладающую минимально необходимыми разрешениями. Это обеспечивает изоляцию служб и упрощает аудит входа. Дополнительные сведения об изменении учетной записи службы, см. в разделе [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md).|  
|PowerPivot: Экземпляр служб Analysis Services работает в табличном режиме, но параметр конфигурации, задающий этот режим, отключен.|Нет|Нет|SharePoint 2010|Это правило проверяет, имеет ли свойство `DeploymentMode` экземпляра служб SQL Server Analysis Services в экземпляре PowerPivot для SharePoint значение 1. Если это свойство имеет другое значение или у службы таймера SharePoint, которая запускает средство проверки правил, отсутствует разрешение на открытие файла, то правило дает отрицательный результат. Дополнительные сведения о свойстве режима развертывания см. в разделе [Определение режима работы сервера экземпляра служб Analysis Services](../instances/determine-the-server-mode-of-an-analysis-services-instance.md).|  
|PowerPivot: Задание таймера обновления данных PowerPivot выключено.|Нет|Нет|SharePoint 2013<br /><br /> SharePoint 2010|Проверьте параметры задания таймера и убедитесь, что оно включено. Если функция обновления данных PowerPivot не используется, то это правило можно пропустить. Дополнительные сведения см. в разделе [обновление данных PowerPivot с SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md).|  
|PowerPivot: Сведения об учетной записи служб SQL Server Analysis Services (PowerPivot), управляемой в диспетчере конфигурации SQL Server, отличаются от сведений об учетной записи, управляемой в центре администрирования.|Нет|Нет|SharePoint 2010|Это правило проверяет, совпадают ли данные учетной записи службы в диспетчере конфигурации SQL Server с данными управляемой учетной записи в центре администрирования для того же экземпляра служб Analysis Services. Если эти учетные записи различаются, то в отчет о проблемах и разрешении добавляется запись, которая позволяет поменять учетную запись службы в диспетчере конфигурации SQL Server на учетную запись, указанную в центре администрирования. Диспетчер конфигурации SQL Server не поддерживается в качестве средства для изменения имени пользователя и пароля учетной записи службы в экземпляре PowerPivot для SharePoint. Центр администрирования позволяет использовать управляемые учетные записи в SharePoint. Более того, если в ферму входит несколько серверов PowerPivot для SharePoint, то наличие несогласованных параметров учетной записи службы может препятствовать операциям обработки и операциям запросов на сервере, где неправильно заданы сведения о службе.<br /><br /> В случае срабатывания этого правила на одиночном сервере книги PowerPivot временно продолжат работу, однако рекомендуется как можно скорее устранить проблему. Разрешения в базе данных и в файловой системе обновляются с учетом данных учетной записи, указанной в центре администрирования.|  
|PowerPivot: Развернутое в ферме решение имеет старую версию.|Нет|Да|SharePoint 2010|Для установки компонентов PowerPivot для SharePoint используется решение на уровне фермы и решение на уровне веб-приложения. Это правило показывает, что решение на уровне фермы имеет более раннюю версию, чем версия сервера или версия веб-решения. Скорее всего, проблема связана с развертыванием сервера. Для устранения этой проблемы рекомендуется запустить программу установки SQL Server, чтобы исправить один из экземпляров PowerPivot для SharePoint, входящих в ферму. Дополнительные сведения о решениях в PowerPivot для SharePoint см. в разделе [развертывание решений PowerPivot в SharePoint](deploy-power-pivot-solutions-to-sharepoint.md).|  
|PowerPivot: Общая загрузка ЦП слишком велика.|Да|Нет|SharePoint 2010|Данное правило сообщает о загрузке ЦП на уровне системы. Загрузка ЦП отслеживается на общем уровне, так как системная служба PowerPivot оценивает по уровню загрузки степень работоспособности сервера и производит в соответствии с этой оценкой балансировку загрузки между несколькими серверами PowerPivot для SharePoint в ферме. Рекомендуется добавить в ферму дополнительный сервер приложений и перенести на него приложения, интенсивно загружающие процессор.|  
|PowerPivot: Службам Analysis Services не хватает ресурсов ЦП для выполнения запрошенных операций.|Да|Нет|SharePoint 2010|Объема ресурсов ЦП, доступных процессу служб Analysis Services (msmdsrv.exe), недостаточно для обеспечения текущего уровня активности этого сервера. Рекомендуется добавить в ферму дополнительный сервер PowerPivot для SharePoint. Дополнительные сведения см. в разделе [контрольный список развертывания: Масштабное развертывание путем добавления серверов PowerPivot в ферме SharePoint 2010](../../sql-server/install/deployment-checklist-scale-out-adding-powerpivot-servers-sharepoint-2010-farm.md).|  
|PowerPivot: Службам Analysis Services не хватает памяти для выполнения запрошенных операций.|Нет|Нет|SharePoint 2010|Это правило срабатывает, если для служб Analysis Services остается только 5 % доступного объема памяти. На сервере приложений SharePoint для экземпляра служб SQL Server Analysis Services должен быть всегда зарезервирован небольшой объем памяти, который никогда не используется. Так как большая часть операций на сервере связана с использованием памяти, сервер работает лучше, если загружен не полностью.<br /><br /> По умолчанию предупреждения о нехватке памяти создаются, когда объем доступной памяти опускается до 5 %. Это значение можно изменять в любую сторону, задав параметры в экземпляре служб Analysis Services. Дополнительные сведения см. в разделе [правила определения исправности PowerPivot — Настройка](configure-power-pivot-health-rules.md).<br /><br /> Величина 5 % от неиспользуемой памяти вычисляется относительно объема, выделенного службам Analysis Services. Например, если общий объем памяти составляет 200 ГБ и службам Analysis Services выделено 80 % (или 160 ГБ), то 5 % неиспользуемой памяти — это 5 % от 160 ГБ (или 8 ГБ).|  
|PowerPivot: Большое число соединений указывает, что для обработки текущей нагрузки необходимо развернуть большее число серверов.|Да|Нет|SharePoint 2010|По умолчанию это правило исправности срабатывает, когда число уникальных соединений пользователей превышает 100. Это значение по умолчанию задается произвольно (не зависит от характеристик оборудования сервера и от активности пользователей), и его можно изменять в любую сторону в зависимости от объема ресурсов сервера и типичных показателей активности пользователей в среде. Дополнительные сведения см. в разделе [правила определения исправности PowerPivot — Настройка](configure-power-pivot-health-rules.md).|  
|PowerPivot: Отношение числа событий загрузки к числу событий соединения слишком велико.|Да|Нет|SharePoint 2013<br /><br /> SharePoint 2010|По умолчанию это правило исправности срабатывает, когда отношение числа событий загрузки к числу событий соединения за весь период сбора данных (по умолчанию — 4 часа) превышает 50 %. Столь высокое отношение означает, что активно очень большое число соединений с уникальными книгами или заданы слишком жесткие параметры сокращения объема кэша (и книги быстро выгружаются и удаляются из системы, хотя еще остаются активные запросы к этим данным). Чтобы исключить ложные положительные результаты, для вычисления отношения необходимо, чтобы за 4-часовой период было установлено не менее 20 соединений. Это правило работоспособности можно поставить в зависимость от другого соотношения. Дополнительные сведения см. в разделе [правила определения исправности PowerPivot — Настройка](configure-power-pivot-health-rules.md). Дополнительные сведения о настройке кэша см. в разделе [Настройка использования места на диске &#40;PowerPivot для SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: В каталоге журналов обнаружен один или несколько файлов мини-дампа, что указывает на сбой программы.|Нет|Нет|SharePoint 2013<br /><br /> SharePoint 2010|Файлы минидампа создаются во время сбоя программы для сохранения данных о состоянии приложения службы PowerPivot непосредственно перед сбоем. Эти данные можно отправить в корпорацию Майкрософт и использовать для устранения неполадок. Это правило срабатывает, когда на сервере обнаруживаются DMP-файлы. Правило предоставляет ссылку на файл, который находится в папке \OLAP\Log экземпляра PowerPivot для SharePoint. Учтите, что содержимое такого файла нельзя просмотреть в текстовом редакторе. Для просмотра файлов минидампа необходимо загрузить и установить отдельное средство отладки. Дополнительные сведения см. в разделе [Debugging Tools for Windows (на английском языке)](https://go.microsoft.com/fwlink/?linkID=208266).|  
|PowerPivot: Недостаточно места на диске, на котором кэшируются данные PowerPivot.|Да|Нет|SharePoint 2010|По умолчанию это правило определения исправности срабатывает, когда объем свободного места на диске становится меньше 5 % объема диска, на котором расположена папка резервного копирования. Дополнительные сведения о задании этого процентного значения см. в разделе [правила определения исправности PowerPivot — Настройка](configure-power-pivot-health-rules.md). Дополнительные сведения об использовании диска см. в разделе [Настройка использования места на диске &#40;PowerPivot для SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: Данные об использовании не обновляются с ожидаемой частотой.|Да|Нет|SharePoint 2013<br /><br /> SharePoint 2010|PowerPivot для SharePoint использует встроенную систему сбора данных об использовании для измерения показателей, связанных со временем ответа подключений, обновления данных и запросов. Эти данные об использовании хранятся в базе данных приложения службы PowerPivot, которая в свою очередь обновляет книгу PowerPivot (PowerPivot Management Data.xlsx), а оттуда данные попадают в отчеты на панели управления PowerPivot. Это правило указывает, что данные не поступают в файл PowerPivot Management Data.xlsx с достаточной частотой. Факт обновления XLSX-файла устанавливается по метке времени. Если в системе сбора данных об использовании имеются другие проблемы, понижающие точность данных, то это правило не обнаружит их. Чтобы устранить эту ошибку, убедитесь, что запущены задания таймера. Дополнительные сведения о сборе данных об использовании см. в разделе [Настройка сбора данных об использовании &#40;PowerPivot для SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|PowerPivot: Учетная запись процесса midtier должна иметь разрешение «Полный доступ для чтения» для всех связанных SPWebApplication.|Нет|Да|SharePoint 2013<br /><br /> SharePoint 2010|Удостоверение приложения службы PowerPivot должно иметь **полный доступ для чтения** разрешения для доступа к SharePoint базы данных содержимого от имени пользователей, обладающих разрешениями только для просмотра для документа. Чтобы определить, какая учетная запись служит удостоверением приложения службы PowerPivot, откройте **Настройка учетных записей служб** страницы в центре администрирования. Скорее всего, приложение службы работает либо в пуле приложений службы **Система веб-служб SharePoint** , либо в выделенном пуле приложений. Несмотря на то, что это правило предоставляет вариант автоматическое исправление, позволит добиться лучших результатов при предоставлении разрешения вручную следующим образом:<br /><br /> 1) откройте страницу **Управление веб-приложениями**в центре администрирования;<br /><br /> 2) выберите веб-сайт и нажмите кнопку **Политика пользователя**;<br /><br /> 3) нажмите кнопку **Добавить пользователей**;<br /><br /> 4) выберите пункт "Все зоны" и нажмите кнопку **Далее**;<br /><br /> (5) в пользователей введите удостоверение приложения службы PowerPivot и нажмите кнопку **полный доступ для чтения** флажок. Нажмите кнопку **Готово**.<br /><br /> 6) убедитесь, что проблема устранена. В разделе «Наблюдение» щелкните ссылку **Пересмотр определений правил**. Найдите и откройте правило PowerPivot. Нажмите кнопку **Выполнить**. Вернитесь к окну **Обзор проблем и решений** и убедитесь, что правило больше не появляется.|  
|PowerPivot: Служба вторичного входа в систему (seclogon) отключена.|Нет|Нет|SharePoint 2013<br /><br /> SharePoint 2010|Служба вторичного входа используется для создания эскизов книг PowerPivot в коллекции PowerPivot. По умолчанию служба вторичного входа должна запускаться вручную. Если служба отключена, создание эскизов невозможно. Кроме того, журналы ULS будут содержать следующую ошибку: «Ошибка 1058 может быть как первопричин факт службу Windows отключена «Вторичного входа в систему».»<br /><br /> Для проверки конфигурации службы используйте консольное приложение «Службы», чтобы найти вторичное имя входа и изменить **Тип запуска** на **Ручной**. Если включить службу невозможно, это означает, что она отключена в соответствии с групповой политикой организации. Выясните у администратора, так ли это.<br /><br /> После включения службы изображения эскиза или моментального снимка будут периодически обновляться. Кроме того, возможно принудительное обновление. Для этого нужно перезапустить службу, а затем открыть и сохранить заново страницы свойств конкретного отчета. Дополнительные сведения см. в разделе [использование коллекции PowerPivot](https://go.microsoft.com/fwlink/?LinkId=246462).|  
|PowerPivot: ADOMD.NET не установлен на автономный клиентский веб-интерфейс (WFE), настроенный для центра администрирования|Нет|Нет|SharePoint 2013<br /><br /> SharePoint 2010|ADOMD.NET — это клиентская библиотека служб Analysis Services, которая поддерживает соединение с базой данных служб Analysis Services. Если развертывается PowerPivot для SharePoint, ADOMD.NET обеспечивает доступ к встроенным отчетам на панели управления PowerPivot в центре администрирования. Фактически встроенные отчеты — это книги PowerPivot, которые содержат внедренные данные служб Analysis Services. Панель управления использует ADOMD.NET для отправки запроса на соединение с сервером, который загружает данные, содержащиеся в книге.<br /><br /> В топологиях, где центр администрирования работает на автономном сервере клиентского веб-интерфейса, необходимо вручную установить ADOMD.NET, чтобы просматривать эти отчеты на панели управления. Дополнительные сведения можно найти в статье [Установка ADOMD.NET на веб-серверах, обслуживающих клиентские запросы, под управлением центра администрирования](../../sql-server/install/install-adomd-net-on-web-front-end-servers-running-central-administration.md).|  
  
  
