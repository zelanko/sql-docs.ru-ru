---
title: 'Не удалось обновить данные для подключения к данным в книге. Повторите попытку или обратитесь к системному администратору. Следующие соединения не удалось обновить: Данные PowerPivot | Документация Майкрософт'
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- analysis-services
ms.topic: conceptual
ms.assetid: 0f6fd52d-ac72-43e3-aa08-05a2d2bb873d
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 7904e42d9ffd82d2c8a5ec7f5c9226d01c5059ef
ms.sourcegitcommit: 334cae1925fa5ac6c140e0b2c38c844c477e3ffb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/13/2018
ms.locfileid: "53371006"
---
# <a name="unable-to-refresh-data-for-a-data-connection-in-the-workbook-try-again-or-contact-your-system-administrator-the-following-connections-failed-to-refresh-powerpivot-data"></a>Не удалось обновить данные для подключения к данным в книге. Повторите попытку или обратитесь к системному администратору. Следующие соединения не удалось обновить: Данные PowerPivot
  Применительно к книгам Excel, содержащим данные PowerPivot, службы Excel возвращают эту ошибку, если при передаче запроса на соединение серверу PowerPivot запрос завершается ошибкой.  
  
## <a name="details"></a>Сведения  
  
|||  
|-|-|  
|Применимо для следующих объектов:|Установка PowerPivot для SharePoint|  
|Номер версии продукта|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)], [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]|  
|Причина|См. ниже.|  
|Текст сообщения|Не удалось обновить данные для подключения к данным в книге. Повторите попытку или обратитесь к системному администратору. Следующие соединения не удалось обновить: Данные PowerPivot|  
  
## <a name="explanation-and-resolution"></a>Описание проблемы и действия по ее разрешению  
 Службы Excel не могут установить соединение или загрузить данные PowerPivot. Эта ошибка возникает, в частности, при следующих условиях.  
  
 **Сценарий 1. Служба не запущена**  
  
 Не запущен экземпляр служб SQL Server Analysis Services (PowerPivot). Истечение срока действия пароля стало причиной остановки выполнения службы. Дополнительные сведения об изменении пароля см. в разделах [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) и [Start or Stop a PowerPivot for SharePoint Server](start-or-stop-a-power-pivot-for-sharepoint-server.md).  
  
 **Сценарий 2a: Открытие более ранней версии книги сервера**  
  
 Возможно книга, которую вы пытаетесь открыть, создана в другой версии PowerPivot для Excel для SQL Server 2008 R2. Наиболее вероятно, что указанный в строке подключения поставщик данных служб Analysis Services, отсутствует на компьютере, который обрабатывает этот запрос.  
  
 Если это так, в журнале ULS вы найдете следующее сообщение: «Сбой обновления для «Данные PowerPivot» в книге "\<URL-адрес книги >"», а затем «Не удалось установить соединение».  
  
 Чтобы определить версию книги, необходимо открыть ее в Excel и проверить, какой поставщик данных указан в строке подключения. Книга SQL Server 2008 R2 использует в качестве поставщика данных MSOLAP.4.  
  
 Для решения этой проблемы вы можете обновить книгу. В качестве альтернативы можно установить клиентские библиотеки из версии служб Analysis Services для SQL Server 2008 R2 на физических ПК, на которых запускается PowerPivot для служб SharePoint или Excel:  
  
 [Установка поставщика OLE DB служб Analysis Services на серверах SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)  
  
 **Сценарий 2b: Службы Excel выполняются на сервере приложений, где находится неправильная версия клиентских библиотек**  
  
 По умолчанию, SharePoint Server 2010 устанавливает на серверы приложений со службами Excel поставщик OLE DB для версии служб Analysis Services, предназначенной для SQL Server 2008. В ферме, которая поддерживает доступ к данным PowerPivot, все физические серверы, на которых запущены приложения, запрашивающие данные PowerPivot, например службы Excel и PowerPivot для SharePoint, должны использовать более позднюю версию поставщика данных.  
  
 Серверы под управлением PowerPivot для SharePoint автоматически получают обновленный поставщик OLE DB. Другие серверы, например такие, на которых запущен отдельный экземпляр служб Excel без служб PowerPivot для SharePoint, установленных на этом же компьютере, должны быть исправлены, чтобы использовать клиентские библиотеки более новой версии. Дополнительные сведения см. в статье [Установка поставщика OLE DB служб Analysis Services на серверах SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).  
  
 **Сценарий 3. Контроллер домена недоступен**  
  
 Причина может заключаться в том, что контроллер домена недоступен для проверки удостоверения пользователя. Для проверки подлинности пользователя SharePoint службе Claims to Windows Token Service требуется контроллер домена при каждом соединении. Служба Claims to Windows Token Service не использует кэшированные учетные данные. Она проверяет удостоверение пользователя для каждого соединения.  
  
 Подтвердить причину этой ошибки можно, открыв файл журнала SharePoint. Если в журналах SharePoint есть сообщение «Не удалось получить WindowsIdentity от IClaimsIdentity», то подлинность удостоверения пользователя не удалось проверить.  
  
 Чтобы решить эту проблему, присоедините компьютер к домену, в котором находится сервер PowerPivot, или установите контроллер домена на локальный компьютер. Второе решение, установка контроллера домена, потребует создания локальных учетных записей домена для всех служб и пользователей. Для создаваемых учетных записей потребуется настроить учетные записи служб и разрешения SharePoint.  
  
 Установка контроллера домена на компьютер рекомендуется в случае, если стоит задача использовать PowerPivot для SharePoint без подключения к сети (вне сети). Подробные инструкции по использованию PowerPivot в автономном режиме, см. в записи блога «Отключение сервера PowerPivot от сети» [ http://www.powerpivotgeek.com ](https://go.microsoft.com/fwlink/?LinkId=184241).  
  
 **Сценарий 4. Сервер работает нестабильно**  
  
 Одна или несколько служб могут находиться в несогласованном состоянии. В некоторых случаях решить эту проблему можно, выполнив команду IISRESET.  
  
  
