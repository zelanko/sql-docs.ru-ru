---
title: Анализ покупательской корзины (таблица Аналисистулс для Excel) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- shopping basket analysis
- mining model, association
- Table Analysis tools
- association [data mining]
- market basket analysis
ms.assetid: ba40cf43-f286-49ad-8316-70f5b11f1dae
author: minewiskan
ms.author: owend
ms.openlocfilehash: 0f5d571d1a3f88f20600947d3093bf1e37feeee2
ms.sourcegitcommit: 9ee72c507ab447ac69014a7eea4e43523a0a3ec4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2020
ms.locfileid: "84940525"
---
# <a name="shopping-basket-analysis-table-analysistools-for-excel"></a>Анализ покупательского поведения (средства анализа таблиц для Excel)
  ![Список покупок](media/tat-shopbskt.gif "Список покупок")  
  
 Средство **анализа покупательской корзины** помогает находить `associations` нужные данные. Взаимосвязь может показать, какие элементы чаще всего приобретаются вместе. В интеллектуальном анализе данных этот метод является хорошо известным методом, известным как *Анализ потребительской корзины*, который используется для анализа поведения клиентов в очень больших наборах данных. Продавцы могут использовать эти сведения, чтобы рекомендовать связанные продукты клиентам и продвигать связанные продукты, располагая их рядом на веб-страницах, в каталогах или на полках.  
  
 Для использования анализа покупательского поведения анализируемые элементы должны быть связаны по идентификатору транзакции. Например, если анализируются все заказы, полученные через веб-узел, у каждого заказа будет существовать идентификатор заказа или идентификатор транзакции, связанный с одним или несколькими приобретенными элементами.  
  
 Когда мастер завершит анализ данных, он создаст два новых листа: **группы элементов корзины покупок** и **правила корзины покупок**.  
  
 Лист " **группы элементов корзины покупок** " содержит список элементов, которые часто отображаются вместе в транзакциях. Эти распространенные группы называются наборами *элементов*. На листе также содержатся статистические данные, такие как *Поддержка* и *Прогноз*, помогающие понять значимость набора элементов. Если доступны сведения о ценах, на листе также создается сумма значений всех связанных элементов, чтобы показать суммарное значение транзакций.  
  
 Столбцы в отчете можно сортировать и фильтровать. Например, может потребоваться просмотреть только наборы элементов с двумя или более продуктами или заказать наборы элементов по **среднему значению корзины**.  
  
 Лист « **правила корзины покупок** » использует статистические данные, полученные от анализа, для создания правил связи между элементами. Например, правило может быть таким, что если клиенты приобретают продукт A, они, скорее всего, приобретают продукт B. Правила можно использовать для создания рекомендаций. Каждое правило поддерживается статистическими данными, помогающими оценить потенциальную силу правила, чтобы можно было давать рекомендации только в том случае, если правило превышает определенный порог вероятности.  
  
## <a name="using-the-shopping-basket-analysis-tool"></a>Использование средства анализа покупательского поведения  
  
1.  Откройте таблицу Excel, содержащую соответствующие данные. Щелкните лист «Взаимосвзяи» в образце книги.  
  
2.  Щелкните **анализ покупательской корзины**.  
  
3.  В диалоговом окне **анализ корзины покупок** выберите столбец, содержащий идентификатор транзакции, а затем выберите столбец, содержащий элементы или продукты, которые требуется проанализировать.  
  
4.  Дополнительно можно добавить столбец, содержащий цену продуктов.  
  
5.  Нажмите кнопку**Дополнительно**, чтобы открыть диалоговое окно **Настройка дополнительных параметров** . Увеличьте значение параметра **Минимальная поддержка** , чтобы сократить количество продуктов, сгруппированных в качестве наборов элементов. Увеличьте **минимальную вероятность правила** , чтобы отфильтровать очень распространенные наборы элементов.  
  
### <a name="requirements"></a>Требования  
 Чтобы использовать средство **анализа покупательской корзины** , данные должны храниться в таблице Excel и должны содержать следующие столбцы:  
  
-   Столбец, содержащий уникальный идентификатор, представляющий транзакцию. Идентификатор может быть числовым или текстовым. Самое важное, чтобы значение в каждой строке было уникально.  
  
-   Столбец, содержащий анализируемый продукт или элемент.  
  
-   Дополнительный числовой столбец, представляющий цену или значение каждого элемента. Данный столбец используется для статистической обработки значений наборов элементов, в которых был найден каждый из продуктов, и помогает понять суммарное значение определенных транзакций.  
  
## <a name="how-items-are-associated"></a>Как устанавливается взаимосвязь элементов  
 Отдельные анализируемые элементы должны быть сгруппированы по определенному идентификатору, представляющему вариант, транзакцию или возможность. Таким образом, этот столбец идентификатора транзакции выбирается как идентификатор, а не идентификатор клиента или номер продукта.  
  
 Когда средство изучает продукты в каждой транзакции, оно создает набор элементов для каждого найденного сочетания элементов. Например, если Заказчик приобрел три элемента в одном центре, существует 7 возможных наборов элементов: каждый продукт считается собственным, каждый продукт объединяется с одним другим продуктом и сочетание всех трех продуктов.  
  
> [!NOTE]  
>  Наборы элементов, содержащие одиночные продукты, можно отфильтровать, однако средству необходимо произвести их анализ для формирования значимой статистики для набора данных.  
  
 Несущее множество для каждого набора элементов — это число клиентов, купивших данный набор элементов. В приведенном выше примере, если существует только один клиент, купивший 3 элемента из 7 возможных наборов элементов, значение несущего множества каждого из семи наборов элементов равно 1. При росте числа клиентов и увеличении числа возможных сочетаний время обработки отчета может значительно увеличиться. Однако у некоторых наборов элементов несущее множество может быть крайне мало. В связи с этим можно ограничить количество элементов в каждом наборе элементов тремя или менее; это позволит сократить время, необходимое для формирования отчета. Обычно большие наборы элементов имеют гораздо меньшее несущее множество, поэтому такой компромисс приемлем.  
  
## <a name="specifying-minimum-support-and-rule-probability"></a>Указание минимального несущего множества и вероятности правил  
 При увеличении размера набора данных число возможных группирований элементов и правил может стать огромным. Однако можно управлять количеством результатов, выводимых средством, чтобы сконцентрировать внимание только на самых важных наборах элементов и правилах. Эти параметры задаются в **диалоговом окне Дополнительные параметры корзины покупок**.  
  
### <a name="minimum-support"></a>Минимальное несущее множество  
 *Минимальная поддержка* означает количество транзакций, которые должны содержать определенный набор элементов, чтобы набор элементов считался значимым. Например, набор элементов может быть интересен только в том случае, если он был приобретен как минимум в 10 разных транзакциях. Существует два способа контролировать пороговое значение для набора элементов и использовать параметр **минимальной поддержки** .  
  
 **Как абсолютное значение:** Введите число, представляющее число транзакций, содержащих целевые элементы. Например, если ввести число 10, в результат будут включены любые наборы элементов, встречающиеся как минимум в 10 списках покупок.  
  
 В **процентах:** Введите число, представляющее процентную долю всей коллекции наборов элементов. Например, если указать значение 10, будет произведен пересчет всех наборов элементов и целевой набор элементов должен присутствовать по крайней мере в 10 процентах от общего числа наборов элементов. При наличии очень большого набора данных использование процентов, а не абсолютного значения поможет сконцентрировать внимание на наиболее важных группированиях элементов.  
  
> [!NOTE]  
>  Следует помнить, что число наборов элементов отличается от числа транзакций в данных. Каждая транзакция может содержать несколько наборов элементов; однако большинство наборов элементов встречается в наборе данных несколько раз.  
  
### <a name="rule-probability-and-rule-importance"></a>Вероятность и важность правил  
 Вероятность правила описывает вероятность результата применения правила. Вероятность правил вычисляется с помощью частоты наборов элементов, поддерживающих правило. Если набор элементов встречается очень редко, у него будет низкая вероятность.  
  
 Однако правила, имеющие высокую вероятность, не всегда могут быть полезными. Они могут показывать наборы элементов, приобретаемые очень часто и, следовательно, не нуждающиеся в дополнительном продвижении. Важность предназначена для измерения степени полезности правила. Иногда правило может иметь очень высокую вероятность, но низкую важность, поскольку прогноз не выдает никакой новой информации. Например, если каждый набор элементов содержит особое состояние атрибута, правило, прогнозирующее состояние, является несущественным, хотя вероятность его очень высокая.  
  
 С этими настройками следует поэкспериментировать, чтобы увидеть различные результаты и определить, какие из настроек приводят к обнаружению наиболее интересных правил.  
  
## <a name="understanding-the-reports"></a>Основные сведения об отчетах  
 Средство **анализа покупательской корзины** создает два дополнительных отчета. Первый отчет, озаглавленный **значительные группы элементов, определенных во время анализа**, содержит список всех найденных наборов элементов. Чтобы сортировать, фильтровать и просматривать данные, можно использовать новые средства для работы с таблицами, предоставленные в Microsoft Excel.  
  
 Второй отчет, озаглавленный **правила корзины покупок**, указывает, какие виды вывода можно сделать на основе наборов элементов, перечисленных в первом отчете. Список наборов элементов будет более полезен для просмотра и понимания данных, тогда как список правил будет более полезен для создания прогнозов или рекомендаций.  
  
### <a name="shopping-basket-item-groups-report"></a>Отчет «Группы элементов списка покупок»  
 В этом отчете содержится список всех возможных сочетаний элементов, найденных в наборе данных. Например, если данные транзакции содержат заказы, для каждого заказа средство анализа покупательской **корзины** вычисляет, сколько раз был заказан отдельный элемент, а затем вычисляет все сочетания этого элемента с другими элементами.  
  
 Найденные наборы элементов перечисляются в отчете в порядке их точности прогноза. Точность прогноза — это оценка, показывающая важность набора элементов.  
  
|Столбец отчета|Содержание|  
|----------------------|-----------------------|  
|Группа элементов|Перечисляются наборы элементов или сочетания элементов.|  
|Размер группы|Количество элементов в наборе элементов. К данному полю можно применить фильтр, чтобы отображались только пары элементов, одиночные элементы и т. д.|  
|Поддержка|Количество вариантов, в которых появилось данное сочетание. По данному столбцу можно выполнить сортировку, чтобы определить наиболее часто встречающиеся наборы элементов.|  
|Среднее значение|Сумма значений всех элементов в данном наборе элементов, деленная на значение несущего множества. По данному столбцу можно выполнить сортировку, также можно применять фильтры, чтобы назначить в качестве цели продукты в разных ценовых диапазонах.|  
|Средняя стоимость корзины|Сумма значений всех элементов в заказах, содержащих данный набор элементов, деленная на значение несущего множества. Эти статистические данные представляют интерес при совместном использовании со средним значением набора элементов.|  
|Точность прогноза|Оценка, представляющая значимость данного элемента во всем наборе элементов. Точность прогноза вычисляется путем деления вероятности совместного появления двух элементов на вероятность их появления независимо друг от друга. Вследствие этого, если между элементами присутствует сильная взаимосвязь, оценка точности прогноза будет выше.|  
  
### <a name="shopping-basket-rules-report"></a>Отчет «Правила списка покупок»  
 В данном отчете содержится набор правил, которые были построены при анализе найденных наборов элементов. Например, если данные транзакций показали, что продукты А и Б часто приобретаются вместе, средство анализа покупательского поведения создаст правило, прогнозирующее продукт А при данном присутствии продукта Б или продукт Б при данном присутствии продукта А.  
  
 Каждое правило связывается с вероятностью, полученной из данных несущего множества. Эти вероятности полезны при создании рекомендаций. Например, основываясь на существующих данных, пользователю могут понадобиться только те правила, которые имеют как минимум 50-процентную вероятность точности.  
  
 Найденные наборы элементов перечисляются в отчете в порядке их точности прогноза. Точность прогноза — это оценка, показывающая важность набора элементов.  
  
|Столбец отчета|Содержание|  
|----------------------|-----------------------|  
|Существующие элементы|Перечисляются элементы, необходимые для создания рекомендации.<br /><br /> В интеллектуальном анализе данных говорят, что эти элементы находятся в *левой* части правила взаимосвязи.|  
|Спрогнозированный элемент|Перечисляет элемент, который следует рекомендовать.<br /><br /> В интеллектуальном анализе данных говорят, что эти элементы находятся в *правой* части правила взаимосвязей.|  
|Вероятность|Отображает вероятность правильности данного правила.|  
|Поддержка|Указывает количество вариантов в существующих данных, предоставляющих доказательства верности данного правила.|  
|Значение правила|Если для элементов в списке покупок были предоставлены значения, данный столбец вычисляет стоимость прогноза, исходя из стоимости элементов.|  
|Точность прогноза|Показывает интенсивность корреляции между элементами в первом столбце и элементами во втором столбце. Также называется *важностью*.<br /><br /> Значение точности прогноза 0 означает, что корреляции не существует. Положительное значение свидетельствует о том, что элементы в первом столбце прогнозируют элемент во втором. Чем больше число, тем сильнее корреляция.|  
  
## <a name="related-tools"></a>Дополнительные средства  
 Клиент интеллектуального анализа данных для Excel, который является отдельной надстройкой, обеспечивающей расширенную функциональность интеллектуального анализа данных, также содержит мастер, выполняющий анализ взаимосвязей. Дополнительные сведения см. в разделе [Мастер связывания &#40;клиент интеллектуального анализа данных для Excel&#41;](associate-wizard-data-mining-client-for-excel.md).  
  
 Дополнительные сведения об алгоритме, используемом для проведения анализа, см. в разделе «Алгоритм взаимосвязей (Майкрософт)» электронной документации по SQL Server.  
  
## <a name="see-also"></a>См. также:  
 [Средства анализа таблиц для Excel](table-analysis-tools-for-excel.md)  
  
  
