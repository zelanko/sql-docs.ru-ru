---
title: Подключение к базе данных табличной модели (SSAS) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 983d0c8a-77da-4c6e-8638-283bcb14f143
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4685dc65c860776143f25f4299a62427adfcb31f
ms.sourcegitcommit: 9ee72c507ab447ac69014a7eea4e43523a0a3ec4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2020
ms.locfileid: "84939895"
---
# <a name="connect-to-a-tabular-model-database-ssas"></a>Соединение с табличным шаблоном баз данных (SSAS)
  После создания табличной модели и развертывания ее на сервере служб Analysis Services в табличном режиме необходимо задать разрешения, которые сделают ее доступной для клиентских приложений. В этом разделе приводятся объяснения по поводу разрешений и того, как подключаться к базе данных из клиентских приложений.  
  
> [!NOTE]  
>  По умолчанию удаленные подключения к службам Analysis Services недоступны до настройки брандмауэра. Убедитесь, что был открыт соответствующий порт, если настраивается именованный экземпляр для клиентских подключений или экземпляр по умолчанию. Дополнительные сведения см. в статье [Configure the Windows Firewall to Allow Analysis Services Access](../instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).  
  
 В этом разделе содержатся следующие подразделы.  
  
 [Разрешения пользователя в базе данных](#bkmk_userpermissions)  
  
 [Административные разрешения на сервере](#bkmk_admin)  
  
 [Соединение из Excel или SharePoint](#bkmk_excelconn)  
  
 [Устранение неполадок подключения](#bkmk_Tshoot)  
  
##  <a name="user-permissions-on-the-database"></a><a name="bkmk_userpermissions"></a>Разрешения пользователя на базу данных  
 Пользователи, подключающиеся к табличным базам данных, должны иметь членство в роли базы данных с доступом «Чтение».  
  
 Роли и иногда членство в роли определяются при создании модели в среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]или для развернутых моделей с помощью [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]. Дополнительные сведения о создании ролей с помощью диспетчера ролей в [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] см. в разделе [Создание ролей и управление ими (табличные службы SSAS)](roles-ssas-tabular.md). Дополнительные сведения о создании ролей и управлении ими для развернутой модели см. в разделе [Роли табличных моделей (табличные службы SSAS)](tabular-model-roles-ssas-tabular.md).  
  
> [!CAUTION]  
>  Повторное развертывание проекта табличной модели с ролями, определенными с помощью диспетчера ролей в среде [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] , приводит к перезаписи ролей, определенных в развернутой табличной модели.  
  
##  <a name="administrative-permissions-on-the-server"></a><a name="bkmk_admin"></a> Административные разрешения на сервере  
 Для организаций, использующих SharePoint для размещения книг Excel или отчетов служб Reporting Services, требуется дополнительная настройка, обеспечивающая доступность данных табличной модели для пользователей SharePoint. Если SharePoint не используется, пропустите этот раздел.  
  
 Для просмотра книг Excel или отчетов [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] , содержащих табличные данные, требуется, чтобы учетная запись, под которой запущены службы Excel или Reporting Services, имела административные разрешения на экземпляре Analysis Services. Административные разрешения требуются для того, чтобы эти службы были доверенными для экземпляра служб Analysis Services.  
  
#### <a name="grant-administrative-access-on-the-server"></a>Предоставление административного доступа на сервере  
  
1.  В центре администрирования откройте страницу «Настройка учетных записей служб».  
  
2.  Выберите пул приложений служб, используемый службами Excel. Он может **обслуживать пул приложений — систему веб-служб SharePoint** или пользовательский пул приложений. На странице появится управляемая учетная запись, используемая службами Excel.  
  
     Для ферм SharePoint, включающих службы Reporting Services в режиме SharePoint, следует также получить сведения об учетной записи для приложения служб Reporting Services.  
  
     В следующих шагах эти учетные записи будут добавлены к роли сервера на экземпляре служб Analysis Services.  
  
3.  В среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]подключитесь к экземпляру [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], щелкните правой кнопкой мыши экземпляр сервера и выберите пункт **Свойства**. В обозревателе объектов щелкните правой кнопкой мыши пункт **Роли** и выберите команду **Создать роль**.  
  
4.  На странице «Свойства служб Analysis Services» щелкните **Безопасность**.  
  
5.  Нажмите кнопку **Добавить**и введите имя учетной записи, используемой службами Excel, а затем имя учетной записи, используемой службами Reporting Services.  
  
##  <a name="connecting-from-excel-or-sharepoint"></a><a name="bkmk_excelconn"></a>Подключение из Excel или SharePoint  
 Клиентские библиотеки, обеспечивающие доступ к базам данных служб Analysis Services, можно использовать для подключения к шаблону базы данных, который выполняется на сервере в табличном режиме. Это следующие библиотеки: поставщик OLE DB служб Analysis Services, ADOMD.NET и объекты AMO.  
  
 В Excel используется поставщик OLE DB. Если вместе с PowerPivot для Excel версии [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] установлен поставщик MSOLAP.4 из SQL Server 2008 R2 (имя файла msolap100.dll, версия 10.50.1600.1) или MSOLAP.5 (имя файла msolap110.dll), то данная версия способна подключаться к табличным базам данных.  
  
 Выберите один из приведенных ниже способов подключения к шаблонам баз данных из Excel.  
  
-   Создайте подключение к данным из Excel по инструкциям из следующего раздела.  
  
-   Создайте файл соединения BISM в SharePoint, обеспечивающий перенаправление на базу данных, выполняющуюся на сервере служб Analysis Services в табличном режиме. В контекстном меню для файла соединения BISM есть команда, которая запускает Excel, используя базу данных модели, указанную в соединении. Команда также запускает [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] , если установлены службы Reporting Services. Дополнительные сведения о создании и использовании файлов соединения семантической модели бизнес-аналитики (BISM) см. в разделе [Создание соединения семантической модели бизнес-аналитики с табличным шаблоном базы данных](../power-pivot-sharepoint/create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).  
  
-   Создайте источник общих данных служб Reporting Services, обращающийся к табличной базе данных как к источнику данных. Источник общих данных можно создать в SharePoint и использовать его для запуска [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)].  
  
#### <a name="connect-from-excel"></a>Соединение из Excel  
  
1.  В Excel на вкладке **Получение внешних данных** в разделе **Данные**щелкните **Из других источников**.  
  
2.  Выберите **Из служб Analysis Services**.  
  
3.  В поле **Имя сервера**укажите экземпляр служб Analysis Services, на котором размещена база данных. Имя сервера часто совпадает с именем компьютера, на котором выполняется серверное ПО. Если сервер был установлен как именованный экземпляр, необходимо указать имя в следующем формате: \<servername> \\<instanceName \> .  
  
     Экземпляр сервера должен быть настроен для автономного табличного развертывания, и для него должно быть создано правило входящих соединений, разрешающее доступ. Дополнительные сведения см. в статьях [Определение режима работы сервера экземпляра служб Analysis Services](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) и [Настройка брандмауэра Windows на разрешение доступа к службам Analysis Services](../instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).  
  
4.  Для использования учетных данных входа в систему выберите **Проверка подлинности Windows** , если имеется разрешение на чтение данных из базы данных. В противном случае выберите **Использовать следующие имя пользователя и пароль**и введите имя пользователя и пароль учетной записи Windows, имеющей разрешения для базы данных. Щелкните **Далее**.  
  
5.  Выберите базу данных. При правильном выборе появится один куб **Модель** для базы данных. Нажмите кнопку **Далее**, а затем — кнопку **Готово**.  
  
 После успешного соединения данные можно будет использовать для создания сводной таблицы или сводной диаграммы. Дополнительные сведения см. далее в подразделе [Анализ в Excel (табличные службы SSAS)](analyze-in-excel-ssas-tabular.md).  
  
##  <a name="connect-from-sharepoint"></a><a name="bkmk_sharepoint"></a> Соединение из SharePoint  
 При использовании PowerPivot для SharePoint можно создать в SharePoint файл соединения BISM, обеспечивающий перенаправление на базу данных, работающую на сервере служб Analysis Services в табличном режиме. Соединение BISM предоставляет конечную точку HTTP для базы данных. Оно также упрощает доступ к табличной модели специалистам по анализу, которые регулярно используют документы на сайте SharePoint. Специалистам по анализу для доступа к табличному шаблону баз данных нужно знать только расположение файла соединения BISM или его URL-адрес. Подробные сведения о расположении сервера или имени базы данных содержатся в соединении BISM. Дополнительные сведения о создании и использовании файлов соединения семантической модели бизнес-аналитики см. в разделе [соединение семантической модели бизнес-аналитики PowerPivot &#40;. bism&#41;](../power-pivot-sharepoint/power-pivot-bi-semantic-model-connection-bism.md) и [Создание соединения семантической модели бизнес-аналитики с базой данных табличной модели](../power-pivot-sharepoint/create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).  
  
##  <a name="troubleshooting-connection-problems"></a><a name="bkmk_Tshoot"></a>Устранение неполадок подключения  
 В этом разделе указаны причины проблем, возникающих при подключении к базе данных табличной модели, и шаги по их устранению.  
  
 **Мастеру подключения к данным не удается получить список баз данных из указанного источника данных.**  
  
 Во время импорта данных эта ошибка Microsoft Excel возникает при попытке использовать мастер для подключения к базе данных табличной модели на удаленном сервере служб Analysis Services, если нет достаточных разрешений. Чтобы устранить эту ошибку, необходимо иметь пользовательские права доступа к базе данных. См. инструкции по предоставлению пользовательского доступа к данным, приведенные выше в этом разделе.  
  
 **Произошла ошибка при попытке установить соединение с внешним источником данных. Не удалось обновить следующие подключения: \<model name> "песочница"**  
  
 В SharePoint эта ошибка Microsoft Excel возникает при попытке взаимодействия с данными (например, при фильтрации данных) в сводной таблице, использующей данные из модели. Эта ошибка возникает из-за отсутствия достаточных разрешений на удаленном сервере служб Analysis Services. Чтобы устранить эту ошибку, необходимо иметь пользовательские права доступа к базе данных. См. инструкции по предоставлению пользовательского доступа к данным, приведенные выше в этом разделе.  
  
 **Произошла ошибка при попытке выполнить эту операцию. Перезагрузите книгу и попытайтесь выполнить эту операцию еще раз.**  
  
 В SharePoint эта ошибка Microsoft Excel возникает при попытке взаимодействия с данными (например, при фильтрации данных) в сводной таблице, использующей данные из модели. Эта ошибка возникает, поскольку службы Excel не является доверенными для экземпляра служб Analysis Services, на котором развернуты данные из модели. Для устранения этой ошибки предоставьте службам Excel административные разрешения в экземпляре служб Analysis Services. См. инструкции по предоставлению административных разрешений, приведенные выше в этом разделе. Если ошибка повторяется, очистите пул приложений служб Excel.  
  
 **При попытке установить соединение с внешним источником данных, используемым в книге, произошла ошибка.**  
  
 В SharePoint эта ошибка Microsoft Excel возникает при попытке взаимодействия с данными (например, при фильтрации данных) в сводной таблице, использующей данные из модели. Эта ошибка возникает, поскольку пользователь не имеет достаточных разрешений SharePoint на книгу. Пользователь должен иметь разрешения **Чтение** или выше. Разрешений**Только просмотр** недостаточно для доступа к данным.  
  
## <a name="see-also"></a>См. также:  
 [Развертывание решений табличной модели (табличные службы SSAS)](tabular-model-solution-deployment-ssas-tabular.md)  
  
  
