---
title: Вставка, обновление и удаление элементов (XMLA) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- inserting dimension members
- XML for Analysis, members
- removing dimension members
- dropping dimension members
- write-enabled dimensions [Analysis Services]
- XMLA, members
- deleting dimension members
- dimensions [Analysis Services], XML for Analysis
ms.assetid: bba922b5-8b88-4051-9506-ff055248182a
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 98da3e0f7a9b61b178372d9b24b8b595ab6b6626
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "62727168"
---
# <a name="inserting-updating-and-dropping-members-xmla"></a>Вставка, обновление и удаление элементов (XMLA)
  Команды [вставки](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/insert-element-xmla), [обновления](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/update-element-xmla)и [удаления](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/drop-element-xmla) в XML для аналитики (XMLA) можно использовать для вставки, обновления или удаления элементов из измерения, доступного для записи. Дополнительные сведения об измерениях, доступных для записи, см. в разделе [измерения, доступные для записи](../multidimensional-models-olap-logical-dimension-objects/write-enabled-dimensions.md).  
  
## <a name="inserting-new-members"></a>Вставка новых элементов  
 Команда `Insert` вставляет новые элементы в указанные атрибуты в измерение, доступное для записи.  
  
 Перед созданием команды `Insert` для новых вставляемых элементов должна быть доступна следующая информация.  
  
-   Измерение, в которое будут вставлены новые элементы.  
  
-   Атрибут измерения, в которое будут вставлены новые элементы.  
  
-   Имена новых элементов, включая все применимые переводы этих имен.  
  
-   Ключи новых элементов. Если в атрибуте используется составной ключ, для ключа может потребоваться несколько значений.  
  
-   Значения для любых применимых свойств атрибутов, которые не реализованы в виде других атрибутов в измерении. К таким свойствам атрибутов относятся унарные операции, переводы, пользовательские свертки, свойства пользовательских сверток и пропускаемые уровни.  
  
 Команда `Insert` принимает только два свойства.  
  
-   Свойство [объекта](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/object-element-xmla) , содержащее ссылку на объект для измерения, в которое вставляются элементы. Ссылка на объект для измерения содержит идентификатор базы данных, идентификатор куба и идентификатор измерения.  
  
-   Свойство [Attributes](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/attributes-element-xmla) , содержащее один или несколько элементов [атрибута](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/attribute-element-xmla) для указания атрибутов, в которых должны быть вставлены элементы. Каждый элемент `Attribute` определяет атрибут и указывает имя, значение, переводы, унарный оператор, пользовательскую свертку, свойства пользовательской свертки и пропущенные уровни для одного элемента, которые должны быть добавлены к указанному атрибуту.  
  
    > [!NOTE]  
    >  Необходимо включать все свойства для элемента `Attribute`. В противном случае может произойти ошибка.  
  
## <a name="updating-existing-members"></a>Обновление существующих элементов  
 Команда `Update` обновляет существующие элементы в указанных атрибутах на основе связей с другими элементами в других атрибутах в измерении, доступном для записи. Команда `Update` позволяет перемещать элементы на другие уровни в иерархиях, содержащихся в измерении, ее также можно использовать, чтобы реконструировать иерархии типа «родители-потомки», определенные родительскими атрибутами.  
  
 Перед созданием команды `Update` для обновляемых элементов должна быть доступна следующая информация.  
  
-   Измерение, в котором будут обновлены существующие элементы.  
  
-   Атрибуты измерения, в котором будут обновлены существующие элементы.  
  
-   Ключи существующих элементов. Если в атрибуте используется составной ключ, для ключа может потребоваться несколько значений.  
  
-   Значения для любых применимых свойств атрибутов, которые не реализованы в виде других атрибутов в измерении. К таким свойствам атрибутов относятся унарные операции, переводы, пользовательские свертки, свойства пользовательских сверток и пропускаемые уровни.  
  
 Команда `Update` принимает только три обязательных свойства.  
  
-   Свойство `Object`, содержащее ссылку на объект для измерения, в котором необходимо обновить элементы. Ссылка на объект для измерения содержит идентификатор базы данных, идентификатор куба и идентификатор измерения.  
  
-   Свойство `Attributes`, содержащее один или несколько элементов `Attribute` для определения атрибутов, в которых должны быть обновлены элементы. Элемент `Attribute` определяет атрибут и указывает имя, значение, переводы, унарный оператор, пользовательскую свертку, свойства пользовательской свертки и пропущенные уровни для одного элемента, которые должны быть обновлены для указанного атрибута.  
  
    > [!NOTE]  
    >  Необходимо включать все свойства для элемента `Attribute`. В противном случае может произойти ошибка.  
  
-   Свойство [WHERE](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/where-element-xmla) , содержащее один или несколько `Attribute` элементов, которые ограничивают атрибуты, в которых должны обновляться элементы. Свойство `Where` является ключевым для ограничения действия команды `Update` указанными экземплярами элемента. Если `Where` свойство не задано, обновляются все экземпляры данного элемента. Например, есть три клиента, в отношении которых требуется изменить название города с Redmond на Bellevue. Чтобы изменить название города, необходимо задать свойство `Where`, определяющее три элемента атрибута Customer, для которых должны быть изменены элементы атрибута City. Если не задать это свойство `Where`, то после выполнения команды `Update` для каждого клиента, названием города которого в данный момент является Redmond, это название будет изменено на Bellevue.  
  
    > [!NOTE]  
    >  За исключением новых элементов, команда `Update` может обновлять только значения ключей атрибутов для атрибутов, не включенных в предложение `Where`. Например, название города невозможно обновить при обновлении клиента, поскольку в этом случае название города будет изменено для всех клиентов.  
  
### <a name="updating-members-in-parent-attributes"></a>Обновление элементов в родительских атрибутах  
 Для поддержки родительских атрибутов `Update` команда является необязательными свойствами [MoveWithDescendants](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/movewithdescendants-element-xmla)мовевисдесцедантс. Если свойству `MoveWithDescendants` задано значение TRUE, это указывает, что потомки родительского элемента должны быть перемещены вместе с родительским элементом при изменении идентификатора данного родительского элемента. Если этому свойству задано значение FALSE, то при перемещении родительского элемента его непосредственные потомки повышаются до уровня, на котором до этого находился родительский элемент.  
  
 При обновлении элементов в родительском атрибуте команда `Update` не может обновлять элементы в других атрибутах.  
  
## <a name="dropping-existing-members"></a>Удаление существующих элементов  
 Перед созданием команды `Drop` для удаляемых элементов должна быть доступна следующая информация.  
  
-   Измерение, из которого будут удалены существующие элементы.  
  
-   Атрибуты измерения, из которого будут удалены существующие элементы.  
  
-   Ключи существующих элементов, которые будут удалены. Если в атрибуте используется составной ключ, для ключа может потребоваться несколько значений.  
  
 Команда `Drop` принимает только два обязательных свойства.  
  
-   Свойство `Object`, содержащее ссылку на объект для измерения, в котором необходимо удалить элементы. Ссылка на объект для измерения содержит идентификатор базы данных, идентификатор куба и идентификатор измерения.  
  
-   Свойство `Where`, содержащее один или несколько элементов `Attribute` для ограничения атрибутов, из которых должны быть удалены элементы. Свойство `Where` является ключевым для ограничения действия команды `Drop` указанными экземплярами элемента. Если значение свойства `Where` не задано, будут удалены все экземпляры данного элемента. Например, допустим, что в элементе Redmond есть три клиента, которых требуется удалить. Чтобы удалить этих клиентов, необходимо задать свойство `Where`, определяющее три элемента в атрибуте Customer, которые должны быть удалены, а также элемент Redmond атрибута City, из которого должны быть удалены три клиента. Если свойство `Where` указывает только элемент Redmond атрибута City, команда `Drop` удалит всех клиентов, связанных с элементом Redmond. Если свойство `Where` указывает только три элемента в атрибуте Customer, то команда `Drop` удаляет трех этих клиентов полностью.  
  
    > [!NOTE]  
    >  Элементы `Attribute`, включенные в команду `Drop`, должны содержать только свойства `AttributeName` и `Keys`. В противном случае может произойти ошибка.  
  
### <a name="dropping-members-in-parent-attributes"></a>Удаление элементов в родительских атрибутах  
 Установка свойства [DeleteWithDescendants](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/deletewithdescendants-element-xmla) указывает, что потомки родительского элемента также должны быть удалены с родительским элементом. Если этому свойству задано значение FALSE, непосредственные потомки данного родительского элемента не удаляются, а повышаются до уровня, на котором находился родительский элемент.  
  
> [!IMPORTANT]  
>  Чтобы удалить и родительский элемент, и его потомков, пользователю необходимо иметь только разрешения на удаление родительского элемента. Разрешения на удаление потомков иметь не обязательно.  
  
## <a name="see-also"></a>См. также:  
 [Drop элемент &#40;XMLA&#41;](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/drop-element-xmla)   
 [Элемент INSERT &#40;&#41;XMLA](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/insert-element-xmla)   
 [Элемент Update &#40;XMLA&#41;](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/update-element-xmla)   
 [Определение и идентификация объектов &#40;XMLA&#41;](https://docs.microsoft.com/bi-reference/xmla/xml-elements-objects)   
 [Разработка с использованием XMLA в службах Analysis Services](developing-with-xmla-in-analysis-services.md)  
  
  
