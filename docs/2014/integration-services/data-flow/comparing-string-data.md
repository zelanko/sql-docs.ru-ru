---
title: Сравнение строковых данных | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.suite: ''
ms.technology:
- integration-services
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- comparing string data
- comparison options [Integration Services]
- locales [Integration Services]
- converting string data
- string comparisons
ms.assetid: 93aeb5bd-e208-46b7-8979-dea2dcd37d4c
caps.latest.revision: 39
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.openlocfilehash: c5c471942764076ac0c03044d1037c3600e83fc5
ms.sourcegitcommit: c18fadce27f330e1d4f36549414e5c84ba2f46c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2018
ms.locfileid: "37280310"
---
# <a name="comparing-string-data"></a>сравнение строковых данных
  Сравнения строк — важная составляющая любого преобразования, которое выполняется с помощью служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]. Кроме того, они применяются для вычисления выражений в переменных и выражениях свойств. Например, при преобразовании «Сортировка» сравниваются значения в наборе данных для сортировки данных по возрастанию или по убыванию.  
  
## <a name="configuring-transformations-for-string-comparisons"></a>Настройка преобразований для сравнений строк  
 Для таких преобразований, как «Сортировка», «Выполнение статистического вычисления», «Нечеткое группирование» и «Нечеткий уточняющий запрос», можно настраивать различные способы сравнения строк на уровне столбца. Например, можно указать, что сравнение нечувствительно к регистру. Это означает, что символы в верхнем и нижнем регистре будут считаться одинаковыми.  
  
 Приведенные ниже преобразования используют выражения, в которых могут быть строковые сравнения.  
  
-   Преобразование «Условное разбиение» с помощью сравнений строк в выражениях может определять, в какой выход следует отправлять строки данных. Дополнительные сведения см. в разделе [Conditional Split Transformation](transformations/conditional-split-transformation.md).  
  
-   Преобразование «Производный столбец» с помощью строковых сравнений в выражениях может формировать новые значения столбцов. Дополнительные сведения см. в статье [Преобразование «Производный столбец»](transformations/derived-column-transformation.md).  
  
 Кроме того, выражения со строковыми сравнениями можно применять в переменных, сопоставлении переменных, а также в элементах управления очередностью. Дополнительные сведения о выражениях см. в разделе [Выражения служб Integration Services (SSIS)](../expressions/integration-services-ssis-expressions.md).  
  
## <a name="processing-during-string-comparison"></a>Обработка в ходе сравнения строк  
 В зависимости от характера данных и конфигурации преобразования при сравнении строковых данных может происходить следующая обработка:  
  
-   Преобразование данных в Юникод. Если в источнике данных не использована кодировка Юникод, то данные автоматически преобразуются в Юникод до начала сравнения.  
  
-   Использование локаля для применения правил конкретных локалей при интерпретации даты, времени, десятичных данных и порядка сортировки.  
  
-   Применение параметров сравнения на уровне столбца для изменения чувствительности сравнений.  
  
## <a name="converting-string-data-to-unicode"></a>Преобразование строковых данных в Юникод  
 В зависимости от операций, которые выполняет преобразование, и конфигурации преобразования строковые данные могут преобразовываться в тип данных DT_WSTR, посредством которого строковые символы представляются в формате Юникод.  
  
 Строковые данные, имеющие тип данных DT_STR, преобразуются в Юникод с использованием кодовой страницы столбца. [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] поддерживают кодовые страницы на уровне столбцов; каждый столбец может быть преобразован с использованием отдельной кодовой страницы.  
  
 Обычно службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] могут самостоятельно определить правильную кодовую страницу по источнику данных. Например, в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] можно настроить параметры сортировки для уровня базы данных и уровня столбца. Кодовая страница является производной от параметров сортировки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которые могут быть либо параметрами сортировки Windows, либо параметрами сортировки SQL.  
  
 Если службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] выдают непредвиденную кодовую таблицу или если пакет подключается к источнику данных с помощью поставщика, который не предоставил данных для определения правильной кодовой страницы, то можно указать кодовую страницу по умолчанию в источнике и назначении OLE DB. Кодовая страница по умолчанию используется вместо кодовых страниц, указанных в службах [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .  
  
 У файлов нет кодовых страниц. Вместо этого в диспетчере соединений одного или нескольких неструктурированных файлов, с помощью которого пакет подключается к данным в файле, предусмотрено свойство, указывающее кодовую страницу для файла. Кодовую страницу можно задавать только на уровне файла, но не на уровне столбца.  
  
## <a name="setting-locale"></a>Настройка локалей  
 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] не применяют кодовые страницы при определении правил, зависящих от языкового стандарта, для сортировки данных или интерпретации даты, времени и десятичных данных. Вместо этого преобразование считывает языковой стандарт, заданный в свойстве LocaleId компонента потока данных, задачи потока данных, контейнера или пакета. По умолчанию локаль преобразования наследуется от задачи потока данных, которая в свою очередь наследует его от пакета. Если задача потока данных находится в контейнере, например в контейнере «цикл по элементам», то она наследует локаль от контейнера.  
  
 Кроме того, можно указывать локаль для диспетчеров соединений с одним или несколькими неструктурированными файлами.  
  
## <a name="setting-comparison-options"></a>Настройка параметров сравнения  
 Локаль содержит основные правила сравнения строковых данных. Например, локаль определяет положение сортировки каждой буквы в алфавите. Тем не менее этих правил может быть недостаточно для сравнений, выполняемых некоторыми преобразованиями, и службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] поддерживают набор расширенных параметров сравнения, которых нет среди основных правил локали. Эти параметры сравнения задаются на уровне столбца. Например, один из параметров сравнения позволяет игнорировать непробельные символы. Он позволяет не учитывать при сравнении диакритические знаки, в результате чего символы «a» и «á» при сравнении будут идентичны.  
  
 В приведенной ниже таблице описаны параметры сравнения и стиль сортировки.  
  
|Параметр сравнения|Описание|  
|-----------------------|-----------------|  
|Игнорировать регистр|Указывает, следует ли при сравнении различать символы в верхнем и нижнем регистре. Если параметр задан, то строковое сравнение игнорирует регистр. Например, «ABC» при сравнении не отличается от «abc».|  
|Игнорируется тип японской азбуки|Указывает, следует ли различать при сравнении два типа символов японской азбуки: хирагана и катакана. Если параметр задан, то строковое сравнение игнорирует тип японской азбуки.|  
|Игнорировать ширину символа|Указывает, следует ли при сравнении различать однобайтовые символы или аналогичные двухбайтовые символы. Если параметр задан, то строковое сравнение рассматривает однобайтовое и двухбайтовое представления символа как один и тот же символ.|  
|Игнорировать непробельные символы|Указывает, следует ли при сравнении различать обычные символы и символы с диакритическими знаками. Если параметр задан, то строковое сравнение не учитывает диакритические знаки. Например, буква «a» с любыми диакритическими знаками будет считаться обычной буквой «a».|  
|Не учитывать символы|Указывает, следует ли различать буквенные символы и такие символы, как пробелы, знаки пунктуации, знаки валют, а также математические символы. Если параметр задан, то строковое сравнение игнорирует символы. Например, « Москва» не отличается от «Москва», а «ABC» не отличается от «ABC'».|  
|Сортировать знаки пунктуации как символы|Указывает, следует ли располагать все знаки пунктуации, кроме дефиса и апострофа, перед буквенно-цифровыми символами. Например, если параметр задан, то «.ABC» оказывается перед «ABC».|  
  
 Для сравнения данных эти параметры используют преобразования «Сортировка», «Выполнение статистического вычисления», «Нечеткое группирование» и «Нечеткий уточняющий запрос».  
  
 Флаг сравнения **FullySensitive** отображается в диалоговом окне **Расширенный редактор** для преобразований «Нечеткое группирование» и «Нечеткий уточняющий запрос». Если установлен флаг сравнения **FullySensitive** , то применяются все параметры сравнения.  
  
## <a name="see-also"></a>См. также  
 [Типы данных служб Integration Services](integration-services-data-types.md)   
 [Быстрый синтаксический анализ](../fast-parse.md)   
 [Стандартный синтаксический анализ](../standard-parse.md)  
  
  
