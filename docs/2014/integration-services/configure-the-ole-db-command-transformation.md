---
title: Настройка преобразования «Команда OLE DB» | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- parameters [Integration Services]
- OLE DB Command transformation
ms.assetid: c800f167-3d2e-4c10-8ba3-a02f1872ccea
author: janinezhang
ms.author: janinez
ms.openlocfilehash: 8f6f14d93e840b9a206e0b5261eb9efade0f0e28
ms.sourcegitcommit: 9ee72c507ab447ac69014a7eea4e43523a0a3ec4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2020
ms.locfileid: "84921511"
---
# <a name="configure-the-ole-db-command-transformation"></a>настроить преобразование «Команда OLE DB»
  Для добавления и настройки преобразования «Команда OLE DB» пакет должен уже содержать по меньшей мере одну задачу потока данных и такой источник, как источник неструктурированного файла или источник OLE DB. Преобразование обычно используется для выполнения параметризованных запросов.  
  
### <a name="to-configure-the-ole-db-command-transformation"></a>Настройка преобразования «Команда OLE DB»  
  
1.  В среде [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)]откройте проект служб [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] , содержащий необходимый пакет.  
  
2.  Чтобы открыть пакет, дважды щелкните его в обозревателе решений.  
  
3.  Перейдите на вкладку **Поток данных** , затем из **области элементов**переместите преобразование «Команда OLE DB» в область конструктора.  
  
4.  Подключите преобразование "Команда OLE DB" к потоку данных, перетащив соединитель — зеленую или красную стрелку — из источника данных или из предыдущего преобразования в преобразование "Команда OLE DB".  
  
5.  Щелкните правой кнопкой мыши компонент и выберите редактировать или показать **Расширенный редактор**.  
  
6.  На вкладке **Диспетчеры соединений** выберите диспетчер соединений OLE DB в списке **Диспетчер соединений** . Дополнительные сведения см. в разделе [Диспетчер соединений OLE DB](connection-manager/ole-db-connection-manager.md).  
  
7.  Перейдите на вкладку **Свойства компонентов** и нажмите кнопку с многоточием **(…)** в поле **SqlCommand**.  
  
8.  В **редакторе строковых значений**введите параметризованную инструкцию SQL, используя знак вопроса (?) в качестве маркера параметра для каждого параметра.  
  
9. Нажмите кнопку **Обновить**. При нажатии кнопки **Обновить**преобразование создает столбец для каждого параметра в коллекции "Внешние столбцы" и устанавливает свойство DBParamInfoFlags.  
  
10. Щелкните вкладку **Свойства входов и выходов** .  
  
11. Раскройте **Вход команды OLE DB**, затем раскройте коллекцию **Внешние столбцы**.  
  
12. Проверьте, что в коллекции **Внешние столбцы** перечисляются столбцы для всех параметров инструкции SQL. Столбцы имеют имена **Param_0**, **Param_1**и т. д.  
  
     Не изменяйте имена столбцов. Если изменить имена столбцов, службы [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] сформирует ошибку проверки правильности для трансформации команды OLE DB.  
  
     Не изменяйте и тип данных. Свойство DataType в каждом столбце устанавливается в соответствии с правильным типом данных.  
  
13. Если в списке **Внешние столбцы** нет ни одного столбца, введите их вручную.  
  
    -   Щелкните **Добавить столбец** один раз для каждого параметра в инструкции SQL.  
  
    -   Переименуйте столбцы в **Param_0**, **Param_1**и т. д.  
  
    -   Укажите значение в свойстве DBParamInfoFlags. Значение должно соответствовать значению перечисления OLE DB DBPARAMFLAGSENUM. Дополнительные сведения см. в справочной документации по OLE DB.  
  
    -   Задайте тип данных столбца и в зависимости от типа данных задайте кодовую страницу, длину, точность и масштаб столбца.  
  
    -   Чтобы удалить неиспользуемый параметр, выберите параметр в коллекции **Внешние столбцы**, затем щелкните **Удалить столбец**.  
  
    -   Щелкните **Сопоставления столбцов** и сопоставьте столбцы в списке **Входные столбцы** с параметрами в списке **Доступные целевые столбцы** .  
  
14. Нажмите кнопку **ОК**.  
  
15. Чтобы сохранить обновленный пакет, щелкните **Сохранить** в меню **Файл** .  
  
## <a name="see-also"></a>См. также:  
 [Преобразование «OLE DB команда»](data-flow/transformations/ole-db-command-transformation.md)   
 [Преобразования Integration Services](data-flow/transformations/integration-services-transformations.md)   
 [Пути Integration Services](data-flow/integration-services-paths.md)   
 [Задача потока данных](control-flow/data-flow-task.md)  
  
  
