---
title: Задание интервала для информации об изменениях данных | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.suite: ''
ms.technology:
- integration-services
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- incremental load [Integration Services],specifying interval
ms.assetid: 17899078-8ba3-4f40-8769-e9837dc3ec60
caps.latest.revision: 30
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.openlocfilehash: 9ecc113b3ed38461a277996497f73bca7cd83a4a
ms.sourcegitcommit: c18fadce27f330e1d4f36549414e5c84ba2f46c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2018
ms.locfileid: "37267240"
---
# <a name="specify-an-interval-of-change-data"></a>Задание интервала для информации об изменениях данных
  Первой задачей в потоке управления пакета служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , который выполняет добавочную загрузку информации об измененных данных, является вычисление конечных точек интервала изменений. Эти конечные точки имеют `datetime` значения и сохраняются в переменных пакета для дальнейшего использования в пакете.  
  
> [!NOTE]  
>  Описание общего процесса по проектированию потока управления см. в разделе [Система отслеживания измененных данных (SSIS)](change-data-capture-ssis.md).  
  
## <a name="set-up-package-variables-for-the-endpoints"></a>Настройка переменных пакета для конечных точек  
 Прежде чем настраивать задачи «Выполнение SQL» для вычисления конечных точек, необходимо определить переменные пакета, в которых будут храниться конечные точки.  
  
#### <a name="to-set-up-package-variables"></a>Настройка переменных пакета  
  
1.  В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]откройте новый проект служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .  
  
2.  В окне **Переменные** создайте следующие переменные:  
  
    1.  Создайте переменную с `datetime` тип данных для хранения начальной точки интервала.  
  
         В этом примере используется имя переменной ExtractStartTime.  
  
    2.  Создайте переменную с `datetime` тип данных для хранения конечной точки интервала.  
  
         В этом примере используется имя переменной ExtractEndTime.  
  
 Если конечные точки вычисляются в главном пакете, который управляет несколькими дочерними пакетами, можно использовать конфигурации переменных родительского пакета, чтобы передать значения этих переменных каждому дочернему пакету. Дополнительные сведения см. в разделах [Задача "Выполнение пакета"](../control-flow/execute-package-task.md) и [Использование значений переменных и параметров в дочернем пакете](../use-the-values-of-variables-and-parameters-in-a-child-package.md).  
  
## <a name="calculate-a-starting-point-and-an-ending-point-for-change-data"></a>Вычисление начальной и конечной точек для измененных данных  
 Когда переменные пакета для конечных точек интервала настроены, можно вычислить фактические значения конечных точек и сопоставить эти значения с соответствующими переменными пакета. Поскольку конечные точки имеют значения `datetime`, необходимо использовать функции, поддерживающие вычисление или обработку значений `datetime`. Оба [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] язык выражений и Transact-SQL имеют функции, работающие с `datetime` значения:  
  
 Функции в [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] язык выражений, которые работают с `datetime` значения  
 -   [DATEADD &#40;выражение служб SSIS&#41;](../expressions/dateadd-ssis-expression.md)  
  
-   [DATEDIFF &#40;выражение служб SSIS&#41;](../expressions/datediff-ssis-expression.md)  
  
-   [DATEPART &#40;выражение служб SSIS&#41;](../expressions/datepart-ssis-expression.md)  
  
-   [ДЕНЬ &#40;выражение служб SSIS&#41;](../expressions/day-ssis-expression.md)  
  
-   [GETDATE &#40;выражение служб SSIS&#41;](../expressions/getdate-ssis-expression.md)  
  
-   [GETUTCDATE &#40;выражение служб SSIS&#41;](../expressions/getutcdate-ssis-expression.md)  
  
-   [МЕСЯЦ &#40;выражение служб SSIS&#41;](../expressions/month-ssis-expression.md)  
  
-   [ГОД &#40;выражение служб SSIS&#41;](../expressions/year-ssis-expression.md)  
  
 Функции Transact-SQL, работающие с `datetime` значения  
 [Типы данных и функции даты и времени (Transact-SQL)](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql).  
  
 Прежде чем использовать какую-либо из этих функций `datetime` для вычисления конечных точек, необходимо определить, является ли интервал фиксированным и регулярно повторяющимся. Обычно требуется регулярное применение изменений, произошедших в исходных таблицах, к целевым таблицам. Например, эти изменения могут применяться каждый час, ежедневно или еженедельно.  
  
 Когда характер интервала изменений установлен (фиксированный или случайный), можно вычислять конечные точки.  
  
-   **Вычисление начальной даты и времени**. В качестве текущей начальной даты и времени используется конечная дата и время предыдущей загрузки. Если для добавочных загрузок используется фиксированный интервал, значение можно вычислить с помощью `datetime` функции Transact-SQL или из [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] языка выражений. В других случаях иногда приходится сохранять конечные точки между выполнениями и использовать задачи «Выполнение SQL» или «Скрипт» для загрузки предыдущей конечной точки.  
  
-   **Вычисление конечной даты и времени**. Если для добавочной загрузки используется фиксированный интервал, текущая конечная дата и время вычисляются как смещение относительно начальной даты и времени. Опять же, это значение можно вычислить с помощью `datetime` функции Transact-SQL или из [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] языка выражений.  
  
 В следующей процедуре используется фиксированный интервал изменений и предполагается, что пакет добавочной загрузки выполняется ежедневно без каких-либо исключений. Иначе информация об измененных данных за пропущенные интервалы будет потеряна. Начальной точкой интервала является полночь позавчерашнего дня, т. е. от 24 до 48 часов назад. Конечной точкой интервала является полночь вчерашнего дня, т. е. прошлая ночь, от 0 до 24 часов назад.  
  
#### <a name="to-calculate-the-starting-point-and-ending-point-for-the-capture-interval"></a>Вычисление начальной и конечной точек интервала отслеживания  
  
1.  На вкладке **Поток управления** в конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] добавьте в пакет задачу «Выполнение SQL».  
  
2.  Откройте **Редактор задачи «Выполнение SQL»** и на странице **Общие** выберите следующие параметры:  
  
    1.  Для параметра **ResultSet**выберите значение **Одна строка**.  
  
    2.  Настройте допустимое соединение с базой данных-источником.  
  
    3.  Для параметра **SQLSourceType**выберите значение **Прямой ввод**.  
  
    4.  В поле **SQLStatement**введите приведенную ниже инструкцию SQL:  
  
        ```  
        SELECT DATEADD(dd,0, DATEDIFF(dd,0,GETDATE()-1)) AS ExtractStartTime,  
          DATEADD(dd,0, DATEDIFF(dd,0,GETDATE())) AS ExtractEndTime  
  
        ```  
  
3.  На странице **Результирующий набор** **Редактора задачи «Выполнение SQL»** сопоставьте результат ExtractStartTime с переменной ExtractStartTime пакета, а результат ExtractEndTime — с переменной ExtractEndTime пакета.  
  
    > [!NOTE]  
    >  Если для установки значения переменной служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] используется выражение, это выражение вычисляется при каждом обращении к значению переменной.  
  
## <a name="next-step"></a>Следующий шаг  
 После вычисления начальной и конечной точек диапазона изменений необходимо определить, готовы ли измененные данные.  
  
 **Следующий раздел:** [Определение готовности информации об изменениях данных](determine-whether-the-change-data-is-ready.md)  
  
## <a name="see-also"></a>См. также  
 [Использование переменных в пакетах](../use-variables-in-packages.md)   
 [Выражения служб Integration Services (SSIS)](../expressions/integration-services-ssis-expressions.md)   
 [Задача "Выполнение SQL"](../control-flow/execute-sql-task.md)   
 [Задача «Скрипт»](../control-flow/script-task.md)  
  
  
