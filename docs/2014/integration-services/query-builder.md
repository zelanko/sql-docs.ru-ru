---
title: конструктор запросов | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.querybuilder.f1
helpviewer_keywords:
- Query Builder dialog box
ms.assetid: 780752c9-6e3c-4f44-aaff-4f4d5e5a45c5
author: janinezhang
ms.author: janinez
manager: craigg
ms.openlocfilehash: 1880ceffb03389bc87ee8f25d1817a5e4f593566
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "66056635"
---
# <a name="query-builder"></a>Построитель запросов
  Используйте диалоговое окно **Построитель запросов** , чтобы создать запрос для использования в задаче «Выполнение SQL», в источнике и цели OLE DB, а также в преобразовании «Уточняющий запрос».  
  
 Построитель запросов можно использовать для выполнения следующих задач.  
  
-   **Работа с графическим представлением запроса или с командами SQL** Конструктор запросов содержит панель, которая отображает запрос в графическом виде, и панель, в которой отображается текст SQL запроса. Можно работать либо в графической, либо в текстовой панели. Построитель запросов синхронизирует представления, так что они всегда отражают текущее состояние.  
  
-   **Соединение связанных таблиц** Если в запрос добавляется более одной таблицы, конструктор запросов автоматически определяет, как взаимосвязаны таблицы, и конструирует соответствующую команду JOIN.  
  
-   **Запрос или обновление баз данных** Конструктор запросов можно использовать для возврата данных с помощью инструкций Transact-SQL SELECT и для создания запросов, которые обновляют, добавляют или удаляют записи в базе данных.  
  
-   **Немедленное Просмотр и изменение результатов** Можно выполнить запрос и работать с набором записей в сетке, позволяющей прокручивать и изменять записи в базе данных.  
  
 Графические средства в диалоговом окне **Построитель запросов** позволяют создавать запросы с помощью операций перетаскивания. По умолчанию в диалоговом окне построителя запросов строятся запросы SELECT, также можно строить запросы INSERT, UPDATE или DELETE. Все типы инструкций SQL также могут быть проанализированы и выполнены в диалоговом окне **Построитель запросов** . Дополнительные сведения об инструкциях SQL в пакетах см. в разделе [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).  
  
 Для более подробного знакомства с языком Transact-SQL и его синтаксисом см. раздел [Справочник по Transact-SQL (компонент Database Engine)](/sql/t-sql/language-reference).  
  
 Кроме того, в запросе можно использовать переменные для предоставления значений входному параметру, для сбора значений выходных параметров и хранения кодов возврата. Дополнительные сведения об использовании переменных в запросах пакетов см. в разделах [Задача "Выполнение SQL"](control-flow/execute-sql-task.md), [Источник OLE DB](data-flow/ole-db-source.md)и [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md). Дополнительные сведения об использовании переменных в задаче "Выполнение SQL" см. в разделах [Параметры и коды возврата в задаче "Выполнение SQL"](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) и [Результирующие наборы в задаче "Выполнение SQL"](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).  
  
 Переменные с параметрами и кодами возврата используются в преобразованиях «Уточняющий запрос» и «Нечеткий уточняющий запрос». Сведения об источнике OLE DB применимы к этим двум преобразованиям.  
  
## <a name="options"></a>Параметры  
 **Панель инструментов**  
 Используйте панель инструментов для управления наборами данных, для выбора отображаемых областей, а также для управления функциями запросов.  
  
|Значение|Description|  
|-----------|-----------------|  
|**Показать/скрыть панель диаграмм**|Показывает или скрывает панель **диаграммы** .|  
|**Показать/скрыть панель сетки**|Показывает или скрывает панель **сетки** .|  
|**Показать/скрыть панель SQL**|Показывает или скрывает панель **SQL** .|  
|**Показать/скрыть панель результатов**|Показывает или скрывает панель **Результаты** .|  
|**Run (Запустить)**|Выполняет запрос. Результаты отображаются на панели результатов.|  
|**Проверить SQL**|Осуществляет проверку допустимости инструкции SQL.|  
|**Сортировка по возрастанию**|Сортирует по возрастанию выходные строки в выбранном столбце на панели сетки.|  
|**Сортировка по убыванию**|Сортирует по убыванию выходные строки в выбранном столбце на панели сетки.|  
|**Удалить фильтр**|Выберите имя столбца на панели сетки, а затем нажмите кнопку **Удалить фильтр** , чтобы удалить критерии сортировки для столбца.|  
|**Использовать Group By**|Добавляет к запросу функцию GROUP BY.|  
|**Добавить таблицу**|Добавляет новую таблицу в запрос.|  
  
 **Определение запроса**  
 Определение запроса предлагает панель инструментов и набор других областей, при помощи которых можно определить и проверить запрос.  
  
|Панель|Description|  
|----------|-----------------|  
|Панель **диаграммы**|Отображает запрос в виде диаграммы. Диаграмма показывает включенные в запрос таблицы, а также способы их соединения. Установите или снимите флажок рядом со столбцом в таблице, чтобы добавить или исключить его из результатов запроса.<br /><br /> При добавлении таблиц в запрос построитель запросов создает соединения между таблицами на основе ключей в таблице. Чтобы добавить соединение, перетащите поле одной таблицы на поле другой таблицы. Для управления соединением щелкните его правой кнопкой мыши, а затем выберите пункт в меню.<br /><br /> Щелкните правой кнопкой мыши **Панель диаграмм** , чтобы добавить или удалить таблицы, выбрать все таблицы и отобразить или скрыть области.|  
|Панель **сетки**|Отображает запрос в виде сетки. Можно использовать эту панель, чтобы добавить или удалить столбцы из запроса и изменить настройки для каждого столбца.|  
|Панель **SQL**|Отображает запрос в виде текста SQL. Изменения, совершенные на панели **Диаграмма** и на панели **Сетка** отобразятся здесь, а изменения, совершенные здесь, будут отображены на панели **Диаграмма** и на панели **Сетка** .|  
|Панель **результатов**|Отображает результаты запроса после нажатия кнопки **Выполнить** на панели инструментов.|  
  
## <a name="see-also"></a>См. также:  
 [Задача «Выполнение SQL»](control-flow/execute-sql-task.md)   
 [Источник OLE DB](data-flow/ole-db-source.md)   
 [Назначение OLE DB](data-flow/ole-db-destination.md)   
 [Преобразование «Уточняющий запрос»](data-flow/transformations/lookup-transformation.md)   
 [Запросы&#41; Integration Services &#40;SSIS](integration-services-ssis-queries.md)   
 [Предложение MERGE в пакетах служб Integration Services](control-flow/merge-in-integration-services-packages.md)  
  
  
