---
title: TOKEN (выражение служб SSIS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: 9fdd06bf-5bc9-445c-95bf-709e0ca5989b
author: janinezhang
ms.author: janinez
manager: craigg
ms.openlocfilehash: af82c187fce638ddd1f28ab98a5109898f7cad25
ms.sourcegitcommit: 6fd8c1914de4c7ac24900fe388ecc7883c740077
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2020
ms.locfileid: "62768710"
---
# <a name="token--ssis-expression"></a>TOKEN (выражение служб SSIS)
  Возвращает токен (подстроку) из строки с учетом заданных разделителей токенов строки и номера токена, определяющего, какой токен следует возвратить.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
TOKEN(character_expression, delimiter_string, occurrence)  
```  
  
## <a name="arguments"></a>Аргументы  
 *character_expression*  
 Строка, содержащая токены, разделенные соответствующими символами.  
  
 *delimiter_string*  
 Строка, содержащая символы разделения. Например, строка "; ," содержит три символа разделения: точку с запятой, пробел и запятую.  
  
 *occurrence*  
 Целое число со знаком или без знака, указывающее возвращаемый токен. Например, если для параметра указать значение 3, из строки будет возвращен третий токен.  
  
## <a name="result-types"></a>Типы результата  
 DT_WSTR  
  
## <a name="remarks"></a>Remarks  
 Эта функция разделяет строку <character_expression> на набор токенов, разделенных символами, которые заданы в строке <delimiter_string>, а затем возвращает токен N, где N — это порядковый номер токена, заданный параметром \<occurrence>. Примеры использования этой функции см. в разделе «Примеры».  
  
 Следующие примечания относятся к функции TOKEN.  
  
-   Строка разделения может содержать один или несколько символов разделения.  
  
-   Если значение параметра \<occurrence> больше общего числа токенов в строке, функция возвратит значение NULL.  
  
-   Первые разделители пропускаются.  
  
-   Функция TOKEN работает только с типом данных DT_WSTR. Аргумент *character_expression* , являющийся строковым литералом или столбцом данных с типом данных DT_STR, неявно приведен к типу данных DT_WSTR до выполнения функции TOKEN. Прочие типы данных должны быть явно приведены к типу данных DT_WSTR.  
  
-   Функция TOKEN возвращает значение NULL, если строка character_expression имеет значение NULL.  
  
-   Переменные и столбцы могут использоваться в качестве значений всех аргументов в выражении.  
  
## <a name="expression-examples"></a>Примеры выражений  
 В следующем примере функция TOKEN возвращает значение «a». Строка "a little white dog" состоит из 4 токенов: "a", "little", "white" и "dog", разделенных символом " " (символ пробела). Второй аргумент — строка разделителя, задает только один разделитель, символ пробела, который используется для разбития входной строки на токены. Последний аргумент — 1, указывает, что возвращаться должен первый токен. В этом образце строки первый токен — "а".  
  
```  
TOKEN("a little white dog"," ",1)  
```  
  
 В следующем примере функция TOKEN возвращает значение «dog». Строка разделителя в этом примере содержит 5 разделителей. Входная строка содержит 4 токена: "a", "little", "white", "dog".  
  
```  
TOKEN("a:little|white dog","| ,.:",4)  
```  
  
 В следующем примере функция TOKEN возвращает «» (пустая строка) потому, что в строке нет 99 токенов.  
  
```  
TOKEN("a little white dog"," ",99)  
```  
  
 В следующем примере функция TOKEN возвращает полную строку. Функция выполняет синтаксический анализ входной строки на предмет разделителей, и, поскольку их в строке нет, добавляет всю строку как первый токен.  
  
```  
TOKEN("a little white dog","|",1)  
```  
  
 В следующем примере функция TOKEN возвращает значение «a». Функция пропускает все пробелы в начале строки.  
  
```  
TOKEN("        a little white dog", " ", 1)  
```  
  
 В следующем примере функция TOKEN возвращает год из строки даты.  
  
```  
TOKEN("2009/01/01", "/"), 1  
```  
  
 В следующем примере функция TOKEN возвращает имя файла из указанного пути. Например, если значение параметра User::Path равно "c:\program files\data\myfile.txt", функция TOKEN возвращает строку "myfile.txt". Функция TOKENCOUNT возвращает 4, а функция TOKEN возвращает четвертый токен — "myfile.txt".  
  
```  
TOKEN(@[User::Path], "\\", TOKENCOUNT(@[User::Path], "\\"))  
```  
  
## <a name="see-also"></a>См. также:  
 [Функции (выражение служб SSIS)](functions-ssis-expression.md)  
  
  
