---
title: Учебник. Добавление спарклайна в отчет (построитель отчетов) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 18c90a36-48bf-4805-a960-2d1e8f00c2dc
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: a543182d5c367be9cc1be875f05c1ab5d4c9bfcf
ms.sourcegitcommit: f40fa47619512a9a9c3e3258fda3242c76c008e6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2019
ms.locfileid: "66099035"
---
# <a name="tutorial-add-a-sparkline-to-your-report-report-builder"></a>Учебник. Добавление спарклайна в отчет (построитель отчетов)
  Этот учебник помогает создать простой табличный отчет на основе образцов данных продаж и добавить спарклайн-график в ячейку таблицы.  
  
 Улучшенная версия отчета, созданного в этом учебнике, доступна в качестве образца отчета в построителе отчетов [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] . Дополнительные сведения о загрузке этого и других образцов отчетов см. в разделе [Образцы отчетов построителя отчетов](https://go.microsoft.com/fwlink/?LinkId=184851). На следующем рисунке показан образец отчета, похожий на тот, который будет в итоге создан.  
  
 ![rs_SparklineMatrixTutorial](../../2014/tutorials/media/rs-sparklinematrixtutorial.gif "rs_SparklineMatrixTutorial")  
  
 Видео [как: Создать спарклайн в таблице (видеоматериалы по построителю отчетов)](https://technet.microsoft.com/bi/ff871942.aspx) показано, как создать подобный отчет со спарклайнами.  
  
##  <a name="BackToTop"></a> Новые знания  
 В этом учебнике рассматриваются следующие темы:  
  
 1. [Создание табличного отчета](#CreateTable)  
  
 2. [Создание запроса в мастере таблицы или матрицы](#Query)  
  
 3. [Добавление спарклайна в таблицу](#Sparkline)  
  
 4. [Выравнивание спарклайнов по вертикали и горизонтали](#AlignSparklines)  
  
### <a name="other-optional-steps"></a>Другие дополнительные шаги  
 5. [Форматирование данных в денежном формате](#FormatCurrency)  
  
 6. [Форматирование данных в формат даты](#FormatDates)  
  
 7. [Изменение ширины столбцов](#Width)  
  
 8. [Добавление заголовка отчета](#Title)  
  
 9. [Сохранение отчета](#Save)  
  
 Предполагаемое время для выполнения заданий данного учебника: 30 минут.  
  
## <a name="requirements"></a>Требования  
 Дополнительные сведения о требованиях см. в разделе [Предварительные условия для использования учебников (построитель отчетов)](../reporting-services/report-builder-tutorials.md).  
  
##  <a name="CreateTable"></a> 1. Создание табличного отчета  
  
#### <a name="to-create-a-report"></a>Создание отчета  
  
1.  Нажмите кнопку **Пуск**, наведите курсор на пункты **Все программы**, **Построитель отчетов Microsoft SQL Server 2012**и выберите пункт **Построитель отчетов**.  
  
     Откроется диалоговое окно **Приступая к работе** .  
  
    > [!NOTE]  
    >  Если диалоговое окно **Приступая к работе** не откроется, в меню кнопки **Построитель отчетов** выберите **Создать**.  
  
2.  Убедитесь, что на левой панели выбран **Новый отчет** .  
  
3.  На панели справа выберите **Мастер таблицы или матрицы**.  
  
4.  На странице **Выбор набора данных** выберите команду **Создать набор данных**, а затем нажмите кнопку **Далее**. Откроется страница **Выберите соединение с источником данных** .  
  
    > [!NOTE]  
    >  Для этого учебника не требуется специальных данных. Необходимо только соединение с базой данных [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] . Если соединение с источником данных, входящим в список **Соединения с источниками данных**уже имеется, выберите его и переходите к шагу 10. Дополнительные сведения см. в разделе [Альтернативные способы создания подключения к данным &#40;построитель отчетов&#41;](../reporting-services/alternative-ways-to-get-a-data-connection-report-builder.md).  
  
5.  Нажмите кнопку **Создать**. Откроется диалоговое окно **Свойства источника данных** .  
  
6.  В текстовое поле **Имя**введите имя источника данных: **Продажи продукции**.  
  
7.  Убедитесь, что в поле **Выберите тип соединения**выбран тип **Microsoft SQL Server** .  
  
8.  В поле **Строка подключения**введите следующий текст:  
  
     **Источник данных =\<servername >**  
  
     Выражение \<servername >, например Report001, указывает компьютер, на котором установлен экземпляр SQL Server Database Engine. Поскольку данные отчета не извлекаются из базы данных SQL Server, не нужно указывать имя базы данных. Для синтаксического анализа запроса используется база данных по умолчанию на указанном сервере.  
  
9. Нажмите кнопку **Учетные данные**. Введите учетные данные, необходимые для доступа к внешнему источнику данных.  
  
10. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
     Снова откроется страница **Выбор соединения с источником данных** .  
  
11. Нажмите кнопку **Проверить соединение**, чтобы проверить соединение с источником данных.  
  
     Отобразится сообщение «Соединение установлено успешно».  
  
12. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
13. Нажмите кнопку **Далее**.  
  
##  <a name="Query"></a> 2. Создание запроса в мастере таблиц  
 В отчете можно использовать общий набор данных со стандартным запросом или создать внедренный набор данных только для этого отчета. В этом учебнике рассматривается создание внедренного набора данных.  
  
> [!NOTE]  
>  В этом учебнике запрос уже содержит значения данных, поэтому внешний источник данных не требуется. В связи с этим запрос получается весьма длинным. В рабочей среде запрос не будет содержать данные. Этот запрос содержит данные только в учебных целях.  
  
#### <a name="to-create-a-query"></a>Создание запроса  
  
1.  На странице **Создание запроса** открывается конструктор реляционных запросов. В этом учебнике будет использоваться текстовый конструктор запросов.  
  
2.  Нажмите кнопку **Редактировать как текст**. Текстовый конструктор запросов отображает панель запросов и панель результатов.  
  
3.  Вставьте в поле [!INCLUDE[tsql](../includes/tsql-md.md)] Запрос **следующий запрос** .  
  
    ```  
    SELECT CAST('2010-01-04' AS date) as SalesDate, 'Accessories' as Subcategory,   
       'Carrying Case' as Product, CAST(16996.60 AS money) AS Sales, 68 as Quantity  
    UNION SELECT CAST('2010-01-05' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Carrying Case' as Product, CAST(1350.00 AS money) AS Sales, 18 as Quantity  
    UNION SELECT CAST('2010-01-10' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Carrying Case' as Product, CAST(1147.50 AS money) AS Sales, 17 as Quantity  
    UNION SELECT CAST('2010-01-04' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Budget Movie-Maker' as Product, CAST(1056.00 AS money) AS Sales, 44 as Quantity  
    UNION SELECT CAST('2010-01-05' AS date) as SalesDate,  'Accessories' as Subcategory,  
       'Slim Digital' as Product, CAST(1380.00 AS money) AS Sales, 18 as Quantity  
    UNION SELECT CAST('2010-01-05' AS date) as SalesDate,'Accessories' as Subcategory,    
       'Budget Movie-Maker' as Product, CAST(780.00 AS money) AS Sales, 26 as Quantity  
    UNION SELECT CAST('2010-01-07' AS date) as SalesDate, 'Accessories' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(3798.00 AS money) AS Sales, 9 as Quantity  
    UNION SELECT CAST('2010-01-08' AS date) as SalesDate, 'Camcorders' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(10400.00 AS money) AS Sales, 13 as Quantity  
    UNION SELECT CAST('2010-01-09' AS date) as SalesDate, 'Camcorders' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(3000.00 AS money) AS Sales, 60 as Quantity  
    UNION SELECT CAST('2010-01-10' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(7234.50 AS money) AS Sales, 39 as Quantity  
    UNION SELECT CAST('2010-01-06' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Carrying Case' as Product, CAST(10836.00 AS money) AS Sales, 84 as Quantity  
    UNION SELECT CAST('2010-01-07' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Slim Digital' as Product, CAST(2550.00 AS money) AS Sales, 17 as Quantity  
    UNION SELECT CAST('2010-01-04' AS date) as SalesDate, 'Digital' as Subcategory,   
       'Slim Digital' as Product, CAST(8357.80 AS money) AS Sales, 44 as Quantity  
    UNION SELECT CAST('2010-01-08' AS date) as SalesDate, 'Digital SLR' as Subcategory,   
       'Slim Digital' as Product, CAST(18530.00 AS money) AS Sales, 34 as Quantity  
    UNION SELECT CAST('2010-01-06' AS date) as SalesDate, 'Digital SLR' as Subcategory,   
       'Slim Digital' as Product, CAST(26576.00 AS money) AS Sales, 88 as Quantity  
    ```  
  
4.  На панели инструментов конструктора запросов нажмите кнопку "Выполнить" (**!**).  
  
     Запрос выполняется и отображает результирующий набор для полей **SalesDate**, **Subcategory**, **Product**, **Sales**и **Quantity**.  
  
5.  Нажмите кнопку **Далее**.  
  
6.  На странице **Размещение полей** перетащите поле **Sales** в область **Значения**.  
  
     Значение поля**Sales** вычисляется агрегатной функцией Sum. Значение равно [Sum(Sales)].  
  
7.  Перетащите поле **Product** в область **Группы строк**.  
  
8.  Перетащите поле **SalesDate** в область **Группы столбцов**.  
  
9. Нажмите кнопку **Далее**.  
  
10. На странице **Выбор макета** в области **Параметры**убедитесь в том, что выбран параметр **Показать подытоги и общие итоги** .  
  
     На панели просмотра в мастере отображается таблица с тремя строками. При запуске отчета каждая строка отобразится следующим образом:  
  
    1.  Первая строка отображается один раз для таблицы, в ней будут содержаться заголовки столбцов.  
  
    2.  Вторая строка повторится один раз для каждого продукта и отобразит название продукта, количество заказа в день и линейный итог.  
  
    3.  Третья строка отобразится один раз для таблицы и будет содержать общие итоги.  
  
11. Нажмите кнопку **Далее**.  
  
12. На странице **Выбор стиля** панели **Стили** выберите **Сланец**.  
  
     На панели предварительного просмотра отобразится образец таблицы с этим стилем.  
  
13. Нажмите кнопку **Готово**.  
  
14. Таблица добавляется в область конструктора. Таблица содержит три столбца и три строки.  
  
     Посмотрите на панель группировки. Если панель группировки не видна, в меню **Вид** выберите пункт **Группирование**. Панель «группы строк» показана одна группа строк: **Product**. Панель «группы столбцов» показана одна группа столбцов: **SalesDate**. Подробные данные — это все данные, которые извлекаются с помощью запроса к набору данных.  
  
15. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
##  <a name="Sparkline"></a> 3. Добавление спарклайна  
  
#### <a name="to-add-a-sparkline-chart-to-a-table"></a>Добавление спарклайн-графика в таблицу  
  
1.  Щелкните **Конструктор** для возврата в режим конструктора.  
  
2.  Выберите в таблице столбец Total.  
  
3.  Щелкните правой кнопкой мыши и установите указатель на пункте **Вставить столбец**, затем нажмите **Слева**.  
  
4.  В новом столбце щелкните правой кнопкой мыши в строке [Product], выберите вкладку ленты **Вставка** и выберите **Спарклайн**.  
  
5.  Убедитесь, что выбран первый спарклайн в строке **Column** , и нажмите кнопку **ОК**.  
  
6.  Щелкните спарклайн для отображения панели «Данные диаграммы».  
  
7.  Щелкните знак плюса (+) в поле «Значения» и выберите **Sales**.  
  
     Значения в поле **Sales** станут значениями спарклайна.  
  
8.  Щелкните знак плюса (+) в поле «Группы категорий» и выберите **SalesDate**.  
  
9. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
     Обратите внимание, что в каждой строке таблицы есть спарклайн графики, но все они неправильные. Столбцы в диаграммах не соответствуют друг другу. Во второй строке данных представлено только четыре столбца, поэтому столбцы шире, чем в первой строке, в которой представлено шесть столбцов. Нельзя сравнить значения по каждому продукту в день. Для этого они должны стоять вровень друг с другом.  
  
     Также обратите внимание, что для каждой строки самый высокий столбец имеет высоту строки. Это тоже неправильно, поскольку наибольшие значения для каждой строки не равны: $видеокамеры равно наибольшее значение для недорогая видеокамера, а наибольшее значение для упрощенной Digital равно $26,576 более чем в два раза превышает. Тем не менее наибольшие столбцы в этих двух строках имеют примерно одинаковую высоту. Ее также необходимо привести в соответствие по масштабу с другими спарклайнами.  
  
     ![rs_SprklineMtrxUnaligndBars](../../2014/tutorials/media/rs-sprklinemtrxunaligndbars.gif "rs_SprklineMtrxUnaligndBars")  
  
##  <a name="AlignSparklines"></a> 4. Выравнивание спарклайнов по вертикали и горизонтали  
 Спарклайны, трудно читать, когда они не используют те же измерения. И горизонтальные и вертикальные оси должны совпадать с остальными.  
  
#### <a name="to-set-alignment-for-the-sparklines-in-the-table"></a>Выравнивание спарклайнов в таблице  
  
1.  Щелкните **Конструктор** для возврата в режим конструктора.  
  
2.  Щелкните правой кнопкой мыши спарклайн и выберите пункт **Свойства вертикальной оси**.  
  
3.  Установите флажок **Выровнять оси в** .  
  
     Tablix1 показан в списке. Это единственный допустимый параметр. Параметр устанавливает высоту столбцов в каждом спарклайне относительно других.  
  
4.  Нажмите кнопку **ОК**.  
  
5.  Щелкните правой кнопкой мыши спарклайн и выберите пункт **Свойства горизонтальной оси**.  
  
6.  Установите флажок **Выровнять оси в** .  
  
     Tablix1 показан в списке. Это единственный допустимый параметр. Параметр устанавливает ширину столбцов в каждом спарклайне относительно других. Если некоторые из спарклайнов имеют меньше столбцов, чем другие, то на месте отсутствующих данных они будут отображать пустое пространство.  
  
7.  Нажмите кнопку **ОК**.  
  
8.  Нажмите кнопку **Выполнить** для повторного предварительного просмотра отчета.  
  
 Обратите внимание, что теперь все столбцы выровнены по отношению к столбцам в других строках.  
  
##  <a name="FormatCurrency"></a> 5. (Необязательно) Форматирование данных в денежном формате  
 По умолчанию сводные данные поля **Sales** отображаются в виде числа с общим форматом. Отформатируйте его для представления валюты. Чтобы форматируемые текстовые поля и текст заполнителей отображался в виде образцов значений, переключайте параметр **Стили заполнителя** .  
  
#### <a name="to-format-a-currency-field"></a>Форматирование поля валюты  
  
1.  Щелкните **Конструктор** для переключения в режим конструктора.  
  
2.  Щелкните ячейку во второй строке (под строкой заголовков столбцов) в столбце **SalesDate** и перетащите указатель мыши вниз, чтобы выбрать все ячейки, содержащие `[Sum(Sales)]`.  
  
3.  На вкладке **Главная** в группе **Число** нажмите кнопку **Валюта** . Ячейки изменятся, отображая содержимое в формате валюты.  
  
     Если в качестве региональных настроек компьютера выбран «Английский (США)», текстом по умолчанию образца будет [**$12,345.00**]. Если значение валюты не отображается, щелкните ссылку **Стили заполнителя** в группе **Числа** , а затем нажмите кнопку **Образцы значений**.  
  
4.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
 Сводные значения для столбца **Sales** отображаются в денежном формате.  
  
##  <a name="FormatDates"></a> 6. (Необязательно) Форматирование данных в формат даты  
 По умолчанию в поле **SalesDate** отображаются дата и время. Можно отформатировать его таким образом, чтобы отображалась только дата.  
  
#### <a name="to-format-a-date-field-as-the-default-format"></a>Указание форматирования для поля даты в формат по умолчанию  
  
1.  Щелкните **Конструктор** для возврата в режим конструктора.  
  
2.  Щелкните ячейку, содержащую `[SalesDate]`.  
  
3.  На ленте, на вкладке **Корневая папка** в группе **Число** в раскрывающемся списке выберите **Дата**.  
  
     В ячейке будет содержаться дата **[1/31/2000]**. Если дата не отображается, щелкните ссылку **Стили заполнителя** в группе **Числа** , а затем нажмите кнопку **Образцы значений**.  
  
4.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
 Значения **SalesDate** отображаются в формате даты по умолчанию.  
  
##  <a name="Width"></a> 7. (Необязательно) Изменение ширины столбцов  
 По умолчанию в каждой ячейке таблицы есть текстовое поле. Текстовое поле расширяется вниз, чтобы вместить введенный текст при подготовке страницы к просмотру. В отчете, готовом для просмотра, каждая строка расширяется по высоте самого высокого текстового поля в строке. Высота строки в области конструктора не влияет на высоту строки в отчете, готовом для просмотра.  
  
 Чтобы уменьшить высоту каждой строки, увеличьте ширину столбца, чтобы ожидаемое содержимое текстовых полей умещалось в одну строку.  
  
#### <a name="to-change-the-width-of-columns"></a>Изменение ширины столбцов  
  
1.  Щелкните **Конструктор** для возврата в режим конструктора.  
  
2.  Щелкните таблицу, чтобы сбоку и сверху от нее появились маркеры строк и столбцов.  
  
     Серые линии, расположенные вдоль верха и стороны таблицы, — это маркеры столбцов и строк.  
  
3.  Установите указатель на линии раздела между маркерами столбцов, чтобы курсор принял вид двойной стрелки. Перетаскиванием установите нужный размер столбцов. Например, расширьте столбец **Product** , чтобы название продукта отображалось в одной строке.  
  
4.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
##  <a name="Title"></a> 8. (Необязательно) Добавление заголовка отчета  
 Заголовок отчета отображается в верхней части отчета. Можно поместить заголовок отчета в верхнем колонтитуле или, если в отчете колонтитулы не используются, в текстовом поле в верхней части текста отчета. В данном учебнике это текстовое поле автоматически размещается в верхней части текста отчета.  
  
 Текст можно улучшить, применяя к отдельным символам различные стили шрифтов, размеры и цвета. Дополнительные сведения см. в разделе [Форматирование текста в текстовом поле &#40;построитель отчетов и службы SSRS&#41;](report-design/format-text-in-a-text-box-report-builder-and-ssrs.md).  
  
#### <a name="to-add-a-report-title"></a>Добавление заголовка отчета  
  
1.  В области конструктора щелкните ссылку **Щелкните, чтобы добавить заголовок**.  
  
2.  Введите фразу **Product Sales**и щелкните вне текстового поля.  
  
3.  Щелкните правой кнопкой мыши текстовое поле **Продажи товаров** и выберите пункт **Свойства текстового поля**.  
  
4.  В диалоговом окне **Свойства текстового поля** нажмите кнопку **Шрифт**.  
  
5.  В списке **Размер** выберите **18пт**.  
  
6.  В списке **Цвет** выберите **Каштановый**.  
  
7.  Выберите **Полужирное**начертание.  
  
8.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
##  <a name="Save"></a> 9. Сохранение отчета  
 Сохраните отчет на сервере отчетов или на своем компьютере. Если не сохранить отчет на сервере отчетов, некоторые функции служб [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] , в том числе элементы отчета и вложенные отчеты, будут недоступны.  
  
#### <a name="to-save-the-report-on-a-report-server"></a>Сохранение отчета на сервере отчетов  
  
1.  Нажмите кнопку **Построитель отчетов** и выберите **Сохранить как**.  
  
2.  Нажмите кнопку **Последние сайты и серверы**.  
  
3.  Выберите или введите имя сервера отчетов, для которого существует разрешение на сохранение отчетов.  
  
     Появится сообщение «Соединение с сервером отчетов». После того как соединение установлено, пользователю представляется содержимое папки, заданной администратором сервера отчетов как место по умолчанию для отчетов.  
  
4.  В поле **Имя**замените имя по умолчанию фразой **Product Sales**.  
  
5.  Нажмите кнопку **Сохранить**.  
  
 Отчет будет сохранен на сервере отчетов. Имя сервера отчетов, с которым установлено соединение, будет отображено в строке состояния в нижней части окна.  
  
#### <a name="to-save-the-report-on-your-computer"></a>Сохранение отчета на компьютере  
  
1.  Нажмите кнопку **Построитель отчетов** и выберите **Сохранить как**.  
  
2.  Перейдите на **Рабочий стол**, откройте папку **Мои документы**или **Мой компьютер**и перейдите в папку, в которую нужно сохранить отчет.  
  
3.  В поле **Имя**замените имя по умолчанию фразой **Product Sales**.  
  
4.  Нажмите кнопку **Сохранить**.  
  
## <a name="next-steps"></a>Next Steps  
 На этом заканчивается учебник по созданию табличного отчета со спарклайн графиками. Дополнительные сведения о спарклайнах см. в разделе [Спарклайны и гистограммы (построитель отчетов и службы SSRS)](report-design/sparklines-and-data-bars-report-builder-and-ssrs.md).  
  
## <a name="see-also"></a>См. также  
 [Учебники по &#40;построитель отчетов&#41;](report-builder-tutorials.md)   
 [Построитель отчетов в SQL Server 2014](report-builder/report-builder-in-sql-server-2016.md)  
  
  
