---
title: Встроенные глобальные значения и ссылки на пользовательские поля (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- reporting-services-native
ms.topic: conceptual
ms.assetid: 5f5e1149-c967-454d-9a63-18ec4a33d985
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 268deacf076f7ea79222dd441777f1ad16149750
ms.sourcegitcommit: 8d6fb6bbe3491925909b83103c409effa006df88
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "59942290"
---
# <a name="built-in-globals-and-users-references-report-builder-and-ssrs"></a>Встроенные глобальные значения и ссылки на пользовательские поля (построитель отчетов и службы SSRS)
  Коллекция «Встроенные поля», включающая как коллекцию `Globals`, так и коллекцию `User`, представляет глобальные значения, предоставленные службами Reporting Services при обработке отчета. Коллекция `Globals` предоставляет такие значения, как имя отчета, время начала обработки отчета и текущее количество страниц для верхнего или нижнего колонтитула отчета. Коллекция `User` предоставляет идентификатор пользователя и параметры языка. Эти значения можно использовать в выражениях для фильтрации результатов отчета.  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="using-the-globals-collection"></a>Использование коллекции Globals  
 Коллекция `Globals` содержит глобальные переменные отчета. В области конструктора эти переменные отображаются с префиксом & (амперсандом), например `[&ReportName]`. Следующая таблица описывает элементы коллекции `Globals`.  
  
|**Член**|**Тип**|**Описание**|  
|----------------|--------------|---------------------|  
|ExecutionTime|`DateTime`|Дата и время начала выполнения отчета.|  
|PageNumber|`Integer`|Номер текущей страницы относительно разрывов страниц, сбрасывающих номера страниц. В начале обработки отчета исходное значение устанавливается равным 1. Номер страницы наращивается для каждой страницы, подготовленной к просмотру.<br /><br /> Чтобы страницы разрывов страниц для прямоугольника, области данных, группы областей данных или карты нумеровались свойство PageBreak присвоено значение свойства ResetPageNumber `True`. Не поддерживается для иерархии групп столбцов табликса.<br /><br /> Свойство PageNumber может использоваться только в выражении в верхнем колонтитуле страницы или в нижнем колонтитуле страницы.|  
|ReportFolder|`String`|Полный путь к папке, содержащей отчет. Не включает в себя URL-адрес сервера отчетов.|  
|ReportName|`String`|Имя отчета в том виде, в каком оно хранится в базе данных сервера отчетов.|  
|ReportServerUrl|`String`|URL-адрес сервера отчетов, на котором выполняется отчет.|  
|TotalPages|`Integer`|Общее количество страниц относительно разрывов страниц, которые сбрасывают значение PageNumber. Если разрывы страниц не заданы, то это значение совпадает с OverallTotalPages.<br /><br /> Свойство TotalPages может использоваться только в выражении в верхнем колонтитуле страницы или в нижнем колонтитуле страницы.|  
|PageName|`String`|Имя страницы. В начале обработки отчета исходное значение устанавливается на основе свойства отчета InitialPageName. По мере обработки каждого элемента отчета это значение заменяется соответствующим значением PageName из прямоугольника, области данных, группы областей данных или карты. Не поддерживается для иерархии групп столбцов табликса.<br /><br /> PageName может использоваться только в выражении в верхнем колонтитуле страницы или в нижнем колонтитуле страницы.|  
|OverallPageNumber|`Integer`|Номер текущей страницы в масштабе всего отчета. На это значение не влияет значение ResetPageNumber.<br /><br /> Свойство OverallPageNumber может использоваться только в выражении в верхнем колонтитуле страницы или в нижнем колонтитуле страницы.|  
|OverallTotalPages|`Integer`|Общее число страниц, относящееся ко всему отчету. На это значение не влияет значение ResetPageNumber.<br /><br /> Свойство OverallTotalPages может использоваться только в выражении в верхнем колонтитуле страницы или в нижнем колонтитуле страницы.|  
|RenderFormat|`RenderFormat`|Информация о текущем запросе на подготовку к просмотру.<br /><br /> Дополнительные сведения см. в подразделе «RenderFormat» следующего раздела.|  
  
 Элементы коллекции `Globals` возвращают тип variant. Если нужно использовать элемент этой коллекции в выражении, требующем определенный тип данных, необходимо сначала привести переменную. Например, чтобы преобразовать тип данных времени выполнения variant в формат Date, используйте синтаксис `=CDate(Globals!ExecutionTime)`. Дополнительные сведения см. в разделе [Типы данных в выражениях (построитель отчетов и службы SSRS)](expressions-report-builder-and-ssrs.md).  
  
### <a name="renderformat"></a>RenderFormat  
 В следующей таблице приведены описания элементов для `RenderFormat`.  
  
|Член|Тип|Описание|  
|------------|----------|-----------------|  
|Имя|`String`|Имя модуля подготовки, зарегистрированное в файле конфигурации RSReportServer.<br /><br /> Доступно на протяжении конкретных участков цикла обработки отчета и подготовки его к просмотру.|  
|IsInteractive|`Boolean`|Используется ли в текущем запросе на подготовку к просмотру интерактивный формат подготовки к просмотру.|  
|DeviceInfo|Предназначенная только для чтения коллекция «имя/значение»|Пары «ключ/значение» для параметров DeviceInfo, относящихся к текущему запросу на подготовку к просмотру.<br /><br /> Строковые значения могут быть заданы с помощью ключа или индекса в коллекции.|  
  
### <a name="examples"></a>Примеры  
 Следующие примеры показывают использование ссылки на коллекцию `Globals` в выражении.  
  
-   Это выражение, помещенное в текстовое поле нижнего колонтитула отчета, содержит номер страницы и общее количество страниц в отчете:  
  
     `=Globals.PageNumber & " of " & Globals.TotalPages`  
  
-   Это выражение сообщает имя отчета и время его выполнения. Время форматируется с помощью строки форматирования [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] для короткой даты:  
  
     `=Globals.ReportName & ", dated " & Format(Globals.ExecutionTime, "d")`  
  
-   Это выражение, помещенное в диалоговое окно **Видимость столбца** для выделенного столбца, отображает при экспорте в Excel только столбец. В противном случае столбец будет скрыт.  
  
     `EXCELOPENXML` относится к формату Excel, который используется в Office 2007. `EXCEL` означает формат Excel, который используется в Office 2003.  
  
     `=IIF(Globals!RenderFormat.Name = "EXCELOPENXML" OR Globals!RenderFormat.Name = "EXCEL", false, true)`  
  
## <a name="using-the-user-collection"></a>Использование коллекции User  
 Коллекция `User` содержит данные о пользователе, выполняющем отчет. Эту коллекцию можно использовать для фильтрации данных, появляющихся в отчете; например, можно отобразить только данные текущего пользователя или отобразить идентификатор пользователя, к примеру, в заголовке отчета. В области конструктора эти переменные отображаются с префиксом & (амперсандом), например `[&UserID]`.  
  
 Следующая таблица описывает элементы коллекции `User`.  
  
|**Член**|**Тип**|**Описание**|  
|----------------|--------------|---------------------|  
|`Language`|`String`|Язык пользователя, выполняющего отчет. Например, `en-US`.|  
|`UserID`|`String`|Идентификатор пользователя, запустившего отчет. Если используется проверка подлинности Windows, то это значение является учетной записью домена текущего пользователя. Значение определяется модулем безопасности служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] , который может использовать проверку подлинности Windows или нестандартную проверку подлинности.|  
  
 Дополнительные сведения о поддержке в отчете нескольких языков см. в разделе "Вопросы проектирования решений для многоязыкового или глобального развертывания" документации по службам [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] в [электронной документации по SQL Server](https://go.microsoft.com/fwlink/?LinkId=120955).  
  
### <a name="using-locale-settings"></a>Использование параметров локали  
 В выражениях можно обращаться к параметрам локали на клиентском компьютере через значение `User.Language` для определения способа отображения отчета пользователю. Например, можно создать отчет, использующий выражение запроса, различающимся в зависимости от значения локали. Этот запрос может изменяться и получать локализованную информацию из разных столбцов в зависимости от установленного языка. Выражения на основе этой переменной можно также использовать в языковых параметрах отчета или его элементов.  
  
> [!NOTE]  
>  Хотя в отчете можно изменять языковые параметры, нужно следить за всеми проблемами отображения, которые могут при этом возникнуть. Например, изменение параметра локали отчета может изменить в нем не только формат даты, но и формат денежной единицы. Если в поле валюты не использовано преобразование, это может привести к отображению в отчете неверного символа валюты. Во избежание этого устанавливайте языковые настройки для отдельных элементов, которые нужно изменять, или настройте этот элемент на отображение денежных данных на определенном языке.  
  
### <a name="identifying-userid-for-snapshot-or-history-reports"></a>Определение переменной UserID для моментального снимка или отчетов журнала  
 В некоторых случаях отчеты, содержащие переменную *User!UserID* , не смогут отобразить данные отчета, относящиеся к текущему пользователю, просматривающему отчет.  
  
## <a name="see-also"></a>См. также  
 [Выражения (построитель отчетов и службы SSRS)](expressions-report-builder-and-ssrs.md)   
 [Диалоговое окно "Выражение" (построитель отчетов)](../expression-dialog-box-report-builder.md)   
 [Типы данных в выражениях (построитель отчетов и службы SSRS)](expressions-report-builder-and-ssrs.md)   
 [Форматирование чисел и дат (построитель отчетов и службы SSRS)](formatting-numbers-and-dates-report-builder-and-ssrs.md)   
 [Примеры выражений (построитель отчетов и службы SSRS)](expression-examples-report-builder-and-ssrs.md)  
  
  
