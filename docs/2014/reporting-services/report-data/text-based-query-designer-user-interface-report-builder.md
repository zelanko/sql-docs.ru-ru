---
title: Пользовательский интерфейс текстового конструктора запросов (построитель отчетов) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10010"
helpviewer_keywords:
- query designers, text-based
ms.assetid: 89fddca5-bd96-4128-9072-5348d1b6e02c
author: markingmyname
ms.author: maghan
manager: craigg
ms.openlocfilehash: d2eecd40de68a6678b3011d15fc13f7cf9757022
ms.sourcegitcommit: 3da2edf82763852cff6772a1a282ace3034b4936
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2018
ms.locfileid: "48111874"
---
# <a name="text-based-query-designer-user-interface-report-builder"></a>Пользовательский интерфейс текстового конструктора запросов (построитель отчетов)
  Текстовый конструктор запросов предназначен для ввода запроса на языке запросов, поддерживаемом источником данных, его выполнения и просмотра результатов во время разработки. Можно указать несколько инструкций, запросов или команд языка [!INCLUDE[tsql](../../../includes/tsql-md.md)] для создания собственных модулей обработки данных, а также указать запросы, заданные как выражения. Поскольку текстовый конструктор запросов не выполняет предварительную обработку запроса и позволяет использовать любой синтаксис запросов, он представляет собой стандартное средство конструктора запросов для источников данных многих типов.  
  
> [!IMPORTANT]  
>  При создании и выполнении запросов пользователи получают доступ к источникам данных. Следует предоставить минимальные разрешения на источники данных, например разрешение только на чтение.  
  
 В окне текстового конструктора запросов отображаются панель инструментов и следующие две области.  
  
-   **Запрос** Показывает текст запроса, имя таблицы или имя хранимой процедуры, в зависимости от типа запроса. Не все типы запросов поддерживаются всеми типами источников данных. Например, имя таблицы поддерживается только для типа источника данных OLE DB.  
  
-   **Результат** Показывает результаты выполнения запроса во время разработки.  
  
## <a name="text-based-query-designer-toolbar"></a>Панель инструментов текстового конструктора запросов  
 Текстовый конструктор запросов предоставляет одну панель инструментов для всех типов команд. В следующей таблице перечислены все кнопки панели инструментов и их функции.  
  
|Кнопка|Описание|  
|------------|-----------------|  
|**Редактировать как текст**|Переключиться из текстового конструктора запросов в графический и обратно. Не все источники данных поддерживают графические конструкторы запросов.|  
|**Импорт**|Импорт существующего запроса из файла или отчета. Поддерживаются только SQL-файлы и RDL-файлы.|  
|![Выполнить запрос](../../analysis-services/media/rsqdicon-run.gif "Выполнить запрос")|Выполнить запрос и показать результирующий набор в панели результатов.|  
|**Тип команды**|Выберите **Text**, **StoredProcedure**или **TableDirect**. Если хранимая процедура имеет параметры, при нажатии на панели инструментов кнопки **Выполнить** появится диалоговое окно **Определение параметров запроса** , в котором можно ввести значения параметров.<br /><br /> Примечание. Если хранимая процедура возвращает несколько результирующих наборов, для заполнения набора данных значениями используется только первый из них.|  
  
### <a name="command-type-text"></a>Тип команды Text  
 При создании набора данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] конструктор реляционных запросов открывается по умолчанию. Чтобы переключиться в текстовый конструктор запросов, нажмите кнопку переключателя **Редактировать как текст** на панели инструментов. В окне текстового конструктора запросов отображаются две панели: панель запросов и область результатов. На следующем рисунке показана каждая панель.  
  
 ![Конструктор универсальных запросов с запросом реляционных данных](../../analysis-services/media/rsqd-dsaw-sql-generic.gif "Конструктор универсальных запросов с запросом реляционных данных")  
  
 В следующей таблице описываются функции каждой панели.  
  
|Панель|Компонент|  
|----------|--------------|  
|Запрос|Отображает текст запроса [!INCLUDE[tsql](../../../includes/tsql-md.md)] . Используйте эту панель, чтобы написать или изменить запрос [!INCLUDE[tsql](../../../includes/tsql-md.md)] .|  
|Результат|Отображает результаты запроса. Чтобы выполнить запрос, щелкните правой кнопкой мыши любую область и выберите команду **Выполнить**либо нажмите кнопку **Выполнить** на панели инструментов.|  
  
#### <a name="example"></a>Пример  
 Следующий запрос возвращает список фамилий из [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] **2008** базы данных `ContactType` таблиц для `Person` схемы.  
  
```  
SELECT Name FROM Person.ContactType  
```  
  
 При нажатии кнопки **Выполнить** на панели инструментов выполняется команда на панели **Запрос** , а результаты выводятся на панели **Результат** . Результирующий набор отображает список из 20 типов контактов, например владельца или агента по продажам.  
  
### <a name="command-type-storedprocedure"></a>Тип команды StoredProcedure  
 Если выбран **Тип команды StoredProcedure**, то текстовый конструктор запросов содержит две панели: панель запросов и область результатов. Введите имя хранимой процедуры в области «Запрос» и нажмите кнопку **Выполнить** на панели инструментов. Если хранимые процедуры используют параметры, откроется диалоговое окно **Определение параметров запроса** . Введите значения параметров для хранимой процедуры. Параметр отчета создается для каждого входного параметра хранимой процедуры.  
  
 На следующем рисунке показаны области «Запрос» и «Результаты» при выполнении хранимой процедуры. В данном случае входные параметры являются константами.  
  
 ![Хранимая процедура в конструкторе текстовых запросов](../../analysis-services/media/rs-relational-text-sp.gif "Хранимая процедура в конструкторе текстовых запросов")  
  
 В следующей таблице описываются функции каждой панели.  
  
|Панель|Компонент|  
|----------|--------------|  
|Запрос|Отображает имя хранимой процедуры и все входные параметры.|  
|Результат|Отображает результаты запроса. Чтобы выполнить запрос, щелкните правой кнопкой мыши любую область и выберите команду **Выполнить**либо нажмите кнопку **Выполнить** на панели инструментов.|  
  
#### <a name="example"></a>Пример  
 Следующий запрос вызывает [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] **2008** хранимой процедуры `uspGetWhereUsedProductID`. При запуске этого запроса необходимо задать значение параметра с идентификационным номером продукта.  
  
```  
uspGetWhereUsedProductID  
```  
  
 Нажмите кнопку **Выполнить** (**!**). При получении запроса на ввод параметров введите значения из следующей таблицы.  
  
|||  
|-|-|  
|*@StartProductID*|820|  
|*@CheckDate*|20010115|  
  
 Для указанной даты результирующий набор отображает список из 13 идентификаторов продуктов, которые используют указанный номер компонента.  
  
### <a name="command-type-tabledirect"></a>Тип команды TableDirect  
 Если выбран **Тип команды TableDirect**, то текстовый конструктор запросов содержит две панели: панель запросов и область результатов. Если ввести имя таблицы и нажать кнопку **Выполнить** , возвращаются все столбцы этой таблицы.  
  
#### <a name="example"></a>Пример  
 Для типа источника данных OLE DB, следующий запрос набора данных возвращает результирующий набор для всех типов контактов в [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] **2008** базы данных.  
  
 `Person.ContactType`  
  
 Ввод имени таблицы Person.ContactType эквивалентен созданию на языке [!INCLUDE[tsql](../../../includes/tsql-md.md)] инструкции `SELECT * FROM Person.ContactType`.  
  
## <a name="see-also"></a>См. также  
 [Пользовательский интерфейс конструктора реляционных запросов (построитель отчетов)](relational-query-designer-user-interface-report-builder.md)   
 [Конструкторы запросов (построитель отчетов)](../query-designers-report-builder.md)  
  
  
