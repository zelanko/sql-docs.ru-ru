---
title: Тип подключения списка SharePoint (службы SSRS) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- reporting-services-native
ms.topic: conceptual
ms.assetid: 2c4adf2f-e9c4-4fae-bd3c-97fe64436caf
author: markingmyname
ms.author: maghan
manager: craigg
ms.openlocfilehash: 09adbf8ca6fb16becd98b94c15f93052c003abb2
ms.sourcegitcommit: 3da2edf82763852cff6772a1a282ace3034b4936
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2018
ms.locfileid: "48116355"
---
# <a name="sharepoint-list-connection-type-ssrs"></a>Тип соединения список SharePoint (службы SSRS)
  Для включения данных из списка Microsoft SharePoint в отчет следует добавить или создать набор данных, основанный на источнике данных отчета типа «Список Microsoft SharePoint». Это встроенный тип источника данных, основанный на модуле обработки данных «Список SharePoint служб Microsoft SQL Server Reporting Services». Используйте этот тип источника данных для подключения и извлечения данных списка с сайтов [!INCLUDE[SPF2010](../../includes/spf2010-md.md)], [!INCLUDE[SPS2010](../../includes/sps2010-md.md)], [!INCLUDE[winSPServ](../../includes/winspserv-md.md)] 3.0 и [!INCLUDE[offSPServ](../../includes/offspserv-md.md)] 2007.  
  
 Используйте сведения в этом разделе для создания источника данных. Пошаговые инструкции см. в разделе [Добавление и проверка подключения к данным или источнику данных &#40;построитель отчетов и службы SSRS&#41;](add-and-verify-a-data-connection-report-builder-and-ssrs.md).  
  
##  <a name="Connection"></a> Строка подключения  
 Строка подключения к списку SharePoint — это URL-адрес сайта или дочернего сайта SharePoint, например `http://MySharePointWeb/MySharePointSite` или `http://MySharePointWeb/MySharePointSite/Subsite`.  
  
 Конструктор запросов автоматически отображает списки SharePoint, для доступа к которым имеются достаточные разрешения.  
  
 Дополнительные примеры строк соединения см. в разделе [Подключения к данным, источники данных и строки подключения в построителе отчетов](../data-connections-data-sources-and-connection-strings-in-report-builder.md).  
  
##  <a name="Credentials"></a> Учетные данные  
 Учетные данные необходимы для запуска запросов, локального предварительного просмотра отчетов, а также для предварительного просмотра отчетов на сервере отчетов. После публикации отчета может понадобиться изменить учетные данные источника данных, чтобы разрешения, необходимые для получения данных при запуске отчета на сервере отчетов, были допустимыми. Типы учетных данных, которые можно использовать с этим модулем обработки данных, зависят от конфигурации технологии SharePoint для списка SharePoint, который используется в качестве источника данных.  
  
 В следующих таблицах описано получение учетных данных для расширения списка SharePoint при подключении к локальному списку фермы SharePoint и к удаленному списку SharePoint.  
  
 **Таблица 1** предназначена для отчетов, развернутых на устаревшем сайте Windows SharePoint. Устаревший сайт Windows поддерживает только проверку подлинности Kerberos, NTLM и проверку подлинности на основе форм (FBA). **Таблица 2** предназначена для отчетов, развернутых на сайте SharePoint с проверкой подлинности на основе утверждений.  
  
 **Таблица 1**  
  
||Поддерживаемые учетные данные|Классический режим проверки подлинности Windows|<sup>3</sup> утверждений проверки подлинности|  
|-|---------------------------|-----------------------------------------|----------------------------------------|  
|Локальный список фермы SharePoint|Проверка подлинности Windows (встроенная) или токен пользователя SharePoint|Да|Да|  
||Хранимые, запрос, нет (с учетными данными Windows<sup>1</sup>)|Да|Нет|  
|Удаленный список SharePoint|Проверка подлинности Windows (встроенная) или токен пользователя SharePoint|Да|Не<sup>2</sup>|  
||Хранимые, запрос, нет (с учетными данными Windows<sup>1</sup>)|Да|Не<sup>2</sup>|  
  
 **Таблица 2**  
  
||Поддерживаемые учетные данные|Классический режим проверки подлинности Windows|<sup>3</sup> утверждений проверки подлинности|  
|-|---------------------------|-----------------------------------------|----------------------------------------|  
|Локальный список фермы SharePoint|Проверка подлинности Windows (встроенная) или токен пользователя SharePoint|Да|Да|  
||Хранимые, запрос, нет (с учетными данными Windows<sup>1</sup>)|Нет|Нет|  
|Удаленный список SharePoint|Проверка подлинности Windows (встроенная) или токен пользователя SharePoint|Да|Не<sup>2</sup>|  
||Хранимые, запрос, нет (с учетными данными Windows<sup>1</sup>)|Нет|Не<sup>2</sup>|  
  
 <sup>1</sup> хранимые данные и запрос учетных данных с учетными данными не Windows не поддерживается.  
  
 <sup>2</sup> проверки подлинности на основе форм и проверки подлинности утверждений не поддерживаются для удаленных списков SharePoint.  
  
 <sup>3</sup> проверки подлинности Windows, проверку подлинности на основе форм (FBA), Secure Application Markup Language (SAML) маркеры, других поставщиков удостоверений или сочетание нескольких из перечисленных выше упомянутых поставщиков проверки подлинности.  
  
 **Проверка подлинности Windows.**  
 Для технологии SharePoint, настроенной для работы с сервером отчетов в режиме «Доверенная учетная запись», этот параметр не поддерживается. Относится только к выпускам до версии служб SQL Server 2012 Reporting Services.  
  
 Для технологии SharePoint, настроенной для работы с сервером отчетов в режиме интеграции с Windows, этот параметр применяется как к текущему пользователю Windows, так и к текущему пользователю SharePoint.  
  
 Для технологии SharePoint, настроенной для работы без сервера отчетов (в локальном режиме), этот параметр не поддерживается. Дополнительные сведения о локальном режиме см. в разделе [Отчеты, созданные в локальном и подключенном режиме в средстве просмотра отчетов (службы Reporting Services в режиме интеграции с SharePoint)](../local-vs-connected-mode-report-viewer-reporting-services-sharepoint-mode.md).  
  
 **Учетные данные не требуются (не использовать учетные данные).**  
 Чтобы использовать этот параметр, необходима учетная запись автоматического выполнения, настроенная на сервере отчетов. Дополнительные сведения см. в разделе [Настройка учетной записи автоматического выполнения &#40;диспетчер конфигурации служб SSRS&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).  
  
 Дополнительные сведения о поддержке проверки подлинности на основе утверждений в стеке бизнес-аналитики Майкрософт см. в разделе [Использование проверки подлинности на основе утверждений в стеке бизнес-аналитики Майкрософт](http://social.technet.microsoft.com/wiki/contents/articles/15274.using-claims-authentication-across-the-microsoft-bi-stack.aspx).  
  
 Дополнительные сведения см. в разделе [подключения к данным, источники данных и строки подключения в службах Reporting Services](../data-connections-data-sources-and-connection-strings-in-reporting-services.md), [указание учетных данных в построителе отчетов](../specify-credentials-in-report-builder.md), и [Data Sources Supported by Службы Reporting Services &#40;SSRS&#41;](../create-deploy-and-manage-mobile-and-paginated-reports.md).  
  
##  <a name="Query"></a> Запросы  
 Чтобы построить запрос, создайте новый набор данных на основе источника данных и откройте связанный конструктор запросов. Дополнительные сведения см. в разделе [Создание общего или внедренного набора данных (построитель отчетов и службы SSRS)](create-a-shared-dataset-or-embedded-dataset-report-builder-and-ssrs.md).  
  
 Графический конструктор запросов списка SharePoint имеет четыре панели.  
  
 **Списки SharePoint.**  Отображает список всех списков SharePoint на сайте для данного источника данных. Выберите список и поля, которые нужно добавить в запрос. Имена полей на данной панели являются понятными именами SharePoint, которые также называются отображаемыми именами. Наведите курсор мыши на элемент. В подсказке отобразятся следующие свойства.  
  
-   **Имя.** Уникальное имя поля.  
  
-   **Идентификатор.** Уникальный идентификатор поля.  
  
-   **Тип поля.** Тип данных поля.  
  
-   **Скрыто.** Отображается ли поле в представлении списка SharePoint.  
  
 Выбор полей из нескольких списков не поддерживается. Можно создать набор данных для каждого списка и выбирать поля из каждого набора данных. Если списки имеют общее поле, можно использовать функцию уточняющего запроса в области данных табликса, которая привязана к одному набору данных, чтобы получать значение из другого набора данных, который не привязан к области данных. Дополнительные сведения см. в разделе [Функция Lookup &#40;построитель отчетов и службы SSRS&#41;](../report-design/report-builder-functions-lookup-function.md).  
  
-   **Выбранные поля.**  Отображает выбранные поля. Имена полей на этой панели являются понятными именами SharePoint, которые были указаны пользователем SharePoint. При закрытии конструктора запросов эти имена можно увидеть в наборе полей набора данных в области данных отчета. Связь между уникальными именами и понятными именами см. на странице [Диалоговое окно "Свойства набора данных" — "Поля", &#40;построитель отчетов&#41;](../dataset-properties-dialog-box-fields-report-builder.md).  
  
-   **Примененные фильтры.**  Ограничивает данные, возвращаемые из списка SharePoint, прежде чем вернуть их в отчет. Выберите имя поля, оператор и значение, которые будут использованы для ограничения данных, извлекаемых из списка. Список доступных операторов зависит от выбранного типа данных значения.  
  
     В графическом конструкторе запросов изменять порядок сортировки или указывать группы нельзя. Чтобы сделать это, задайте выражения сортировки в наборе данных отчетов и сгруппируйте выражения в областях данных отчета. Параметры запросов не поддерживаются. Для фильтрации данных в отчете пользуйтесь фильтрами или параметрами отчетов. Дополнительные сведения см. в разделе [Фильтрация, группирование и сортировка данных (построитель отчетов и службы SSRS)](../report-design/filter-group-and-sort-data-report-builder-and-ssrs.md) и [Параметры отчета (построитель отчетов и конструктор отчетов)](../report-design/report-parameters-report-builder-and-report-designer.md).  
  
-   **Результаты запросов.**  Отображает примеры строк, возвращаемых при выполнении запроса. Если значения списка SharePoint часто изменяются на сайте SharePoint, то значения на панели результатов запросов могут отличаться от значений, выводимых в отчете.  
  
-   **Выбранные поля.**  Отображает выбранные поля. Имена полей на этой панели являются понятными именами SharePoint, которые были указаны пользователем SharePoint. При закрытии конструктора запросов эти имена можно увидеть в наборе полей набора данных в области данных отчета. Связь между уникальными именами и понятными именами см. на странице [Диалоговое окно "Свойства набора данных" — "Поля", &#40;построитель отчетов&#41;](../dataset-properties-dialog-box-fields-report-builder.md).  
  
-   **Примененные фильтры.**  Ограничивает данные, возвращаемые из списка SharePoint, прежде чем вернуть их в отчет. Выберите имя поля, оператор и значение, которые будут использованы для ограничения данных, извлекаемых из списка. Список доступных операторов зависит от выбранного типа данных значения.  
  
     В графическом конструкторе запросов изменять порядок сортировки или указывать группы нельзя. Чтобы сделать это, задайте выражения сортировки в наборе данных отчетов и сгруппируйте выражения в областях данных отчета. Параметры запросов не поддерживаются. Для фильтрации данных в отчете пользуйтесь фильтрами или параметрами отчетов. Дополнительные сведения см. в разделе [Фильтрация, группирование и сортировка данных (построитель отчетов и службы SSRS)](../report-design/filter-group-and-sort-data-report-builder-and-ssrs.md) и [Параметры отчета (построитель отчетов и конструктор отчетов)](../report-design/report-parameters-report-builder-and-report-designer.md).  
  
-   **Результаты запросов.**  Отображает примеры строк, возвращаемых при выполнении запроса. Если значения списка SharePoint часто изменяются на сайте SharePoint, то значения на панели результатов запросов могут отличаться от значений, выводимых в отчете.  
  
 Дополнительные сведения см. в разделе [Конструктор запросов к спискам SharePoint &#40;построитель отчетов&#41;](sharepoint-list-query-designer-report-builder.md).  
  
### <a name="query-text"></a>Текст запроса  
 Чтобы просмотреть запрос, созданный с помощью графического конструктора запросов, переключитесь в текстовый конструктор запросов. Здесь можно просмотреть XML-текст, созданный графическим конструктором запросов. XML-код включает элементы для имени списка, набора полей и фильтров.  
  
#### <a name="example-1-specified-fields-for-a-list"></a>Пример 1. Указанные поля для списка  
 В следующем примере показан правильно составленный запрос SharePoint:  
  
```  
<RSSharePointList>  
<listName>MyList</listName>  
<viewFields>  
  <FieldRef Name="Field1"/>  
  <FieldRef Name="Field4"/>  
</viewFields>  
<Query>  
  <Where>  
    <And>  
      <Gt>  
        <FieldRef Name="Field1"/>  
        <Value Type="Integer">1</Value>  
      </Gt>  
      <IsNotNull>  
        <FieldRef Name="Field2"/>  
        <Value Type="string"/>  
      </IsNotNull>   
    </And>  
  </Where>  
</Query>  
</RSSharePointList>  
```  
  
 Данное представление запроса можно изменить, если запрос представлен в виде XML-текста.  
  
#### <a name="example-2-all-fields-for-a-list"></a>Пример 2. Все поля для списка  
 Достаточно указать имя списка, и будут возвращены все поля, включая скрытые. В следующем примере из списка Tasks извлекаются все поля:  
  
```  
<RSSharePointList>  
<listName>Tasks</listName>  
</RSSharePointList>  
```  
  
 В результатах запроса возвращаются все поля для списка Tasks.  
  
##  <a name="Parameters"></a> Параметры  
 Параметры не поддерживаются этим модулем обработки данных.  
  
  
##  <a name="HowTo"></a> Инструкции  
 В этом разделе содержатся пошаговые инструкции по работе с подключениями к данным, источниками данных и наборами данных.  
  
 [Добавление и проверка подключения к данным или источнику данных &#40;построитель отчетов и службы SSRS&#41;](add-and-verify-a-data-connection-report-builder-and-ssrs.md)  
  
 [Создание общего или внедренного набора данных (построитель отчетов и службы SSRS)](create-a-shared-dataset-or-embedded-dataset-report-builder-and-ssrs.md)  
  
 [Добавление фильтра к набору данных (построитель отчетов и службы SSRS)](add-a-filter-to-a-dataset-report-builder-and-ssrs.md)  
  
  
##  <a name="Related"></a> См. также  
 В этих разделах документации содержатся подробные сведения о данных отчетов, а также методические сведения об определении, настройке и использовании элементов отчетов, связанных с данными.  
  
 [Добавление данных в отчет &#40;построитель отчетов и службы SSRS&#41;](report-datasets-ssrs.md)  
 Предоставляет общие сведения о доступе к данным отчета.  
  
 [Подключения к данным, источники данных и строки подключения в построителе отчетов](../data-connections-data-sources-and-connection-strings-in-report-builder.md)  
 Предоставляет сведения о подключениях к данным и источникам данных.  
  
 [Внедренные и общие наборы данных отчета (построитель отчетов и службы SSRS)](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md)  
 Предоставляет сведения об общих и внедренных наборах данных.  
  
 [Коллекция полей набора данных (построитель отчетов и службы SSRS)](dataset-fields-collection-report-builder-and-ssrs.md)  
 Предоставляет сведения о коллекции полей набора данных, создаваемой запросом.  
  
 [Источники данных, поддерживаемые службами Reporting Services &#40;SSRS&#41;](../create-deploy-and-manage-mobile-and-paginated-reports.md), см. в документации [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] в [электронной документации](http://go.microsoft.com/fwlink/?linkid=121312) [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
 Предоставляет подробные сведения о поддержке платформ и версий для каждого модуля обработки данных.  
  
  
## <a name="see-also"></a>См. также  
 [Параметры отчета (построитель отчетов и конструктор отчетов)](../report-design/report-parameters-report-builder-and-report-designer.md)   
 [Фильтрация, группирование и сортировка данных (построитель отчетов и службы SSRS)](../report-design/filter-group-and-sort-data-report-builder-and-ssrs.md)   
 [Выражения (построитель отчетов и службы SSRS)](../report-design/expressions-report-builder-and-ssrs.md)  
  
  
