---
title: Учебник. Добавление линейчатой диаграммы к отчету (построитель отчетов) | Документация Майкрософт
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- reporting-services-native
ms.topic: conceptual
ms.assetid: 6956ebd6-0217-4087-a4fa-5cc1c3804691
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0b21826cb926dbd5f8b0315f490b20850c6ccd23
ms.sourcegitcommit: dfb1e6deaa4919a0f4e654af57252cfb09613dd5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/11/2019
ms.locfileid: "56041425"
---
# <a name="tutorial-add-a-bar-chart-to-your-report-report-builder"></a>Учебник. Добавление в отчет линейчатой диаграммы (построитель отчетов)
  В линейчатых диаграммах категории данных отображаются по горизонтали. Это может использоваться для:  
  
-   улучшения читаемости длинных имен категорий;  
  
-   облегчения восприятия времени, отображаемого в виде значений;  
  
-   сравнение относительных значений нескольких рядов.  
  
 На следующем рисунке показана создаваемая линейчатая диаграмма, на которой отображены данные продаж за 2008 и 2009 гг. для пяти менеджеров по продажам с максимальными объемами продаж, перечисленных в алфавитном порядке.  
  
 ![rs_BarChartTutorial](../../2014/tutorials/media/rs-barcharttutorial.gif "rs_BarChartTutorial")  
  
##  <a name="BackToTop"></a> Новые знания  
 В этом учебнике рассматриваются следующие темы:  
  
1.  [Создание диаграммы с помощью мастера диаграмм](#Chart)  
  
2.  [Выбор типа диаграммы](#ChartType)  
  
3.  [Отображение всех значений категорий по вертикальной оси](#AllValues)  
  
4.  [Изменение отображения имен по вертикальной оси](#Sort)  
  
5.  [Перемещение условных обозначений](#Legend)  
  
6.  [Перемещение заголовка диаграммы](#ChartTitle)  
  
7.  [Форматирование и задание меток для горизонтальной оси](#Horizontal)  
  
8.  [Добавление фильтра для отображения 5 максимальных значений](#Filter)  
  
9. [Добавление заголовка отчета](#Title)  
  
10. [Сохранение отчета](#Save)  
  
> [!NOTE]  
>  В этом учебнике шаги работы с мастером объединены в одну процедуру. Пошаговые инструкции по переходу к серверу отчетов, созданию набора данных и выбору источника данных см. в первом учебнике этой серии: [Учебник. Создание простого табличного отчета &#40;построитель отчетов&#41;](../reporting-services/tutorial-creating-a-basic-table-report-report-builder.md).  
  
 Предполагаемое время для выполнения заданий данного учебника: 15 минут.  
  
## <a name="requirements"></a>Требования  
 Дополнительные сведения о требованиях см. в разделе [Предварительные условия для использования учебников (построитель отчетов)](../reporting-services/report-builder-tutorials.md).  
  
##  <a name="Chart"></a> 1. Создание отчета с диаграммой с помощью мастера диаграмм  
 Из **Приступая к работе** » диалогового окна «создать внедренный набор данных, выберите общий источник данных и создайте линейчатую диаграмму с помощью мастера диаграмм.  
  
> [!NOTE]  
>  В этом учебнике запрос уже содержит значения данных, поэтому внешний источник данных не требуется. В связи с этим запрос получается весьма длинным. В рабочей среде запрос не будет содержать данные. Этот запрос содержит данные только в учебных целях.  
  
#### <a name="to-create-a-new-chart-report"></a>Создание нового отчета с диаграммой  
  
1.  Нажмите кнопку **Пуск**, наведите курсор на пункты **Все программы**, **Построитель отчетов Microsoft SQL Server 2012**и выберите пункт **Построитель отчетов**.  
  
     Откроется диалоговое окно **Приступая к работе** .  
  
    > [!NOTE]  
    >  Если **Приступая к работе** диалоговое окно не отображается, нажмите кнопку «Построитель отчетов» и нажмите кнопку **New**.  
  
2.  Убедитесь, что на левой панели выбран **Новый отчет** .  
  
3.  На правой панели выберите **Мастер диаграмм**.  
  
4.  На странице **Выбор набора данных** нажмите кнопку **Создать набор данных**, а затем кнопку **Далее**.  
  
5.  На странице **Выбор соединения с источником данных** выберите существующий источник данных или перейдите к серверу отчетов и выберите источник данных, а затем нажмите кнопку **Далее**. Может потребоваться указать имя пользователя и пароль.  
  
    > [!NOTE]  
    >  При наличии необходимых разрешений выбор источника данных не имеет существенного значения. Этот источник данных не будет использоваться для получения данных. Дополнительные сведения см. в разделе [Альтернативные способы создания подключения к данным &#40;построитель отчетов&#41;](../reporting-services/alternative-ways-to-get-a-data-connection-report-builder.md).  
  
6.  На странице **Проектирование запроса** нажмите кнопку **Изменить как текст**.  
  
7.  На панель запроса вставьте следующий запрос:  
  
    ```  
    SELECT 'Luis' as FirstName, 'Alverca' as LastName, CAST(170000.00 AS money) AS SalesYear2009, CAST(150000. AS money) AS SalesYear2008  
    UNION SELECT 'Jeffrey' as FirstName, 'Zeng' as LastName, CAST(210000. AS money) AS SalesYear2009, CAST(190000. AS money) AS SalesYear2008  
    UNION SELECT 'Houman' as FirstName, 'Pournasseh' as LastName, CAST(150000. AS money) AS SalesYear2009, CAST(180000. AS money) AS SalesYear2008  
    UNION SELECT 'Robin' as FirstName, 'Wood' as LastName, CAST(75000. AS money) AS SalesYear2009, CAST(175000. AS money) AS SalesYear2008  
    UNION SELECT 'Daniela' as FirstName, 'Guaita' as LastName,  CAST(170000. AS money) AS SalesYear2009, CAST(175000. AS money) AS SalesYear2008  
    UNION SELECT 'John' as FirstName, 'Yokim' as LastName, CAST(160000. AS money) AS SalesYear2009, CAST(195000. AS money) AS SalesYear2008  
    UNION SELECT 'Delphine' as FirstName, 'Ribaute' as LastName, CAST(180000. AS money) AS SalesYear2009, CAST(205000. AS money) AS SalesYear2008  
    UNION SELECT 'Robert' as FirstName, 'Hernady' as LastName, CAST(140000. AS money) AS SalesYear2009, CAST(180000. AS money) AS SalesYear2008  
    UNION SELECT 'Tanja' as FirstName, 'Plate' as LastName, CAST(150000. AS money) AS SalesYear2009, CAST(160000. AS money) AS SalesYear2008  
    UNION SELECT 'David' as FirstName, 'Bradley' as LastName, CAST(210000. AS money) AS SalesYear2009, CAST(180000. AS money) AS SalesYear2008  
    UNION SELECT 'Michal' as FirstName, 'Jaworski' as LastName, CAST(175000. AS money) AS SalesYear2009, CAST(220000. AS money) AS SalesYear2008  
    UNION SELECT 'Chris' as FirstName, 'Ashton' as LastName, CAST(195000. AS money) AS SalesYear2009, CAST(205000. AS money) AS SalesYear2008  
    UNION SELECT 'Pongsiri' as FirstName, 'Hirunyanitiwatna' as LastName, CAST(175000. AS money) AS SalesYear2009, CAST(215000. AS money) AS SalesYear2008  
    UNION SELECT 'Brian' as FirstName, 'Burke' as LastName, CAST(187000. AS money) AS SalesYear2009, CAST(207000. AS money) AS SalesYear2008  
    ```  
  
8.  Нажмите кнопку "Выполнить" (**!**), чтобы просмотреть данные, на основе которых будет создана диаграмма (необязательно).  
  
9. Нажмите кнопку **Далее**.  
  
##  <a name="ChartType"></a> 2. Выбор типа диаграммы  
 Можно выбрать один из различных стандартных типов диаграмм.  
  
#### <a name="to-add-a-column-chart"></a>Добавление гистограммы  
  
1.  На странице **Выбор типа диаграммы** в качестве типа диаграммы по умолчанию задана гистограмма.  
  
2.  Нажмите кнопку **Линейчатая**, а затем кнопку **Далее**.  
  
     На **расположение полей диаграммы** странице, есть четыре поля в **доступные поля** области: FirstName, LastName, SalesYear2009 и SalesYear2008.  
  
3.  Перетащите поле «LastName» на панель «Категории».  
  
4.  Перетащите поле «SalesYear2009» на панель «Значения». «SalesYear2009» представляет объем продаж всех менеджеров по продажам за 2009 г. На панели «Значения» отображается выражение `[Sum(SalesYear2009)]` , поскольку в диаграмме отображается агрегат для каждого из продуктов.  
  
5.  Перетащите поле «SalesYear2008» на панель «Значения» ниже «SalesYear2009». «SalesYear2008» представляет объем продаж всех менеджеров по продажам за 2008 г.  
  
6.  Нажмите кнопку **Далее**.  
  
7.  На **Выбор стиля** страницы, на панели «Стили» выберите стиль.  
  
     Стиль задает стиль шрифта, набор цветов и стиль границы. При выборе стиля на панели просмотра отобразится образец диаграммы с этим стилем.  
  
8.  Нажмите кнопку **Готово**.  
  
     Диаграмма добавляется в область конструктора.  
  
9. Щелкните диаграмму, чтобы отобразить ее маркеры. Перетащите правый нижний угол диаграммы вниз, чтобы увеличить ее размер.  
  
10. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
 В отчете отображается линейчатая диаграмма с данными продаж всех менеджеров по продажам за 2008 и 2009 гг. Длина линии на диаграмме соответствует общему значению объема продаж.  
  
##  <a name="AllValues"></a> 3. Изменение отображения имен по вертикальной оси  
 По умолчанию на вертикальной оси отображаются только определенные значения. Диаграмму можно изменить для отображения всех категорий.  
  
#### <a name="to-display-all-sales-persons-along-the-category-axis-of-a-bar-chart"></a>Отображение всех менеджеров по продажам на оси категорий линейчатой диаграммы  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Щелкните правой кнопкой мыши вертикальную ось, а затем нажмите кнопку **свойства вертикальной оси**.  
  
3.  В области **Диапазон и интервал оси**в поле **Интервал** введите значение **1**.  
  
4.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
5.  Щелкните правой кнопкой мыши по вертикали **заголовок оси** и очистить **показывать название оси** "флажок".  
  
6.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
> [!NOTE]  
>  Если имена менеджеров по продажам на вертикальной оси невозможно прочесть, можно увеличить высоту диаграммы или изменить параметры форматирования для меток оси.  
  
###  <a name="CategoryExpression"></a> Отображение фамилии и имени на вертикальной оси  
 Можно изменить выражение категории для отображения фамилии, после которой будет отображаться имя для всех менеджеров по продажам.  
  
##### <a name="to-change-the-category-expression"></a>Изменение выражения категории  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Дважды щелкните диаграмму, чтобы отобразить панель **Данные диаграммы** .  
  
3.  Щелкните правой кнопкой мыши поле [LastName] в области **Группы категорий** и выберите пункт **Свойства группы категорий**.  
  
4.  В поле «Метка» нажмите кнопку «Выражение» (Fx).  
  
5.  Введите следующее выражение: `=Fields!LastName.Value & ", " & Fields!FirstName.Value`  
  
     В выражении будут объединены фамилия, запятая и имя.  
  
6.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
7.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
8.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
 Если фамилии не отображаются при выполнении отчета, то данные можно обновить вручную. Оставаясь в режиме предварительного просмотра, на вкладке **Выполнить** в группе **Навигация** нажмите кнопку **Обновить**.  
  
> [!NOTE]  
>  Если имена менеджеров по продажам на вертикальной оси невозможно прочесть, можно увеличить высоту диаграммы или изменить параметры форматирования для меток оси.  
  
##  <a name="Sort"></a> 4. Изменение порядка сортировки имен по вертикальной оси  
 При сортировке данных на диаграмме изменяется порядок значений на осях категории.  
  
#### <a name="to-sort-the-names-in-alphabetical-order-on-the-bar-chart"></a>Сортировка имен на линейчатой диаграмме в алфавитном порядке  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Дважды щелкните диаграмму, чтобы отобразить панель **Данные диаграммы** .  
  
3.  Щелкните правой кнопкой мыши поле [LastName] в области **Группы категорий** и выберите пункт **Свойства группы категорий**.  
  
4.  Щелкните **Сортировка**. На странице **Изменение параметров сортировки** отображается список выражений фильтров. По умолчанию в этом списке имеется одно выражение сортировки, идентичное исходному выражению группы категорий.  
  
5.  В сортировке, нажмите кнопку выражения (**Fx**) кнопку.  
  
6.  Введите следующее выражение: `=Fields!LastName.Value & ", " & Fields!FirstName.Value`  
  
7.  Нажмите кнопку **ОК**.  
  
8.  Вернитесь на **свойства группы категорий** странице **порядок** стрелку раскрывающегося списка выберите **от я до А**. При этом будет выбран обратный алфавитный порядок и имена будут отображаться сверху вниз.  
  
9. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
10. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
 Имена на горизонтальной оси сортируются в обратном порядке с **Alerca** вверху и **Zeng** внизу.  
  
##  <a name="Legend"></a> 5. Перемещение условных обозначений  
 Чтобы улучшить читаемость значений диаграммы, можно переместить ее условные обозначения. Например, в линейчатой диаграмме, в которой столбцы отображаются горизонтально, можно изменить положение условных обозначений, чтобы они находились выше или ниже области диаграммы. В результате для столбцов выделяется больше места.  
  
#### <a name="to-display-the-legend-below-the-chart-area-of-a-bar-chart"></a>Вывод условных обозначений под областью линейчатой диаграммы  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Щелкните правой кнопкой мыши условные обозначения диаграммы.  
  
3.  Выберите **Свойства условных обозначений**.  
  
4.  Выберите другое значение для параметра **Положение условных обозначений**. Например, можно выбрать параметр, соответствующий расположению посередине в нижней части.  
  
     Если условные обозначения перемесить в верхнюю или нижнюю часть диаграммы, их макет изменится с вертикального на горизонтальный. Можно выбрать другой макет в раскрывающемся списке **Макет** .  
  
5.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
6.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
##  <a name="ChartTitle"></a> 6. Задание заголовка для диаграммы  
  
#### <a name="to-change-the-chart-title-above-the-chart-area-of-a-bar-chart"></a>Изменение заголовка диаграммы над областью линейчатой диаграммы  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Выделите слова **заголовок диаграммы** в верхней части диаграммы, а затем введите следующий текст: **Продажи за 2008 и 2009 годы**.  
  
3.  Щелкните в любом месте текста.  
  
4.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
##  <a name="Horizontal"></a> 7. Форматирование и задание меток для горизонтальной оси  
 По умолчанию по горизонтальной оси отображаются значения в общем формате, который автоматически масштабируется в соответствии с размером диаграммы.  
  
#### <a name="to-format-the-numbers-on-the-horizontal-axis"></a>Форматирование чисел по горизонтальной оси  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Щелкните горизонтальную ось в нижней части диаграммы, чтобы выбрать ее.  
  
     На ленте на **Главная** на вкладке **номер** щелкните **валюты** кнопки. Метки на горизонтальной оси изменятся на валюту.  
  
3.  (Необязательно) Удалите десятичные знаки. Рядом с кнопкой **Денежный** дважды нажмите кнопку **Уменьшить число десятичных разрядов** .  
  
4.  Щелкните правой кнопкой мыши горизонтальную ось и выберите пункт **Свойства горизонтальной оси**.  
  
5.  На **номер** выберите **Показывать значения в тысячах.**  
  
6.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
7.  Щелкните правой кнопкой мыши **заголовок оси** и нажмите кнопку **свойства заголовка оси**.  
  
8.  В **текст заголовка** введите **продажи в тысячах** и нажмите кнопку **ОК**.  
  
9. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
 В отчете объем продаж отображается по горизонтальной оси в виде валюты в тысячах без десятичных знаков.  
  
##  <a name="Filter"></a> 8. Добавление фильтра для отображения 5 максимальных значений  
 К диаграмме можно добавить фильтр, чтобы выбрать данные в наборе данных для включения или исключения из диаграммы.  
  
#### <a name="to-add-a-filter-and-display-the-top-five-values"></a>Добавление фильтра и отображение 5 наибольших значений  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Дважды щелкните диаграмму, чтобы отобразить панель **Данные диаграммы** .  
  
3.  Щелкните правой кнопкой мыши поле [LastName] в области **Группы категорий** и выберите пункт **Свойства группы категорий**.  
  
4.  Перейдите на вкладку **Фильтры**. На странице **Изменение фильтров** может отображаться список критериев фильтров. По умолчанию этот список пустой.  
  
5.  Нажмите кнопку **Добавить**. Появится новый пустой фильтр.  
  
6.  В **выражение**, тип **[Sum(SalesYear2009)]**. При этом создается базовое выражение `=Sum(Fields!SalesYear2009.Value)`, которое можно просмотреть, нажав кнопку **fx** .  
  
7.  Убедитесь в том, что типом данных является **Текст**.  
  
8.  В раскрывающемся списке **Оператор**выберите вариант **Первые N** .  
  
9. В поле **Значение**введите следующее выражение: **=5**  
  
10. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
11. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
 Если к результатам не применяется фильтр при выполнении отчета, данные можно обновить вручную. На вкладке **Выполнить** в группе **Навигация** нажмите кнопку **Обновить**.  
  
 На диаграмме отобразятся имена пяти первых менеджеров по продажам из данных продаж за 2009 г.  
  
##  <a name="Title"></a> 9. Добавление заголовка отчета  
  
#### <a name="to-add-a-report-title"></a>Добавление заголовка отчета  
  
1.  В области конструктора щелкните ссылку **Щелкните, чтобы добавить заголовок**.  
  
2.  Тип **линейчатая диаграмма продаж**, нажмите клавишу ВВОД, а затем введите **верхней пять продавцов за 2009 г.**, чтобы он выглядел следующим образом:  
  
     **Линейчатая диаграмма продаж**  
  
     **Лидеры пять продаж за 2009 г.**  
  
3.  Выберите **Линейчатая диаграмма продаж**и нажмите кнопку **Полужирный** .  
  
4.  Выберите **верхней пять продавцов за 2009 г.** и в **шрифта** разделе **Главная** вкладку, задайте размер шрифта равным **10**.  
  
5.  Может потребоваться увеличить высоту текстового поля «Заголовок» для соответствия размерам двух строк текста (необязательно).  
  
     Данный заголовок появится в верхней части отчета. При отсутствии верхнего колонтитула страницы элементы в верхней части текста отчета выполняют роль заголовка отчета.  
  
6.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
##  <a name="Save"></a> 10. Сохранение отчета  
  
#### <a name="to-save-the-report"></a>Сохранение отчета  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Нажмите кнопку **Построитель отчетов** и выберите **Сохранить как**.  
  
3.  В поле **Имя**введите **Линейчатая диаграмма продаж**.  
  
4.  Нажмите кнопку **Сохранить**.  
  
 Отчет будет сохранен на сервере отчетов.  
  
## <a name="next-steps"></a>Следующие шаги  
 Учебник «Добавление линейчатой диаграммы в отчет» успешно завершен. Дополнительные сведения о диаграммах см. в разделах [Диаграммы (построитель отчетов и службы SSRS)](report-design/charts-report-builder-and-ssrs.md) и [Спарклайны и гистограммы (построитель отчетов и службы SSRS)](report-design/sparklines-and-data-bars-report-builder-and-ssrs.md).  
  
## <a name="see-also"></a>См. также  
 [Учебники по &#40;построитель отчетов&#41;](report-builder-tutorials.md)   
 [Построитель отчетов в SQL Server 2014](report-builder/report-builder-in-sql-server-2016.md)  
  
  
