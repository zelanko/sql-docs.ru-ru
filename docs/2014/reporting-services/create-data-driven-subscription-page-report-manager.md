---
title: «Создание управляемой данными подписки» (диспетчер отчетов) | Документация Майкрософт
ms.custom: ''
ms.date: 05/24/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- reporting-services-native
ms.topic: conceptual
ms.assetid: 814b4653-572a-48c7-847f-b310ba0f3046
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 625afedabdb376f913d3353e2bda343bba66e3e1
ms.sourcegitcommit: 8d6fb6bbe3491925909b83103c409effa006df88
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "59964820"
---
# <a name="create-data-driven-subscription-page-report-manager"></a>Страница «Создание управляемой данными подписки» (диспетчер отчетов)
  Страницы «Создание управляемой данными подписки» позволяют создавать и изменять подписки, при каждом запуске которых сведения о подписке запрашиваются в базе данных подписчика. В управляемых данными подписках результаты запросов используются для определения получателей подписки, параметров доставки и значений параметров отчета. Во время выполнения сервер отчетов запускает запрос для получения значений, используемых в настройках подписки. При помощи страниц «Создание управляемой данными подписки» можно определить запрос и назначить параметрам подписки значения из запросов. Значения и параметры, указываемые для управляемой данными подписки, разделены между несколькими страницами, подобно мастеру. Всего имеется семь страниц.  
  
 Чтобы создать управляемую данными подписку, необходимо знать, как написать запрос или команду для получения данных для этой подписки. Необходимо также хранилище данных, в котором содержатся данные о подписчиках (например: имена подписчиков и адреса электронной почты), используемые в подписке.  
  
 Эта страница доступна для пользователей с повышенными разрешениями. Если используются настройки безопасности по умолчанию, управляемые данными подписки не могут использоваться для отчетов, размещенных в папке «My Reports» (Мои отчеты).  
  
> [!NOTE]  
>  Эта функция поддерживается не во всех выпусках [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. Перечень функций, поддерживаемых в разных выпусках [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], см. в разделе [Features Supported by the Editions of SQL Server 2014](../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md).  
  
## <a name="navigation"></a>Навигация  
 Чтобы перейти к этому местоположению в пользовательском интерфейсе, используйте следующую процедуру.  
  
###### <a name="to-open-the-data-driven-subscription-page"></a>Открытие страницы «Создание управляемой данными подписки»  
  
1.  Откройте диспетчер отчетов и найдите отчет, для которого необходимо создать управляемую данными подписку.  
  
2.  Подведите курсор к отчету и щелкните стрелку раскрывающегося списка.  
  
3.  В раскрывающемся меню выберите **Управление**. Откроется страница свойств отчета **Общие** .  
  
4.  Перейдите на вкладку **Подписки** и нажмите кнопку **Создать управляемую данными подписку**.  
  
    > [!NOTE]  
    >  Чтобы эта кнопка была доступна, источник данных для отчета должен использовать сохраненные учетные данные.  
  
## <a name="start-a-subscription-page-1"></a>Начало создания подписки (страница 1)  
 **Описание**  
 Введите описание подписки. В списках подписки описание будет отображаться в поле **Мои подписки** и на вкладке **Подписки** данного отчета.  
  
 **Укажите способ извещения получателей**  
 Выберите модуль доставки, при помощи которого будет выполняться распространение отчета. Для каждой подписки можно выбрать только один модуль доставки. Доступны следующие параметры:  
  
-   Параметр **Общая папка сервера отчетов** используется для доставки отчетов в общую папку. Отчет доставляется в виде статического файла, отключенного от сервера отчетов. Дополнительные сведения см. в разделе [File Share Delivery in Reporting Services](subscriptions/file-share-delivery-in-reporting-services.md).  
  
-   Параметр **Электронная почта сервера отчетов** используется для доставки отчетов в почтовый ящик. Дополнительные сведения см. в статье [E-Mail Delivery in Reporting Services](subscriptions/e-mail-delivery-in-reporting-services.md).  
  
-   Параметр **Отсутствует поставщик доставки** используется для доставки отчетов в базу данных сервера отчетов. Этот параметр позволяет создавать моментальные снимки отчетов. Выберите этот параметр, когда необходимо осуществлять предварительную загрузку сервера отчетов пользовательскими или параметризованными моментальными снимками отчета по заданному расписанию. Дополнительные сведения см. в разделе [Кэширование отчетов (службы SSRS)](report-server/caching-reports-ssrs.md), это был единственный способ предварительной загрузки кэша.  
  
 **Укажите источник данных, в котором содержатся данные получателя**  
 Укажите соединения с источником данных. Можно выбрать общий источник данных, если таковой имеется и содержит требуемые сведения для соединения. Можно также указать сведения для соединения непосредственно в данной подписке.  
  
 Источник данных содержит сведения о подписчике. Эти данные могут состоять из имен сотрудников, их идентификаторов, адресов электронной почты, а также настроек форматов экспорта (например, HTML или PDF). Если используется модуль доставки по электронной почте для сервера отчетов, источник данных должен содержать адреса электронной почты.  
  
## <a name="specify-a-connection-page-2"></a>Задание подключения (страница 2)  
 Если указан общий источник данных, эта страница используется для выбора общего элемента источника данных. Можно использовать древовидное представление, чтобы найти и выбрать элемент. Если определяется подключение для данной подписки, эта страница используется для задания следующих параметров.  
  
 **Тип соединения**  
 Позволяет выбрать используемый с источником данных модуль обработки данных.  
  
 **Строка подключения**  
 Введите строку соединения, используемую для соединения с источником данных.  
  
 **Подключение с использованием**  
 Введите учетные данные, используемые для соединения с источником данных. Учетные данные хранятся в виде зашифрованных значений в базе данных сервера отчетов.  
  
 Если источник данных использует проверку подлинности Windows, при соединении с базой данных установите флажок **Использовать в качестве учетных данных Windows** .  
  
 Если используется источник данных, не выполняющий проверку подлинности соединений пользователя (например, если источником данных является XML-файл), установите флажок «Учетные данные не требуются». Для этого параметра требуется предварительная настройка учетной записи автоматического выполнения. Дополнительные сведения см. в разделе [Настройка учетной записи автоматического выполнения &#40;диспетчер конфигурации служб SSRS&#41;](install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).  
  
## <a name="specify-a-query-page-3"></a>Задание запроса (страница 3)  
 На этой странице можно ввести запрос, получающий данные о подписчике. Чтобы добиться наилучших результатов, сначала запрос нужно выполнить в среде SQL Server Management Studio, а затем использовать его в управляемой данными подписке. Тогда можно проверить результаты, чтобы убедиться в наличии необходимых сведений. В результатах запроса важно определить следующие моменты.  
  
-   Столбцы результирующего набора определяют значения, которые можно указать в параметрах доставки и в параметрах отчета. Например, при создании управляемой данными подписки с доставкой по электронной почте необходимо наличие столбца с адресами электронной почты.  
  
-   Строки результирующего набора определяют количество формируемых доставок отчета. При наличии 10 000 строк сервер отчета сформирует 10 000 уведомлений и доставок.  
  
 **Запрос**  
 Задайте SQL-запрос или команду для извлечения результирующего набора, содержащего по одной строке на каждого получателя подписки. На последующих страницах этот результирующий набор будет использоваться для заполнения настроек модуля, управляемого данными.  
  
 **Timeout**  
 Укажите значение времени ожидания запроса. Это значение должно быть достаточно большим, чтобы завершить обработку запроса.  
  
 **Проверить**  
 Нажмите кнопку **Проверить** для проверки запроса. Прежде чем продолжить, необходимо убедиться, что запрос предоставил достоверные данные. Если кнопка **Проверить**не была нажата, запрос будет проверен при нажатии **Далее**.  
  
## <a name="set-delivery-options-page-4"></a>Установка параметров доставки (страница 4)  
 На четвертой странице задаются параметры модуля доставки. Параметры, отображаемые на этой странице, относятся к модулю доставки. Способ указания этих параметров может в значительной степени зависеть от того, как их представляет модуль доставки. Если модуль не имеет настроек, на этой странице не отображаются никакие параметры.  
  
|Выберите|Чтобы выполнить следующее действие|  
|-----------------|----------------|  
|**Указать статическое значение**|Использовать постоянное значение параметра доставки. В некоторых модулях доставки доступны статические значения для выбора. Например: для доставки сервером отчетов по электронной почте поддерживаются значения параметров **IncludeReport**, **RenderFormat**, **Приоритет**и **Включить ссылку**.|  
|**Получить значение из базы данных**|Использовать значение из результирующего набора. Столбцы результирующего набора можно использовать для получения данных о подписчиках и значений параметров отчета.|  
|**Нет значения**|Убрать этот параметр из подписки.|  
  
#### <a name="set-delivery-options-for-file-share-delivery"></a>Настройка параметров доставки при доставке в общую папку  
 Модуль доставки в общие папки часто используется, поскольку он не требует какой-либо дополнительной настройки. При использовании модуля доставки в общие папки можно задать параметры, описанные в следующей таблице.  
  
 **Имя файла**  
 Задает имя файла для отчета. Модуль доставки в общие папки доставляет отчеты в общие папки в виде статических файлов приложений. В большинстве случаев для создания имени файла следует использовать значение из базы данных. В зависимости от настройки режима записи использование статических значений приводит к перезаписи предыдущих доставок новыми.  
  
 **Путь**  
 Задает общую папку, доступную через сетевое подключение. Чтобы проверить доступность папки, нажмите кнопку **запуска** в меню "Пуск" и введите путь к папке в следующем формате: \\ \\< computername\>\\< имя_общей_папки\>.  
  
 **Формат отображения**  
 Задает выходной формат файла. Сервер отчетов может записать файл в форматах приложений, соответствующих модулям подготовки к просмотру, установленным на сервере отчетов.  
  
 **Режим записи**  
 Задает, должен ли сервер отчетов заменять файл более новой версией, добавлять его или отменять доставку при обнаружении файла с таким же именем.  
  
 **Расширение файла**  
 Укажите значение true, чтобы добавить расширение файла, соответствующее выбранному формату подготовки к просмотру.  
  
 **Имя пользователя**  
 Введите учетную запись домена, имеющую разрешение на добавление файлов в общую папку, в следующем формате: \<домена >\\< имя пользователя\>.  
  
 **Пароль**  
 Пароль для учетной записи.  
  
## <a name="set-parameters-page-5"></a>Установка параметров (страница 5)  
 Если отчет включает параметры, необходимо указать, какие значения параметров будут использоваться в отчете. Значения параметров можно получить из источника данных подписчика (например, если имеется региональный отчет о продажах, параметризованный на основе регионального кода, можно получить сведения о регионе для каждого сотрудника, если эти сведения хранятся в базе данных сотрудников).  
  
|Выберите|Чтобы выполнить следующее действие|  
|-----------------|----------------|  
|**Указать статическое значение**|Использовать постоянное значение параметра, если необходимо использовать один и тот же параметр для всех подписчиков. Если параметр многозначный, значение можно выбрать из списка.|  
|**Использовать значение по умолчанию**|В некоторых отчетах для всех или некоторых параметров содержатся значения по умолчанию. Если для параметра отчета имеется значение по умолчанию, установите этот флажок, чтобы использовать его.|  
|**Получить значение из базы данных**|Использовать значение из результирующего набора. Столбцы результирующего набора можно выбрать в качестве источника значений типа данных для использования с каждым экземпляром подписки.|  
  
## <a name="specify-a-trigger-page-6"></a>Выбор триггера (страница 6)  
 Выбор события, запускающего обработку подписки.  
  
|Выберите|Чтобы выполнить следующее действие|  
|-----------------|----------------|  
|**При обновлении данных отчета на сервере отчетов**|Если отчет настроен для запуска в качестве снимка состояния выполнения отчета, запуск подписки можно назначить на время обновления моментального снимка.|  
|**По расписанию, созданному для этой подписки**|Запустить подписку в указанные дату и время.|  
|**По общему расписанию**|Запустить подписку, используя данные из общего расписания.|  
  
## <a name="schedule-a-subscription-page-7"></a>Расписание подписки (страница 7)  
 Если задается расписание подписки, необходимо задать частоту доставки отчета. Первый набор параметров позволяет задать категорию частоты (ежечасно, ежедневно, еженедельно и т.д.). Второй отображаемый набор параметров формируется на основе первого.  
  
 **Почасовые**  
 Задать расписание запуска каждый час.  
  
 **Ежедневно**  
 Задать расписание запуска по выбранным дням в указанные час и минуту. Дни можно указывать следующими способами: Каждый  *\<день >*, ежедневно и каждый  *\<номер >* день. Выбор одного из подходов отменяет другие, даже если остальные дни отображаются выделенными.  
  
 **Еженедельно**  
 Задать расписание запуска с интервалом в неделю в указанные час и минуту. Интервал может измеряться в целых неделях (например каждый две недели) или днях в пределах недели.  
  
 **Ежемесячно**  
 Задать расписание запуска на ежемесячной основе. В пределах месяца можно выбрать день по шаблону (например, последнее воскресенье каждого месяца) или конкретные календарные даты (такие как 1 и 15, что означает первый и пятнадцатый день каждого месяца). При помощи запятых и дефисов можно задать несколько дней или их диапазоны, например 1, 5, 7-12, 21.  
  
 **Однократно**  
 Задать расписание запуска только один раз. Раздел **Даты начала и окончания** используется для задания дня запуска расписания. Срок действия расписания истекает, как только оно обработано.  
  
 **Даты начала и окончания**  
 Задать начальную дату, определяющую начальное время действия расписания, и конечную дату, определяющую срок действия расписания. Срок действия расписания истекает без уведомления. После конечной даты расписание больше не запускается.  
  
## <a name="saving-the-subscription"></a>Сохранение подписки  
 Кнопка **Готово** становится доступной, когда для подписки указаны все необходимые данные. Для завершения подписки нажмите **Готово** .  
  
## <a name="see-also"></a>См. также  
 [Диспетчер отчетов (службы Reporting Services в основном режиме)](../../2014/reporting-services/report-manager-ssrs-native-mode.md)   
 [Data-Driven Subscriptions](subscriptions/data-driven-subscriptions.md)   
 [Создание управляемой данными подписки (учебник по службам SSRS)](create-a-data-driven-subscription-ssrs-tutorial.md)   
 [Задание учетных данных и сведениях о соединении для источников данных отчета](report-data/specify-credential-and-connection-information-for-report-data-sources.md)   
 [Подписки и доставка (службы Reporting Services)](subscriptions/subscriptions-and-delivery-reporting-services.md)   
 [Справка F1 диспетчера отчетов](../../2014/reporting-services/report-manager-f1-help.md)  
  
  
