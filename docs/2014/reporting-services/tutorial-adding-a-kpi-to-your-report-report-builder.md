---
title: Учебник. Добавление ключевого показателя Эффективности к отчету (построитель отчетов) | Документация Майкрософт
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- reporting-services-native
ms.topic: conceptual
ms.assetid: 1bf77859-0b33-4f40-abaf-ebeeb6ebb1f8
author: markingmyname
ms.author: maghan
manager: kfile
ms.openlocfilehash: 5e00afd4954a328e767ccb2d991338d9dffb1dff
ms.sourcegitcommit: 31800ba0bb0af09476e38f6b4d155b136764c06c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2019
ms.locfileid: "56296452"
---
# <a name="tutorial-adding-a-kpi-to-your-report-report-builder"></a>Учебник. Добавление в отчет ключевого показателя эффективности (построитель отчетов)
  Ключевой показатель эффективности (KPI) — это измеримое значение, имеющее деловую значимость. Этот учебник поможет научиться включать ключевые показатели эффективности в отчет. В данном случае ключевым показателем эффективности является сводка по продажам (по подкатегориям продуктов). Текущее состояние ключевого показателя эффективности отображается с помощью цветов, датчиков и индикаторов.  
  
 На приведенном далее рисунке показан отчет, который вам предстоит создать.  
  
 ![rs_AddKPITutorial](../../2014/tutorials/media/rs-addkpitutorial.gif "rs_AddKPITutorial")  
  
##  <a name="BackToTop"></a> Новые знания  
 Этот учебник поможет научиться добавлять ключевой показатель эффективности путем задания цвета фона ячеек таблицы, исходя из значения каждой ячейки, и последующего добавления датчика и индикатора. Кроме того, вы научитесь писать выражения, задающее цвет фона ячеек таблицы.  
  
 Этот учебник описывает следующие процедуры:  
  
1.  [Создание табличного отчета и набора данных из мастера таблицы или матрицы](#Table)  
  
2.  [Организация данных, Выбор макета и стиля в таблице или мастер матриц](#CompleteWizard)  
  
3.  [Для отображения ключевого показателя Эффективности с помощью цветов фона](#BackgroundColors)  
  
4.  [Отображение ключевого показателя Эффективности с помощью датчика](#Gauge)  
  
5.  [Отображение ключевого показателя Эффективности с помощью индикатора](#Indicator)  
  
6.  [Добавление заголовка отчета](#Title)  
  
7.  [Сохранение отчета](#Save)  
  
> [!NOTE]  
>  В данном учебнике стадии работы мастера объединены в две процедуры: для создания набора данных и для создания таблиц. Пошаговые инструкции по обзору сервера отчетов, выбору источника данных, созданию набора данных и запуску мастера см. в первом учебнике этой серии: [Учебник. Создание простого табличного отчета &#40;построитель отчетов&#41;](../reporting-services/tutorial-creating-a-basic-table-report-report-builder.md).  
  
 Предполагаемое время для выполнения заданий данного учебника: 15 минут.  
  
## <a name="requirements"></a>Требования  
 Дополнительные сведения о требованиях см. в разделе [Предварительные условия для использования учебников (построитель отчетов)](../reporting-services/report-builder-tutorials.md).  
  
##  <a name="Table"></a> 1. Создание табличного отчета и набора данных с помощью мастера таблицы или матрицы  
 Из **Приступая к работе** диалоговом окне выберите общий источник данных, создайте внедренный набор данных и отображения данных в таблице.  
  
> [!NOTE]  
>  В этом учебнике запрос уже содержит значения данных, поэтому внешний источник данных не требуется. В связи с этим запрос получается весьма длинным. В рабочей среде запрос не будет содержать данные. Этот запрос содержит данные только в учебных целях.  
  
#### <a name="to-create-a-new-table"></a>Создание новой таблицы  
  
1.  Нажмите кнопку **Пуск**, наведите курсор на пункты **Все программы**, **Построитель отчетов Microsoft SQL Server 2012**и выберите пункт **Построитель отчетов**.  
  
     Откроется диалоговое окно **Приступая к работе** .  
  
    > [!NOTE]  
    >  Если **Приступая к работе** диалоговое окно не отображается, в построителе отчетов нажмите кнопку **New**.  
  
2.  Убедитесь, что на левой панели выбран **Новый отчет** .  
  
3.  На панели справа выберите **Мастер таблицы или матрицы**.  
  
4.  На странице «Выбор набора данных», нажмите кнопку **Создание набора данных**.  
  
5.  Нажмите кнопку **Далее**.  
  
6.  На странице **Выберите соединение с источником данных** выберите существующий источник данных или перейдите к серверу отчетов и выберите источник данных. Если отсутствуют доступные источники данных или доступ к серверу отчетов, можно воспользоваться внедренным источником данных. Дополнительные сведения см. в разделе [руководства: Создание простого табличного отчета &#40;построитель отчетов&#41;](../reporting-services/tutorial-creating-a-basic-table-report-report-builder.md).  
  
7.  Нажмите кнопку **Далее**.  
  
8.  На странице **Проектирование запроса** нажмите кнопку **Изменить как текст**.  
  
9. Скопируйте и вставьте на панели запросов следующий запрос:  
  
    ```  
    SELECT CAST('2009-01-05' AS date) as SalesDate, 'Accessories' as Subcategory,   
       'Carrying Case' as Product, CAST(16996.60 AS money) AS Sales, 68 as Quantity  
    UNION SELECT CAST('2009-01-06' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Tripod' as Product, CAST(1350.00 AS money) AS Sales, 18 as Quantity  
    UNION SELECT CAST('2009-01-11' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Lens Adapter' as Product, CAST(1147.50 AS money) AS Sales, 17 as Quantity  
    UNION SELECT CAST('2009-01-05' AS date) as SalesDate, 'Accessories' as Subcategory,  
       'Mini Battery Charger' as Product, CAST(1056.00 AS money) AS Sales, 44 as Quantity  
    UNION SELECT CAST('2009-01-06' AS date) as SalesDate,  'Accessories' as Subcategory,  
       'Telephoto Conversion Lens' as Product, CAST(1380.00 AS money) AS Sales, 18 as Quantity  
    UNION SELECT CAST('2009-01-06' AS date) as SalesDate,'Accessories' as Subcategory,    
       'USB Cable' as Product, CAST(780.00 AS money) AS Sales, 26 as Quantity  
    UNION SELECT CAST('2009-01-08' AS date) as SalesDate, 'Accessories' as Subcategory,   
       'Budget Movie-Maker' as Product, CAST(3798.00 AS money) AS Sales, 9 as Quantity  
    UNION SELECT CAST('2009-01-09' AS date) as SalesDate, 'Camcorders' as Subcategory,   
       'Business Videographer' as Product, CAST(10400.00 AS money) AS Sales, 13 as Quantity  
    UNION SELECT CAST('2009-01-10' AS date) as SalesDate, 'Camcorders' as Subcategory,   
       'Social Videographer' as Product, CAST(3000.00 AS money) AS Sales, 60 as Quantity  
    UNION SELECT CAST('2009-01-11' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Advanced Digital' as Product, CAST(7234.50 AS money) AS Sales, 39 as Quantity  
    UNION SELECT CAST('2009-01-07' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Compact Digital' as Product, CAST(10836.00 AS money) AS Sales, 84 as Quantity  
    UNION SELECT CAST('2009-01-08' AS date) as SalesDate,  'Digital' as Subcategory,   
       'Consumer Digital' as Product, CAST(2550.00 AS money) AS Sales, 17 as Quantity  
    UNION SELECT CAST('2009-01-05' AS date) as SalesDate, 'Digital' as Subcategory,   
       'Slim Digital' as Product, CAST(8357.80 AS money) AS Sales, 44 as Quantity  
    UNION SELECT CAST('2009-01-09' AS date) as SalesDate, 'Digital SLR' as Subcategory,   
       'SLR Camera 35mm' as Product, CAST(18530.00 AS money) AS Sales, 34 as Quantity  
    UNION SELECT CAST('2009-01-07' AS date) as SalesDate, 'Digital SLR' as Subcategory,   
       'SLR Camera' as Product, CAST(26576.00 AS money) AS Sales, 88 as Quantity  
    ```  
  
10. Нажмите кнопку **Далее**.  
  
##  <a name="CompleteWizard"></a> 2. Организация данных, выбор макета и стиля в мастере таблицы или матрицы  
 С помощью мастера начните конструировать отчет, в котором будут отображаться данные. Панель предварительного просмотра в мастере позволяет визуализировать результат группирования данных до завершения конструирования таблицы или матрицы.  
  
#### <a name="to-organize-data-into-groups-choose-a-layout-and-a-style"></a>Разбиение данных по группам выберите макет и стиль  
  
1.  На странице "Размещение полей" перетащите поле "Продукт" в область **Значения**.  
  
2.  Перетащите поле "Количество" в область **Значения** и поместите ниже поля "Продукт".  
  
     Сводные значения для поля Quantity вычисляются с помощью функции Sum, которая является функцией по умолчанию для вычисления сводных значений числовых полей.  
  
3.  Перетащите поле "Продажи" в область **Значения** и поместите ниже поля "Количество".  
  
     Шаги 1, 2 и 3 задают данные, отображаемые в таблице.  
  
4.  Перетащите поле SalesDate в область **Группы строк**.  
  
5.  Перетащите поле "Подкатегория" в область **Группы строк** и поместите его ниже поля SalesDate.  
  
     Шаги 4 и 5 организуют значения полей сначала по дате, а потом по всем продажам для данной даты.  
  
6.  Нажмите кнопку **Далее**.  
  
     При выполнении отчета в таблице отображается каждая дата, все заказы для каждой даты и все продукты, количества и итоги по продажам для каждого заказа.  
  
7.  Убедитесь в том, что на странице "Выбор макета" в области **Параметры**выбран параметр **Показывать подытоги и общие итоги** .  
  
8.  Убедитесь в том, что выбран параметр **Заблокированный, подытог ниже** .  
  
9. Снимите флажок **Развернуть или свернуть группы**.  
  
     В описываемом здесь отчете не используется функция углубленной детализации, которая позволяет пользователю разворачивать родительскую групповую иерархию, чтобы отобразить строки дочерней группы и строки подробностей.  
  
10. Нажмите кнопку **Далее**.  
  
11. На странице «Выбор стиля» на панели «Стили» выберите стиль.  
  
     На иллюстрации с законченным отчетом показан отчет в стиле «Аквамарин».  
  
12. Нажмите кнопку **Готово**.  
  
     Таблица добавляется в область конструктора. Таблица содержит пять столбцов и пять строк. Панель «Группы строк» показывает три группы строк: SalesDate, Subcategory и Details. Подробные данные — это все данные, которые извлекаются с помощью запроса к набору данных.  
  
13. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
 Для каждого продукта, проданного за указанную дату, в таблице отображается название этого продукта, проданное количество и сумма продаж. Данные упорядочиваются сначала по дате продажи, а потом по подкатегории.  
  
##  <a name="BackgroundColors"></a> 3. Отображение ключевого показателя эффективности с помощью цветов фона  
 Цвета фона можно задавать в виде выражений, вычисляемых при запуске отчета.  
  
#### <a name="to-display-the-present-state-of-a-kpi-by-using-background-colors"></a>Отображение текущего состояния ключевого показателя эффективности с помощью цвета фона  
  
1.  В таблице, щелкните правой кнопкой мыши две ячейки вниз от `[Sum(Sales)]` ячейки (строке промежуточных итогов, отображающую продажи для подкатегории), а затем щелкните **свойства текстового поля**.  
  
2.  В **заполнения**, нажмите кнопку **fx** рядом с пунктом **цвет заливки** параметр и введите следующее выражение в **задать выражение для: BackgroundColor** поля:  
  
 `=IIF(Sum(Fields!Sales.Value) >= 5000 ,"Lime", IIF(Sum(Fields!Sales.Value) < 2500, "Red","Yellow"))`  
  
 Это изменяет цвет фона на зеленый с использованием оттенка зеленого «Lime» для каждой ячейки, содержащей итоговые суммы для `[Sum(Sales)]`, которые больше или равны 5 000. Значения `[Sum(Sales)]` в диапазоне от 2 500 до 5 000 окрашены желтым цветом. Значения менее 2 500 окрашены красным цветом.  
  
1.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
2.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
 В строке промежуточных итогов, где отображаются продажи для подкатегории, цвет ячейки может быть красным, желтым или зеленым в зависимости от значения суммы продаж.  
  
##  <a name="Gauge"></a> 4. Отображение ключевого показателя эффективности с помощью датчика  
 Датчик показывает одно значение из набора данных. В этом учебнике используется горизонтальный линейный датчик, поскольку его форма и простота облегчают его чтение, даже когда он имеет небольшой размер и помещен в ячейку таблицы. Дополнительные сведения см. в разделе [Датчики (построитель отчетов и службы SSRS)](report-design/gauges-report-builder-and-ssrs.md).  
  
#### <a name="to-display-the-present-state-of-a-kpi-using-a-gauge"></a>Отображение текущего состояния ключевого показателя эффективности с помощью датчика  
  
1.  Переключитесь в режим конструктора.  
  
2.  В таблице, щелкните правой кнопкой мыши маркер столбца ячейки, измененной в предыдущей процедуре, пункты **вставить столбец**, а затем нажмите кнопку **справа**. В таблицу добавится новый столбец.  
  
3.  Тип **ключевого показателя Эффективности** в заголовке столбца.  
  
4.  На **вставить** на вкладке **областей данных** щелкните **датчика**, а затем щелкните область конструктора вне таблицы. Откроется диалоговое окно **Выбор типа датчика** .  
  
5.  Нажмите кнопку **линейной**. Первый тип линейного датчика, **горизонтальной**, выбран.  
  
6.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
     В область конструктора добавится датчик.  
  
7.  Перетащите поле Sales из области данных отчета на датчик. При перетаскивании поля Sales по датчику откроется панель «Данные датчика».  
  
8.  Перетащите поле Sales в **значения** списка.  
  
     Когда поле перетаскивается на датчик, его значение вычисляется с помощью встроенной функции Sum.  
  
9. Щелкните правой кнопкой мыши указатель датчика и выберите **свойства указателя**.  
  
10. В **тип указателя**выберите **строке**. Указатель будет изменен с маркера на черту, это сделает его более видимым, когда в таблицу добавится датчик.  
  
11. Нажмите кнопку **заливка указателя**. В **вторичный цвет** выбрать **желтый**. Шаблон градиента заливки изменится с белого на желтый.  
  
12. Щелкните правой кнопкой мыши шкалу датчика и выберите пункт **Свойства шкалы**.  
  
13. Задайте **максимальное** параметр значение 25 000.  
  
    > [!NOTE]  
    >  Вместо константы (например, 25 000) можно использовать выражение для динамического вычисления значения параметра **Максимум** . Оно является агрегатным выражением агрегатной функции и выглядит аналогично выражению `=Max(Sum(Fields!Sales.value), "Tablix1")`.  
  
14. Перетащите датчик внутри таблицы в третью ячейку добавленного столбца, в строку промежуточных итогов, где отображаются продажи для подкатегории.  
  
    > [!NOTE]  
    >  Возможно, придется изменить размер столбца, чтобы горизонтальный линейный датчик соответствовал по размеру ячейке. Чтобы изменить размер столбца, щелкните заголовок столбца и используйте маркеры, чтобы изменить размеры ячейки по вертикали и горизонтали.  
  
15. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
     Горизонтальная длина черты датчика изменяется в зависимости от значения ключевого показателя эффективности.  
  
16. (Дополнительно) Добавьте штифт-ограничитель для управления переполнением, чтобы любое значение, превосходящее максимальное значение шкалы, всегда указывало на штифт-ограничитель.  
  
    1.  Откройте панель «Свойства».  
  
    2.  Щелкните шкалу. На панели «Свойства» отобразятся свойства линейной шкалы.  
  
    3.  В **ограничитель шкалы** категории, разверните **MaximumPin** узла.  
  
    4.  Задайте **включить** свойства `True`. Ограничитель появляется за максимальным значением на шкале.  
  
    5.  Задайте **BorderColor** для `Lime`.  
  
17. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
##  <a name="Indicator"></a> 5. Отображение ключевого показателя эффективности с помощью индикатора  
 Индикаторы — это небольшие простые датчики, позволяющие с первого взгляда получить представление о значениях данных. Из-за своего размера и простоты индикаторы часто используются в таблицах и матрицах. Дополнительные сведения см. в разделе [Индикаторы (построитель отчетов и службы SSRS)](report-design/indicators-report-builder-and-ssrs.md).  
  
#### <a name="to-display-the-present-state-of-a-kpi-using-an-indicator"></a>Отображение текущего состояния ключевого показателя эффективности с помощью индикатора  
  
1.  Переключитесь в режим конструктора.  
  
2.  В таблице, щелкните правой кнопкой мыши маркер столбца ячейки, измененной в предыдущей процедуре, пункты **вставить столбец**, а затем нажмите кнопку **справа**. В таблицу добавится новый столбец.  
  
3.  Тип **ключевого показателя Эффективности** в заголовке столбца.  
  
4.  Щелкните ячейку подытога подкатегории.  
  
5.  На **вставить** на вкладке **областей данных** группе, дважды щелкните **индикатора.**  
  
     Откроется диалоговое окно **Выбор стиля индикатора** .  
  
6.  Нажмите кнопку **фигур**. Первый тип фигуры, **3 сигнала трафика (без Ободка)** выбран.  
  
     Именно этот индикатор и будет использоваться в данном учебнике.  
  
7.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
     Индикатор будет добавлен в область конструктора.  
  
8.  Щелкните индикатор правой кнопкой мыши и выберите пункт **Свойства индикатора**.  
  
9. Нажмите кнопку **значения и состояния**.  
  
10. В раскрывающемся списке значение выберите **[Sum(Sales)]**, но не изменяйте другие параметры.  
  
     По умолчанию синхронизация данных происходит в пределах области данных, а значение **Tablix1**, имя табличной области данных из отчета, отображается в поле **Область синхронизации** .  
  
     В этом отчете можно также изменить область индикатора, помещенного в ячейку подытога подкатегории, чтобы синхронизация выполнялась в поле SalesDate.  
  
11. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
##  <a name="Title"></a> 6. Добавление заголовка отчета  
 Заголовок отчета отображается в верхней части отчета. Можно поместить заголовок отчета в верхнем колонтитуле или, если в отчете колонтитулы не используются, в текстовом поле в верхней части текста отчета. Используется текстовое поле, которое автоматически размещается в верхней части текста отчета.  
  
 Текст можно улучшить, применяя к отдельным символам различные стили шрифтов, размеры и цвета. Дополнительные сведения см. в разделе [Форматирование текста в текстовом поле &#40;построитель отчетов и службы SSRS&#41;](report-design/format-text-in-a-text-box-report-builder-and-ssrs.md).  
  
#### <a name="to-add-a-report-title"></a>Добавление заголовка отчета  
  
1.  В области конструктора щелкните ссылку **Щелкните, чтобы добавить заголовок**.  
  
2.  Тип **ключевой показатель Эффективности продаж продукта**, а затем щелкните за пределами текстового поля.  
  
3.  При необходимости щелкните правой кнопкой мыши текстовое поле, которое содержит **ключевой показатель Эффективности продаж продукта**, нажмите кнопку **свойства текстового поля**, а затем на вкладке «Шрифт» выберите нужные стили шрифтов, размеры и цвета.  
  
4.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
##  <a name="Save"></a> 7. Сохранение отчета  
 Сохраните отчет на сервере отчетов или на своем компьютере. Если не сохранить отчет на сервере отчетов, некоторые функции служб [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] , в том числе элементы отчета и вложенные отчеты, будут недоступны.  
  
#### <a name="to-save-the-report-on-a-report-server"></a>Сохранение отчета на сервере отчетов  
  
1.  Нажмите кнопку **Построитель отчетов** и выберите **Сохранить как**.  
  
2.  Нажмите кнопку **Последние сайты и серверы**.  
  
3.  Выберите или введите имя сервера отчетов, для которого существует разрешение на сохранение отчетов.  
  
     Появится сообщение «Соединение с сервером отчетов». После того как соединение установлено, пользователю представляется содержимое папки, заданной администратором сервера отчетов как место по умолчанию для отчетов.  
  
4.  В поле **Имя**замените имя по умолчанию фразой **Ключевой показатель эффективности продаж товаров**.  
  
5.  Нажмите кнопку **Сохранить**.  
  
 Отчет будет сохранен на сервере отчетов. Имя сервера отчетов, с которым установлено соединение, будет отображено в строке состояния в нижней части окна.  
  
#### <a name="to-save-the-report-on-your-computer"></a>Сохранение отчета на компьютере  
  
1.  Нажмите кнопку **Построитель отчетов** и выберите **Сохранить как**.  
  
2.  Перейдите на **Рабочий стол**, откройте папку **Мои документы**или **Мой компьютер**и перейдите в папку, в которую нужно сохранить отчет.  
  
> [!NOTE]  
>  При отсутствии доступа к серверу отчетов на **рабочем столе**откройте папку **Мои документы**или **Мой компьютер** и сохраните отчет на компьютере.  
  
1.  В поле **Имя**замените имя по умолчанию фразой **Ключевой показатель эффективности продаж товаров**.  
  
2.  Нажмите кнопку **Сохранить**.  
  
## <a name="next-steps"></a>Next Steps  
 Учебник «Добавление ключевого показателя эффективности в отчет» успешно завершен. Дополнительные сведения см. в разделе датчики (построитель отчетов) [индикаторы &#40;построитель отчетов и службы SSRS&#41;](report-design/indicators-report-builder-and-ssrs.md).  
  
## <a name="see-also"></a>См. также  
 [Учебники по &#40;построитель отчетов&#41;](report-builder-tutorials.md)   
 [Построитель отчетов в SQL Server 2014](report-builder/report-builder-in-sql-server-2016.md)  
  
  
