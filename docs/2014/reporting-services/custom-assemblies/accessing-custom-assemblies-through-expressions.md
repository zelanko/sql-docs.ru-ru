---
title: Доступ к пользовательским сборкам с использованием выражений | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.suite: ''
ms.technology:
- docset-sql-devref
- reporting-services-native
ms.tgt_pltfrm: ''
ms.topic: reference
helpviewer_keywords:
- expressions [Reporting Services], custom assemblies
- static member calls
- instance member calls [Reporting Services]
- calling class members
- custom assemblies [Reporting Services], expressions
ms.assetid: 917c4d47-1a95-4f54-98b1-e8cb2165d90f
caps.latest.revision: 31
author: markingmyname
ms.author: maghan
manager: craigg
ms.openlocfilehash: 1ba043a1a8d817432976e726dd11f84243f389ad
ms.sourcegitcommit: c18fadce27f330e1d4f36549414e5c84ba2f46c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2018
ms.locfileid: "37250044"
---
# <a name="accessing-custom-assemblies-through-expressions"></a>Доступ к пользовательским сборкам посредством выражений
  После того как пользовательская сборка была создана, сделана доступной для конструктора отчетов или сервера отчетов, добавлена к подходящей политике безопасности, а также после того, как в определение отчета была добавлена ссылка на данную пользовательскую сборку, появится возможность доступа к членам классов сборки посредством выражений отчетов. Для ссылки в выражении на пользовательский код следует вызвать элемент класса этой сборки. Способ создания ссылки зависит от того, является ли метод статическим или основывается на экземпляре.  
  
## <a name="calling-static-members-from-a-report-definition-file"></a>Вызов статических членов из файла определения отчета  
 Статические члены принадлежат классу или типу, а не к созданному объекту. Доступ к данным членам можно получить, напрямую вызвав их из класса.  По возможности для вызова пользовательских функций в отчете следует использовать статические члены, поскольку они обладают большей производительностью. Для вызова статического члена необходимо сослаться на него как на выражение, принимающее вид =*Namespace.Class.Method*.  
  
#### <a name="to-call-static-members"></a>Вызов статических членов  
  
-   Для вызова статического члена следует установить выражение равным полностью указанному имени члена, в которое включено пространство имен, имя класса и имя члена. Следующий пример вызывает метод **ToGBP**, преобразующий значение поля **StandardCost** из долларов в фунты стерлингов и отображающий это в отчете.  
  
    ```  
    =CurrencyConversion.DollarCurrencyConversion.ToGBP(Fields!StandardCost.Value)  
    ```  
  
### <a name="important-information-regarding-static-fields-and-properties"></a>Важные сведения о статических полях и свойствах  
 В данный момент все отчеты выполняются в одном и том же домене приложения. Это означает, что те отчеты, в которых присутствуют пользовательские статические данные, предоставляют доступ к этим данным другим экземплярам того же отчета. В связи с этим статические данные одного пользователя могут стать доступны всем пользователям, которые в данное время выполняют этот определенный отчет. В связи с этим не рекомендуется использовать статические поля или свойства в пользовательских сборках или в элементе **Code**; вместо этого в отчетах следует использовать поля или свойства экземпляров. Однако статические методы можно использовать, поскольку они не сохраняют состояния или данные.  
  
## <a name="calling-instance-members-from-a-report-definition-file"></a>Вызов членов экземпляров из файла определения отчета  
 Если в пользовательской сборке содержатся члены экземпляров, к которым нужно обращаться из определения отчета, то в отчет следует добавить имя экземпляра класса. Имя экземпляра для класса можно добавить, использовав вкладку **Код** диалогового окна **Свойства отчета**. Дополнительные сведения о добавлении экземпляров классов в отчет см. в разделе [Пользовательский код и ссылки на сборки в выражениях в конструкторе отчетов &#40;SSRS&#41;](../report-design/custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).  
  
 Для вызова статического члена необходимо сослаться на него как на выражение, принимающее следующий вид =Code *.ИмяЭкземпляра.Метод*.  
  
#### <a name="to-call-instance-members"></a>Вызов членов экземпляра  
  
-   Для вызова члена экземпляра пользовательской сборки необходимо создать ссылку на ключевое слово **Code**, за которым следует имя экземпляра и метод. Следующий пример вызывает метод экземпляра **ToEUR**, преобразующий значение поля **StandardCost** из долларов в евро и отображающий это в отчете.  
  
    ```  
    =Code.m_myDollarCoversion.ToEUR(Fields!StandardCost.Value)  
    ```  
  
## <a name="see-also"></a>См. также  
 [Использование пользовательских сборок с отчетами](using-custom-assemblies-with-reports.md)  
  
  
