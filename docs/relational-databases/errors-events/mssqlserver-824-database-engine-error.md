---
title: MSSQLSERVER_824 | Документация Майкрософт
ms.custom: ''
ms.date: 04/04/2017
ms.prod: sql
ms.reviewer: ''
ms.technology: supportability
ms.topic: language-reference
helpviewer_keywords:
- 824 (Database Engine error)
ms.assetid: 2aa22246-2712-4fdb-9744-36e7e6f3175e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c3fa77a50b32541a4ed9b8742bebe04e4e735b45
ms.sourcegitcommit: 58158eda0aa0d7f87f9d958ae349a14c0ba8a209
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2020
ms.locfileid: "80342930"
---
# <a name="mssqlserver_824"></a>MSSQLSERVER_824
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]
  
## <a name="details"></a>Сведения  
  
|||  
|-|-|  
|Название продукта|SQL Server|  
|Идентификатор события|824|  
|Источник события|MSSQLSERVER|  
|Компонент|SQLEngine|  
|Символическое имя|B_HARDSSERR|  
|Текст сообщения|SQL Server обнаружил логическую ошибку ввода-вывода, связанную с согласованностью: %ls. Она произошла при %S_MSG страницы %S_PGID в базе данных с идентификатором %d по смещению %#016I64x файла «%ls».  Дополнительные сведения см. в журнале ошибок SQL Server и журнале системных событий.|  
  
## <a name="symptom"></a>Симптом  


В журнале ошибок SQL Server или журнале событий приложений Windows может появиться следующее сообщение об ошибке, если после чтения или записи базы данных произошел сбой проверки логической согласованности:
 
``` 
2009-11-02 15:46:42.90 spid51      Error: 824, Severity: 24, State: 2.
2009-11-02 15:46:42.90 spid51      SQL Server detected a logical consistency-based I/O error: incorrect pageid (expected 1:43686; actual 0:0). It occurred during a read of page (1:43686) in database ID 23 at offset 0x0000001554c000 in file 'H:\MSSQL.SQL2008\MSSQL\DATA\my_db.mdf'.  Additional messages in the SQL Server error log or system event log may provide more detail. This is a severe error condition that threatens database integrity and must be corrected immediately. Complete a full database consistency check (DBCC CHECKDB). This error can be caused by many factors; for more information, see SQL Server Books Online.
```
 
Если приложение встречает это сообщение во время запроса или изменения данных, сообщение об ошибке возвращается в приложение, и подключение к базе данных завершается. 
  
## <a name="cause"></a>Причина
Эта ошибка говорит о следующем: Windows сообщает об успешном считывании страницы с диска, но [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] обнаружил некоторые повреждения страницы. Данная ошибка схожа с ошибкой 823, за исключением того, что ОС Windows ее не обнаружила. Чаще всего это говорит о проблеме с подсистемой ввода-вывода, например сбое жесткого диска, проблемах со встроенным ПО диска, драйверами устройств и т. д. Дополнительные сведения об ошибках ввода-вывода см. в [главе 2 документации Майкрософт об основных операциях ввода-вывода в SQL Server](/previous-versions/sql/sql-server-2005/administrator/cc917726(v=technet.10)).  

SQL Server использует API Windows, например ReadFile, WriteFile, ReadFileScatter, WriteFileGather, для операций ввода-вывода. После выполнения этих операций ввода-вывода SQL Server проверяет наличие ошибок, связанных с вызовами этих API. Если при вызове API происходит сбой из-за ошибки операционной системы, SQL Server сообщает об ошибке 823. Возможны ситуации, когда вызов API Windows фактически выполняется успешно, но данные, передаваемые операцией ввода-вывода, могли столкнуться с проблемой логической согласованности. Эти проблемы с логической согласованностью выводятся через ошибку 824.
 
В сообщении об ошибке 824 содержатся следующие сведения:

- Файл базы данных, для которого была выполнена операция ввода-вывода.
- Смещение в файле, где была предпринята попытка выполнить операцию ввода-вывода.
- База данных, которой принадлежит этот файл.
- Номер страницы, включенной в операцию ввода-вывода.
- Была ли это операция чтения или записи.
- Сведения о проверке логической согласованности, которая завершилась ошибкой [тип проверки, фактическое значение и ожидаемое значение, используемое для этой проверки].
 
Эти проверки логической согласованности являются дополнительными проверками целостности, выполняемыми SQL Server, чтобы гарантировать, что определенные ключевые аспекты данных, вовлеченных в передачу, поддерживались в ходе операции ввода-вывода. К этим проверкам относятся контрольная сумма, обрыв страницы, короткий перенос, неверный идентификатор страницы, устаревшее чтение, ошибка аудита страницы. Характер выполненных проверок зависит от различных параметров конфигурации на уровне базы данных и сервера. 
 
Сообщение об ошибке 824 обычно указывает на наличие проблемы с базовой системой хранения данных, оборудованием или драйвером в пути запроса ввода-вывода. Эта ошибка может возникать, если в файловой системе возникли несоответствия или если файл базы данных поврежден.

## <a name="resolution"></a>Решение  

При возникновении ошибки 824 можно попробовать следующие решения. 

- Проверьте таблицу [suspect_pages](../backup-restore/manage-the-suspect-pages-table-sql-server.md) в msdb на наличие других страниц, которые сталкиваются с этой проблемой (в той же или другой базе данных).
- Проверьте согласованность баз данных, расположенных на том же томе (что и в сообщении 824), с помощью команды DBCC CHECKDB. Если при выполнении команды DBCC CHECKDB обнаружены несоответствия, используйте инструкции из статьи базы знаний [Устранение ошибок согласованности базы данных, обнаруженных командой DBCC CHECKDB](https://support.microsoft.com/help/2015748/how-to-troubleshoot-database-consistency-errors-reported-by-dbcc-check).
- Если в базе данных, в которой обнаруживаются ошибки 824, не включен параметр PAGE_VERIFY CHECKSUM, включите его. Ошибки 824 могут возникать по другим причинам, кроме ошибки контрольной суммы, но CHECKSUM обеспечивает наилучший вариант проверки согласованности страницы после ее записи на диск.
- Проверьте журналы событий Windows на наличие ошибок или сообщений от операционной системы, устройства хранения или драйвера устройства. Если они связаны с этой ошибкой, сначала устраните эти ошибки. Например, помимо сообщения 824, можно также увидеть событие вроде "Драйвер обнаружил ошибку контроллера в \Device\Harddisk4\DR4", о которой сообщает дисковый источник в журнале событий. В этом случае необходимо проверить наличие этого файла на устройстве, а затем сначала исправить ошибки диска.
- Используйте служебную программу [SQLIOSim](https://support.microsoft.com/help/231619/how-to-use-the-sqliosim-utility-to-simulate-sql-server-activity-on-a-d), чтобы узнать, можно ли воспроизвести ошибки 824 за пределами обычных запросов ввода-вывода SQL Server. SQLIOSim поставляется с SQL Server 2008, поэтому нет необходимости в отдельном скачивании для этой или более поздних версий.
- Обратитесь к поставщику оборудования или изготовителю устройства, чтобы убедиться, что:
   - аппаратные устройства и конфигурация соответствуют [требованиям к вводу-выводу SQL Server](https://support.microsoft.com/help/967576/microsoft-sql-server-database-engine-input-output-requirements);
   - драйверы устройств и другие программные компоненты, поддерживающие все устройства в пути ввода-вывода, обновлены.
- Если поставщик оборудования или производитель устройства предоставил вам диагностические служебные программы, используйте их для проверки работоспособности системы ввода-вывода.
- Проверьте, нет ли драйверов фильтров, которые находятся в пути этих запросов ввода-вывода и вызывают проблемы.
   - Проверьте наличие обновлений для этих драйверов фильтра.
   - Можно ли удалить или отключить эти драйверы фильтра, чтобы определить, не исчезает ли проблема, связанная с ошибкой 824.
- Если проблема не связана с оборудованием и имеется безошибочная резервная копия, восстановите базу данных из этой копии.  

## <a name="see-also"></a>См. также:  
[Управление таблицей suspect_pages (SQL Server)](~/relational-databases/backup-restore/manage-the-suspect-pages-table-sql-server.md)  
  
