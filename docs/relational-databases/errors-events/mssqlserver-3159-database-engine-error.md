---
title: "MSSQLSERVER_3159 | Документация Майкрософт"
ms.custom: 
ms.date: 04/04/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- database-engine
ms.tgt_pltfrm: 
ms.topic: language-reference
helpviewer_keywords:
- 3159 (Database Engine error)
ms.assetid: c93c1003-0e3a-40aa-9873-44a0f5b8b57e
caps.latest.revision: 16
author: BYHAM
ms.author: rickbyh
manager: jhubbard
ms.workload: Inactive
ms.translationtype: Human Translation
ms.sourcegitcommit: 2edcce51c6822a89151c3c3c76fbaacb5edd54f4
ms.openlocfilehash: 2cbb7fbb13780dac80c8c8b4f4c38734df2f0f4a
ms.contentlocale: ru-ru
ms.lasthandoff: 06/22/2017

---
# <a name="mssqlserver3159"></a>MSSQLSERVER_3159
  
## <a name="details"></a>Сведения  
  
|||  
|-|-|  
|Название продукта|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]|  
|Идентификатор события|3159|  
|Источник события|MSSQLSERVER|  
|Компонент|SQLEngine|  
|Символическое имя|LDDB_LOGNOTBACKEDUP|  
|Текст сообщения|Не удалось создать резервную копию заключительного фрагмента журнала базы данных «%s». Если журнал содержит работу, потеря которой нежелательна, создайте резервную копию с помощью инструкции BACKUP LOG WITH NORECOVERY. Чтобы просто перезаписать содержимое журнала, используются предложения WITH REPLACE или WITH STOPAT с инструкцией RESTORE.|  
  
## <a name="explanation"></a>Объяснение  
В большинстве случаев при использовании модели восстановления с неполным протоколированием или полной модели в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] необходимо создать резервную копию заключительного фрагмента журнала, чтобы захватить записи журнала, резервной копии которых еще нет. Резервная копия журнала, созданная для заключительного фрагмента журнала непосредственно перед операцией восстановления, называется резервной копией заключительного фрагмента журнала.  
  
При восстановлении базы данных в состояние на момент сбоя резервная копия заключительного фрагмента журнала является наименее важной в плане восстановления. Если резервную копию заключительного фрагмента журнала создать невозможно, то базу данных можно восстановить только до конца последней резервной копии, созданной до сбоя.  
  
Обычно в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] перед восстановлением резервной копии базы данных необходимо создавать резервную копию заключительного фрагмента журнала. Резервная копия заключительного фрагмента журнала предотвращает потерю работы и поддерживает целостность цепочки журналов. Однако резервная копия заключительного фрагмента журнала требуется не для всех сценариев восстановления. Резервная копия заключительного фрагмента журнала не нужна, если точка восстановления содержится в более ранней резервной копии журнала или если выполняется перемещение или замещение (перезапись) базы данных, когда не нужно восстанавливать ее на определенный момент времени после последней резервной копии. Кроме того, если файлы журналов повреждены и невозможно создать резервную копию заключительного фрагмента журнала, то восстанавливать базу данных следует без использования резервной копии заключительного фрагмента журнала. Будут потеряны любые транзакции, зафиксированные после создания последней резервной копии журнала. Дополнительные сведения см. ниже в подразделе «Восстановление без использования резервной копии заключительного фрагмента журнала».  
  
> [!CAUTION]  
> Параметр REPLACE следует использовать редко и очень аккуратно.  
  
## <a name="user-action"></a>Действие пользователя  
Создайте резервную копию заключительного фрагмента журнала и повторите операцию восстановления.  
  
Если не удается создать резервную копию заключительного фрагмента журнала, то следует использовать предложения WITH STOPAT или WITH REPLACE с инструкцией RESTORE.  
  
## <a name="see-also"></a>См. также:  
[Восстановление базы данных SQL Server до определенного момента времени (модель полного восстановления)](~/relational-databases/backup-restore/restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md)  
[Создание резервной копии журнала транзакций при повреждении базы данных (SQL Server)](~/relational-databases/backup-restore/back-up-and-restore-of-system-databases-sql-server.md)  
[Создание резервной копии журнала транзакций &#40;SQL Server&#41;](~/relational-databases/backup-restore/back-up-a-transaction-log-sql-server.md)  
[Резервные копии заключительного фрагмента журнала (SQL Server)](~/relational-databases/backup-restore/tail-log-backups-sql-server.md)  
  

