---
title: Просмотр файлов журнала в режиме "вне сети" | Документация Майкрософт
description: Узнайте, как просматривать файлы журнала SQL Server из локальных и удаленных экземпляров SQL Server, когда целевого экземпляра нет в сети или он не может запуститься.
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
helpviewer_keywords:
- Log File Viewer, viewing offline logs
- offline log files
ms.assetid: 9223e474-f224-4907-a4f2-081e11db58f5
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 4f0f124b9073335a5dc681c34fb7fa977123f04c
ms.sourcegitcommit: 4d370399f6f142e25075b3714e5c2ce056b1bfd0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91869282"
---
# <a name="view-offline-log-files"></a>просматривать файлы журнала в режиме «вне сети»
 [!INCLUDE [SQL Server](../../includes/applies-to-version/sqlserver.md)]
  Начиная с версии [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], появилась возможность просматривать файлы журнала [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на локальных и удаленных экземплярах [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которые находятся вне сети или не могут запуститься.  
  
 Получить доступ к файлам журналов вне сети можно в списке «Зарегистрированные серверы» или программным способом с помощью запросов WMI и WQL.  
  
> [!NOTE]  
>  Эти методы подходят для подключения к экземпляру в сети, к которому по ряду причин нельзя подключиться с помощью соединения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
## <a name="before-you-begin"></a>Перед началом работы  
 Чтобы подключиться к файлам журналов вне сети, на компьютере, который используется для просмотра автономных файлов журнала, и на компьютере, на котором расположены файлы журналов для просмотра, должен быть установлен экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Если на обоих компьютерах установлен экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , то на каждом из них можно просматривать «вне сети» файлы журналов для экземпляров [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]и экземпляров, на которых выполняется [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] более ранней версии.  
  
 При использовании списка "Зарегистрированные серверы" экземпляр, к которому нужно подключиться, должен быть зарегистрирован в **Группы локальных серверов** или **Центральные серверы управления**. (Экземпляр может быть зарегистрирован сам по себе или в качестве члена группы серверов.) Дополнительные сведения о добавлении экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в список «Зарегистрированные серверы» см. в следующих разделах:  
  
-   [Создание или изменение группы серверов (среда SQL Server Management Studio)](../../ssms/register-servers/create-or-edit-a-server-group-sql-server-management-studio.md)  
  
-   [Регистрация подключенного сервера (среда SQL Server Management Studio)](../../ssms/register-servers/register-a-connected-server-sql-server-management-studio.md)  
  
-   [Создание центрального сервера управления и группы сервера (среда SQL Server Management Studio)](../../ssms/register-servers/create-a-central-management-server-and-server-group.md)  
  
 Дополнительные сведения о просмотре файлов журналов вне сети программным способом с помощью запросов WMI и WQL см. в следующих разделах:  
  
-   [SqlErrorLogEvent, класс](../../relational-databases/wmi-provider-configuration-classes/sqlerrorlogevent-class.md) (В этом разделе рассматривается извлечение значений событий, зарегистрированных в указанном файле журнала.)  
  
-   [SqlErrorLogFile, класс](../../relational-databases/wmi-provider-configuration-classes/sqlerrorlogfile-class.md) (В этом разделе рассматривается извлечение данных из всех файлов журнала [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в указанном экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].)  
  
##  <a name="permissions"></a><a name="BeforeYouBegin"></a> Permissions  
 Для подключения к файлу журнала вне сети необходимы следующие разрешения на локальном и на удаленном компьютерах.  
  
-   Доступ для чтения к пространству имен WMI **Root\Microsoft\SqlServer\ComputerManagement12** . По умолчанию доступ для чтения задается для всех с помощью разрешения «Включить учетную запись». Дополнительные сведения см. в описании процедуры «Проверка разрешений WMI» этого раздела.  
  
-   Разрешение на чтение для папки, содержащей файлы журналов ошибок. По умолчанию файлы журналов ошибок находятся по следующему пути (где \<*Drive>* представляет диск, на котором установлен [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], а \<*InstanceName*> является именем экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]):  
  
     **\<Drive>:\Program Files\Microsoft SQL Server\MSSQL13.\<InstanceName>\MSSQL\Log**  
  
 Для проверки параметров безопасности пространства имен WMI можно использовать оснастку «Элемент управления WMI».  
  
#### <a name="to-verify-wmi-permissions"></a>Проверка разрешений WMI  
  
1.  Откройте оснастку «Элемент управления WMI». Для этого выполните одно из следующих действий в зависимости от операционной системы.  
  
    -   Нажмите кнопку **Пуск**, введите **wmimgmt.msc** в поле **Начать поиск** и нажмите клавишу ВВОД.  
  
    -   Нажмите кнопку **Пуск**, выберите пункт **Выполнить**, введите **wmimgmt.msc**и нажмите клавишу ВВОД.  
  
2.  По умолчанию оснастка «Элемент управления WMI» управляет локальным компьютером.  
  
     Чтобы подключиться к удаленному компьютеру, выполните следующие действия.  
  
    1.  Щелкните правой кнопкой мыши **Элемент управления WMI (локальный)** и выберите пункт **Подключение к другому компьютеру**.  
  
    2.  В диалоговом окне **Выбор управляемого компьютера** выберите **Другой компьютер**.  
  
    3.  Введите имя удаленного компьютера и нажмите кнопку **ОК**.  
  
3.  Щелкните правой кнопкой мыши **Элемент управления WMI (локальный)** или **Элемент управления WMI (** _ИмяУдаленногоКомпьютера_ **)** и выберите пункт **Свойства**.  
  
4.  В диалоговом окне **Свойства: элемент управления WMI** перейдите на вкладку **Безопасность** .  
  
5.  В дереве пространства имен найдите и выберите следующее пространство имен:  
  
     **Root\Microsoft\SqlServer\ComputerManagement10**  
  
6.  Перейдите на вкладку **Безопасность**.  
  
7.  Убедитесь в том, что у учетной записи, которая будет использоваться, имеется разрешение **Включить учетную запись** . Это разрешение предоставляет доступ на чтение к объектам WMI.  

### <a name="view-log-files"></a>Просмотр файлов журнала  
 В следующей процедуре демонстрируется просмотр файлов журнала вне сети с помощью списка «Зарегистрированные серверы». Для этой процедуры предполагается следующее.  
  
 Экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , к которому нужно подключиться, уже зарегистрирован в списке «Зарегистрированные серверы».  
  
##### <a name="to-view-log-files-for-instances-that-are-offline"></a>Просмотр файлов журнала для экземпляров вне сети  
  
1.  Если необходимо просмотреть файлы журнала вне сети на локальном экземпляре, среду [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] необходимо запустить с повышенными разрешениями. Для этого при запуске среды [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]щелкните правой кнопкой мыши **SQL Server Management Studio**и выберите команду **Запуск от имени администратора**.  
  
2.  В среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]в меню **Вид** выберите пункт **Зарегистрированные серверы**.  
  
3.  В дереве консоли найдите экземпляр, на котором нужно просмотреть файлы вне сети.  
  
4.  Выполните одно из следующих действий.  
  
    -   Если экземпляр вложен в **Группы локальных серверов**, разверните **Группы локальных серверов**, затем группу серверов (если экземпляр является членом группы), щелкните экземпляр правой кнопкой мыши и выберите пункт **Просмотр журнала SQL Server**.  
  
    -   Если экземпляр сам является центральным сервером управления, разверните **Центральные серверы управления**, щелкните правой кнопкой мыши экземпляр, наведите указатель на пункт **Действия центрального сервера управления**и выберите пункт **Просмотр журнала SQL Server**.  
  
    -   Если экземпляр вложен в **Центральные серверы управления**, разверните **Центральные серверы управления**, затем разверните центральный сервер управления, щелкните экземпляр правой кнопкой мыши (или разверните группу серверов и щелкните экземпляр правой кнопкой мыши), а затем выберите пункт **Просмотр журнала SQL Server**.  
  
5.  При подключении к локальному экземпляру соединение устанавливается с использованием учетных данных текущего пользователя.  
  
     При соединении с удаленным экземпляром в диалоговом окне **Средство просмотра журнала — подключиться как** выполните одно из указанных ниже действий.  
  
    -   Чтобы подключиться от имени текущего пользователя, снимите флажок **Подключиться от имени другого пользователя** и нажмите кнопку **ОК**.  
  
    -   Чтобы подключиться от имени другого пользователя, установите флажок **Подключиться от имени другого пользователя** и нажмите кнопку **Задать пользователя**. При появлении запроса введите учетные данные пользователя (указав имя пользователя в формате *имя_домена*\\*имя_пользователя*) и дважды нажмите кнопку **ОК**, чтобы подключиться.  
  
    > [!NOTE]  
    >  Если файлы журналов загружаются слишком долго, можно нажать кнопку **Стоп** на панели инструментов средства просмотра файлов журналов.  
  
## <a name="see-also"></a>См. также:  
 [Средство просмотра файлов журнала](../../relational-databases/logs/log-file-viewer.md)  
  
