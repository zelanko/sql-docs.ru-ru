---
title: Создание, изменение и удаление пространственных индексов | Документация Майкрософт
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: database-engine, sql-database
ms.reviewer: ''
ms.technology:
- dbe-spatial
ms.topic: conceptual
helpviewer_keywords:
- indexes [SQL Server], creating
- spatial indexes [SQL Server], dropping
- spatial indexes [SQL Server], creating
- indexes [SQL Server], dropping
- indexes [SQL Server], modifying
- spatial indexes [SQL Server], modifying
ms.assetid: 00c1b927-8ec5-44cf-87c2-c8de59745735
author: douglaslMS
ms.author: douglasl
manager: craigg
monikerRange: =azuresqldb-current||>=sql-server-2016||=sqlallproducts-allversions||>=sql-server-linux-2017||=azuresqldb-mi-current
ms.openlocfilehash: f4582efcfd91c71e1b40b454712d5d0afeeb8765
ms.sourcegitcommit: 61381ef939415fe019285def9450d7583df1fed0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47646452"
---
# <a name="create-modify-and-drop-spatial-indexes"></a>Создание, изменение и удаление пространственных индексов
[!INCLUDE[appliesto-ss-asdb-xxxx-xxx-md](../../includes/appliesto-ss-asdb-xxxx-xxx-md.md)]
  Пространственный индекс позволяет более эффективно выполнять определенные операции со столбцами, содержащими данные типа **geometry** или **geography** ( *пространственные столбцы*). Для пространственного столбца может быть задано несколько пространственных индексов. Это целесообразно, например, при индексировании различных параметров тесселяции в одном столбце.  
  
 На создание пространственных индексов накладывается ряд ограничений. Дополнительные сведения см. в подразделе [Ограничения пространственных индексов](#restrictions) далее в этом разделе.  
  
> [!NOTE]  
>  Дополнительные сведения о связи пространственных индексов с секциями и файловыми группами см. в подразделе "Примечания" раздела [CREATE SPATIAL INDEX (Transact-SQL)](../../t-sql/statements/create-spatial-index-transact-sql.md).  
  
##  <a name="creating"></a> Создание, изменение и удаление пространственных индексов  
  
###  <a name="create"></a> Создание пространственного индекса  
 **Создание нового пространственного индекса с помощью Transact-SQL**  
 [CREATE SPATIAL INDEX (Transact-SQL)](../../t-sql/statements/create-spatial-index-transact-sql.md)  
  
 **Создание пространственного индекса с помощью диалогового окна «Создание индекса» в среде Management Studio**  
 ##### <a name="to-create-a-spatial-index-in-management-studio"></a>Создание пространственного индекса в среде Management Studio  
  
1.  В обозревателе объектов подключитесь к экземпляру компонента [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] и разверните его.  
  
2.  Разверните узел **Базы данных**, разверните базу данных, содержащую таблицу с нужным индексом, а затем — узел **Таблицы**.  
  
3.  Раскройте таблицу, для которой необходимо создать индекс.  
  
4.  Щелкните правой кнопкой мыши **Индексы** и в контекстном меню выберите команду **Создать индекс**.  
  
5.  В поле **Имя индекса** введите имя индекса.  
  
6.  В раскрывающемся списке **Тип индекса** выберите **Пространственный**.  
  
7.  Чтобы указать пространственный столбец, который необходимо проиндексировать, нажмите кнопку **Добавить**.  
  
8.  В диалоговом окне **Выбор столбцов из** *\<имя таблицы>* выберите столбец типа **geometry** или **geography**, установив рядом с ним флажок. Остальные пространственные столбцы при этом станут недоступными для редактирования. Если необходимо выбрать другой пространственный столбец, то сначала нужно снять флажок со столбца, выбранного в данный момент. После завершения нажмите кнопку **ОК**.  
  
9. Проверьте выбор столбца в сетке **Ключевые столбцы индекса** .  
  
10. В области **Выбор страницы** диалогового окна **Свойства индекса** щелкните **Пространственный**.  
  
11. На странице **Пространственный** укажите значения, которые необходимо использовать для пространственных свойств индекса.  
  
     При создании индекса для столбца типа **geometry** необходимо указать координаты **(**_X-min_**,**_Y-min_**)** и **(**_X-max_**,**_Y-max_**)** ограничивающего прямоугольника. При создании индекса для столбца типа **geography** после задания схемы тесселяции **Географическая сетка** поля ограничивающего прямоугольника становятся доступными только для чтения, так как в тесселяции географической сетки ограничивающий прямоугольник не используется.  
  
     При необходимости можно указать нестандартные значения для поля **Число ячеек на объект** и для плотности сетки на любом уровне схемы тесселяции. По умолчанию количество ячеек на объект составляет 16 для [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] или 8 для [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] или более поздней версии, а плотность сетки — **Средняя** для [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].  
  
     В [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]можно выбрать схему тесселяции GEOMETRY_AUTO_GRID или GEOGRAPHY_AUTO_GRID. При выборе GEOMETRY_AUTO_GRID или GEOGRAPHY_AUTO_GRID параметры плотности сетки «Уровень 1», «Уровень 2», «Уровень 3» и «Уровень 4» будут отключены.  
  
     Дополнительные сведения об этих свойствах см. в разделе [Справка F1 свойств индекса](../../relational-databases/indexes/index-properties-f1-help.md).  
  
12. Нажмите кнопку **ОК**.  
  
> [!NOTE]  
>  Чтобы создать другой пространственный индекс на том же или другом пространственном столбце, повторите предыдущие шаги.  
  
  
 **Создание пространственного индекса с помощью конструктора таблиц в среде Management Studio**  
 ##### <a name="to-create-a-spatial-index-in-table-designer"></a>Создание пространственного индекса в конструкторе таблиц  
  
1.  В обозревателе объектов щелкните правой кнопкой мыши таблицу, для которой нужно создать пространственный индекс, и выберите пункт **Конструктор**.  
  
     Таблица откроется в конструкторе таблиц.  
  
2.  Выберите для индекса столбец **geometry** или **geography** .  
  
3.  В меню **Конструктор таблиц** выберите пункт **Пространственный индекс**.  
  
4.  В диалоговом окне **Пространственные индексы** нажмите кнопку **Добавить**.  
  
5.  Выберите новый индекс в списке **Выбранные пространственные индексы** и в сетке справа задайте свойства пространственного индекса. Дополнительные сведения о свойствах см. в разделе [Диалоговое окно "Пространственные индексы" (визуальные инструменты для баз данных)](http://msdn.microsoft.com/library/4d84239a-68c7-4aa2-8602-2b51dd07260f).  
  
  
###  <a name="alter"></a> Изменение пространственного индекса  
  
-   [ALTER INDEX (Transact-SQL)](../../t-sql/statements/alter-index-transact-sql.md)  
  
    > [!IMPORTANT]  
    >  Чтобы изменить параметры, характерные для пространственного индекса (такие как BOUNDING_BOX или GRID), необходимо либо применить инструкцию CREATE SPATIAL INDEX с параметром DROP_EXISTING = ON, либо удалить пространственный индекс и создать новый. Пример см. в разделе [CREATE SPATIAL INDEX (Transact-SQL)](../../t-sql/statements/create-spatial-index-transact-sql.md).  
  
-   [Изменение индекса](../../relational-databases/indexes/modify-an-index.md)  
  
-   [Перемещение существующего индекса в другую файловую группу](../../relational-databases/indexes/move-an-existing-index-to-a-different-filegroup.md)  
  
  
###  <a name="drop"></a> Удаление пространственного индекса  
 **Удаление пространственного индекса с помощью Transact-SQL**  
 [DROP INDEX (Transact-SQL)](../../t-sql/statements/drop-index-transact-sql.md)  
  
 **Удаление индекса с помощью среды Management Studio**  
 [Удаление индекса](../../relational-databases/indexes/delete-an-index.md)  
  
 **Удаление пространственного индекса с помощью конструктора таблиц в среде Management Studio**  
 ##### <a name="to-drop-a-spatial-index-in-table-designer"></a>Удаление пространственного индекса в конструкторе таблиц  
  
1.  В обозревателе объектов щелкните правой кнопкой мыши таблицу с пространственным индексом, который необходимо удалить, и выберите пункт **Конструктор**.  
  
     Таблица откроется в конструкторе таблиц.  
  
2.  В меню **Конструктор таблиц** выберите пункт **Пространственный индекс**.  
  
     Откроется диалоговое окно **Пространственный индекс** .  
  
3.  Щелкните удаляемый индекс в столбце **Выбранные пространственные индексы** .  
  
4.  Щелкните **Удалить**.  
  
  
##  <a name="restrictions"></a> Ограничения пространственных индексов  
 Пространственный индекс можно создать только для столбца типа **geometry** или **geography**.  
  
### <a name="table-and-view-restrictions"></a>Ограничения таблиц и представлений  
 Пространственные индексы можно определить только для таблицы, у которой имеется первичный ключ. Максимально допустимое число столбцов первичного ключа составляет 15.  
  
 Размер записей ключа индекса не должен превышать 895 байт. Размеры, превышающие указанное значение, приводят к ошибке.  
  
> [!NOTE]  
>  Пока для таблицы определен пространственный индекс, изменить метаданные первичного ключа невозможно.  
  
 Пространственные индексы не могут быть заданы в индексированных представлениях.  
  
### <a name="multiple-spatial-index-restrictions"></a>Ограничения количества пространственных индексов  
 На любом из пространственных столбцов поддерживаемой таблицы можно создать до 249 пространственных индексов. Создание нескольких пространственных индексов на одном и том же пространственном столбце может оказаться целесообразным, например, для индексации различных параметров тесселяции в одном столбце.  
  
 Одновременно можно создать только один пространственный индекс.  
  
### <a name="spatial-indexes-and-process-parallelism"></a>Пространственные индексы и параллелизм процессов  
 Для построения индексов можно воспользоваться доступным параллелизмом процессов.  
  
### <a name="version-restrictions"></a>Ограничения версии  
 Пространственные тесселяции, введенные в [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] , не могут проходить репликацию в [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] или [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]. Необходимо использовать пространственные тесселяции [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] или [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] для пространственных индексов, чтобы обеспечить обратную совместимость с базами данных [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] или [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] .  
  
  
## <a name="see-also"></a>См. также:  
 [Общие сведения о пространственных индексах](../../relational-databases/spatial/spatial-indexes-overview.md)  
  
  
