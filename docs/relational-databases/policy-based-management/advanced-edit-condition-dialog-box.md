---
title: Диалоговое окно "Расширенное редактирование" (условие) | Документация Майкрософт
ms.custom: ''
ms.date: 08/12/2016
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
f1_keywords:
- sql13.swb.dmf.condition.advancededit.f1
ms.assetid: a0bbe501-78c5-45ad-9087-965d04855663
author: VanMSFT
ms.author: vanto
ms.openlocfilehash: 85e5416df62423ddbfaffb3f8490687cda1349eb
ms.sourcegitcommit: b2e81cb349eecacee91cd3766410ffb3677ad7e2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "68109899"
---
# <a name="advanced-edit-condition-dialog-box"></a>Диалоговое окно «Расширенное редактирование» (условие)
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]
  С помощью диалогового окна **Расширенное редактирование** создаются сложные выражения для условий управления на основе политик.  
  
## <a name="options"></a>Параметры  
 **Значение ячейки**  
 Отображает функцию или выражение, которое будет использовано в качестве значения для ячейки при ее создании. При нажатии кнопки **ОК**значение ячейки появится в ячейке **Поле** или **Значение** в поле выражения условия диалогового окна **Создание нового условия** или **Открытие условия** на странице **Общие** .  
  
 **Функции и свойства**  
 Отображает доступные функции и свойства.  
  
 **Сведения**  
 Отображает сведения о функциях и свойствах в следующем формате: подпись функции, описание функции, возвращаемое значение и пример.  
  
## <a name="syntax"></a>Синтаксис  
 Допустимые выражения должны быть представлены в следующем формате:  
  
 `{property | function | constant}`  
  
 `{operator}`  
  
 `{property | function | constant}`  
  
## <a name="examples"></a>Примеры  
 Ниже приводятся примеры допустимых выражений:  
  
-   *Property1*> 5  
  
-   *Property1*=*Property2*  
  
-   Add(5, Multiply(.2,*Property1*))<*Property2*  
  
-   *Sometext* IN *Property1*  
  
-   *Property1*< Fn(*Property2*)  
  
-   BitwiseAnd(*Property1*,*Property2*)= 0  
  
## <a name="additional-function-information"></a>Дополнительные сведения о функциях  
 В следующих разделах приводятся дополнительные сведения о функциях, которые можно использовать при создании сложных выражений для условий управления на основе политик.  
  
> **ВАЖНО!** В функциях, которые можно использовать для создания условий управления на основе политик, не всегда используется синтаксис [!INCLUDE[tsql](../../includes/tsql-md.md)] . Необходимо следовать синтаксисту примера. Например, при использовании функций **DateAdd** или **DatePart** необходимо заключать аргумент *datepart* в одинарные кавычки.  
  
|Компонент|Сигнатура|Описание|Аргументы|Возвращаемое значение|Пример|  
|--------------|---------------|-----------------|---------------|------------------|-------------|  
|**Add()**|Numeric Add (Numeric *expression1*, Numeric *expression2*)|складывает два числа.|*expression1* и *expression2* . Любое допустимое выражение любого из типов данных в категории числовых данных, кроме типа данных **bit** . Может быть константой, свойством или функцией, возвращающей числовой тип данных.|возвращает тип данных аргумента, у которого более высокий приоритет.|`Add(Property1, 5)`|  
|**Array()**|Array Array (VarArgs *expression*)|создает массив из заданного списка значений. Может использоваться с агрегатными функциями, например Sum() или Count().|*expression* . Выражение, которое должно быть преобразовано в массив.|Массив|`Array(2,3,4,5,6)`|  
|**Avg()**|Numeric Avg (*VarArgs*)|возвращает среднее значение значений в списке аргументов.|*VarArgs* . Список выражений Variant, относящихся к категории точных числовых или приблизительных числовых типов данных, за исключением типа данных **bit** .|возвращаемый тип определяется типом вычисленного результата выражения.<br /><br /> Возвращаемый тип определяется типом вычисленного результата выражения. Если результат выражения относится к категории **integer**, **decimal**, **money** , **smallmoney**, **float** и **real** , то возвращаемыми типами являются **int**, **decimal**, **money**и **float**, соответственно.|`Avg(1.0, 2.0, 3.0, 4.0, 5.0)` в этом примере возвращает значение `3.0` .|  
|**BitwiseAnd()**|Numeric BitwiseAnd (Numeric *expression 1*, Numeric *expression2*)|Выполняет побитовую логическую операцию «И» между двумя целочисленными значениями.|*expression1* и *expression2* . Любое допустимое выражение любого из типов данных категории типов данных integer.|возвращает значение из категории типа данных integer.|`BitwiseAnd(Property1, Property2)`|  
|**BitwiseOr()**|Numeric BitwiseOr (Numeric *expression1*, Numeric *expression2*)|выполняет побитовую логическую операцию «ИЛИ» применительно к двум указанным целочисленным значениям.|*expression1* и *expression2* . Любое допустимое выражение любого из типов данных категории типов данных integer.|возвращает значение из категории типа данных integer.|`BitwiseOr(Property1, Property2)`|  
|**Concatenate()**|String Concatenate (String *string1*, String *string2*)|Объединяет две строки.|*string1* и *string2* — две строки для объединения. Допускаются любые строки со значением, отличным от NULL.|Объединенная строка, в которой за строкой *string1* следует строка *string2*.|`Concatenate("Hello", " World` `")` возвращает "`Hello World`".|  
|**Count()**|Numeric Count (*VarArgs*)|возвращает количество элементов в списке аргументов.|*VarArgs* — это выражение любого типа, за исключением **text**, **image**и **ntext**.|возвращает значение из категории типа данных integer.|`Count(1.0, 2.0, 3.0, 4.0, 5.0)` в этом примере возвращает значение `5` .|  
|**DateAdd()**|DateTime DateAdd (String *datepart*, Numeric *number*, DateTime *date*)|Возвращает новое значение типа **datetime** , получаемое за счет добавления интервала к указанной дате.|*datepart* — параметр, указывающий, для какой части даты вернуть новое значение. Некоторыми из поддерживаемых типов являются: year (yy, yyyy), month (mm, m) и dayofyear (dy, y). Дополнительные сведения см. в разделе [DATEADD (Transact-SQL)](../../t-sql/functions/dateadd-transact-sql.md).<br /><br /> *number* — значение, используемое для увеличения *datepart*.<br /><br /> *date* — выражение, которое возвращает значение типа **datetime** или строку символов в формате даты.|Новое значение типа **datetime** , получаемое за счет добавления интервала к указанной дате.|**Пример**: `DateAdd('day', 21, DateTime('2007-08-06 14:21:50'))` в этом примере возвращает значение `'2007-08-27 14:21:50'`.<br /><br /> В следующей таблице перечислены значения *dateparts* и аббревиатуры, поддерживаемые данной функцией.<br /><br /> **year**: yy, yyyy<br /><br /> **month**: mm, m<br /><br /> **dayofyear**: dy, y<br /><br /> **day**: dd, d<br /><br /> **week**: wk, ww<br /><br /> **weekday**: dw, w<br /><br /> **hour**: hh<br /><br /> **minute**: mi, n<br /><br /> **second**: ss, s<br /><br /> **millisecond**: ms|  
|**DatePart()**|Numeric DatePart (String *datepart*, DateTime *date*)|Возвращает целое число, представляющее указанную часть *datepart* указанной даты.|*datepart* — параметр, который указывает возвращаемую часть даты. Некоторыми из поддерживаемых типов являются: year (yy, yyyy), month (mm, m) и dayofyear (dy, y). Дополнительные сведения см. в разделе [DATEPART (Transact-SQL)](../../t-sql/functions/datepart-transact-sql.md).<br /><br /> *date* — выражение, которое возвращает значение типа **datetime** или строку символов в формате даты.|Возвращает значение из категории типов данных integer, представляя указанную часть *datepart* указанной даты.|`DatePart('month', DateTime('2007-08-06 14:21:50.620'))` в этом примере возвращает значение `8` .|  
|**DateTime()**|DateTime DateTime (String *dateString*)|создает значение типа datetime из строки.|*dateString* . Значение даты и времени в виде строки.|возвращает значение даты и времени, созданное на основе входной строки.|`DateTime('3/12/2006')`|  
|**Divide()**|Numeric Divide (Numeric *expression_dividend*, Numeric *expression_divisor*)|делит одно число на другое.|*expression_dividend* — делимое числовое выражение. Делимое может представлять собой любое допустимое выражение любого из типов данных категории числовых типов данных, кроме типа данных **datetime** .<br /><br /> *expression_divisor* — это числовое выражение, на которое делится делимое. Делитель может представлять собой любое допустимое выражение любого из типов данных категории числовых типов данных, кроме типа данных **datetime** .|возвращает тип данных аргумента, у которого более высокий приоритет.|**Пример:** `Divide(Property1, 2)`<br /><br /> Примечание. Это операция со значениями типа double. Чтобы выполнить целочисленное сравнение, необходимо применить к результатам функцию `Round()`. Например: `Round(Divide(10, 3), 0) = 3`.|  
|**Enum()**|Numeric Enum (String *enumTypeName*, String *enumValueName*)|создает значение типа enum из строки.|*enumTypeName* — представляет собой имя типа enum.<br /><br /> *enumValueName* — значение типа enum.|возвращает значение типа enum в виде числового значения.|`Enum('CompatibilityLevel','Version100')`|  
|**Escape()**|String Escape (String *replaceString*, String *stringToEscape*, String *escapeString*)|Экранирует подстроку входной строки заданной экранизирующей строкой.|*replaceString* — входная строка.<br /><br /> *stringToEscape* — подстрока строки *replaceString*. Это строка, перед которой добавляется экранизирующая строка.<br /><br /> *escapeString* — экранирующая строка, добавляемая перед каждым экземпляром строки *stringToEscape*.|Возвращает измененную строку *replaceString* , в которой перед каждым экземпляром строки *stringToEscape* помещена строка *escapeString*.|`Escape("Hello", "l", "[")` возвращает строку`He[l[lo`.|  
|**ExecuteSQL()**|Variant ExecuteSQL (String *returnType*, String *sqlQuery*)|выполняет запрос [!INCLUDE[tsql](../../includes/tsql-md.md)] к целевому серверу.<br /><br /> Дополнительные сведения о функции ExecuteSql() см. в разделе [Функция ExecuteSql()](https://blogs.msdn.com/b/sqlpbm/archive/2008/07/03/executesql.aspx).|*returnType* — указывает тип данных, возвращаемый инструкцией [!INCLUDE[tsql](../../includes/tsql-md.md)] . Допустимые литералы для *returnType*: **Numeric**, **String**, **Bool**, **DateTime**, **Array** и **Guid**.<br /><br /> *sqlQuery* — строка, содержащая выполняемый запрос.||`ExecuteSQL ('Numeric', 'SELECT COUNT(*) FROM msdb.dbo.sysjobs') <> 0`<br /><br /> Выполняет скалярный запрос Transact-SQL к целевому экземпляру SQL Server. В инструкции `SELECT` можно указать только один столбец; дополнительные столбцы вслед за первым не учитываются. Результирующий запрос должен возвращать только одну строку; дополнительные строки не учитываются. Если запрос возвращает пустой набор, то выражение условия, построенное на функции `ExecuteSQL` , возвращает значение false. `ExecuteSql` поддерживает режимы вычисления **По запросу** и **По расписанию** .<br /><br /> -`@@ObjectName`:<br />                      соответствует полю имени в таблице [sys.objects](../../relational-databases/system-catalog-views/sys-objects-transact-sql.md). Переменная будет заменена именем текущего объекта.<br /><br /> -`@@SchemaName`:  Соответствует полю имени в таблице [sys.schemas](../../relational-databases/system-catalog-views/schemas-catalog-views-sys-schemas.md). Переменная будет заменена именем схемы текущего объекта, если это возможно.<br /><br /> Примечание. Если в инструкцию ExecuteSQL необходимо включить одиночную кавычку, ее следует экранировать второй одиночной кавычкой. Например, чтобы включить ссылку на пользователя с именем O'Brian, следует ввести O''Brian.|  
|**ExecuteWQL()**|Variant ExecuteWQL (string *returnType* , string *namespace*, string *wql*)|выполняет скрипт WQL по отношению к предоставленному пространству имен. Инструкция выборки может содержать только единственный возвращаемый столбец. Если предоставлен больше чем один столбец, выдается ошибка.|*returnType* — указывает тип данных, возвращаемый WQL-запросом. Допустимыми литералами являются **Numeric**, **String**, **Bool**, **DateTime**, **Array**и **Guid**.<br /><br /> *namespace* — пространство имен WMI, для которого выполняется запрос.<br /><br /> *wql* — строка, содержащая выполняемый WQL-запрос.||`ExecuteWQL('Numeric', 'root\CIMV2', 'select NumberOfProcessors from win32_ComputerSystem') <> 0`|  
|**False()**|Bool False()|возвращает логическое значение FALSE.|None|возвращает логическое значение FALSE.|`IsDatabaseMailEnabled = False()`|  
|**GetDate()**|DateTime GetDate()|возвращает системную дату.|None|возвращает системную дату как значение типа DateTime.|`@DateLastModified = GetDate()`|  
|**Guid()**|Guid Guid(String *guidString*)|возвращает значение идентификатора GUID из строки.|*guidString* — строковое представление создаваемого идентификатора GUID.|возвращает идентификатор GUID, созданный на основе строки.|`Guid('12340000-0000-3455-0000-000000000454')`|  
|**IsNull()**|Variant IsNull (Variant *check_expression*, Variant *replacement_value*)|Возвращается значение *check_expression* , если это выражение не равно NULL; в противном случае возвращается значение *replacement_value* . Если тип аргументов отличается, тип аргумента *replacement_value* неявно преобразуется в тип аргумента *check_expression*.|*check_expression* — выражение, для которого проверяется значение NULL. Выражение *check_expression* может иметь любой тип, поддерживаемый для управления на основе политик: Numeric, String, Bool, DateTime, Array и Guid.<br /><br /> *replacement_value* — выражение, возвращаемое, если *check_expression* имеет значение NULL. Аргумент*replacement_value* должен иметь тип, который неявно преобразован в тип *check_expression*.|Возвращаемый тип — *check_expression* в том случае, если значение *check_expression* не равно NULL. В противном случае возвращается тип *replacement_value* .||  
|**Len()**|Numeric Len (*string_expression*)|возвращает количество символов указанного строкового выражения, исключая конечные пробелы.|*string_expression* — оцениваемое строковое выражение.|возвращает значение из категории типа данных integer.|`Len('Hello')` в этом примере возвращает значение `5` .|  
|**Lower()**|String Lower (String *_expression*)|возвращает строку после преобразования всех символов верхнего регистра в нижний регистр.|*expression* — выражение исходной строки.|возвращает строку, которая представляет исходную строку после преобразования всех символов верхнего регистра в нижний регистр.|`Len('HeLlO')` в этом примере возвращает значение `'hello'` .|  
|**Mod()**|Numeric Mod (Numeric *expression_dividend*, Numeric *expression_divisor*)|вычисляет целочисленный остаток после деления первого числового выражения на второе.|*expression_dividend* — делимое числовое выражение. Аргумент*expression_dividend* должен быть допустимым выражением любого типа данных из категории целочисленных или числовых.<br /><br /> *expression_divisor* — это числовое выражение, на которое делится делимое. Аргумент*expression_divisor* должен быть допустимым выражением любого типа данных из категории целочисленных или числовых.|возвращает значение из категории типа данных integer.|`Mod(Property1, 3)`|  
|**Multiply()**|Numeric Multiply (Numeric *expression1*, Numeric *expression2*)|умножает два выражения.|*expression1* и *expression2* — любое допустимое выражение любого из типов данных в категории числовых данных, кроме типа данных **datetime** .|возвращает тип данных аргумента, у которого более высокий приоритет.|`Multiply(Property1, .20)`|  
|**Power()**|Numeric Power (Numeric *numeric_expression*, Numeric *expression_power*)|возвращает значение указанного выражения, возведенное в заданную степень.|*numeric_expression* — выражение категории точного числового или приблизительного числового типа данных, за исключением типа данных bit.<br /><br /> *expression_power* — степень, в которую возводится арумент *numeric_expression*. *expression_power* может быть выражением категории точного или приблизительного числового типа данных, за исключением типа данных **bit** .|Возвращаемым типом является такой же тип, как и у выражения *numeric_expression*.|`Power(Property1, 3)`|  
|**Round()**|Numeric Round (Numeric *expression*, Numeric *expression_precision*)|Возвращает числовое выражение, округленное до указанной длины или точности.|*expression* — выражение категории точного числового или приблизительного числового типа данных, за исключением типа данных **bit** .<br /><br /> *expression_precision* — точность, до которой должно быть округлено значение выражения. Если аргумент *expression_precision* является положительным числом, значение *numeric_expression* округляется до числа десятичных разрядов, указанных в виде длины. Когда *expression_precision* является отрицательным числом, *numeric_expression* округляется слева от точки, отделяющей десятичную дробь от целого числа, как указано в *expression_precision*.|Возвращает тот же тип, что и аргумент *numeric_expression*.|`Round(5.333, 0)`|  
|**String()**|String String (Variant *_expression*)|преобразует данные типа Variant в строку.|*expression* — выражение типа Variant, которое должно быть преобразовано в строку.|возвращает строковое значение выражения типа Variant.|`String(4)`|  
|**Sum()**|Numeric Sum (*VarArgs*)|возвращает сумму всех значений в списке аргументов. Эту функцию можно использовать с численными значениями.|*VarArgs*— список выражений типа Variant, относящихся к категории точных числовых или приблизительных числовых типов данных, за исключением типа данных **bit** .|возвращает сумму всех значений выражения, представленную в наиболее точном формате данных.<br /><br /> Если результат выражения относится к категории **integer**, **numeric**, **money** , **small money**, **float** и **real** ,то возвращаемыми типами являются **int**, **numeric**, **money**и **float**, соответственно.|`Sum(1.0, 2.0, 3.0, 4.0, 5.0)` в этом примере возвращает значение `15` .|  
|**True()**|Bool TRUE()|возвращает логическое значение TRUE.||возвращает логическое значение TRUE.|`IsDatabaseMailEnabled = True()`|  
|**Upper()**|String Upper (String *_expression*)|возвращает строку после преобразования всех символов нижнего регистра в верхний регистр.|*expression* — выражение исходной строки.|возвращает строку, представляющую собой исходное строковое выражение после преобразования всех символов нижнего регистра в верхний регистр.|`Upper('HeLlO')` в этом примере возвращает значение `'HELLO'` .|  
  
## <a name="see-also"></a>См. также раздел  
 [Диалоговое окно «Создание нового условия» или «Открытие условия», страница «Общие»](../../relational-databases/policy-based-management/create-new-condition-or-open-condition-dialog-box-general-page.md)   
 [Администрирование серверов с помощью управления на основе политик](../../relational-databases/policy-based-management/administer-servers-by-using-policy-based-management.md)  
  
  
