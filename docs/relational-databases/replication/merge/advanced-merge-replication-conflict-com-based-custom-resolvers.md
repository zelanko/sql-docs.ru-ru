---
title: Сопоставители на основе технологии COM | Документация Майкрософт
ms.custom: ''
ms.date: 03/01/2017
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- COM-based resolvers [SQL Server replication]
- custom resolvers [SQL Server replication]
ms.assetid: 94195797-ad7a-4962-a8e3-b259cd13aa38
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 93093d342a7a7a7a45d625a089a0cdd2753db66c
ms.sourcegitcommit: f7ac1976d4bfa224332edd9ef2f4377a4d55a2c9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85896339"
---
# <a name="advanced-merge-replication-conflict---com-based-custom-resolvers"></a>Конфликт расширенной репликации слиянием: пользовательские сопоставители на основе технологии COM
[!INCLUDE [SQL Server](../../../includes/applies-to-version/sqlserver.md)]
  Пользовательские сопоставители предоставляют большую гибкость по сравнению с механизмом разрешения конфликтов по умолчанию, и они могут реализовать бизнес-логику, необходимую для приложений, использующих реплицированные данные. Пользовательский сопоставитель на основе COM — это динамически подключаемая библиотека (DLL), которая реализует COM-интерфейс **ICustomResolver** , его методы и свойства, а также другие поддерживаемые интерфейсы и определения типов, разработанные специально для устранения конфликтов.  
  
> [!NOTE]  
>  Рекомендуется использовать обработчик бизнес-логики вместо пользовательского сопоставителя на основе COM, если это возможно. Дополнительные сведения об обработчиках бизнес-логики см. в статье [Выполнение бизнес логики во время синхронизации слияния](../../../relational-databases/replication/merge/execute-business-logic-during-merge-synchronization.md).  
  
 Для создания пользовательского COM-сопоставителя можно использовать библиотеку типов, которая содержится в файле replrec.dll. По умолчанию эта библиотека устанавливается в каталог [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.  
  
 Перед написанием пользовательского COM-сопоставителя необходимо определиться по следующим вопросам:  
  
-   Типы изменений строк, конфликты которых необходимо разрешить, например обновления, вставки и удаления, а также, должен ли сопоставитель вызываться во время передачи изменений слияния, загрузки изменений слияния, или его необходимо вызывать в обеих ситуациях. Можно указать один тип изменений, все изменения, или любое их сочетание. Сопоставитель конфликтов слияния по умолчанию обрабатывает любые конфликты, не охваченные пользовательским арбитром конфликтов.  
  
-   Надо ли использовать отслеживание столбца при разрешении конфликта. Когда включено отслеживание на уровне столбцов, только данные в тех столбцах, где существует конфликт, помечаются как конфликт, иначе данные объединяются. Однако конфликты разрешаются таким же способом, как и при отслеживании на уровне строк: победитель по приоритету перезаписывает всю строку данных (однако данные могут быть смесью значений от издателя, подписчиков или измененными значениями, которые не были получены ни от издателя, ни от подписчиков). Дополнительные сведения см. в статье [Обнаружение и разрешение конфликтов репликации слиянием](../../../relational-databases/replication/merge/advanced-merge-replication-conflict-detection-and-resolution.md).  
  
 Чтобы реализовать пользовательский арбитр конфликтов на основе технологии COM, см. раздел [Реализация пользовательского арбитра конфликтов для статьи публикации слиянием](../../../relational-databases/replication/implement-a-custom-conflict-resolver-for-a-merge-article.md).  
  
 Пользовательский сопоставитель указывается для статьи, а не для всей публикации. Тот же самый сопоставитель может использоваться с более чем одной статьей, однако логика разрешения конфликтов в пользовательских сопоставителях часто характерна для определенной таблицы. Если используемая в статье таблица изменена после создания сопоставителя (например, изменено имя столбца, используемого при устранении конфликта), может потребоваться изменение и повторная компиляция пользовательского сопоставителя.  
  
 Чтобы указать пользовательский сопоставитель, см. раздел [Определение сопоставителя статей публикации слиянием](../../../relational-databases/replication/publish/specify-a-merge-article-resolver.md).  
  
## <a name="see-also"></a>См. также:  
 [Advanced Merge Replication Conflict Detection and Resolution](../../../relational-databases/replication/merge/advanced-merge-replication-conflict-detection-and-resolution.md)   
 [Microsoft COM-Based Resolvers](../../../relational-databases/replication/merge/advanced-merge-replication-conflict-com-based-resolvers.md)  
  
  
