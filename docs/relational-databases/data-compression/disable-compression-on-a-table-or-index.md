---
title: Отключение сжатия таблицы или индекса | Документация Майкрософт
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.reviewer: ''
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.technology: performance
ms.topic: conceptual
helpviewer_keywords:
- data compression [SQL Server], disabling
ms.assetid: bda1e452-397b-4757-82a4-181217361589
author: MikeRayMSFT
ms.author: mikeray
monikerRange: '>= aps-pdw-2016 || = azuresqldb-current || = azure-sqldw-latest || >= sql-server-2016 || = sqlallproducts-allversions'
ms.openlocfilehash: 523b082be7b61991db13d588a7203ad4ce5597ff
ms.sourcegitcommit: 58158eda0aa0d7f87f9d958ae349a14c0ba8a209
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2020
ms.locfileid: "68055430"
---
# <a name="disable-compression-on-a-table-or-index"></a>Отключение сжатия таблицы или индекса

[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

  В этом разделе описывается, как отключить сжатие для таблицы или индекса в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] с помощью [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../includes/tsql-md.md)].  
  
 **В этом разделе**  
  
-   **Перед началом работы**  
  
     [Ограничения](#Restrictions)  
  
     [Безопасность](#Security)  
  
-   **Отключение сжатия для таблицы или индекса при помощи:**  
  
     [Среда SQL Server Management Studio](#SSMSProcedure)  
  
     [Transact-SQL](#TsqlProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> Перед началом  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> Ограничения  
  
-   Если таблица является кучей, то операция перестроения в режиме ONLINE будет однопотоковой. Используйте режим OFFLINE для выполнения многопотоковых операций перестроения кучи. Дополнительную информацию о сжатии данных см. в разделе [Сжатие данных](../../relational-databases/data-compression/data-compression.md).  
  
-   Оценить состояние сжатия таблицы, индекса или секции можно с помощью хранимой процедуры [sp_estimate_data_compression_savings](../../relational-databases/system-stored-procedures/sp-estimate-data-compression-savings-transact-sql.md).  
  
-   Если у таблицы есть невыровненные индексы, изменить настройку сжатия отдельной секции невозможно.  
  
###  <a name="security"></a><a name="Security"></a> безопасность  
  
####  <a name="permissions"></a><a name="Permissions"></a> Permissions  
 Необходимо разрешение ALTER на таблицу или индекс.  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> Использование среды SQL Server Management Studio  
  
#### <a name="to-disable-compression-on-a-table"></a>Отключение сжатия в таблице  
  
1.  В обозревателе объектов разверните базу данных, содержащую таблицу, для которой необходимо отключить сжатие, а затем разверните папку **Таблицы** .  
  
2.  Щелкните правой кнопкой мыши эту таблицу или индекс, для которых требуется отключить сжатие, наведите курсор мыши на раздел **Хранилище** и выберите **Управление сжатием...** .  
  
3.  Чтобы отключить сжатие для индекса, разверните таблицу, содержащую индекс, а затем разверните папку **Индексы** .  
  
4.  В мастере сжатия данных на странице **Добро пожаловать в мастер сжатия данных** нажмите кнопку **Далее**.  
  
5.  На странице **Выбор типа сжатия** выберите **Отсутствует** в качестве типа сжатия, который будет применен к каждой секции индекса, для которого требуется отключить сжатие данных. По завершении нажмите кнопку **Далее**.  
  
     Следующие параметры доступны на странице **Выбор типа сжатия** :  
  
     флажок**Использовать один тип сжатия для всех секций**  
     Выберите этот вариант, чтобы задать одинаковые параметры для всех секций. Он включает флажок выбора и делает недоступным столбец **Тип сжатия** в сетке. При его выборе в списке рядом появляются параметры: **Нет**, **Строка**и **Страница**.  
  
     **Номер секции**  
     Перечисляет каждую секцию в таблице или индексе. Столбец доступен только для чтения.  
  
     **Тип сжатия**  
     Выберите параметры сжатия для каждой секции. Вариант недоступен, если выбран параметр **Использовать один и тот же тип сжатия для всех секций** . Список параметров: **Нет**, **Строка**и **Страница**.  
  
     **Граница**  
     Отображает границу секции. Столбец доступен только для чтения.  
  
     **Количество строк**  
     Количество строк в данной секции. Столбец доступен только для чтения.  
  
     **Текущий размер**  
     Текущий размер, занимаемый секцией в мегабайтах (МБ). Столбец доступен только для чтения.  
  
     **Запрошенное сжатое пространство**  
     После нажатия кнопки **Вычислить**в этом столбце будет показан приблизительный размер каждой секции после сжатия на основе значения в столбце **Тип сжатия** . Столбец доступен только для чтения.  
  
     **Вычислить**  
     Нажмите эту кнопку, чтобы получить размер каждой секции после сжатия на основе значения в столбце **Тип сжатия** .  
  
6.  На странице **Выбор выходного параметра** укажите способ завершения этого задания. Выберите **Создать скрипт** для создания скрипта SQL на основе данных на предыдущих страницах мастера. Выберите **Запустить немедленно** , чтобы создать новую секционированную таблицу после завершения работ со всеми оставшимися страницами мастера. Выберите **Расписание** , чтобы создать новую секционированную таблицу в заранее заданное время в будущем.  
  
     При выборе **Создать скрипт**в **Параметры скрипта**будут доступны следующие параметры:  
  
     **Вывести скрипт в файл**  
     Создание скрипта как SQL-файла. Введите имя и местоположение файла в поле **Имя файла** или щелкните **Обзор** , чтобы открыть диалоговое окно **Расположение файла скрипта** . В разделе **Сохранить как**выберите **Текст в Юникоде** или **Текст ANSI**.  
  
     **Вывести скрипт в буфер обмена**  
     Сохранение скрипта в буфере обмена.  
  
     **Вывести скрипт в новое окно запроса**  
     Скрипт создается в новом окне редактора запросов. Это параметр выбирается по умолчанию.  
  
     При выборе **Расписание**щелкните **Изменить расписание**.  
  
    1.  В диалоговом окне **Создание расписания задания** в поле **Имя** введите имя расписания задания.  
  
    2.  В списке **Тип расписания** выберите тип расписания:  
  
        -   **Запускать автоматически при запуске агента SQL Server**  
  
        -   **Запускать при бездействии процессоров**  
  
        -   **Повторяющееся**. Выберите этот параметр, если новая секционированная таблица регулярно обновляется с учетом новых данных.  
  
        -   **Однократно**. Это параметр выбирается по умолчанию.  
  
    3.  Установите или снимите флажок **Включен** , чтобы включить или отключить расписание.  
  
    4.  При выборе **Повторяющееся**:  
  
        1.  В разделе **Частота**в списке **Выполняется** укажите частоту выполнения:  
  
            -   При выборе **Ежедневно**в поле **Выполняется каждые** укажите частоту повторного выполнения расписания задания в днях.  
  
            -   При выборе **Еженедельно**в поле **Выполняется каждые** укажите частоту повторного выполнения расписания задания в неделях. Выберите день или дни недели, в которые выполняется расписание задания.  
  
            -   При выборе **Ежемесячно**щелкните **День** или **Определенный**.  
  
                -   При выборе **День**введите дату месяца, в которую должно выполняться расписание задания, и укажите частоту повторного выполнения расписания задания в месяцах. Например, если требуется, чтобы расписание задания выполнялось 15 числа каждого второго месяца, выберите **День** и введите в первом поле 15 и 2 — во втором поле. Обратите внимание, что число, введенное во втором поле, не должно превышать 99.  
  
                -   При выборе **Определенный**выберите определенный день недели в месяце, в котором должно выполняться расписание задания, и укажите частоту повторного выполнения расписания задания в месяцах. Например, если требуется, чтобы расписание задания выполнялось в последний день недели каждого второго месяца, выберите **День**, затем **последний** в первом списке и **рабочий день** во втором списке, а потом введите "2" во втором поле. Еще можно выбрать **первый**, **второй**, **третий**или **четвертый**, а также конкретные дни недели (например, воскресенье или среду) в первых двух списках. Обратите внимание, что число, введенное в последнем поле, не должно превышать 99.  
  
        2.  В поле **Сколько раз в день**укажите частоту повторного выполнения расписания задания в день запуска расписания задания:  
  
            -   При выборе **Выполнять раз в**укажите определенное время дня для запуска расписания задания в поле **Выполнять раз в** . Укажите время дня: час, минуту и секунду.  
  
            -   При выборе **Выполняется каждые**укажите частоту выполнения задания в выбранный день в поле **Частота**. Например, если требуется, чтобы расписание задания выполнялось каждые 2 часа в день запуска расписания задания, выберите **Выполняется кажд.** , введите "2" в первом поле, а затем выберите в списке **часы**. В этом списке также можно выбрать **минуты** и **секунды**. Обратите внимание, что число, введенное в первом поле, не должно превышать 100.  
  
                 В поле **Начинать в** введите время для начала запуска расписания задания. В поле **Заканчивать в** введите время для завершения повторного выполнения расписания задания. Укажите время дня: час, минуту и секунду.  
  
        3.  В разделе **Длительность**, в области **Дата начала**введите дату начала запуска расписания задания. Выберите **Дата окончания** или **Без даты окончания** , чтобы указать дату завершения выполнения расписания задания. При выборе **Дата окончания**введите дату завершения запуска расписания задания.  
  
    5.  При выборе значения **Однократно**в **Однократное выполнение**в поле **Дата** введите дату запуска расписания задания. В поле **Время** введите время запуска расписания задания. Укажите время дня: час, минуту и секунду.  
  
    6.  В разделе **Сводка**в **Описание**проверьте правильность всех параметров расписания задания.  
  
    7.  Нажмите кнопку **ОК**.  
  
     После завершения работы с этой страницей нажмите кнопку **Далее**.  
  
7.  На странице **Просмотр сводки** в разделе **Просмотр выбранных параметров**разверните все доступные параметры, чтобы убедиться в правильности всех настроек. Если все настройки правильные, нажмите кнопку **Готово**.  
  
8.  Страница **Выполнение мастера сжатия** используется для мониторинга сведений о состоянии действий мастера создания секций. В зависимости от действий, выбранных в мастере, страница выполнения может содержать одно или несколько действий. В верхнем поле показано общее состояние мастера и число полученных им сообщений о состоянии, предупреждений и сообщений об ошибках.  
  
     На странице **Выполнение мастера сжатия** доступны следующие параметры.  
  
     **Сведения**  
     Сведения о событии, состоянии и любых сообщениях, которые возвращены в результате действий мастера.  
  
     **Действие**  
     Задает тип и имя каждого действия.  
  
     **Состояние**  
     Указывает, вернуло ли действие мастера в целом значение **Успешно** или **Ошибка**.  
  
     **Сообщение**  
     Любые сообщения об ошибках или предупреждения от процесса.  
  
     **Отчет**  
     Создание отчета, содержащего результаты мастера создания секций. Доступные параметры: **Просмотреть отчет**, **Сохранить отчет в файл**, **Копировать отчет в буфер обмена**и **Отправить отчет по электронной почте**.  
  
     **Просмотреть отчет**  
     Открытие диалогового окна **Просмотр отчета** , которое содержит текстовый отчет о работе мастера создания секций.  
  
     **Сохранить отчет в файл**  
     Открытие диалогового окна **Сохранить отчет как** .  
  
     **Копировать отчет в буфер обмена**  
     Копирование результатов отчета о работе мастера в буфер обмена.  
  
     **Отправить отчет по электронной почте**  
     Копирование результатов отчета о состоянии мастера в сообщение электронной почты.  
  
     Завершив выбор параметров, нажмите кнопку **Закрыть**.  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> Использование Transact-SQL  
  
#### <a name="to-disable-compression-on-a-table"></a>Отключение сжатия в таблице  
  
1.  В **обозревателе объектов**подключитесь к экземпляру компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)].  
  
2.  На стандартной панели выберите пункт **Создать запрос**.  
  
3.  Скопируйте следующий пример в окно запроса и нажмите кнопку **Выполнить**.  
  
    ```  
    USE AdventureWorks2012;  
    GO  
    ALTER TABLE Person.Person REBUILD PARTITION = ALL  
    WITH (DATA_COMPRESSION = NONE);  
    GO  
    ```  
  
#### <a name="to-disable-compression-on-an-index"></a>Отключение сжатия для индекса  
  
1.  В **обозревателе объектов**подключитесь к экземпляру компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)].  
  
2.  На стандартной панели выберите пункт **Создать запрос**.  
  
3.  Скопируйте следующий пример в окно запроса и нажмите кнопку **Выполнить**.  
  
    ```  
    USE AdventureWorks2012;  
    GO  
    ALTER INDEX AK_Person_rowguid ON Person.Person REBUILD PARTITION = ALL WITH (DATA_COMPRESSION = NONE);  
    GO  
    ```  
  
 Дополнительные сведения см. в разделах [ALTER TABLE (Transact-SQL)](../../t-sql/statements/alter-table-transact-sql.md) и [ALTER INDEX (Transact-SQL)](../../t-sql/statements/alter-index-transact-sql.md).  
  
  
