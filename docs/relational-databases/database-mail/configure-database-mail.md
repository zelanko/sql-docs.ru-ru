---
title: Настройка компонента Database Mail | Документация Майкрософт
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: database-engine
ms.component: database-mail
ms.reviewer: ''
ms.suite: sql
ms.technology:
- database-engine
ms.tgt_pltfrm: ''
ms.topic: conceptual
f1_keywords:
- sql13.swb.sqlimail.profileandaccountmanagement.f1
- sql13.swb.sqlimail.newaccount.f1
- sql13.swb.dbmail. manageprofilesecurity.profileview.f1
- sql13.swb.sqlimail.manageexistingprofile.f1
- sql13.swb.sqlimail.addaccounttoprofile.f1
- sql13.swb.dbmail.manageexistingaccount.f1
- sql13.swb.sqlimail.manageprofilesecurity.profileview.f1
- sql13.swb.sqlimail.welcome.f1
- sql13.swb.sqlimail.manageprofilesecurity.principalview.f1
- sql13.swb.sqlimail.newsqlimailaccount.f1
- sql13.swb.sqlimail.selectconfiguration.f1
- sql13.swb.dbmail.completewizard.f1
- sql13.swb.dbmail.sendtestemail.test.f1
- sql13.swb.sqlimail.newprofile.f1
- sql13.swb.dbmail.addaccounttoprofile.f1
- sql13.swb.dbmail.newprofile.f1
- sql13.swb.sqlimail.manageexistingaccount.f1
- sql13.swb.dbmail.welcome.f1
- sql13.swb.dbmail.newaccount.f1
- sql13.swb.dbmail.profileandaccountmanagement.f1
- sql13.swb.dbmail.selectconfiguration.f1
- sql13.swb.dbmail.sendtestemail.f1
- sql13.swb.sqlimail.completewizard.f1
- sql13.swb.dbmail.configuresystem.f1
- sql13.swb.sqlimail.configuresystem.f1
- sql13.swb.dbmail.newsqlimailaccount.f1
- sql13.swb.dbmail.manageexistingprofile.f1
- sql13.swb.dbmail.manageprofilesecurity.principalview.f1
ms.assetid: 7edc21d4-ccf3-42a9-84c0-3f70333efce6
caps.latest.revision: 13
author: stevestein
ms.author: sstein
manager: craigg
ms.openlocfilehash: b1df9d91458211d66722ac1b844e5d938690acc3
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="configure-database-mail"></a>Настройка компонента Database Mail
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]
  В этом разделе описано включение и настройка компонента Database Mail с помощью мастера настройки компонента Database Mail и создание скрипта настройки компонента Database Mail с помощью шаблонов.  
  
-   **Перед началом:**  [Ограничения](#Restrictions), [Безопасность](#Security)  
  
-   **Настройка компонента Database Mail с помощью:**  [Мастера настройки компонента Database Mail](#DBWizard), [С помощью шаблонов](#Template)  
  
##  <a name="BeforeYouBegin"></a> Перед началом  
 Используйте параметр **Расширенные хранимые процедуры компонента Database Mail** для включения компонента Database Mail на сервере. Дополнительные сведения см. в справочном разделе [Параметр конфигурации сервера "Database Mail XPs"](../../database-engine/configure-windows/database-mail-xps-server-configuration-option.md) .  
  
###  <a name="Restrictions"></a> Ограничения  
 Чтобы включить компонент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Service Broker в любой базе данных, требуется блокировка базы данных. Если компонент Service Broker был выключен в базе данных **msdb**, чтобы включить компонент Database Mail, сначала необходимо остановить агент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , чтобы компонент Service Broker смог получить необходимую блокировку.  
  
###  <a name="Security"></a> безопасность  
 Чтобы настроить компонент Database Mail, необходимо быть членом предопределенной роли сервера **sysadmin** . Чтобы отправлять почту через компонент Database Mail, необходимо быть членом роли **DatabaseMailUserRole** в базе данных **msdb** .  
  
##  <a name="DBWizard"></a> Использование мастера настройки компонента Database Mail  
 **Настройка компонента Database Mail с помощью мастера**  
  
1.  В обозревателе объектов разверните узел экземпляра, на котором нужно настроить компонент Database Mail.  
  
2.  Разверните узел **Управление** .  
  
3.  Щелкните правой кнопкой мыши **Компонент Database Mail**и выберите пункт **Настроить компонент Database Mail**.  
  
4.  Выполните шаги в диалоговых окнах мастера  
  
    -   [Страница приветствия](#Welcome)  
  
    -   [Страница выбора задач настройки](#ConfigTask)  
  
    -   [Страница создания учетной записи](#NewAccount)  
  
    -   [Страница управления существующей учетной записью](#ExistingAccount)  
  
    -   [Страница создания профиля](#NewProfile)  
  
    -   [Страница управления существующим профилем](#ExistingProfile)  
  
    -   [Страница добавления учетной записи в профиль](#AddAccount)  
  
    -   [Страница управления учетными записями и профилями](#AccountsProfiles)  
  
    -   [Управление безопасностью профиля, вкладка «Открытый»](#ProfileSecurityPublic)  
  
    -   [Управление безопасностью профиля, вкладка «Закрытый»](#ProfileSecurityPrivate)  
  
    -   [Страница настройки параметров системы](#SystemParameters)  
  
    -   [Страница завершения мастера](#CompleteWizard)  
  
    -   [Страница отправки тестового сообщения по электронной почте](#TestEmail)  
  
###  <a name="Welcome"></a> Страница приветствия  
 Эта страница описывает шаги по настройке компонента Database Mail.  
  
 **Больше не показывать эту страницу** — установите этот флажок, чтобы в будущем страница приветствия больше не отображалась.  
  
 **Далее** — переход на страницу **Выбор задачи конфигурирования** .  
  
 **Отмена** — завершение работы мастера без настройки компонента Database Mail.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="ConfigTask"></a> Выбор задачи настройки  
 Страница **Выбор задачи настройки** позволяет указать, какую задачу необходимо выполнять каждый раз при использовании этого мастера. Чтобы изменить решение перед завершением мастера, нажмите кнопку **Назад** , вернитесь на эту страницу и выберите другую задачу.  
  
> [!NOTE]  
>  Если компонент Database Mail не включен, будет получено следующее сообщение: **Компонент Database Mail недоступен.  Включить эту функцию?** Ответ **Да**эквивалентен включению компонента Database Mail с помощью параметра [Database Mail XPs](../../database-engine/configure-windows/database-mail-xps-server-configuration-option.md) системной хранимой процедуры **sp_configure** .  
  
 **Установка компонента Database Mail при помощи выполнения следующих задач**  
 Выполнить все задачи, необходимые для первой установки компонента Database Mail. Этот параметр включает в себя все три остальных.  
  
 **Управление учетными записями и профилями компонента Database Mail**  
 Создание, просмотр, изменение и удаление учетных записей и профилей компонента Database Mail.  
  
 **Управление безопасностью профилей**  
 Настройка доступа пользователей к профилям компонента Database Mail.  
  
 **Просмотр или изменение системных параметров**  
 Настройка системных параметров компонента Database Mail (таких как максимальный размер файла для вложений).  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="NewAccount"></a> Страница создания учетной записи  
 Эта страница используется для создания учетной записи компонента Database Mail. Учетная запись компонента Database Mail содержит сведения, необходимые для отправки электронной почты на SMTP-сервер.  
  
 Учетная запись компонента Database Mail содержит сведения, используемые [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для отправки электронных сообщений на SMTP-сервер. Каждая учетная запись содержит сведения для одного сервера электронной почты.  
  
 Учетная запись компонента Database Mail используется только для компонента Database Mail. Учетная запись компонента Database Mail не соответствует учетной записи [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или учетной записи Microsoft Windows. Почту компонента Database Mail можно отправить с использованием учетных данных [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)], с использованием других предоставленных вами учетных данных или анонимно. При обычной проверке подлинности имя пользователя и пароль учетной записи почты компонента Database Mail используются только для проверки подлинности на сервере электронной почты. Учетная запись может не соответствовать пользователю [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или пользователю компьютера, на котором запущен [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
 **Имя учетной записи**  
 Введите имя новой учетной записи.  
  
 **Описание**  
 Введите описание учетной записи. Описание является необязательным.  
  
 **Адрес электронной почты**  
 Введите адрес электронной почты для этой учетной записи. Это адрес электронной почты отправителя. Например, учетная запись агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] позволяет отправлять сообщения с адреса SqlAgent@Adventure-Works.com.  
  
 **Отображаемое имя**  
 Введите имя, которое необходимо отображать в электронных сообщениях, отправляемых с этой учетной записи. Отображаемое имя является необязательным. Это имя отображается в сообщениях, отправляемых с этой учетной записи. Например, учетная запись агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] может отображать имя «SQL Server Agent Automated Mailer» в сообщениях электронной почты.  
  
 **Адрес электронной почты для ответа**  
 Введите адрес электронной почты, который будет использоваться для ответов на электронные сообщения, отправляемые с этой учетной записи. Обратный адрес электронной почты необязателен. Например, ответы на адрес учетной записи агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] можно направлять администратору базы данных (danw@Adventure-Works.com).  
  
 **Имя сервера**  
 Введите имя или IP-адрес SMTP-сервера, который учетная запись будет использовать для отправки электронной почты. Обычно это значение имеет формат **smtp.***<ваша_организация>***.com**. Обратитесь за помощью к администратору электронной почты.  
  
 **Номер порта**  
 Введите номер порта SMTP-сервера для этой учетной записи. Большинство SMTP-серверов используют порт 25.  
  
 **Для этого сервера требуется безопасное соединение (SSL)**  
 Осуществляет шифрование связи, используя протокол SSL.  
  
 **Проверка подлинности Windows с использованием учетных данных службы компонента Database Engine**  
 Соединение с SMTP-сервером выполняется с помощью учетных данных, настроенных для службы компонента [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] .  
  
 **Обычная проверка подлинности**  
 Задайте имя пользователя и пароль, которые требуются для SMTP-сервера.  
  
 **Имя пользователя**  
 Введите имя пользователя, которое компонент Database Mail использует для входа в систему на SMTP-сервере. Если SMTP-сервер требует обычную проверку подлинности, необходимо имя пользователя.  
  
 **Пароль**  
 Введите пароль, который компонент Database Mail использует для входа на SMTP-сервер. Пароль необходим, если SMTP-сервер требует обычную проверку подлинности.  
  
 **Подтверждение пароля**  
 Еще раз введите пароль для подтверждения. Пароль необходим, если SMTP-сервер требует обычную проверку подлинности.  
  
 **Анонимная проверка подлинности**  
 Почта отправляется на SMTP-сервер без учетных данных входа. Этот параметр используется, если на SMTP-сервере не требуется проверка подлинности.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="ExistingAccount"></a> Страница управления существующей учетной записью  
 Эта страница используется для управления существующей учетной записью компонента Database Mail.  
  
 **Имя учетной записи**  
 Выберите учетную запись для просмотра, изменения или удаления.  
  
 **Удаление**  
 Удаление выбранной учетной записи. Необходимо удалить эту учетную запись из связанных профилей или удалить эти профили до удаления учетной записи.  
  
 **Описание**  
 Просмотр или обновление описания учетной записи. Описание является необязательным.  
  
 **Адрес электронной почты**  
 Просмотр или обновление адреса электронной почты для этой учетной записи. Это адрес электронной почты отправителя. Например, учетная запись агента Microsoft SQL Server позволяет отправлять сообщения с адреса **SqlAgent@Adventure-Works.com**.  
  
 **Отображаемое имя**  
 Просмотр или обновление имени, которое будет отражаться на электронных сообщениях, отправленных с этой учетной записи. Отображаемое имя является необязательным. Это имя отображается в сообщениях, отправляемых с этой учетной записи. Например, учетная запись агента SQL Server позволяет выводить имя **SQL Server Agent Automated Mailer** в сообщениях электронной почты.  
  
 **Адрес электронной почты для ответа**  
 Просмотр или обновление адреса электронной почты, который будет использоваться для ответов на электронные сообщения, отправленные с данной учетной записи. Обратный адрес электронной почты необязателен. Например, ответы учетной записи агента SQL Server могут быть перенаправлены администратору базы данных, **danw@Adventure-Works.com**.  
  
 **Имя сервера**  
 Просмотр или обновления имени SMTP-сервера, который учетная запись использует для отправки электронной почты. Обычно это значение имеет формат **smtp.<ваша_организация>.com**. Обратитесь за помощью к администратору электронной почты.  
  
 **Номер порта**  
 Просмотр или обновление номера порта SMTP-сервера для этой учетной записи. Большинство SMTP-серверов используют порт 25.  
  
 **Для этого сервера требуется безопасное соединение (SSL)**  
 Осуществляет шифрование связи, используя протокол SSL.  
  
 **Проверка подлинности Windows с использованием учетных данных службы компонента Database Engine**  
 Соединение с SMTP-сервером выполняется с помощью учетных данных, настроенных для службы компонента [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] .  
  
 **Обычная проверка подлинности**  
 Задайте имя пользователя и пароль, которые требуются для SMTP-сервера.  
  
 **User name**  
 Просмотр или обновление имени пользователя, которое компонент Database Mail использует для входа в систему на SMTP-сервере. Если SMTP-сервер требует обычную проверку подлинности, необходимо имя пользователя.  
  
 **Пароль**  
 Изменение пароля, который компонент Database Mail использует для входа в систему на SMTP-сервере. Пароль необходим, если SMTP-сервер требует обычную проверку подлинности.  
  
 **Подтверждение пароля**  
 Еще раз введите пароль для подтверждения. Пароль необходим, если SMTP-сервер требует обычную проверку подлинности.  
  
 **Анонимная проверка подлинности**  
 Почта отправляется на SMTP-сервер без учетных данных входа. Этот параметр используется, если на SMTP-сервере не требуется проверка подлинности.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="NewProfile"></a> Страница создания профиля  
 Используйте эту страницу для создания профиля компонента Database Mail. Профиль компонента Database Mail является коллекцией учетных записей компонентов Database Mail. Профили повышают надежность в случаях, когда почтовый сервер становится недоступен, предоставляя альтернативные учетные записи компонента Database Mail. Необходима, по крайней мере, одна учетная запись компонента Database Mail. Дополнительные сведения об установке приоритетов учетных записей компонентов Database Mail в профиле см. в разделе [Create a Database Mail Profile](../../relational-databases/database-mail/create-a-database-mail-profile.md).  
  
 С помощью кнопок **Вверх** и **Вниз** можно менять порядок, в котором используются учетные записи компонентов Database Mail. Этот порядок определяется значением, называемым порядковым номером. С помощью кнопки**Вверх** порядковый номер уменьшается, а с помощью кнопки **Вниз** увеличивается. Порядковый номер определяет порядок, в соответствии с которым компонент Database Mail использует учетные записи в профиле. Для нового сообщения электронной почты компонент Database Mail начинает с учетной записи, имеющей наименьший порядковый номер. Если использование этой учетной записи завершилось с ошибкой, компонент Database Mail использует учетную запись со следующим порядковым номером, и так до тех пор, пока сообщение не будет успешно отослано, либо пока не окажется безуспешным использование учетной записи с наибольшим порядковым номером. Если отправка с учетной записью, имеющей наибольший порядковый номер, завершится неудачно, компонент Database Mail приостанавливает попытки отправить почту на время, заданное его параметром **AccountRetryDelay** , после чего возобновляет попытки отправить почту, начиная с наименьшего порядкового номера. Параметр компонента Database Mail **AccountRetryAttempts** используется для задания количества попыток отправки внешним почтовым процессом сообщения с помощью каждой из учетных записей указанного профиля. Можно настроить параметры **AccountRetryDelay** и **AccountRetryAttempts** на странице **Установка системных параметров** мастера настройки компонентов Database Mail.  
  
 **Имя профиля**  
 Введите имя нового профиля. Профиль создается с этим именем. Не используйте имя существующего профиля.  
  
 **Описание**  
 Введите описание профиля. Описание является необязательным.  
  
 **Учетные записи SMTP**  
 Выберите одну или несколько учетных записей для профиля. Приоритет устанавливает порядок, в котором компонент Database Mail использует учетные записи. Если учетные записи в списке отсутствуют, то, чтобы продолжить, нужно нажать кнопку **Добавить** и добавить новую учетную запись SMTP.  
  
 **Добавить**  
 Добавить в профиль учетную запись.  
  
 **Удалить**  
 Удалите выбранную учетную запись из профиля.  
  
 **вверх**  
 Повысьте приоритет выбранной учетной записи.  
  
 **Вниз**  
 Понизьте приоритет выбранной учетной записи.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="ExistingProfile"></a> Страница управления существующим профилем  
 Эта страница используется для управления существующим профилем компонента Database Mail. Профиль компонента Database Mail является коллекцией учетных записей компонентов Database Mail. Профили повышают надежность в случаях, когда почтовый сервер становится недоступен, предоставляя альтернативные учетные записи компонента Database Mail. Необходима, по крайней мере, одна учетная запись компонента Database Mail. Дополнительные сведения об установке приоритетов учетных записей компонентов Database Mail в профиле см. в разделе [Create a Database Mail Profile](../../relational-databases/database-mail/create-a-database-mail-profile.md).  
  
 С помощью кнопок **Вверх** и **Вниз** можно менять порядок, в котором используются учетные записи компонентов Database Mail. Этот порядок определяется значением, называемым порядковым номером. С помощью кнопки**Вверх** порядковый номер уменьшается, а с помощью кнопки **Вниз** увеличивается. Порядковый номер определяет порядок, в соответствии с которым компонент Database Mail использует учетные записи в профиле. Для нового сообщения электронной почты компонент Database Mail начинает с учетной записи, имеющей наименьший порядковый номер. Если использование этой учетной записи завершилось с ошибкой, компонент Database Mail использует учетную запись со следующим порядковым номером, и так до тех пор, пока сообщение не будет успешно отослано, либо пока не окажется безуспешным использование учетной записи с наибольшим порядковым номером. Если отправка с учетной записью, имеющей наибольший порядковый номер, завершится неудачно, компонент Database Mail приостанавливает попытки отправить почту на время, заданное его параметром **AccountRetryDelay** , после чего возобновляет попытки отправить почту, начиная с наименьшего порядкового номера. Параметр компонента Database Mail **AccountRetryAttempts** используется для задания количества попыток отправки внешним почтовым процессом сообщения с помощью каждой из учетных записей указанного профиля. Можно настроить параметры **AccountRetryDelay** и **AccountRetryAttempts** на странице **Установка системных параметров** мастера настройки компонентов Database Mail.  
  
 **Имя профиля**  
 Выберите имя профиля для управления.  
  
 **Удаление**  
 Удаление выбранного профиля. Будет выведено предложение выбрать **Да** , чтобы удалить выделенный профиль и не отправлять неотправленные сообщения, или выбрать **Нет** , чтобы удалить выделенный профиль только в случае, если неотправленные сообщения отсутствуют.  
  
 **Описание**  
 Просмотр или изменение описания выбранного профиля. Описание является необязательным.  
  
 **Учетные записи SMTP**  
 Выберите одну или несколько учетных записей для профиля. Приоритет отработки отказа устанавливает порядок, в котором компонент Database Mail использует учетную запись при обработке отказа.  
  
 **Добавить**  
 Добавить в профиль учетную запись.  
  
 **Удалить**  
 Удалите выбранную учетную запись из профиля.  
  
 **Вверх**  
 Повысить приоритет отработки отказа выбранной учетной записи.  
  
 **вниз**  
 Понизить приоритет отработки отказа выбранной учетной записи.  
  
 **Приоритет**  
 Просмотреть текущий приоритет отработки отказа учетной записи.  
  
 **Имя учетной записи**  
 Просмотреть имя учетной записи.  
  
 **E-mail Address**  
 Просмотреть адрес электронной почты учетной записи.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="AddAccount"></a> Add Account to Profile Page  
 Используйте эту страницу, чтобы выбрать учетную запись для добавления к профилю. Выберите существующую учетную запись из поля **Имя учетной записи** или нажмите кнопку **Создать учетную запись**.  
  
 **Имя учетной записи**  
 Выберите имя учетной записи для добавления к профилю.  
  
 **Адрес электронной почты**  
 Просмотр адреса электронной почты для учетной записи. На этой странице нельзя изменить адрес электронной почты. Чтобы изменить адрес электронной почты для учетной записи, вернитесь на главную страницу мастера и выберите параметр **Управление учетными записями и профилями компонента Database Mail** .  
  
 **Имя сервера**  
 Просмотр имени почтового сервера для выбранной учетной записи. На этой странице нельзя изменить имя сервера. Для изменения имени сервера учетной записи вернитесь на главную страницу мастера и выберите параметр **Управление учетными записями и профилями компонента Database Mail** .  
  
 **Создать учетную запись**  
 Создать новую учетную запись.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="AccountsProfiles"></a> Страница управления учетными записями и профилями  
 Используйте эту страницу для выбора задачи с целью управления профилем или учетной записью.  
  
 **Создать новую учетную запись**  
 Создать новую учетную запись.  
  
 **Просмотр, редактирование или удаление существующей учетной записи**  
 Управление существующей учетной записью или ее удаление.  
  
 **Создать новый профиль**  
 Создать новый профиль.  
  
 **Просмотр, редактирование или удаление существующей учетной записи. Можно также управлять учетными записями, связанными с этим профилем.**  
 Обновление или удаление существующего профиля. Этот параметр также позволяет управлять учетными записями, связанными с данным профилем.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="ProfileSecurityPublic"></a> Управление безопасностью профиля, вкладка «Открытый»  
 Эта страница позволяет настраивать открытый профиль.  
  
 Профили могут быть открытыми или закрытыми. Личный профиль может быть доступен только для определенных пользователей или ролей. Открытый профиль позволяет любому пользователю или роли с правами доступа к базе данных обслуживания почты (**msdb**) отправлять электронную почту с использованием этого профиля.  
  
 Профиль может быть профилем по умолчанию. В этом случае пользователь и роли могут отправлять электронную почту с использованием этого профиля без явного его указания. Если пользователь или роль, отправляющие электронное сообщение, имеют личный профиль по умолчанию, компонент Database Mail использует этот профиль. Если у пользователя или роли нет личного профиля по умолчанию, процедура **sp_send_dbmail** использует открытый профиль по умолчанию для базы данных **msdb** . Если нет ни личного профиля по умолчанию для пользователя или роли, ни открытого профиля по умолчанию для базы данных, процедура **sp_send_dbmail** возвращает ошибку. Только один профиль может быть профилем по умолчанию.  
  
 **Открытый**  
 Выберите этот режим, чтобы указанный профиль стал открытым.  
  
 **Profile Name**  
 Показывает имя профиля.  
  
 **Профиль по умолчанию**  
 Выберите этот режим, чтобы указанный профиль стал профилем по умолчанию.  
  
 **Показывать только существующие открытые профили**  
 Выберите этот режим для отображения только открытых профилей в указанной базе данных.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="ProfileSecurityPrivate"></a> Управление безопасностью профиля, вкладка «Закрытый»  
 Эта страница позволяет настраивать личный профиль.  
  
 Профили могут быть открытыми или закрытыми. Личный профиль может быть доступен только для определенных пользователей или ролей. Открытый профиль позволяет любому пользователю или роли с правами доступа к базе данных обслуживания почты (**msdb**) отправлять электронную почту с использованием этого профиля.  
  
 Профиль может быть профилем по умолчанию. В этом случае пользователь и роли могут отправлять электронную почту с использованием этого профиля без явного его указания. Если пользователь или роль, отправляющие электронное сообщение, имеют личный профиль по умолчанию, компонент Database Mail использует этот профиль. Если у пользователя или роли нет личного профиля по умолчанию, процедура **sp_send_dbmail** использует открытый профиль по умолчанию для базы данных **msdb** . Если нет ни личного профиля по умолчанию для пользователя или роли, ни открытого профиля по умолчанию для базы данных, процедура **sp_send_dbmail** возвращает ошибку.  
  
 **User name**  
 Выберите имя пользователя или роли в базе данных **msdb** .  
  
 **Доступ**  
 Укажите, имеет ли пользователь или роль доступ к выбранному профилю.  
  
 **Имя профиля**  
 Просмотрите имя данного профиля.  
  
 **Является профилем по умолчанию**  
 Выберите, является ли этот профиль профилем по умолчанию для данного пользователя или роли. У каждого пользователя или роли может быть только один профиль по умолчанию.  
  
 **Показывать только существующие персональные профили этого пользователя**  
 Установите этот флажок, чтобы отображать только профили, к которым указанный пользователь или роль имеют доступ.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="SystemParameters"></a> Установка системных параметров  
 Используйте эту страницу для указания системных параметров компонента Database Mail. Просмотрите параметры системы и текущие значения всех параметров. Выберите параметр для просмотра его краткого описания на информационной панели.  
  
 **Количество попыток применения учетной записи**  
 Число попыток, предпринимаемых процессом внешней почты для отправки сообщения электронной почты с использованием каждой учетной записи в указанном профиле.  
  
 **Время между попытками применения учетной записи (секунды)**  
 Время ожидания (в секундах) внешним почтовым процессом после того, как он попытался доставить сообщение при помощи всех учетных записей в профиле, и перед тем, как он предпримет новые попытки со всеми учетными записями.  
  
 **Максимально допустимый размер файла (в байтах)**  
 Максимальный размер вложения в байтах.  
  
 **Запрещенные расширения для файлов вложений**  
 Разделенный запятыми список расширений файлов, которые невозможно отправить в виде вложений в сообщение электронной почты. Для включения в этот список дополнительных расширений нажмите кнопку обзора (**...**).  
  
 **Минимально допустимое время жизни исполняемого объекта компонента Database Mail (в секундах)**  
 Минимальное время в секундах, в течение которого остается активным процесс внешней почты. Процесс остается активным, пока в очереди компонента Database Mail имеются электронные сообщения. Этот параметр задает время, в течение которого процесс остается активным, если нет сообщений для обработки.  
  
 **Уровень ведения журнала**  
 Укажите, какие сообщения записываются в журнал компонента Database Mail. Возможны следующие значения:  
  
-   Обычный — записываются только ошибки.  
  
-   Расширенный — записываются ошибки, предупреждения и информационные сообщения.  
  
-   Подробный — записываются ошибки, предупреждения, информационные сообщения, сообщения об успешном выполнении и дополнительные внутренние сообщения. Используйте подробный уровень ведения журнала для устранения неполадок.  
  
 Уровнем по умолчанию является расширенный.  
  
 **Сбросить все**  
 Выберите этот параметр для приведения всех величин на странице к их значениям по умолчанию.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="CompleteWizard"></a> Страница завершения мастера  
 Данная страница используется для просмотра действий, которые выполнит **Мастер настройки компонента Database Mail** . До окончания выполнения мастера никакие изменения не вступят в силу.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
###  <a name="TestEmail"></a> Send Test E-Mail Page  
 Страница **Отправка тестового сообщения от***<имя_экземпляра>* используется для отправки электронных сообщений с помощью заданного профиля компонента Database Mail. Только члены предопределенной роли сервера **sysadmin** могут отправлять тестовые сообщения электронной почты с этой страницы.  
  
 **Профиль компонента Database Mail**  
 Выберите профиль компонента Database Mail из списка. Это поле является обязательным. Если ни один профиль не отображается, то их либо не существует вовсе, либо у пользователя нет разрешений на профиль. Для создания и настройки профилей используется **Мастер настройки компонента Database Mail** . Если в списке нет ни одного профиля, создайте профиль с помощью мастера настройки компонента Database Mail.  
  
 **Чтобы**  
 Электронные адреса получателей сообщения. Необходимо указать минимум одного получателя.  
  
 **Тема**  
 Строка темы тестового электронного письма. Измените тему по умолчанию, чтобы облегчить поиск электронного письма при устранении неполадок.  
  
 **Текст**  
 Текст тестового электронного письма. Измените тему по умолчанию, чтобы облегчить поиск электронного письма при устранении неполадок.  
  
 Диалоговое окно **Тестовое сообщение компонента Database Mail** предназначено для подтверждения того, что тестовое сообщение, отправлявшееся компонентом Database Mail, отправлено, и отображает параметр **mailitem_id** для этого сообщения. Убедитесь, что тестовое сообщение дошло до получателя. Обычно электронное письмо приходит к получателю через несколько минут, но оно может и задержаться из-за низкой производительности сети, загруженности почтового сервера или его временной недоступности. Для устранения неполадок используется параметр **mailitem_id** .  
  
 **Отправленная почта**  
 Идентификатор **mailitem_id** тестового электронного сообщения.  
  
 **Диагностика**  
 Щелкните ссылку, чтобы открыть раздел [Устранение неполадок компонента Database Mail](http://msdn.microsoft.com/library/ms188663.aspx)электронной документации.  
  
 [Мастера настройки компонента Database Mail](#DBWizard)  
  
##  <a name="Template"></a> С помощью шаблонов  
 **Создание скрипта настройки компонента Database Mail**  
  
1.  В меню **Вид** выберите **Обозреватель шаблонов**.  
  
2.  В окне **Обозреватель шаблонов** разверните папку **Компонент Database Mail** .  
  
3.  Дважды щелкните вкладку **Простая конфигурация компонента Database Mail**. Шаблон откроется в отдельном окне.  
  
4.  В меню **Запрос** выберите пункт **Задание значений для параметров шаблона**. Откроется диалоговое окно **Замена параметров шаблона** .  
  
5.  Введите значения параметров **profile_name**, **account_name**, **SMTP_servername**, **email_address**и **display_name**. Среда SQL Server Management Studio вставляет в шаблон заданные значения.  
  
6.  Запустите скрипт, создающий конфигурацию.  
  
7.  При выполнении скрипта не обязательно предоставляется доступ к профилю для всех пользователей базы данных. По умолчанию право на использование профиля предоставляется только членам фиксированной роли безопасности **sysadmin** . Дополнительные сведения о предоставлении прав доступа к профилям см. в разделе [sysmail_add_principalprofile_sp (Transact-SQL)](../../relational-databases/system-stored-procedures/sysmail-add-principalprofile-sp-transact-sql.md)  
  
  
