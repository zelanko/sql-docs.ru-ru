---
title: Просмотр или изменение модели восстановления для базы данных (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 05/10/2019
ms.prod: sql
ms.prod_service: backup-restore
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- database backups [SQL Server], recovery models
- recovery [SQL Server], recovery model
- backing up databases [SQL Server], recovery models
- recovery models [SQL Server], switching
- recovery models [SQL Server], viewing
- database restores [SQL Server], recovery models
- modifying database recovery models
ms.assetid: 94918d1d-7c10-4be7-bf9f-27e00b003a0f
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: ff66ea5a2e66ddd1f416d21d32130aabce0e6507
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68041295"
---
# <a name="view-or-change-the-recovery-model-of-a-database-sql-server"></a>Просмотр или изменение модели восстановления базы данных (SQL Server)
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]

  В этом разделе описывается просмотр и изменение базы данных с помощью среды [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../includes/tsql-md.md)]. 
  
  *Модель восстановления* — это свойство базы данных, которое управляет процессом регистрации транзакций, определяет, требуется ли для журнала транзакций резервное копирование, а также определяет, какие типы операций восстановления доступны. Существует три модели восстановления: простая модель восстановления, модель полного восстановления и модель восстановления с неполным протоколированием. Обычно в базе данных используется модель полного восстановления или простая модель восстановления. Базу данных можно в любой момент переключить на использование другой модели восстановления. База данных **model** задает модель восстановления по умолчанию для новых баз данных.  
  
  Более подробное объяснение см. в статье о [моделях восстановления](recovery-models-sql-server.md).
  
  
##  <a name="BeforeYouBegin"></a> Перед началом  
  

-   [Back up the transaction log](back-up-a-transaction-log-sql-server.md) **before** switching from the [full recovery or bulk-logged recovery model](recovery-models-sql-server.md).  
  
-   Восстановление на момент времени невозможно в модели с неполным протоколированием. Выполнение транзакций в модели восстановления с неполным протоколированием, которая может потребовать восстановления журнала транзакций, может привести к потере данных. Чтобы до максимума повысить восстанавливаемость данных в сценарии аварийного восстановления, следует переключаться в модель восстановления с неполным протоколированием только в следующих случаях.  
  
    -   в настоящий момент пользователям запрещен доступ к базе данных;  
  
    -   Во время массовой обработки не было изменений, которые невозможно восстановить без применения резервной копии журнала (например, повторным запуском массовой обработки).  
  
     Если выполняются эти два условия, то при восстановлении журнала транзакций, созданного в модели восстановления с неполным протоколированием, не возникнет угрозы потери данных.  
  
**Примечание.** При переключении на модель полного восстановления в ходе массовой операции режим регистрации массовой операции переключается с минимального протоколирования на полное, и наоборот.  
  
###  <a name="Security"></a> Необходимые разрешения  
   Необходимо разрешение ALTER на базу данных.  
  
##  <a name="SSMSProcedure"></a> Использование среды SQL Server Management Studio  
  
#### <a name="to-view-or-change-the-recovery-model"></a>Просмотр или изменение модели восстановления  
  
1.  После подключения к соответствующему экземпляру компонента [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)]в обозревателе объектов разверните дерево сервера, щелкнув его имя.  
  
2.  Раскройте узел **Базы данных**и в зависимости от типа восстанавливаемой базы данных выберите пользовательскую базу данных или раскройте узел **Системные базы данных** и выберите системную базу данных.  
  
3.  Щелкните базу данных правой кнопкой мыши и выберите **Свойства**. Откроется диалоговое окно **Свойства базы данных** .  
  
4.  На панели **Выбор страницы** щелкните **Параметры**.  
  
5.  Текущая модель восстановления будет указана в списке **Модель восстановления** .  
  
6.  Если нужно изменить модель восстановления, выберите в этом списке другую модель. Возможные варианты модели восстановления: **Полная**, **С неполным протоколированием**и **Простая**.  
  
7.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  

[!INCLUDE[freshInclude](../../includes/paragraph-content/fresh-note-steps-feedback.md)]

##  <a name="TsqlProcedure"></a> Использование Transact-SQL  
  
#### <a name="to-view-the-recovery-model"></a>Просмотр модели восстановления  
  
1.  Установите соединение с компонентом [!INCLUDE[ssDE](../../includes/ssde-md.md)].  
  
2.  На панели «Стандартная» нажмите **Создать запрос**.  
  
3.  Скопируйте следующий пример в окно запроса и нажмите кнопку **Выполнить**. В этом примере описано, как запросить через представление каталога [sys.databases](../../relational-databases/system-catalog-views/sys-databases-transact-sql.md) модель восстановления для базы данных **model** .  
  
```sql  
SELECT name, recovery_model_desc  
   FROM sys.databases  
      WHERE name = 'model' ;  
GO  
  
```  
  
#### <a name="to-change-the-recovery-model"></a>Изменение модели восстановления  
  
1.  Установите соединение с компонентом [!INCLUDE[ssDE](../../includes/ssde-md.md)].  
  
2.  На панели «Стандартная» нажмите **Создать запрос**.  
  
3.  Скопируйте следующий пример в окно запроса и нажмите кнопку **Выполнить**. В этом примере показано, как переключить модель восстановления в базе данных `model` в режим `FULL` с помощью параметра `SET RECOVERY` инструкции [ALTER DATABASE](../../t-sql/statements/alter-database-transact-sql-set-options.md) .  
  
```sql  
USE [master] ;  
ALTER DATABASE [model] SET RECOVERY FULL ;  
```  
  
##  <a name="FollowUp"></a> Рекомендуемые действия после изменения модели восстановления  
  
-   **После переключения с модели полного восстановления на модель восстановления с неполным протоколированием**  
  
    -   После завершения массовых операций немедленно переключитесь обратно на модель полного восстановления.  
  
    -   После переключения с модели восстановления с неполным протоколированием в модель полного восстановления создайте резервную копию журнала.  
  
        >**ПРИМЕЧАНИЕ.** Стратегия резервного копирования сохраняется: выполняйте периодически резервное копирование базы данных, журнала и создание разностных резервных копий.  
  
-   **После переключения с простой модели восстановления**  
  
    -   Сразу же после переключения на модель полного восстановления или на модель восстановления с неполным протоколированием создайте полную или разностную резервную копию базы данных, чтобы начать цепочку журналов.  
  
        >**ПРИМЕЧАНИЕ.** Переключение на модель полного восстановления или модель восстановления с неполным протоколированием вступает в силу только после создания первой резервной копии данных.  
  
    -   Запланируйте обычное резервное копирование журнала и соответствующим образом обновите план восстановления.  
  
        > **ВАЖНО!** Выполняйте резервное копирование журналов. Если резервные копии журнала создаются недостаточно часто, журнал транзакций начнет разрастаться до тех пор, пока не переполнит диск.  
  
-   **После переключения на простую модель восстановления**  
  
    -   Отмените все запланированные задания резервного копирования журнала транзакций.  
  
    -   Убедитесь, что запланировано периодическое резервное копирование базы данных. Резервное копирование базы данных очень важно как для защиты ваших данных, так и для усечения неактивной части журнала транзакций.  
  
##  <a name="RelatedTasks"></a> Related tasks  
  
-   [Создание полной резервной копии базы данных (SQL Server)](../../relational-databases/backup-restore/create-a-full-database-backup-sql-server.md)  
  
-   [Создание резервной копии журнала транзакций (SQL Server)](../../relational-databases/backup-restore/back-up-a-transaction-log-sql-server.md)  
  
-   [Создание задания](../../ssms/agent/create-a-job.md)  
  
-   [Отключение или включение задания](../../ssms/agent/disable-or-enable-a-job.md)  
  
##  <a name="RelatedContent"></a> См. также  
  
-   [Планы обслуживания базы данных](../maintenance-plans/maintenance-plans.md) (в электронной документации по [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] )  
  
## <a name="see-also"></a>См. также:  
 [Модели восстановления (SQL Server)](../../relational-databases/backup-restore/recovery-models-sql-server.md)   
 [Журнал транзакций (SQL Server)](../../relational-databases/logs/the-transaction-log-sql-server.md)   
 [ALTER DATABASE (Transact-SQL)](../../t-sql/statements/alter-database-transact-sql.md)   
 [sys.databases (Transact-SQL)](../../relational-databases/system-catalog-views/sys-databases-transact-sql.md)   
 [Модели восстановления (SQL Server)](../../relational-databases/backup-restore/recovery-models-sql-server.md)  
  
  
