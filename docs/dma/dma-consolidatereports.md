---
title: Оценка предприятия и объединение отчетов с оценкой (SQL Server) | Документация Майкрософт
description: Узнайте, как использовать DMA для оценки предприятия и объединение отчетов с оценкой перед обновлением SQL Server или переход на базу данных SQL Azure.
ms.custom: ''
ms.date: 02/27/2019
ms.prod: sql
ms.prod_service: dma
ms.reviewer: ''
ms.technology: dma
ms.topic: conceptual
keywords: ''
helpviewer_keywords:
- Data Migration Assistant, Assess
ms.assetid: ''
author: pochiraju
ms.author: rajpo
manager: craigg
ms.openlocfilehash: adfb1663d9ec1b86abf38c46c0056622105b80d5
ms.sourcegitcommit: 2ab79765e51913f1df6410f0cd56bf2a13221f37
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/27/2019
ms.locfileid: "56956035"
---
# <a name="assess-an-enterprise-and-consolidate-assessment-reports-with-dma"></a>Оценка предприятия и объединять оценки с помощью DMA

Следующие пошаговые инструкции по использованию Data Migration Assistant для выполнения успешной масштабированное оценки для обновления на локальном сервере SQL Server или SQL Server, запущенным на виртуальных машинах Azure или переход на базу данных SQL Azure.

## <a name="prerequisites"></a>предварительные требования

- Назначьте средства компьютер в сети, из которого будет инициироваться DMA. Убедитесь, что этот компьютер может подключиться к используемой SQL Server.
- Скачайте и установите:
    - [Помощник по миграции данных](https://www.microsoft.com/download/details.aspx?id=53595) v3.6 или более поздней версии.
    - [PowerShell](https://aka.ms/wmf5download) версии 5.0 или более поздней версии.
    - [.NET framework](https://www.microsoft.com/download/details.aspx?id=30653) версии 4.5 или более поздней версии.
    - [SSMS](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms) 17.0 или более поздней версии.
    - [PowerBI desktop](https://docs.microsoft.com/power-bi/desktop-get-the-desktop).
    - [Модули Azure PowerShell](https://docs.microsoft.com/powershell/azure/install-az-ps?view=azps-1.0.0)
- Загрузите и извлеките:
    - [DMA отчеты Power BI шаблона](https://msdnshared.blob.core.windows.net/media/2019/02/PowerBI-Reports.zip).
    - [LoadWarehouse скрипт](https://msdnshared.blob.core.windows.net/media/2019/02/LoadWarehouse1.zip).

## <a name="loading-the-powershell-modules"></a>Загрузка модулей PowerShell
Сохранение модулей PowerShell в каталог modules PowerShell позволяет вызывать модули без необходимости загружать их явно перед использованием.

Чтобы загрузить модули, выполните следующие действия:
1. Перейдите к C:\Program Files\WindowsPowerShell\Modules и создайте папку с именем **DataMigrationAssistant**.
2. Откройте [модули PowerShell](https://msdnshared.blob.core.windows.net/media/2019/02/PowerShell-Modules2.zip), а затем сохраните их в созданную папку.

      ![Модули PowerShell](../dma/media//dma-consolidatereports/dma-powershell-modules.png)

    Каждая папка содержит связанный psm1-файл, как показано на следующем рисунке:

   ![Файлов psm1 модули PowerShell](../dma/media//dma-consolidatereports/dma-powershell-modules-psm1-files.png)

   > [!NOTE]
   > Папки и psm1-файл, содержащиеся в ней должен иметь тем же именем.

   > [!IMPORTANT]
   > Может потребоваться разблокировка файлов PowerShell после сохранения их в каталог WindowsPowerShell, чтобы убедиться, что модули нужно загрузить правильно. Чтобы разблокировать файл PowerShell, щелкните правой кнопкой мыши файл, выберите **свойства**выберите **Unblock** текстовое поле, а затем выберите **ОК**.

   ![свойства файлов psm1](../dma/media//dma-consolidatereports/dma-psm1-file-properties.png)

    PowerShell должен загружаться эти модули автоматически при запуске нового сеанса PowerShell.

## <a name="create-inventory"></a> Создание инвентаризации серверов SQL Server
Прежде чем запустить сценарий PowerShell для оценки серверов SQL Server, необходимо создать перечень серверов SQL Server, который вы хотите оценить.

Этот инвентаризации может находиться в одном из двух форм:
- Excel CSV-файла
- Таблицы SQL Server

### <a name="if-using-a-csv-file"></a>Если в CSV-файле
При использовании CSV-файл для импорта данных, убедитесь, существует только два столбца данных — **имя экземпляра** и **имя базы данных**, и что у столбцов нет строки заголовка.
 
 ![содержимое файла CSV](../dma/media//dma-consolidatereports/dma-csv-file-contents.png)

### <a name="if-using-sql-server-table"></a>При использовании таблицы SQL Server
Создать базу данных с именем **EstateInventory** и таблица с именем **DatabaseInventory**. Может иметь любое количество столбцов, таблица, содержащая эти данные инвентаризации, до тех пор, пока существуют следующие четыре столбца:
- ServerName
- InstanceName
- DatabaseName
- AssessmentFlag

![Содержимое таблицы SQL Server](../dma/media//dma-consolidatereports/dma-sql-server-table-contents.png)

Если эта база данных не на компьютере средства, убедитесь, что компьютер инструментов имеет сетевое подключение к данному экземпляру SQL Server.

Преимуществом использования таблицы SQL Server через CSV-файл является, что столбец флагов оценки можно использовать для управления экземпляром / database, что получает выбран для оценки, что упрощает для разделения оценок на небольшие фрагменты.  Затем, может охватывать несколько оценок (см. раздел о запуске оценку далее в этой статье), который легче, чем сохранение нескольких CSV-файлов.

Имейте в виду, что в зависимости от количества объектов и их сложности, оценка может занять слишком долго (часов +), поэтому разумно отделить оценки на управляемые фрагменты.

## <a name="running-a-scaled-assessment"></a>Выполнение масштабированное оценки
После загрузки модули PowerShell в каталог modules и проведения инвентаризации, необходимо провести оценку, масштабируемой, откройте PowerShell и выполните функцию dmaDataCollector.
 
  ![функция вхождений dmaDataCollector](../dma/media//dma-consolidatereports/dma-dmaDataCollector-function-listing.png)

В следующей таблице описываются параметры, связанные с функцией dmaDataCollector.

|Параметр  |Описание |
|---------|---------|
|**getServerListFrom** | Данные инвентаризации. Возможные значения: **SqlServer** и **CSV**.<br/>Дополнительные сведения см. в разделе [создания перечня серверов SQL Server](#create-inventory). |
|**serverName** | Имя экземпляра SQL Server при использовании запасов **SqlServer** в **getServerListFrom** параметра. |
|**databaseName** | Размещение таблицы inventory базы данных. |
|**AssessmentName** | Имя оценки DMA. |
|**TargetPlatform** | Оценка целевого типа, который вы хотите выполнить.  Возможные значения: **AzureSQLDatabase**, **SQLServer2012**, **SQLServer2014**, **SQLServer2016**,  **SQLServerLinux2017**, **SQLServerWindows2017**, и **ManagedSqlServer**. |
|**AuthenticationMethod** | Метод проверки подлинности для подключения к целевым объектам SQL Server, вы хотите оценить. Возможные значения: **SQLAuth** и **WindowsAuth**. |
|**OutputLocation** | Каталог, в котором для хранения JSON оценки выходной файл. В зависимости от количества баз данных, оцениваются и количество объектов в базах данных оценки может занять слишком долго. Файл будет записан после выполнения всех оценок. |

Если непредвиденная ошибка, то командное окно, которое получает инициировано этот процесс будет завершен.  Просмотрите журнал ошибок, чтобы определить причину сбоя.
 
  ![Расположение журнала ошибок](../dma/media//dma-consolidatereports/dma-error-log-file-location.png)

## <a name="consuming-the-assessment-json-file"></a>Использование JSON-файл оценки

После завершения оценку, вы теперь все готово для импорта данных в SQL Server для анализа. Чтобы использовать файл JSON для оценки, откройте PowerShell и выполните функцию dmaProcessor.
 
  ![Листинг функция dmaProcessor](../dma/media//dma-consolidatereports/dma-dmaProcessor-function-listing.png)

В следующей таблице описываются параметры, связанные с функцией dmaProcessor.

|Параметр  |Описание |
|---------|---------|
|**processTo** | Расположение, к которому будут обрабатываться JSON-файл. Возможные значения: **SQLServer** и **AzureSQLDatabase**. |
|**serverName** | Экземпляр SQL Server, к которому данные будут обрабатываться.  Если указать **AzureSQLDatabase** для **processTo** параметра, включите только имя SQL Server (не включайте. database.windows.net). Вам предложат для двух имен входа при разработке для базы данных SQL Azure; Первый — учетные данные клиента Azure, второй — на имя для входа администратора для сервера SQL Azure. |
|**CreateDMAReporting** | Промежуточной базы данных, создаваемой для обработки JSON-файл.  Если база данных уже существует, необходимо задать этот параметр один, затем не создаются объекты.  Этот параметр полезен для повторного создания один объект, который был удален. |
|**CreateDataWarehouse** | Создает хранилище данных, который будет использоваться в отчете Power BI. |
|**databaseName** | Имя базы данных DMAReporting. |
|**warehouseName** | Имя базы данных хранилища данных. |
|**jsonDirectory** | Каталог, содержащий JSON-файл оценки.  Если имеются несколько JSON-файлов в каталоге, то они при обработке по одному. |

Функция dmaProcessor обычно занимает несколько секунд для обработки одного файла.

## <a name="loading-the-data-warehouse"></a>Загрузка хранилища данных
После завершения обработки файлов оценки dmaProcessor данные будут загружены в таблице ReportData базы данных DMAReporting. На этом этапе необходимо загрузить в хранилище данных.

1. Используйте сценарий LoadWarehouse для заполнения отсутствующих значений в измерениях.

    Сценарий принимает данные из таблицы ReportData в базе данных DMAReporting и загрузить его в хранилище.  При возникновении ошибки во время этого процесса загрузки, скорее всего они результатом недостающие записи в таблицах измерений.

2. Загрузка хранилища данных.
 
      ![Загрузить содержимое LoadWarehouse](../dma/media//dma-consolidatereports/dma-LoadWarehouse-loaded.png)

## <a name="set-your-database-owners"></a>Задайте ваши владельцы базы данных
Хотя это не обязательно, чтобы извлечь максимальную пользу из отчетов, рекомендуется установить владельцы базы данных **dimDBOwner** измерения, а затем обновите **DBOwnerKey** в  **FactAssessment** таблицы.  Этот процесс позволит создания срезов и фильтрации отчета Power BI, в зависимости от конкретной базы данных владельцы.

Сценарий LoadWarehouse может использоваться для предоставления простых инструкций TSQL для задания владельцы базы данных.

  ![Владельцы параметр LoadWarehouse](../dma/media//dma-consolidatereports/dma-LoadWarehouse-set-owners.png)

## <a name="dma-reports"></a>Отчеты DMA

1. Откройте шаблон DMA отчеты Power BI в Power BI Desktop.
2. Введите данные сервера, которые указывают на вашей **DMAWarehouse** базы данных, а затем выберите **нагрузки**.

    > [!IMPORTANT]
    > Не нажимайте клавишу ВВОД, чтобы принять значения.

      ![Загрузить шаблон DMA отчеты Power BI](../dma/media//dma-consolidatereports/dma-reports-powerbi-template-loaded.png)

   После отчета обновляются данные из **DMAWarehouse** базы данных, вам предоставляется отчет, подобный следующему.

   ![Представление отчетов DMAWarehouse](../dma/media//dma-consolidatereports/dma-DMAWarehouse-report1.png)

   > [!TIP]
   > Если вы не видите данных, которые вы ожидали, попробуйте изменить active закладки.  Дополнительные сведения см. в разделе подробно в следующем разделе.

## <a name="working-with-dma-reports"></a>Работа с отчетами DMA
Для работы с отчетами DMA используйте закладки и срезы для фильтрации по:
- Оценка типов (база данных SQL Azure, Azure SQL MI, SQL на локальной) 
- Имя экземпляра
- Имя базы данных
- Имя команды

Чтобы получить доступ к колонке "закладки" и "фильтры", выберите закладку фильтры на странице основного отчета:

![DMA отчет закладки и фильтры](../dma/media//dma-consolidatereports/dma-report-bookmarks-filters.png)

Это позволяет колонку следующего вида:

![Колонка DMA представлений отчетов](../dma/media//dma-consolidatereports/dma-report-views-blade.png)

Закладки можно использовать для переключения контекста отчетов между:
- Оценок облака Azure SQL DB
- Azure SQL MI cloud оценок
- В локальной оценок

![Представления отчетов о DMA закладки](../dma/media//dma-consolidatereports/dma-report-bookmarks1.png)

Чтобы скрыть фильтры колонки, удерживая нажатой кнопку "Назад":

![Кнопка "Назад" DMA представлений отчетов](../dma/media//dma-consolidatereports/dma-report-bookmarks-back.png)

Есть приглашение в левом нижнем углу страницы отчета для отображения, применяется ли в настоящее время фильтр на любой из следующих:
* FactAssessment — InstanceName
* FactAssessment — имя базы данных
* dimDBOwner - DBOwner

![Применен фильтр строки](../dma/media//dma-consolidatereports/dma-filter-applied-prompt.png)

> [!NOTE]
> Если только выполнить оценку базы данных SQL Azure, заполняются только отчеты в облаке. И наоборот если только выполнить оценку в локальной, заполняются только отчеты на локальном. Тем не менее если выполнить приложение Azure и локальной оценку, а затем загрузки обоих оценок в хранилище, можно переключаться между облачной и локальной отчеты с помощью клавиши CTRL значок.

## <a name="reports-visuals"></a>Визуальные элементы отчетов
Отображаемые сведения в отчетах Power BI отображается в следующих разделах.

### <a name="readiness-"></a>% Готовности

  ![Процент готовности DMA](../dma/media//dma-consolidatereports/dma-readiness-percentage.png)

Этот визуальный элемент обновляется на основе контекста выбора (все, экземпляр базы данных [кратными]).

### <a name="readiness-count"></a>Число готовности

  ![Число готовности DMA](../dma/media//dma-consolidatereports/dma-readiness-count.png)

Этот визуальный элемент, показывает количество баз данных, которые готовы к миграции количество баз данных, которые еще не готовы к миграции.

### <a name="readiness-bucket"></a>Готовность контейнеров

  ![Контейнер готовности DMA](../dma/media//dma-consolidatereports/dma-readiness-bucket.png)

Этот визуальный элемент приведена разбивка этих баз данных, в следующих ресурсах готовности:
- 100% ГОТОВНОСТИ
- ВСЕ ГОТОВО ДЛЯ 75-99%
- ВСЕ ГОТОВО ДЛЯ 50-75%
- НЕ ГОТОВО

### <a name="issues-word-cloud"></a>Облако Word проблемы
 
  ![Проблемы DMA WordCloud](../dma/media//dma-consolidatereports/dma-issues-word-cloud.png)

Этот визуальный элемент показаны проблемы, которые в данный момент выполняются в рамках в контексте выделения (все, экземпляр базы данных [кратными]). Чем больше отображается слово на экран, тем больше число проблем в этой категории. При наведении указателя мыши слово показывает количество возникающих в этой категории.

### <a name="database-readiness"></a>Готовность к базе данных

  ![Отчет о готовности базы данных DMA](../dma/media//dma-consolidatereports/dma-database-readiness-report.png)

В этом разделе находится в основной отчет, показывающий готовность базы-данных экземпляра. Этот отчет содержит иерархию детализации:
- База_данных_экземпляра
- ChangeCategory
- Заголовок
- ObjectType
- ImpactedObjectName

 ![Углубленная детализация DMA готовности базы данных отчетов](../dma/media//dma-consolidatereports/dma-database-readiness-report-drilldown.png)

Этот отчет также служит точкой фильтр по созданию отчета план по исправлению.

Для детализации в отчет план исправления, щелкните правой кнопкой мыши на точку данных на этой диаграмме, выберите пункт **детализации**, а затем выберите **планы исправления**.

Эта задача обеспечивает фильтрацию отчета план исправления к текущему уровню иерархии на основе точки, с которой выбран параметр детализации.

  ![Отфильтрованные детализации отчета DMA готовности базы данных](../dma/media//dma-consolidatereports/dma-database-readiness-report-drilldown-filtered.png)

  ![Отчет плана исправления DMA](../dma/media//dma-consolidatereports/dma-remediation-plan-report.png)

Можно также воспользоваться отчетом плана исправления для построения пользовательских обновлений плана с помощью фильтров в **фильтры визуализаций** колонке.
 
  ![Планирование обновлений DMA параметры фильтра отчета](../dma/media//dma-consolidatereports/dma-remediation-plan-report-filter-options.png)

### <a name="script-disclaimer"></a>Заявление об отказе скрипта
*Примеры сценариев, приведенные в этой статье не поддерживаются никакими Microsoft стандартными программами поддержки и обслуживания. Все скрипты предоставляются как есть без каких-либо гарантий. Корпорация Майкрософт не предоставляет все подразумеваемые гарантии, включая, без ограничений, любые подразумеваемые гарантии товарной пригодности или пригодности для определенной цели. Весь риск, возникающие в результате использования или функционирования примеры сценариев и документации, остается с вами. Не Майкрософт, ее автора или всех пользователей, в противном случае при создании, производства и доставки сценариев несут ответственность за весь ущебр ни при каких обстоятельствах (включая без ограничения, потерю упущенную, перерыв, потере бизнес-информации, или других упущенную потери) возникающие в результате использования или невозможности использовать примеры сценариев или документации, даже если корпорация Майкрософт знала о возможности таких убытков.  Поиск разрешения, прежде чем повторно записывающие эти сценарии на другие сайты/репозиториев и блоги.*
