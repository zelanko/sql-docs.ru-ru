---
title: DrilldownLevel (многомерные выражения) | Документация Майкрософт
ms.date: 06/04/2018
ms.prod: sql
ms.technology: analysis-services
ms.custom: mdx
ms.topic: reference
ms.author: owend
ms.reviewer: owend
author: minewiskan
ms.openlocfilehash: 6fdbc6ef265d51484160ab57a87e5672362326cc
ms.sourcegitcommit: 205de8fa4845c491914902432791bddf11002945
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "86970075"
---
# <a name="drilldownlevel-mdx"></a>DrilldownLevel (многомерные выражения)


  Детализирует углублением элементы набора на одном уровне под самым низким уровнем, представленным в наборе.  
  
 Указание уровня детализации не является обязательным, но если задать уровень, то можно использовать либо **выражение уровня** , либо **уровень индекса**. Эти аргументы являются взаимоисключающими. Наконец, при наличии в запросе вычисляемых элементов можно указать аргумент для включения их в набор строк.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
DrilldownLevel(Set_Expression [,[Level_Expression] ,[Index]] [,INCLUDE_CALC_MEMBERS])  
```  
  
## <a name="arguments"></a>Аргументы  
 *Set_Expression*  
 Допустимое многомерное выражение, возвращающее набор.  
  
 *Level_Expression*  
 (Необязательно). Выражение MDX, которое явно определяет уровень, на котором следует выполнять детализацию углублением. Если выражение уровня указано, пропустите аргумент индекса ниже.  
  
 *Index*  
 (Необязательно). Допустимое числовое выражение, указывающее количество иерархий, которые необходимо детализировать углублением в наборе. Вместо Level_Expression для явного определения уровня, на котором следует выполнять детализацию углублением, можно использовать уровень индекса.  
  
 *Include_Calc_Members*  
 (Необязательно). Флажок, указывающий, следует ли включать вычисленные элементы и должны ли они существовать на уровне детализации углублением.  
  
## <a name="remarks"></a>Примечания  
 Функция **DrilldownLevel** возвращает набор дочерних элементов в иерархическом порядке на основе элементов, включенных в указанный набор. Порядок следования исходных элементов указанного набора сохраняется, однако все дочерние элементы, входящие в результирующий набор функции, следуют непосредственно за своим родительским элементом.  
  
 При наличии многоуровневой иерархической структуры данных можно явно выбрать уровень детализации углублением. Существует два взаимоисключающих способа указать уровень. Первый подход заключается в установке аргумента **Level_Expression** с помощью многомерного выражения, возвращающего уровень. альтернативный подход заключается в указании аргумента **индекса** с помощью числового выражения, определяющего уровень по номеру.  
  
 Если выражение уровня указано, функция создает набор в иерархическом порядке, извлекая потомков только элементов указанного уровня. Если указано выражение уровня и на этом уровне отсутствует элемент, выражение уровня игнорируется.  
  
 Если указано значение индекса, функция создает набор в иерархическом порядке, получая потомков только тех элементов, которые находятся на следующем наиболее низком уровне указанной иерархии (на которую ссылается указанный набор) на основе начинающегося с нуля индекса.  
  
 Если ни выражение уровня, ни значение индекса не указаны, функция создает набор в иерархическом порядке, извлекая потомков только тех элементов, которые находятся на самом низком уровне первого измерения, на которое ссылается указанный набор.  
  
 Запрос свойства XMLA Мдпропмдксдриллфунктионс позволяет проверить уровень поддержки, предоставляемый сервером для функций сверления; Дополнительные сведения см. в разделе [Поддерживаемые свойства xmla &#40;&#41;XMLA](https://docs.microsoft.com/analysis-services/xmla/xml-elements-properties/propertylist-element-supported-xmla-properties) .  
  
## <a name="examples"></a>Примеры  
 Вы можете ознакомиться со следующими примерами в окне запроса MDX в SSMS, используя куб Adventure Works.  
  
 **Пример 1. Демонстрация минимального синтаксиса**  
  
 В первом примере показан минимальный синтаксис для **DrilldownLevel**. Единственным обязательным аргументом является выражение набора. Обратите внимание, что при выполнении этого запроса вы получаете родительский элемент [все категории] и члены следующего уровня: [стандартные], [велосипеды] и т. д. Хотя этот пример прост, он демонстрирует базовое назначение функции **DrilldownLevel** , которая детализирует углублением следующий уровень ниже.  
  
```  
SELECT DRILLDOWNLEVEL({[Product].[Product Categories]} * {[Sales Territory].[Sales Territory]}}) ON COLUMNS  
FROM [Adventure Works]  
```  
  
 Пример 2. Альтернативный синтаксис, использующий явный уровень индекса  
  
 В этом примере демонстрируется другой синтаксис, в котором уровень индекса указывается через числовое выражение. В этом случае уровень индекса равен 0. Для начинающегося с нуля индекса это самый низкий уровень.  
  
```  
SELECT  
DRILLDOWNLEVEL({[Product].[Product Categories]} * {[Sales Territory].[Sales Territory]},,0) ON COLUMNS  
FROM [Adventure Works]  
```  
  
 Обратите внимание, что набор результатов идентичен предыдущему запросу. Обычно указывать уровень индекса не требуется за исключением случаев, когда нужно выполнить детализацию углублением, чтобы начать на определенном уровне. Перезапустите предыдущий запрос, указав значение индекса 1, а затем 2. Со значением индекса, равным 1, детализация углублением начнется на втором уровне в иерархии. Со значением индекса, равным 2, детализация углублением начнется на третьем уровне — наивысшем в этом примере. Чем выше числовое выражение, тем выше уровень индекса.  
  
 **Пример 3. Демонстрация выражения уровня**  
  
 В следующем примере показывается, как использовать выражение уровня. При условии, что набор представляет иерархическую структуру, использование выражения уровня позволяет выбрать уровень иерархии, чтобы начать детализацию углублением.  
  
 В этом примере уровень детализации начинается в [City] в качестве второго аргумента функции **DrilldownLevel** . Когда вы запустите этот запрос, детализация углублением начнется на уровне [City] для штатов Вашингтон и Орегон. Для функции **DrilldownLevel** результирующий набор также включает элементы на следующем уровне вниз ([почтовые коды]).  
  
```  
SELECT [Measures].[Internet Sales Amount] ON COLUMNS,  
   NON EMPTY (  
   DRILLDOWNLEVEL(  
       {[Customer].[Customer Geography].[Country].[United States],  
           DESCENDANTS(  
             { [Customer].[Customer Geography].[State-Province].[Washington],    
               [Customer].[Customer Geography].[State-Province].[Oregon]},   
               [Customer].[Customer Geography].[City]) } ,  
[Customer].[Customer Geography].[City] ) )  ON ROWS  
FROM [Adventure Works]  
```  
  
 **Пример 4. Включение вычисляемых элементов**  
  
 В последнем примере показан вычисляемый элемент, который отображается в нижней части результирующего набора при добавлении флага **include_calculated_members** . Обратите внимание, чтобы флажок указан как четвертый параметр.  
  
 Этот пример работает, так как вычисленный элемент находится на том же уровне, что и не вычисленные элементы. Вычисленный элемент [West Coast] состоит из элементов из [США] и из всех элементов на один уровень ниже, чем [США].  
  
```  
WITH MEMBER   
[Customer].[Customer Geography].[Country].&[United States].[West Coast] AS  
[Customer].[Customer Geography].[State-Province].&[OR]&[US] +  
[Customer].[Customer Geography].[State-Province].&[WA]&[US] +  
[Customer].[Customer Geography].[State-Province].&[CA]&[US]  
SELECT [Measures].[Internet Order Count] ON 0,  
DRILLDOWNLEVEL([Customer].[Customer Geography].[Country].&[United States],,,INCLUDE_CALC_MEMBERS) on 1  
FROM [Adventure Works]  
```  
  
 Если вы только снимете флажок и перезапустите запрос, то получите те же результаты, кроме вычисленного элемента, [West Coast].  
  
## <a name="see-also"></a>См. также:  
 [Справочник по функциям многомерных выражений (многомерные выражения)](../mdx/mdx-function-reference-mdx.md)  
  
  
