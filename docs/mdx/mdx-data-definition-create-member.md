---
title: Инструкция CREATE MEMBER (многомерные выражения) | Документация Майкрософт
ms.date: 07/22/2020
ms.prod: sql
ms.technology: analysis-services
ms.custom: mdx
ms.topic: reference
ms.author: owend
ms.reviewer: owend
author: minewiskan
ms.openlocfilehash: 3ca2c664246dfeab8070337a0daf818fb0a3327c
ms.sourcegitcommit: 768f046107642f72693514f51bf2cbd00f58f58a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "87110152"
---
# <a name="mdx-data-definition---create-member"></a>Определение данных многомерных выражений — CREATE MEMBER


  Создает вычисляемый элемент.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
CREATE [ SESSION ] [HIDDDEN] [ CALCULATED ] MEMBER CURRENTCUBE | Cube_Name.Member_Name   
   AS MDX_Expression  
      [,Property_Name = Property_Value, ...n]  
......[,SCOPE_ISOLATION = CUBE]  
```  
  
## <a name="arguments"></a>Аргументы  
 *Cube_Name*  
 Допустимое строковое выражение, содержащее имя куба, в котором будет создан элемент.  
  
 *Member_Name*  
 Допустимое строковое выражение, возвращающее имя элемента. Укажите полное имя, чтобы создать элемент в измерении, отличном от измерения мер. Если этого не сделать, элемент будет создан в измерении мер.  
  
 *MDX_Expression*  
 Допустимое многомерное выражение.  
  
 *Property_Name*  
 Допустимое строковое выражение, представляющее имя свойства вычисляемого элемента.  
  
 *Property_Value*  
 Допустимое скалярное выражение, представляющее значение свойства вычисляемого элемента.  
  
## <a name="remarks"></a>Комментарии  
 Инструкция CREATE MEMBER определяет вычисляемые элементы, которые доступны для всего сеанса и могут использоваться в нескольких запросах в данном сеансе. Дополнительные сведения см. в разделе [Создание вычисляемых элементов с областью действия сеанса &#40;&#41;многомерных выражений ](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-calculated-members-session-scoped-calculated-members).  
  
 Можно также определить вычисляемый элемент для использования только в одном запросе. Для определения вычисляемого элемента, ограниченного рамками одного запроса, используется предложение WITH в инструкции SELECT. Дополнительные сведения см. в разделе [Создание вычисляемых элементов с областью действия запроса &#40;&#41;многомерных выражений ](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-calculated-members-query-scoped-calculated-members).  
  
 *Property_name* могут ссылаться либо на стандартные, либо на необязательные свойства вычисляемых элементов. Стандартные свойства элементов перечислены далее в этом разделе. Вычисляемые элементы, созданные с помощью CREATE MEMBER без значения **сеанса** , имеют область сеанса. Кроме того, строки в определениях вычисляемых элементов разделяются двойными кавычками. В OLE DB определен другой метод, указывающий, что строки должны разделяться одиночными кавычками.  
  
 При указании куба, отличного от текущего подключенного куба, возникает ошибка. Поэтому для обращения к текущему кубу вместо указания имени куба рекомендуется использовать переменную CURRENTCUBE.  
  
 Дополнительные сведения о свойствах элементов, определенных в OLE DB, см. в документации OLE DB.  
  
## <a name="scope"></a>Область  
 Вычисляемый элемент может встречаться в одной из областей действия, перечисленных ниже.  
  
 Область запроса  
 Видимость и время жизни этого вычисляемого элемента ограничиваются данным запросом. Вычисляемый элемент определен в одном запросе. Область запроса имеет приоритет по сравнению с областью сеанса. Дополнительные сведения см. в разделе [Создание вычисляемых элементов с областью действия запроса &#40;&#41;многомерных выражений ](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-calculated-members-query-scoped-calculated-members).  
  
 Область сеанса  
 Видимость и время жизни этого вычисляемого элемента ограничиваются сеансом, в котором создан элемент. (Время существования меньше, чем длительность сеанса, если для вычисляемого элемента выдается инструкция DROP MEMBER.) Инструкция CREATE MEMBER создает вычисляемый элемент с областью действия сеанса.  
  
### <a name="scope-isolation"></a>Изоляция на уровне области  
 Если скрипт многомерных выражений куба содержит вычисляемые элементы, то по умолчанию они вычисляются до выполнения любых вычислений области сеанса и вычислений, определенных в запросе.  
  
> [!NOTE]  
>  В некоторых сценариях функция [Aggregate (многомерные выражения)](../mdx/aggregate-mdx.md) и функция [VisualTotals (MDX)](../mdx/visualtotals-mdx.md) не демонстрируют такое поведение.  
  
 Эта особенность позволяет обычным клиентским приложениям работать с кубами, которые содержат сложные вычисления, не вдаваясь в конкретную реализацию вычислений. Однако в некоторых случаях может потребоваться выполнить сеанс или вычисляемые элементы с областью действия запроса перед определенными вычислениями в Кубе, а также не применять ни **агрегатную** функцию, ни функцию **VisualTotals** . Чтобы сделать это, воспользуйтесь свойством вычисления SCOPE_ISOLATION.  
  
#### <a name="example"></a>Пример  
 Ниже приведен пример скрипта, в котором для получения правильного результата используется свойство вычисления SCOPE_ISOLATION.  
  
 **скрипт многомерных выражений куба:**  
  
```  
CREATE MEMBER CURRENTCUBE.Measures.ProfitRatio AS 'Measures.[Store Sales]/Measures.[Store Cost]', SOLVE_ORDER = 10  
```  
  
 **Запрос многомерных выражений:**  
  
```  
WITH MEMBER [Customer].[Customers].[USA]. USAWithoutWA AS  
[Customer].[Customers].[Country].&[USA] - [Customer].[Customers].[State Province.&[WA], SOLVE_ORDER=5  
SELECT {USAWithoutWA} ON 0 FROM SALES  
WHERE ProfitRatio  
```  
  
 В результате предыдущего запроса требовалось определить долю продаж в США, без штата Вашингтон (чтобы сохранить стоимость для США без штата Вашингтон). Предыдущий запрос не вернул ожидаемого результата. Возвращенным результатом была доля США за вычетом доли штата Вашингтон, что лишено смысла. Для достижения желаемого результата можно воспользоваться свойством вычисления SCOPE_ISOLATION.  
  
 **Запрос многомерных выражений с применением свойства вычисления SCOPE_ISOLATION:**  
  
```  
WITH MEMBER [Customer].[Customers].[USA]. USAWithoutWA AS  
[Customer].[Customers].[Country].&[USA] - [Customer].[Customers].[State Province.&[WA], SOLVE_ORDER=5  
,SCOPE_ISOLATION=CUBE  
SELECT {USAWithoutWA} ON 0 FROM SALES  
WHERE ProfitRatio  
```  
  
## <a name="standard-properties"></a>Стандартные свойства  
 У каждого вычисляемого элемента есть набор стандартных свойств. Когда клиентское приложение подключено к [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] , свойства по умолчанию либо поддерживаются, либо поддерживаются, так как администратор выбирает.  
  
 Дополнительные свойства могут быть доступны в зависимости от определения куба. Следующие свойства отражают сведения, относящиеся к уровню измерения в данном кубе.  
  
|Идентификатор свойства|Значение|  
|-------------------------|-------------|  
|SOLVE_ORDER|Порядок, в котором этот вычисляемый элемент будет вычисляться в случаях, когда один вычисляемый элемент ссылается на другой (то есть когда вычисляемые элементы пересекаются друг с другом).|  
|FORMAT_STRING|Строка формата стиля Office, которую клиентское приложение может использовать при отображении значений ячеек.|  
|VISIBLE|Значение, определяющее видимость вычисляемого элемента в наборе строк схемы. Видимые вычисляемые элементы можно добавить в набор с помощью функции [AddCalculatedMembers](../mdx/addcalculatedmembers-mdx.md) . Ненулевое значение указывает, что данный вычисляемый элемент видим. Значение по умолчанию для этого свойства — *Visible*.<br /><br /> Невидимые вычисляемые элементы (для которых значение свойства равно нулю) обычно используются как промежуточные этапы при вычислении более сложных элементов. К таким вычисляемым элементам могут также обращаться другие типы элементов, например меры.|  
|NON_EMPTY_BEHAVIOR|Мера или набор, используемые для определения поведения вычисляемых элементов при разрешении пустых ячеек.<br /><br /> Предупреждение. это свойство является устаревшим. ** \* \* \* \* ** Не задавайте его. Дополнительные сведения см. [в статье нерекомендуемые Analysis Services функции в SQL Server 2014](/previous-versions/sql/2014/analysis-services/deprecated-analysis-services-features-in-sql-server-2014?view=sql-server-2014) .|  
|CAPTION|Строка, используемая клиентским приложением в качестве заголовка элемента.|  
|DISPLAY_FOLDER|Строка, определяющая путь к папке отображения, которую клиентское приложение использует для демонстрации элемента. Разделитель уровней вложенности папок определяется клиентским приложением. Для средств и клиентов, входящих в [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] , обратная косая черта ( \\ ) — это разделитель уровней. Чтобы предоставить несколько папок вывода для определенного элемента, используйте точку с запятой (;) для разделения папок.|  
|ASSOCIATED_MEASURE_GROUP|Имя группы мер, с которой связан элемент.|  
  
## <a name="see-also"></a>См. также  
 [Инструкция DROP MEMBER &#40;&#41;многомерных выражений](../mdx/mdx-data-definition-drop-member.md)   
 [Инструкция обновления элемента &#40;многомерных выражений&#41;](../mdx/mdx-data-definition-update-member.md)   
 [Инструкции определения данных многомерных выражений &#40;&#41;многомерных выражений](../mdx/mdx-data-definition-statements-mdx.md)  
  
  
