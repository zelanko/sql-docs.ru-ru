---
title: Что такое прослушиватель группы доступности?
description: 'Общие сведения о прослушивателе группы доступности Always On и способах автоматического перенаправления трафика на требуемый сервер. '
ms.custom: seodec18
ms.date: 02/27/2020
ms.prod: sql
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], listeners
- read-only routing
- read-intent connections [AlwaysOn Availability Groups]
- Availability Groups [SQL Server], configuring
- Availability Groups [SQL Server], read-only routing
- Availability Groups [SQL Server], client connectivity
ms.assetid: 76fb3eca-6b08-4610-8d79-64019dd56c44
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 19718f762a7352865c5b9741ee42ec8cfe965eb8
ms.sourcegitcommit: 58158eda0aa0d7f87f9d958ae349a14c0ba8a209
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2020
ms.locfileid: "79434527"
---
# <a name="what-is-an-availability-group-listener"></a>Что такое прослушиватель группы доступности?  
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]

Прослушиватель группы доступности ― это виртуальное сетевое имя (VNN), к которому могут подключаться клиенты, чтобы получить доступ к базе данных из первичной или вторичной реплики группы доступности Always On. Прослушиватель позволяет клиенту подключаться к реплике, не зная физического имени экземпляра SQL Server. Так как прослушиватель маршрутизирует трафик, строку подключения клиента не нужно изменять после отработки отказа. 

Прослушиватель группы доступности состоит из службы доменных имен прослушивателя (DNS), обозначения порта прослушивателя, а также одного или нескольких IP-адресов. Для работы прослушивателя группы доступности поддерживается только протокол TCP.  Имя DNS прослушивателя должно быть уникальным в домене и в NetBIOS.  При создании прослушивателя он становится ресурсом кластера с соответствующим виртуальным сетевым именем (VNN), виртуальным IP-адресом (VIP) и зависимостью группы доступности. Клиент с помощью DNS разрешает VNN в несколько IP-адресов, а затем пытается подключаться по каждому адресу, пока запрос подключения не завершится успехом или не истечет время ожидания.  
  
Если для одной или нескольких [вторичных реплик для чтения](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) настроена маршрутизация только для чтения, то клиентские соединения с прослушивателем с намерением чтения автоматически направляются во вторичную реплику для чтения. 
  
В этой статье представлены общие сведения о прослушивателе группы доступности. Можно также [настроить прослушиватель](create-or-configure-an-availability-group-listener-sql-server.md), а затем узнать, как [подключиться к прослушивателю](listeners-client-connectivity-application-failover.md).
  
  
##  <a name="listener-parameters"></a><a name="AGlConfig"></a> Параметры прослушивателя  

 Прослушиватель группы доступности использует следующие элементы:
  
 **Уникальное имя DNS**  
 Оно известно также как имя виртуальной сети (VNN). Действуют правила именования Active Directory для DNS-имен узла. Дополнительные сведения см. в статье базы знаний [Соглашения о наименовании в Active Directory для компьютеров, доменов, сайтов и подразделений](https://support.microsoft.com/kb/909264) .  
  
**Один или несколько виртуальных IP-адресов (VIP)**  
 Виртуальные IP-адреса настраиваются для одной или нескольких подсетей, для которых группа доступности может выполнить отработку отказа.  
  
**Настройка IP-адресов**  
 Для данного прослушивателя группы доступности IP-адрес может использовать протокол DHCP или один или несколько статических IP-адресов. Использование DHCP может привести к задержкам подключения во время отработки отказа, поэтому его не рекомендуется использовать в рабочих средах. Группы доступности, которые распространяются на несколько подсетей или используют конфигурации гибридной сети, должны использовать статический IP-адрес. 
 
  
##  <a name="listener-port"></a><a name="SelectListenerPort"></a> Порт прослушивателя 
 При настройке прослушивателя группы доступности необходимо назначить порт.  Для упрощения строки подключения клиента в качестве порта по умолчанию можно задать порт 1433. При использовании порта 1433 указывать номер порта в строках подключения не требуется. Кроме того, поскольку каждый прослушиватель группы доступности будет иметь собственное имя виртуальной сети, каждый прослушиватель группы доступности, настроенный в одном кластере WSFC, может использовать один и тот же порт по умолчанию ― 1433.  
  
 Также можно назначить нестандартный порт прослушивателя, однако это приведет к тому, что при подключении к прослушивателю группы доступности его также придется явно указывать в строках подключения.  Кроме того, для нестандартного порта также придется создавать разрешение в брандмауэре.  
  
 Если для имен виртуальной сети прослушивателей используется порт по умолчанию 1433, необходимо будет сделать так, чтобы никакая другая служба в узле кластера не использовала этот порт. В противном случае возникнет конфликт порта.  
  
 Если один из экземпляров SQL Server уже прослушивает TCP-порт 1433 через прослушиватель экземпляра и при этом на данном компьютере больше нет служб (включая дополнительные экземпляры SQL Server), прослушивающие порт 1433, это не приведет к конфликту порта с прослушивателем группы доступности.  Обусловлено это тем, что прослушиватель группы доступности может совместно использовать один TCP-порт внутри одного процесса службы.  Однако не следует настраивать прослушивание одного порта несколькими экземплярами SQL Server (работающими параллельно).  
  
  
##  <a name="behavior-of-client-connections-on-failover"></a><a name="CCBehaviorOnFailover"></a> Поведение клиентских подключений при отработке отказа  

 В случае отработки отказа группы доступности существующие постоянные подключения к группе доступности разрываются, при этом, чтобы продолжить работать с той же базой данных-источником или доступной только для чтения базой данных-получателем, клиент должен установить новое соединение.  Пока на стороне сервера выполняется отработка отказа, связь с группой доступности может прерваться, что заставит клиентское приложение начать попытки установить новое подключение до тех пор, пока база данных-источник не будет переведена в режим «в сети».  
  
 Если группа доступности возвращается в режим "в сети" в то время, когда клиентское приложение пытается установить соединение, и до истечения времени ожидания подключения, то драйвер клиента может успешно выполнить одну из своих внутренних попыток установить соединение. В этом случае приложение не выдаст никакого сообщения об ошибке.  


## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы знакомы с функциями прослушивателя группы доступности, [создайте прослушиватель](create-or-configure-an-availability-group-listener-sql-server.md), а затем настройте приложение для [подключения к прослушивателю](listeners-client-connectivity-application-failover.md). Вы также можете ознакомиться с различными [стратегиями мониторинга группы доступности](monitoring-of-availability-groups-sql-server.md), чтобы обеспечить работоспособность группы доступности. 

Дополнительные сведения о группах доступности см. в разделе [Обзор групп доступности Always On (SQL Server)](../../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md). 
  

  
  
