---
title: Руководство по мониторингу и устранению неполадок в группах доступности AlwaysOn (SQL Server) | Документы Майкрософт
ms.custom: ag-guide
ms.date: 05/10/2016
ms.prod: sql
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
ms.assetid: 8d6d9954-ff6b-4e58-882e-eff0174f0d07
author: rothja
ms.author: jroth
manager: craigg
ms.openlocfilehash: 0e950ae6cbbf71154bfaf402ae9e3246bd3d93fe
ms.sourcegitcommit: 63b4f62c13ccdc2c097570fe8ed07263b4dc4df0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/13/2018
ms.locfileid: "51606934"
---
# <a name="always-on-availability-groups-troubleshooting-and-monitoring-guide"></a>Руководство по мониторингу и устранению неполадок в группах доступности AlwaysOn
 Это руководство поможет вам приступить к мониторингу групп доступности AlwaysOn и устранению некоторых распространенных проблем с ними. Оно предоставляет исходное содержимое, а также целевую страницу с полезной информацией, опубликованной в другом месте. Хотя это руководство не может полностью охватить все возможные проблемы с группами доступности, оно способно указать вам правильное направление для анализа первопричин и разрешения проблем. 
 
 Так как группы доступности являются встроенной технологией, множество возникающих проблем может быть вызвано другими проблемами в системе базы данных. Некоторые проблемы вызывают параметры в группе доступности, например приостановка базы данных доступности. Другие проблемы могут быть связаны с другими аспектами работы SQL Server, такими как параметры SQL Server, развертывания файла базы данных и систематические проблемы с производительностью, не относящиеся к доступности. За пределами SQL Server могут существовать и другие проблемы, например, связанные с сетевыми операциями ввода-вывода, TCP/IP, Active Directory и отказоустойчивой кластеризацией Windows Server (WSFC). Часто для выявления первопричины проблем, возникающих в группе доступности, реплике или базе данных, требуется устранить неполадки в нескольких технологиях.  
  

  
##  <a name="BKMK_SCENARIOS"></a> Сценарии устранения неполадок  
 Приведенная ниже таблица содержит ссылки на распространенные сценарии устранения неполадок для групп доступности. Они упорядочены по типам сценариев, таким как конфигурация, возможность подключения клиентов, переход на другой ресурс и производительность.  
  
|Сценарий|Тип сценария|Описание|  
|--------------|-------------------|-----------------|  
|[Поиск и устранение неисправностей конфигурации групп доступности AlwaysOn (SQL Server)](troubleshoot-always-on-availability-groups-configuration-sql-server.md)|Конфигурация|Содержит сведения об устранении типичных проблем, возникающих при настройке экземпляров сервера для групп доступности. Примеры типичных проблем настройки: группы доступности отключены, учетные записи настроены неправильно, конечная точка зеркального отображения баз данных не существует, конечная точка недоступна (ошибка SQL Server 1418), отсутствует сетевой доступ, команда присоединения базы данных завершается с ошибкой (ошибка SQL Server 35250).|  
|[Устранение неполадок с операцией добавления файла, давшей сбой (группы доступности AlwaysOn)](troubleshoot-a-failed-add-file-operation-always-on-availability-groups.md)|Конфигурация|Операция добавления файла приводит к приостановке базы данных-получателя и переключению ее в состояние "Не синхронизируется".|  
|[Не удается подключиться к прослушивателю группы доступности в среде с несколькими подсетями](https://support.microsoft.com/kb/2792139/en-us)|Подключение клиента|После настройки прослушивателя группы доступности вы не можете проверить связь с прослушивателем или подключиться к нему из приложения.|  
|[Устранение неполадок с неудачными автоматическими переходами на другой ресурс](https://support.microsoft.com/kb/2833707)|Отработка отказа|Не удалось успешно завершить автоматический переход на другой ресурс.|  
|[Устранение неполадок: превышение RTO в группе доступности](troubleshoot-availability-group-exceeded-rto.md)|Производительность|После автоматического перехода на другой ресурс или планового перехода на другой ресурс вручную без потери данных время перехода на другой ресурс превышает цель времени восстановления (RTO). Или при оценке времени перехода на другой ресурс для вторичной реплики с синхронной фиксацией (например, партнера по обеспечению автоматической отработки отказа) вы обнаруживаете, что оно превышает RTO.|  
|[Устранение неполадок: превышение RPO в группе доступности](troubleshoot-availability-group-exceeded-rpo.md)|Производительность|После принудительного перехода на другой ресурс вручную потеря данных превышает RPO. Или при расчете возможной потери данных для вторичной реплики с асинхронной фиксацией вы обнаруживаете, что она превышает RPO.|  
|[Устранение неполадок: изменения в первичной реплике не отражены во вторичной](troubleshoot-primary-changes-not-reflected-on-secondary.md)|Производительность|Клиентское приложение успешно изменяет первичную реплику, но запрос вторичной реплики показывает, что это изменение не отражено.|  
|[Устранение неполадок: высокое значение типа ожидания HADR_SYNC_COMMIT для групп доступности AlwaysOn](https://blogs.msdn.microsoft.com/sql_server_team/troubleshooting-high-hadr_sync_commit-wait-type-with-always-on-availability-groups/)|Производительность|Если HADR_SYNC_COMMIT слишком длинный, в потоке перемещения данных или фиксировании журнала вторичной реплики возникает проблема производительности.|  

##  <a name="BKMK_TOOLS"></a> Полезные инструменты для устранения неполадок  
 При настройке или выполнении групп доступности можно использовать различные инструменты для диагностирования различных типов проблем. Приведенная ниже таблица содержит ссылки на полезные сведения об инструментах.  
  
|Инструмент|Описание|  
|----------|-----------------|  
|[Использование панели мониторинга AlwaysOn (среда SQL Server Management Studio)](use-the-always-on-dashboard-sql-server-management-studio.md)|Дает обзорное представление работоспособности группы доступности в понятном интерфейсе.|  
|[Политики AlwaysOn](always-on-policies.md)|Используется панелью мониторинга AlwaysOn.|  
|[Журнал ошибок SQL Server (группы доступности AlwaysOn)](sql-server-error-log-always-on-availability-groups.md)|Регистрирует события перехода состояния для групп доступности, реплик и баз данных, состояний других компонентов AlwaysOn и ошибок AlwaysOn.|  
|[CLUSTER.LOG (группы доступности AlwaysOn)](cluster-log-always-on-availability-groups.md)|Регистрирует события кластера, включая переходы состояния ресурсов группы доступности, а также события и ошибки из библиотеки ресурсов SQL Server.|  
|[Журнал диагностики работоспособности AlwaysOn](always-on-health-diagnostics-log.md)|Регистрирует диагностические данные о работоспособности SQL Server, предоставленные кластеру WSFC (библиотека ресурсов SQL Server) процедурой [sp_server_diagnostics (Transact-SQL)](~/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql.md).|  
|[Динамические административные представления и представления системного каталога (группы доступности AlwaysOn)](dynamic-management-views-and-system-catalog-views-always-on-availability-groups.md)|Сообщает сведения о группах доступности, такие как конфигурация, состояние работоспособности и метрики производительности.|  
|[Расширенные события AlwaysOn](always-on-extended-events.md)|Предоставляет подробные диагностические данных по группам доступности и удобен для анализа первопричин.|  
|[Типы ожидания AlwaysOn](always-on-wait-types.md)|Предоставляет статистику ожидания для групп доступности и удобен для настройки производительности.|  
|Счетчики производительности AlwaysOn|Отслеживают активность групп доступности, отражаются в системном мониторе и удобны для настройки производительности. Дополнительные сведения см. в разделе [SQL Server, реплика доступности](~/relational-databases/performance-monitor/sql-server-availability-replica.md) и [SQL Server, реплика базы данных](~/relational-databases/performance-monitor/sql-server-database-replica.md).|  
|[Кольцевые буферы AlwaysOn](always-on-ring-buffers.md)|Регистрируют предупреждения в системе SQL Server для внутренней диагностики, а также могут использоваться для отладки проблем, связанных с группами доступности.|  
  
##  <a name="BKMK_MONITOR"></a> Мониторинг групп доступности  
 Оптимальным временем для устранения неполадок группы доступности является момент перед тем, как проблема потребует автоматически или вручную перейти на другой ресурс. Для этого можно отслеживать метрики производительности группы доступности и отправлять предупреждения, когда реплики доступности выполняются за пределами соглашения об уровне обслуживания (SLA). Например, если синхронная вторичная реплика имеет проблемы с производительностью, приводящие к увеличению приблизительного времени перехода на другой ресурс, дождитесь автоматического перехода на другой ресурс, чтобы узнать, что время перехода на другой ресурс превышает время цели времени восстановления.  
  
 Так как группы доступности поддерживают высокую доступность и аварийное восстановление, наиболее важными отслеживаемыми метриками производительности являются приблизительное время перехода на другой ресурс, которое влияет на цель времени восстановления (RTO), и возможная потеря данных при аварии, которая влияет на целевую точку восстановления (RPO). Эти метрики можно в любой момент получить из данных, предоставляемых SQL Server, чтобы узнать о проблеме с возможностями аварийного восстановления высокой доступности (HADR) до возникновения события сбоя. Таким образом, важно ознакомиться с процессом синхронизации данных в группах доступности и организовать сбор метрик должным образом.  
  
 Приведенная ниже таблица указывает разделы, описывающие мониторинг работоспособности для решения групп доступности.  
  
|Раздел|Описание|  
|-----------|-----------------|  
|[Мониторинг производительности для групп доступности AlwaysOn](monitor-performance-for-always-on-availability-groups.md)|Описание процесса синхронизации данных для групп доступности, шлюзы управления потоком и метрики, которые могут пригодиться при мониторинге группы доступности, а также процесса сбора метрик RTO и RPO.|  
|[Отслеживание групп доступности (SQL Server)](monitoring-of-availability-groups-sql-server.md)|Сведения о средствах наблюдения за группой доступности.|  
|[Модель работоспособности AlwaysOn, часть 1. Архитектура модели работоспособности](https://blogs.msdn.com/b/sqlalwayson/archive/2012/02/09/overview-of-the-alwayson-manageability-health-model.aspx)|Общие сведения о модели работоспособности AlwaysOn.|  
|[Модель работоспособности AlwaysOn, часть 2. Расширение модели работоспособности](https://blogs.msdn.com/b/sqlalwayson/archive/2012/02/13/extending-the-alwayson-health-model.aspx)|Описание настройки модели работоспособности AlwaysOn и панели мониторинга AlwaysOn для отображения дополнительных сведений.|  
|[Мониторинг работоспособности AlwaysOn с использованием PowerShell, часть 1. Общий обзор командлетов](https://blogs.msdn.com/b/sqlalwayson/archive/2012/02/13/monitoring-alwayson-health-with-powershell-part-1.aspx)|Общий обзор командлетов AlwaysOn PowerShell, которые можно использовать для наблюдения за работоспособностью группы доступности.|  
|[Мониторинг работоспособности AlwaysOn с использованием PowerShell, часть 2. Расширенное использование командлетов](https://blogs.msdn.com/b/sqlalwayson/archive/2012/02/13/monitoring-alwayson-health-with-powershell-part-2.aspx)|Сведения о расширенном использовании командлетов AlwaysOn PowerShell для наблюдения за работоспособностью группы доступности.|  
|[Мониторинг работоспособности AlwaysOn с использованием PowerShell, часть 3. Простое приложение для мониторинга](https://blogs.msdn.com/b/sqlalwayson/archive/2012/02/15/monitoring-alwayson-health-with-powershell-part-3.aspx)|Описание автоматического мониторинга группы доступности с помощью приложения.|  
|[Мониторинг работоспособности AlwaysOn с использованием PowerShell, часть 4. Интеграция с агентом SQL Server](https://blogs.msdn.com/b/sqlalwayson/archive/2012/02/15/the-always-on-health-model-part-4.aspx)|Сведения об интеграции мониторинга группы доступности с агентом SQL Server и настройке уведомления соответствующих сторон при возникновении проблем.|  

## <a name="next-steps"></a>Следующие шаги  
 [Блог группы разработчиков SQL Server AlwaysOn](https://blogs.msdn.com/b/sqlalwayson/)   
 [Блоги инженеров CSS SQL Server](https://blogs.msdn.com/b/psssql/)  
  
  
