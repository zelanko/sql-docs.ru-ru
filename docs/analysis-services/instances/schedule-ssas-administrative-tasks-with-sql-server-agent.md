---
title: "Планирование задач администрирования служб SSAS с агентом SQL Server | Документы Microsoft"
ms.custom: 
ms.date: 03/14/2017
ms.prod: analysis-services
ms.prod_service: analysis-services
ms.service: 
ms.component: data-mining
ms.reviewer: 
ms.suite: pro-bi
ms.technology: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 2d1484b3-51d9-48a0-93d2-0c3e4ed22b87
caps.latest.revision: "12"
author: Minewiskan
ms.author: owend
manager: kfile
ms.workload: On Demand
ms.openlocfilehash: d8872cadbcbd7da67212fa26417ac66debc5f79c
ms.sourcegitcommit: 3206a31870f8febab7d1718fa59fe0590d4d45db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
# <a name="schedule-ssas-administrative-tasks-with-sql-server-agent"></a>Планирование задач администрирования служб SSAS с помощью агента SQL Server
[!INCLUDE[ssas-appliesto-sqlas](../../includes/ssas-appliesto-sqlas.md)]Используя службу агента SQL Server, можно запланировать [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] требуются административные задачи для выполнения в порядке и время. Планирование задач позволяет автоматизировать процессы, выполняющиеся регулярно или с предсказуемой цикличностью. Задачи типа обработки кубов могут быть запланированы на периоды низкой деловой активности. Кроме того, при создании шагов задания агента SQL Server пользователь имеет возможность определить порядок, в котором будут выполняться задачи. Например, можно выполнить обработку куба, а затем создать его резервную копию.  
  
 Шаги задания позволяют управлять потоком выполнения. Агент SQL Server может быть настроен таким образом, чтобы в случае сбоя одного из заданий выполнение оставшихся задач было продолжено или прекращено. Вы можете также настроить агент SQL Server на отправку уведомлений о выполнении или сбое выполнения задания.  
  
 Данный раздел является пошаговым руководством, демонстрирующим два способа использования агента SQL Server для запуска скрипта XML для аналитики. В первом примере показано, как запланировать обработку одного измерения. Второй пример показывает, как объединить задачи обработки в единый скрипт, выполняемый по расписанию. Для прохождения этого пошагового руководства необходимо выполнить следующие предварительные требования.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Должна быть установлена служба агента SQL Server.  
  
 По умолчанию задания запускаются под учетной записью службы. Учетная запись по умолчанию для агента SQL Server является NT Service\SQLAgent$\<имя_экземпляра >. Для выполнения задачи резервного копирования или обработки эта учетная запись должна принадлежать системному администратору в экземпляре служб Analysis Services. Дополнительные сведения см. в разделе [Предоставление прав администратора сервера для экземпляра служб Analysis Services](../../analysis-services/instances/grant-server-admin-rights-to-an-analysis-services-instance.md).  
  
 Также необходимо наличие тестовой базы данных, с которой будет производиться работа. Для использования в данном пошаговом руководстве вы можете развернуть образец многомерной базы данных AdventureWorks или проект из учебника по многомерному моделированию в службах Analysis Services. Дополнительные сведения см. в статье [Установка образцов данных и проектов для учебника по многомерному моделированию в службах Analysis Services](../../analysis-services/install-sample-data-and-projects.md).  
  
## <a name="example-1-processing-a-dimension-in-a-scheduled-task"></a>Пример 1. Обработка измерения в запланированной задаче  
 В этом примере показано, как создать и запланировать задание по обработке измерения.  
  
 Запланированная задача служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] представляет собой скрипт XML для аналитики, внедренный в задание агента SQL Server. Это задание имеет расписание для запуска в нужное время и с нужной частотой. Поскольку агент SQL Server является частью [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], при создании задачи администрирования придется работать и с ядром СУБД, и со службами [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .  
  
###  <a name="bkmk_CreateScript"></a> Создание скрипта для обработки измерения в задании агента SQL Server  
  
1.  В среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]подключитесь к службам [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Откройте папку базы данных и найдите измерение. Щелкните измерение правой кнопкой мыши и выберите команду **Обработать**.  
  
2.  Убедитесь в том, что в диалоговом окне **Обработка измерения** в разделе **Список объектов** для столбца **Параметры обработки**выбран параметр **Обработка. Полная**. Если этот параметр не выбран, выделите столбец **Параметры обработки**, а затем в раскрывающемся списке выберите **Обработка. Полная** .  
  
3.  Нажмите кнопку **Скрипт**.  
  
     На этом шаге открывается окно **XML-запрос** , содержащее скрипт XML для аналитики, который обрабатывает измерение.  
  
4.  В диалоговом окне **Обработка измерения** нажмите кнопку **Отмена** , чтобы закрыть его.  
  
5.  В окне **Запрос XML для аналитики** выделите скрипт XML для аналитики, щелкните его правой кнопкой мыши и выберите команду **Копировать**.  
  
     Этот шаг копирует скрипт XML для аналитики в буфер обмена Windows. Скрипт XML для аналитики вы можете оставить в буфере обмена или вставить его в «Блокнот» или другой текстовый редактор. Далее приведен пример скрипта XML для аналитики.  
  
    ```  
    <Batch xmlns="http://schemas.microsoft.com/analysisservices/2003/engine">  
     <Parallel>  
      <Process xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">  
        <Object>  
          <DatabaseID>Adventure Works DW Multidimensional</DatabaseID>  
          <DimensionID>Dim Account</DimensionID>  
        </Object>  
        <Type>ProcessFull</Type>  
        <WriteBackTableCreation>UseExisting</WriteBackTableCreation>  
      </Process>  
     </Parallel>  
    </Batch>  
    ```  
  
###  <a name="bkmk_ProcessJob"></a> Создание и планирование задания обработки измерения  
  
1.  Подключитесь к экземпляру ядра СУБД, а затем откройте обозреватель объектов.  
  
2.  Разверните узел **Агент SQL Server**.  
  
3.  Щелкните правой кнопкой мыши **Задания** и выберите пункт **Создать задание**.  
  
4.  В диалоговом окне **Создание задания** введите имя задания в поле **Имя**.  
  
5.  В разделе **Выбор страницы**выберите **Шаги**, а затем нажмите **Создать**.  
  
6.  В диалоговом окне **Новый шаг задания** введите имя шага в поле **Имя шага**.  
  
7.  В поле **Сервер** введите **localhost** для экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] по умолчанию или **localhost\\**\<*имя экземпляра*> для именованного экземпляра.  
  
     Если задание будет выполняться с удаленного компьютера, используйте имя сервера и имя экземпляра, в котором будет выполняться задание. Используйте формат \< *имя сервера*> для экземпляра по умолчанию и \< *имя сервера*>\\<*экземпляра имя*> для именованного экземпляра.  
  
8.  В поле **Тип**выберите **Команда служб SQL Server Analysis Services**.  
  
9. В поле **Команда**щелкните правой кнопкой мыши и выберите **Вставить**. Скрипт XML для аналитики, созданный на предыдущем шаге, должен отобразиться в командном окне.  
  
10. Нажмите кнопку **ОК**.  
  
11. В разделе **Выбор страницы**выберите **Расписания**, а затем нажмите **Создать**.  
  
12. В диалоговом окне **Создание расписания задания** введите имя расписания в поле **Имя**, а затем нажмите кнопку **ОК**.  
  
     Этот шаг создает расписание на воскресенье в 00:00. Следующий шаг показывает, как вручную выполнить задание. Вы можете также указать расписание, которое выполнит задание во время его мониторинга.  
  
13. В диалоговом окне **Создание задания** нажмите кнопку **ОК**.  
  
14. В **обозревателе объектов**разверните узел **Задания**, щелкните правой кнопкой мыши созданное задание и выберите команду **Запустить задание на шаге**.  
  
     Поскольку задание состоит только из одного шага, оно будет выполнено немедленно. Если в задании содержится более одного шага, вы можете выбрать шаг, с которого будет запущено задание.  
  
15. По завершении задания нажмите кнопку **Закрыть**.  
  
## <a name="example-2-batch-processing-a-dimension-and-a-partition-in-a-scheduled-task"></a>Пример 2. Пакетная обработка измерения и секции в запланированной задаче  
 Процедуры в данном примере демонстрируют, как создать и запланировать задание по пакетной обработке измерения базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] и одновременно обработать секцию куба, которая зависит от измерения для агрегата. Дополнительные сведения о пакетной обработке объектов [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] см. в разделе [Пакетная обработка (службы Analysis Services)](../../analysis-services/multidimensional-models/batch-processing-analysis-services.md).  
  
###  <a name="bkmk_BatchProcess"></a> Создание скрипта для пакетной обработки измерения и секции в задании агента SQL Server  
  
1.  Используя ту же базу данных, разверните узел **Измерения**, щелкните правой кнопкой мыши измерение **Клиент** и выберите **Обработать**.  
  
2.  Убедитесь в том, что в диалоговом окне **Обработка измерения** для столбца **Параметры обработки** в разделе **Список объектов**выбран параметр **Обработка. Полная**.  
  
3.  Нажмите кнопку **Скрипт**.  
  
     На этом шаге открывается окно **XML-запрос** , содержащее скрипт XML для аналитики, который обрабатывает измерение.  
  
4.  В диалоговом окне **Обработка измерения** нажмите кнопку **Отмена** , чтобы закрыть его.  
  
5.  Разверните последовательно узлы **Кубы**, **Adventure Works**, **Группы мер**, **Интернет-продажи**, **Секции**, щелкните правой кнопкой мыши последнюю секцию в списке и выберите команду **Обработать**.  
  
6.  Убедитесь в том, что в диалоговом окне **Обработка секции** для столбца **Параметры обработки** в разделе **Список объектов**выбран параметр **Обработка. Полная**.  
  
7.  Нажмите кнопку **Скрипт**.  
  
     На этом шаге откроется второе окно **XML-запрос** , содержащее скрипт XML для аналитики, который обрабатывает секцию.  
  
8.  В диалоговом окне **Обработка секции** нажмите кнопку **Отмена** , чтобы закрыть редактор.  
  
     На этом этапе необходимо объединить два скрипта и обеспечить обработку измерения в первую очередь.  
  
    > [!WARNING]  
    >  Если сначала обрабатывается секция, последующая обработка измерения приводит к тому, что секция становится необработанной. После этого для достижения обработанного состояния требуется повторная обработка секции.  
  
9. В окне **Запрос XML для аналитики** , содержащем скрипт XML для аналитики, который обрабатывает раздел, выделите код внутри тегов `Batch` и `Parallel` , щелкните правой кнопкой мыши выделенный скрипт и выберите команду **Копировать**.  
  
    ```  
    <Process xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">  
        <Object>  
          <DatabaseID> Adventure Works DW Multidimensional</DatabaseID>  
          <CubeID>Adventure Works</CubeID>  
          <MeasureGroupID>Fact Internet Sales 1</MeasureGroupID>  
          <PartitionID> Internet_Sales_2004</PartitionID>  
        </Object>  
        <Type>ProcessFull</Type>  
        <WriteBackTableCreation>UseExisting</WriteBackTableCreation>  
      </Process>  
    ```  
  
10. Откройте окно **Запрос XML для аналитики** , содержащее скрипт XML для аналитики, который обрабатывает измерение. Щелкните правой кнопкой мыши внутри скрипта слева от тега `</Process>` и выберите команду **Вставить**.  
  
     В следующем примере показан измененный скрипт XML для аналитики.  
  
    ```  
    <Batch xmlns="http://schemas.microsoft.com/analysisservices/2003/engine">  
     <Parallel>  
      <Process xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">  
        <Object>  
          <DatabaseID>Adventure Works DW Multidimensional</DatabaseID>  
          <DimensionID>Dim Customer</DimensionID>  
        </Object>  
        <Type>ProcessFull</Type>  
        <WriteBackTableCreation>UseExisting</WriteBackTableCreation>  
      </Process>  
      <Process xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">  
        <Object>  
          <DatabaseID>Adventure Works DW Multidimensional</DatabaseID>  
          <CubeID>Adventure Works</CubeID>  
          <MeasureGroupID>Fact Internet Sales 1</MeasureGroupID>  
          <PartitionID>Internet_Sales_2004</PartitionID>  
        </Object>  
        <Type>ProcessFull</Type>  
        <WriteBackTableCreation>UseExisting</WriteBackTableCreation>  
      </Process>  
     </Parallel>  
    </Batch>  
    ```  
  
11. Выделите измененный скрипт XML для аналитики, щелкните его правой кнопкой мыши и выберите команду **Копировать**.  
  
12. Этот шаг копирует скрипт XML для аналитики в буфер обмена Windows. Скрипт XML для аналитики вы можете оставить в буфере обмена, сохранить в файл или вставить его в «Блокнот» или другой текстовый редактор.  
  
###  <a name="bkmk_Scheduling"></a> Создание и планирование задания пакетной обработки  
  
1.  Подключитесь к экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], после чего откройте обозреватель объектов.  
  
2.  Разверните узел **Агент SQL Server**. Если служба не запущена, запустите ее.  
  
3.  Щелкните правой кнопкой мыши **Задания** и выберите пункт **Создать задание**.  
  
4.  В диалоговом окне **Создание задания** введите имя задания в поле **Имя**.  
  
5.  В разделе **Шаги**нажмите **Создать**.  
  
6.  В диалоговом окне **Новый шаг задания** введите имя шага в поле **Имя шага**.  
  
7.  В поле **Тип**выберите **Команда служб SQL Server Analysis Services**.  
  
8.  В разделе **Выполнять как**выберите пункт **Учетная запись службы агента SQL Server**. Как было указано в разделе «Предварительные требования», эта учетная запись должна иметь разрешения администратора для служб Analysis Services.  
  
9. В поле **Сервер**укажите имя сервера экземпляра служб Analysis Services.  
  
10. В поле **Команда**щелкните правой кнопкой мыши и выберите **Вставить**.  
  
11. Нажмите кнопку **ОК**.  
  
12. На странице **Расписания** нажмите кнопку **Создать**.  
  
13. В диалоговом окне **Создание расписания задания** введите имя расписания в поле **Имя**, а затем нажмите кнопку **ОК**.  
  
     Этот шаг создает расписание на воскресенье в 00:00. Следующий шаг показывает, как вручную выполнить задание. Вы можете также выбрать расписание, которое выполнит задание во время его мониторинга.  
  
14. Чтобы закрыть диалоговое окно, нажмите кнопку **ОК** .  
  
15. В **обозревателе объектов**разверните узел **Задания**, щелкните правой кнопкой мыши созданное задание и выберите команду **Запустить задание на шаге**.  
  
     Поскольку задание состоит только из одного шага, оно будет выполнено немедленно. Если в задании содержится более одного шага, вы можете выбрать шаг, с которого будет запущено задание.  
  
16. По завершении задания нажмите кнопку **Закрыть**.  
  
## <a name="see-also"></a>См. также  
 [Параметры обработки и параметры &#40; Службы Analysis Services &#41;](../../analysis-services/multidimensional-models/processing-options-and-settings-analysis-services.md)   
  
  
