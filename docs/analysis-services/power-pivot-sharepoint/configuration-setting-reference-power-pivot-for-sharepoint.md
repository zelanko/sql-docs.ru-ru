---
title: Справочник (PowerPivot для SharePoint) по параметрам конфигурации | Документы Microsoft
ms.date: 05/02/2018
ms.prod: sql
ms.technology: analysis-services
ms.component: ppvt-sharepoint
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
ms.openlocfilehash: d58ca9b3c3769a34164157f7297269f100ea8c1d
ms.sourcegitcommit: 38f8824abb6760a9dc6953f10a6c91f97fa48432
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2018
---
# <a name="configuration-setting-reference-power-pivot-for-sharepoint"></a>Справочник по параметрам конфигурации (Power Pivot для SharePoint)
[!INCLUDE[ssas-appliesto-sqlas](../../includes/ssas-appliesto-sqlas.md)]
  Эта статья содержит сведения о параметрах настройки, используемых приложениями служб [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] на ферме SharePoint. В этом разделе можно найти подробные сведения об использовании скриптов PowerShell для настройки сервера, а также обо всех параметрах.  
  
 Параметры конфигурации задаются для каждого приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . На ферме можно создать несколько приложений служб, чтобы настроить независимые логические экземпляры одного и того же физического экземпляра службы. Параметры конфигурации хранятся в базе данных приложения [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , отдельно созданной для каждого настроенного приложения службы.  
  
 При изменении параметров конфигурации изменения применяются сразу и используются для последующих запросов и соединений. При выполнении операций используются параметры, которые были определены на момент начала операции.  
  
 По нижеприведенным ссылкам можно ознакомиться с различными областями конфигурации:  
  
 [Время ожидания для загрузки данных](#LoadingData)  
  
 [Пулы соединений](#ConnectionPool)  
  
 [Балансировка нагрузки](#AllocationScheme)  
  
 [Обновление данных](#DataRefresh)  
  
 [Сбор данных об использовании](#UsageData)  
  
 Инструкции по созданию приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] см. в разделе [Создание и настройка приложения службы PowerPivot в центре администрирования](../../analysis-services/power-pivot-sharepoint/create-and-configure-power-pivot-service-application-in-ca.md).  
  
##  <a name="LoadingData"></a> Время ожидания для загрузки данных  
 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] извлекаются и загружаются экземплярами службы Analysis Services на ферме. В зависимости от того, когда и каким образом к данным осуществлялся доступ в последний раз, они будут загружены либо из библиотеки содержимого, либо из локального файлового кэша. Данные загружаются в память каждый раз при получении запроса. Для повышения общего уровня доступности сервера можно задать время ожидания, которое укажет серверу остановить запрос на загрузку данных, если он не может быть завершен в течение заданного периода времени.  
  
|Название|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Время ожидания для загрузки данных|1800 (в секундах)|От 1 до 3600|Определяет время, в течение которого приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] будет ждать отклика от определенного экземпляра сервера служб Analysis Services.<br /><br /> По умолчанию приложение службы ожидает получения полезных данных от экземпляра службы Engine, которому был направлен специальный запрос, в течение 30 минут.<br /><br /> Если источник данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] не будет загружен в течение этого времени, поток будет остановлен и запустится новый поток.|  
  
##  <a name="ConnectionPool"></a> Пулы соединений  
 Приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] создает пулы соединений и управляет ими, обеспечивая повторное использование соединений. Существует два типа пулов соединений: для подключения к данным только для чтения и для соединений с сервером.  
  
 Пулы подключения к данным содержат кэшируемые подключения к источнику данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Каждый пул соединений создается на основе контекста, заданного при загрузке базы данных. Этот контекст включает идентификатор физического экземпляра службы, идентификатор базы данных и идентификатор пользователя SharePoint, который запрашивает данные. Для каждого сочетания создается отдельный пул соединений. Например, запросы разных пользователей к одной и той же базе данных, находящейся на одном сервере, будут находиться в разных пулах соединений.  
  
 Назначением пула соединений является кэширование соединений для запросов к данным только для чтения к одной базе данных служб Analysis Services одним пользователем SharePoint. Экземпляр службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] — это сервер, в память которого загружены данные. Идентификатор базы данных — это внутренний идентификатор для структур данных модели в памяти (для модели создается экземпляр в виде базы данных куба служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ). Сведения о версии неявным образом включаются в идентификатор.  
  
 Пулы соединений с сервером содержат кэшируемые соединения между экземпляром приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] и экземпляром сервера служб Analysis Services. В рамках этого соединения приложение службы входит на сервер служб Analysis Services с разрешениями системного администратора [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] . Эти соединения служат для отправки запросов на загрузку базы данных и мониторинга исправности системы.  
  
 Каждый из типов пулов соединений имеет настраиваемые верхние предельные значения, позволяющие обеспечить оптимальное использование системной памяти для управления соединениями.  
  
|Название|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Время ожидания пула соединений|1800 (в секундах)|От 1 до 3600.|Этот параметр применяется к пулам подключений к данным.<br /><br /> Он определяет время, в течение которого неактивное соединение может оставаться в пуле соединений, прежде чем оно будет удалено.<br /><br /> По умолчанию приложение службы удаляет соединение после пяти минут отсутствия активности.|  
|Максимальный размер пула пользовательских соединений|1000|От -1, 0 или 1 до 10000.<br /><br /> -1 означает неограниченное количество неактивных соединений.<br /><br /> 0 означает, что неактивные соединения не сохраняются. Соединения с источником данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] каждый раз создаются заново.|Этот параметр применяется к числу неактивных соединений во всех пулах подключений к данным, созданных для экземпляра приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .<br /><br /> Отдельные пулы соединений создаются для всех уникальных сочетаний пользователя SharePoint, данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] и экземпляра службы. Если у вас есть много пользователей, которые обращаются к нескольким источникам данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , то увеличение размера пула соединений может положительно повлиять на производительность сервера.<br /><br /> Если создано более 100 неактивных соединений с экземпляром службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , новые неактивные соединения отключаются, а не возвращаются в пул.|  
|Максимальный размер пула административных соединений|200|От -1, 0 или 1 до 10000.<br /><br /> -1 означает неограниченное количество неактивных соединений.|Максимальное число неактивных соединений сервера во всех пулах административных соединений для соединений приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] с экземпляром сервера служб Analysis Services. Соединения сервера используются для запросов на загрузку баз данных и сохранения изменений в базе данных SharePoint.|  
  
##  <a name="AllocationScheme"></a> Балансировка нагрузки  
 Одной из функций, реализуемых в службе [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , является выбор одного из доступных экземпляров службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для загрузки данных служб Analysis Services. Параметр **AllocationMethod** определяет условия, по которым выбирается экземпляр службы.  
  
|Название|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Способ распределения|RoundRobin|Циклический перебор<br /><br /> По исправности|Схема распределения запросов загрузки между двумя и более экземплярами сервера служб Analysis Services.<br /><br /> По умолчанию служба [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] равномерно распределяет запросы с учетом работоспособности серверов. Параметр «На основе исправности системы» определяет передачу запросов на сервер, который имеет наибольший объем доступных ресурсов (память и загрузка ЦП).<br /><br /> Циклический список предусматривает циклическое распределение запросов по доступным серверам в последовательном порядке, без учета текущей загруженности или работоспособности сервера.|  
  
##  <a name="DataRefresh"></a> Обновление данных  
 Укажите временной интервал, который считается типичным рабочим временем в вашей организации. Эти параметры конфигурации определяют, во сколько должно выполняться обновление данных после окончания рабочего дня. Она начнется по истечении этого интервала. Обработка после окончания рабочего дня — это хороший вариант расписания для владельцев документов, которые хотят вносить в источник данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] данные о транзакциях, созданных в течение рабочего дня.  
  
|Название|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Время начала|04:00|От 1 до 12 часов, где значение представляет собой допустимое целое число в данном диапазоне.<br /><br /> Тип Time.|Определяет нижнюю границу диапазона рабочего времени.|  
|Время завершения|20:00|От 1 до 12 часов, где значение представляет собой допустимое целое число в данном диапазоне.<br /><br /> Тип Time.|Определяет верхнюю границу диапазона рабочего времени.|  
|[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] Учетная запись автоматического обновления данных|Нет|Идентификатор целевого приложения|Эта учетная запись используется для выполнения заданий по обновлению данных от имени владельца расписания.<br /><br /> Учетную запись автоматического обновления данных необходимо определить до того, как она указывается на странице настройки приложения службы. Дополнительные сведения см. в статье [Настройка учетной записи автоматического обновления данных PowerPivot (PowerPivot для SharePoint)](http://msdn.microsoft.com/en-us/81401eac-c619-4fad-ad3e-599e7a6f8493).|  
|Разрешить пользователям вводить пользовательские учетные данные Windows|Включено|Boolean|Определяет, выводится ли на странице настройки планового обновления данных параметр, который позволяет владельцу расписания указать учетную запись пользователя и пароль Windows для выполнения задания по обновлению данных.<br /><br /> Для работы этого параметра должна быть включена служба Secure Store. Дополнительные сведения см. в статье [Настройка сохраненных учетных данных для обновления данных PowerPivot (PowerPivot для SharePoint)](http://msdn.microsoft.com/en-us/987eff0f-bcfe-4bbd-81e0-9aca993a2a75).|  
|Максимальный размер журнала обработки|365|От 1 до 5000 дней|Определяет, сколько времени журнал обновления данных хранится в базе данных приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Дополнительные сведения см. в статье [Power Pivot Usage Data Collection](../../analysis-services/power-pivot-sharepoint/power-pivot-usage-data-collection.md).|  
  
##  <a name="UsageData"></a> Сбор данных об использовании  
 Отчеты об использовании, выводимые на панели мониторинга управления [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , могут содержать важные сведения о том, как используются книги с поддержкой [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]. Следующие параметры конфигурации управляют некоторыми аспектами сбора данных о событиях сервера [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , которые позднее будут представлены в отчетах об использовании или активности.  
  
|Название|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Период составления отчетов о запросах|300 (в секундах)|От 1 до n секунд, где n — допустимое целое число.|Чтобы затрачивать на сбор данных об использовании слишком много ресурсов фермы, статистика запросов собирается по каждому соединению и отправляется в виде единого события. Параметр «Интервал отчетов о запросах» определяет частоту передачи события. По умолчанию отчет по статистике запросов отправляется раз в 5 минут.<br /><br /> Так как соединение закрывается сразу после отправки запроса, система формирует очень большое количество соединений даже для одного пользователя, который обращается к одному источнику данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Поэтому пулы соединений создаются для каждого сочетания пользователя с источником данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , чтобы после создания соединения пользователь мог с его помощью повторно получить доступ к тем же данным. Периодически с интервалами, которые определяются этим параметром конфигурации, приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] сообщает информацию об использовании для каждого соединения в пуле соединений.<br /><br /> Увеличение этого значения приведет к сокращению числа событий, регистрируемых в журнал. Однако, если оно будет слишком большим, существует риск потери данных о событиях в случае перезапуска сервера или закрытия соединения.<br /><br /> Уменьшение этого значения приведет к тому, что запись событий в журнал будет производиться с большей частотой и вырастет объем данных об использовании [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)], передаваемых системой сбора данных в базу данных SharePoint.<br /><br /> Как правило, этот параметр конфигурации не требует изменения, кроме тех случаев, когда необходимо разрешить какую-либо особую проблему (например, если база данных использования слишком быстро растет и причина этого — данные об использовании [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] ).|  
|Журнал данных об использовании|365 (дни)|0 или от 1 до n дней, где n — допустимое целое число.<br /><br /> 0 означает, что история сохраняется всегда и никогда не удаляется.|По умолчанию данные об использовании хранятся в базе данных приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] в течение одного года. По истечении одного года записи удаляются из базы данных.<br /><br /> Проверка статистических данных с истекшим сроком происходит ежедневно при запуске задания по обработке данных об использовании Microsoft SharePoint Foundation. Задание таймера считывает этот параметр и активирует команду удаления журнала с истекшим сроком хранения из базы данных приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .|  
|Верхняя граница тривиального ответа|500 (в миллисекундах)|От 1 до n миллисекунд, где n представляет собой допустимое целое число.|По умолчанию пороговое значение для обычных запросов составляет полсекунды.<br /><br /> Обычные запросы включают команды ping для сервера, запросы метаданных и установление сеансов.|  
|Верхняя граница быстрого ответа|1000 (в миллисекундах)|От 1 до n миллисекунд, где n представляет собой допустимое целое число.|По умолчанию пороговое значение для быстрых запросов составляет одну секунду.<br /><br /> Быстрые запросы оперируют чрезвычайно малыми объемами наборами данных либо запрашивают метаданные, которые распространяются на большие наборы элементов.|  
|Верхняя граница ожидаемого времени ответа|3000 (в миллисекундах)|От 1 до n миллисекунд, где n представляет собой допустимое целое число.|По умолчанию пороговое значение для ожидаемых запросов составляет 3 секунды.<br /><br /> Это значение определяет верхнюю границу времени ожидаемого запроса.|  
|Верхний предел для долгих ответов|10000 (в миллисекундах)|От 1 до n миллисекунд, где n представляет собой допустимое целое число.|По умолчанию пороговое значение для длинных запросов составляет десять секунд.<br /><br /> Такие запросы выполняются дольше ожидаемых, но все же попадают в приемлемый диапазон.|  
  
## <a name="see-also"></a>См. также  
 [Создание и настройка приложения службы PowerPivot в центре администрирования](../../analysis-services/power-pivot-sharepoint/create-and-configure-power-pivot-service-application-in-ca.md)   
 [Обновление данных Power Pivot в SharePoint 2010](http://msdn.microsoft.com/en-us/01b54e6f-66e5-485c-acaa-3f9aa53119c9)   
 [Настройка сбора данных об использовании с PowerPivot для SharePoint](../../analysis-services/power-pivot-sharepoint/configure-usage-data-collection-for-power-pivot-for-sharepoint.md)   
 [Настройка учетных записей служб Power Pivot](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-service-accounts.md)   
 [Информационная панель управления PowerPivot и данные об использовании](../../analysis-services/power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md)  
  
  
