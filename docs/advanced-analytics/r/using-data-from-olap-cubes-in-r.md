---
title: Использование данных из кубов OLAP в R - служб машинного обучения SQL Server
ms.prod: sql
ms.technology: machine-learning
ms.date: 04/15/2018
ms.topic: conceptual
author: dphansen
ms.author: davidph
manager: cgronlun
ms.openlocfilehash: e55093c83e9a306a06235d6bb613dac78d4677ce
ms.sourcegitcommit: 2827d19393c8060eafac18db3155a9bd230df423
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2019
ms.locfileid: "58512971"
---
# <a name="using-data-from-olap-cubes-in-r"></a>Использование данных из кубов OLAP в R
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

**OlapR** пакета — это пакет R, предоставляемых корпорацией Майкрософт для использования с Machine Learning Server и SQL Server, который позволяет выполнять запросы многомерных Выражений для получения данных из кубов OLAP. При использовании этого пакета не нужно создавать связанные серверы или очищать плоские наборы строк; данные OLAP можно получить непосредственно из кода R.

В этой статье описывает API, а также обзор для пользователей R, которые могут быть новыми для базы данных многомерных кубов OLAP и многомерных Выражений.

> [!IMPORTANT]
> Экземпляр служб Analysis Services может поддерживать обычной многомерных кубов или табличных моделей, но экземпляр не поддерживает обоих типов моделей. Таким образом прежде чем пытаться построить запрос многомерных Выражений к кубу, убедитесь, что экземпляр служб Analysis Services содержит многомерных моделей.

## <a name="what-is-an-olap-cube"></a>Что такое куба OLAP?

Оперативная аналитическая Обработка осуществляется сокращение оперативной аналитической обработки. Решения OLAP часто используются для сбора и хранения важных бизнес-данных со временем. Многие инструменты, панели мониторинга и визуализации используют данные OLAP для бизнес-аналитики. Дополнительные сведения см. в разделе [оперативной аналитической обработки](https://en.wikipedia.org/wiki/Online_analytical_processing).

Корпорация Майкрософт предоставляет [служб Analysis Services](https://docs.microsoft.com/sql/analysis-services/analysis-services), которая позволяет проектировать, развертывать и запроса данных OLAP в виде _кубы_ или _табличных моделей_. Куб представляет собой многомерную базу данных. _Измерения_ подобны аспекты данных, или факторов, влияющих на R: использования измерений для определения некоторых определенное подмножество данных, который вы хотите составления сводки или анализа. Например время — важные измерения, так много, таким образом, многие решения OLAP включал несколько календарей, которые определены по умолчанию, используемый при срезов и обобщения данных. 

Для повышения производительности базы данных OLAP часто вычисляют сводные значения (или _агрегаты_) заранее и сохраняет их для ускорения извлечения. Сводные данные основаны на *меры*, которые представляют формулы, которые могут применяться для числовых данных. Использовать для определения подмножества данных измерения и меры для вычисления к этим данным. Например мера используется для вычисления полного объема продаж строку продукта в течение нескольких кварталов минус налоги, чтобы сообщить Средняя стоимость для определенного поставщика, накопительное платные заработной плате для года и т. д.

Многомерные Выражения, сокращение многомерные выражения — это язык, используемый для выполнения запросов к кубам. Запрос многомерных Выражений обычно содержит определение данных, который включает в себя одно или несколько измерений и по крайней мере одну меру, то, что запросы многомерных Выражений можно получить более сложным и последовательного windows, совокупное средние значения, суммы, ранги или процентили. 

Ниже приведены некоторые другие условия, которые могут оказаться полезными при запуске построения запросов многомерных Выражений.

+ *Создание срезов* используется подмножество куба, используя значения из одного измерения.

+ При*сегментировании* создается вложенный куб посредством указания диапазона значений для нескольких измерений.

+ *Детализация* позволяет перейти от сводки к подробностям.

+ *Подъем* позволяет перейти от подробностей к более высокому уровню статистической обработки.

+ *Свертка* дает сводные данные по данным в измерении.

+ *Сводка* поворачивает куб или выбранные данные.

## <a name="how-to-use-olapr-to-create-mdx-queries"></a>Как использовать olapR для создания запросов многомерных Выражений

В следующей статье приведены подробные примеры синтаксиса для создания и выполнения запросов к кубу:

+ [Создание запросов многомерных Выражений, с помощью языка R](../../advanced-analytics/r/how-to-create-mdx-queries-using-olapr.md)

## <a name="olapr-api"></a>olapR API

Пакет **OlapR** поддерживает два метода создания запросов многомерных выражений:

- **Используйте Конструктор многомерных Выражений.** Использование функций R в пакете для создания простой запрос многомерных Выражений, путем выбора куба и затем настройки оси и срезы. Это простой способ создать допустимый запрос многомерных Выражений, если вы не имеют доступа к традиционным средствам OLAP или нехватке опыта языка многомерных Выражений.

    Не все запросы многомерных Выражений могут создаваться с помощью этого метода, так как многомерные Выражения могут быть сложными. Тем не менее этот API поддерживает большинство наиболее распространенные и полезные операции, включая срез, dice, Углубленная детализация, rollup и pivot в N измерениях.

+ **Скопировать и вставить правильный формат MDX.** Создание вручную, а затем вставьте в любом запросе многомерных Выражений. Этот параметр рекомендуется использовать, если у вас есть существующие запросы многомерных Выражений, которые вы хотите повторно использовать или если требуется построить запрос слишком сложен для **olapR** для обработки.

    После построения многомерное Выражение с помощью любой клиентской программы, такой как SSMS или Excel, сохраните строку запроса. Передайте эту строку многомерных Выражений в качестве аргумента для *обработчика запросов SSAS* в **olapR** пакета. Поставщик отправляет запрос к указанному серверу служб Analysis Services и передает результаты в R. 

Примеры для создания многомерных Выражений запросов или запустить существующий запрос многомерных Выражений, см. в разделе [способы создания запросов многомерных Выражений, с помощью R](../../advanced-analytics/r/how-to-create-mdx-queries-using-olapr.md).

## <a name="known-issues"></a>Известные проблемы

В этом разделе перечислены некоторые известные проблемы и часто задаваемые вопросы о **olapR** пакета.

### <a name="tabular-model-support"></a>Поддержка табличной модели

Если вы подключитесь к экземпляру служб Analysis Services, который содержит табличной модели, `explore` функция сообщает об успешном выполнении с возвращением значения TRUE. Тем не менее объекты табличной модели различаются многомерных объектов и структуру многомерной базы данных отличается от используемой в табличной модели.

Несмотря на то, что DAX (выражения анализа данных) — это язык, обычно используемых с табличными моделями, можно создать допустимые запросы многомерных Выражений для табличной модели, если вы уже знакомы с помощью многомерных Выражений. Для построения допустимые запросы многомерных Выражений для табличной модели нельзя использовать конструкторы olapR.

Тем не менее запросы многомерных Выражений являются неэффективный способ получить данные из табличной модели. Если вам нужно получить данные из табличной модели для использования в R, рассмотрите следующие методы:

+ Включение режима DirectQuery на модели и добавьте сервер в качестве связанного сервера в SQL Server. 
+ Если табличная модель построена на реляционном киоске данных, получите данные непосредственно из источника.

### <a name="how-to-determine-whether-an-instance-contains-tabular-or-multidimensional-models"></a>Как определить, содержит ли экземпляр табличные или многомерные модели

Один экземпляр служб Analysis Services может содержать только один тип модели, хотя он может содержать несколько моделей. Причина: существуют фундаментальные различия между табличными моделями и многомерных моделей, управляющие данные могут храниться и обрабатываться. Например табличные модели хранятся в памяти и использовать индексы columnstore для выполнения вычислений очень быстро. В многомерных моделях данных хранится на диске и статистические выражения определяются заранее и получать с помощью запросов многомерных Выражений.

При подключении к службам Analysis Services с помощью клиента, например SQL Server Management Studio, вы можно сразу сказать, какой тип модели поддерживается, просмотрев значок для базы данных.

Вы также можете просматривать и запрашивать свойства сервера, чтобы определить, какой тип модели, поддерживает экземпляр. **Режим сервера** свойство поддерживает два значения: _многомерные_ или _табличных_.

См. в следующей статье Общие сведения об этих двух типах моделей:

+ [Сравнение многомерных и табличных моделей](https://docs.microsoft.com/sql/analysis-services/comparing-tabular-and-multidimensional-solutions-ssas)

См. в следующей статье, сведения о запросе свойства сервера:

+ [Наборы строк схемы OLE DB для OLAP](https://docs.microsoft.com/bi-reference/schema-rowsets/ole-db-olap/ole-db-for-olap-schema-rowsets)

### <a name="writeback-is-not-supported"></a>Обратная запись не поддерживается

Не поддерживается для обратной записи результаты пользовательских вычислений R в куб.

Как правило даже в том случае, если куб включена для обратной записи, поддерживаются только ограниченные операции и может потребоваться дополнительная настройка. Мы рекомендуем использовать многомерных Выражений для таких операций.

+ [Измерения, доступные для записи](https://docs.microsoft.com/sql/analysis-services/multidimensional-models-olap-logical-dimension-objects/write-enabled-dimensions)
+ [Секции, доступные для записи](https://docs.microsoft.com/sql/analysis-services/multidimensional-models-olap-logical-cube-objects/partitions-write-enabled-partitions)
+ [Значение настраиваемого доступа к данным ячейки](https://docs.microsoft.com/sql/analysis-services/multidimensional-models/grant-custom-access-to-cell-data-analysis-services)

### <a name="long-running-mdx-queries-block-cube-processing"></a>Длительные запросы многомерных Выражений Блокировать обработку куба

Несмотря на то что **olapR** пакет выполняет только операции чтения, длительные запросы многомерных Выражений можно создавать блокировок, предотвратить обработку куба. Всегда заранее тестируйте запросы многомерных Выражений, чтобы знать, какой объем данных должны возвращаться.

При попытке подключиться к кубу, заблокирован, может возникнуть ошибка, в хранилище данных SQL Server не удается связаться. Рекомендуемые решения включают активацию удаленных соединений, проверка сервера или имя экземпляра и т. д.; Тем не менее Учитывайте возможность выполнения предыдущего открытое соединение.

Администратор службы SSAS может предотвратить проблемы блокировки, определяя и завершение открытых сеансов. Свойство времени ожидания могут также применяться к запросам многомерных Выражений на уровне сервера, чтобы выполнить завершение всех долго выполняющихся запросов.

## <a name="resources"></a>Ресурсы

Если вы не знакомы с OLAP или запросы многомерных Выражений, см. в статьях Wikipedia: 

+ [Кубы OLAP](https://en.wikipedia.org/wiki/OLAP_cube)
+ [Запросы многомерных Выражений](https://en.wikipedia.org/wiki/MultiDimensional_eXpressions)
