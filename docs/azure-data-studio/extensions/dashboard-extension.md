---
title: Создание расширения панели мониторинга
description: В этом учебнике показано, как создать расширение панели мониторинга, чтобы добавить пользовательские функции для Azure Data Studio.
ms.prod: azure-data-studio
ms.technology: azure-data-studio
ms.topic: conceptual
author: yualan
ms.author: alayu
ms.reviewer: alayu, maghan
ms.custom: ''
ms.date: 08/28/2020
ms.openlocfilehash: c7402c8dd0d2d85d38536a0bcfea3ce8cd780657
ms.sourcegitcommit: 7f76975c29d948a9a3b51abce564b9c73d05dcf0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2020
ms.locfileid: "96900877"
---
# <a name="create-an-azure-data-studio-dashboard-extension"></a>Создание расширения панели мониторинга в Azure Data Studio

В этом учебнике показано, как создать расширение панели мониторинга в Azure Data Studio. Это расширение связано с панелью мониторинга подключений Azure Data Studio, поэтому вы можете расширить функциональные возможности Azure Data Studio так, чтобы это было заметно пользователям.

В этой статье раскрываются следующие темы:

> [!div class="checklist"]
> - Установка генератора расширений.
> - Создайте расширение.
> - Создайте вклад в панель мониторинга в расширении.
> - Проверьте работу расширения.
> - Упакуйте расширение.
> - Опубликуйте расширение в Marketplace.

## <a name="prerequisites"></a>Предварительные требования

Средство Azure Data Studio основано на той же платформе, что и Visual Studio Code, поэтому расширения для Azure Data Studio создаются с помощью Visual Studio Code. Чтобы приступить к работе, вам потребуются следующие компоненты.

- Установленный [Node.js](https://nodejs.org), доступный в вашей переменной `$PATH`. Node.js включает в себя [npm](https://www.npmjs.com/), диспетчер пакетов Node.js, который будет использоваться для установки генератора расширений.
- [Visual Studio Code](https://code.visualstudio.com) для отладки расширения.
- [Расширение отладки](https://marketplace.visualstudio.com/items?itemName=ms-mssql.sqlops-debug) Azure Data Studio (необязательно). Оно позволяет протестировать расширение без необходимости упаковывать и устанавливать его в Azure Data Studio.
- Убедитесь, что `azuredatastudio` указан в вашем пути. Для Windows выберите параметр **Добавить в PATH** в setup.exe. Для Mac или Linux выберите параметр **Установить путь к команде azuredatastudio в PATH**.

## <a name="install-the-extension-generator"></a>Установка генератора расширений

Чтобы упростить процесс создания расширений, мы создали [генератор расширений](https://code.visualstudio.com/docs/extensions/yocode) с помощью Yeoman. Для его установки выполните следующую команду в командной строке:

```console
npm install -g yo generator-azuredatastudio
```

## <a name="create-your-dashboard-extension"></a>Создание расширения панели мониторинга

### <a name="introduction-to-the-dashboard"></a>Общие сведения о панели мониторинга

Панель мониторинга подключений Azure Data Studio — это эффективный инструмент, который предоставляет общие и аналитические сведения о подключениях пользователя.

Существуют два варианта этой панели мониторинга: *панель мониторинга сервера*, которая предоставляет общие сведения обо всем сервере, и *панель мониторинга базы данных*, которая предоставляет общие сведения об отдельной базе данных. Доступ к любому из них можно получить, щелкнув правой кнопкой мыши сервер или базу данных в разделе **Подключения** в Azure Data Studio и выбрав **Управление**.

:::image type="content" source="media/dashboard-extension/dashboard-summary.gif" alt-text="Снимок экрана, на котором приведены общие сведения о панелях мониторинга.":::

Существуют три ключевые точки вклада для расширений, чтобы добавить функциональные возможности на панель мониторинга.

1. **Вкладка панели мониторинга**: Отдельная вкладка на панели мониторинга для вашего расширения. Можно добавить на панель мониторинга сервера или базы данных. Настраивается с помощью мини-приложений, панели инструментов и раздела навигации.
2. **Действия на домашней странице**. Кнопки действий в верхней части панели инструментов подключения.
3. **Мини-приложения**. Графы, которые выполняются для SQL Server.

   :::image type="content" source="media/dashboard-extension/dashboard-contrib-points.png" alt-text="Снимок экрана с точками вклада.":::

### <a name="run-the-extension-generator"></a>Запуск генератора расширений

Для создания расширения сделайте следующее.

1. Запустите генератор расширений с помощью следующей команды:

   `yo azuredatastudio`

1. Выберите **Новая панель мониторинга** в списке типов расширений.

1. Введите данные в окна запросов, как показано далее, чтобы создать расширение, добавляющее вкладку на панель мониторинга сервера.

   :::image type="content" source="media/dashboard-extension/dashboard-generator.png" alt-text="Снимок экрана, на котором показан генератор расширений.":::

   Доступно множество запросов, поэтому ниже приведены некоторые сведения о том, что означает каждый из них:

   :::image type="content" source="media/dashboard-extension/dashboard-flowchart.png" alt-text="Снимок экрана, на котором показана блок-схема панели мониторинга.":::

При выполнении предыдущих шагов создается папка. Откройте ее в Visual Studio Code, чтобы создать собственное расширение панели мониторинга.

### <a name="run-the-extension"></a>Запуск расширения

Давайте посмотрим, что делает шаблон панели мониторинга, запустив расширение. Перед запуском убедитесь, что в Visual Studio Code установлено **расширение отладки Azure Data Studio**.

Нажмите клавишу **F5** в Visual Studio Code, чтобы запустить Azure Data Studio в режиме отладки с запущенным расширением. Затем посмотрите, как этот шаблон по умолчанию вносит вклад на панели мониторинга.

Далее мы рассмотрим, как изменить эту панель мониторинга по умолчанию.

### <a name="develop-the-dashboard"></a>Разработка панели мониторинга

Разработку расширения нужно начать с самого важного файла — `package.json`. Это файл манифеста, в котором зарегистрированы вклады панелей мониторинга. Обратите внимание на разделы `dashboard.tabs`, `dashboard.insights` и `dashboard.containers`.

Можно попробовать внести следующие изменения:

- Поэкспериментируйте с типами аналитических сведений, включая bar, horizontalBar, timeSeries.
- Напишите собственные запросы, которые будут выполняться через подключение к SQL Server.
- Ознакомьтесь [с этим](../tutorial-qds-sql-server.md) или [этим](../tutorial-table-space-sql-server.md) примером аналитических сведений.

## <a name="package-your-extension"></a>Упаковка расширения

Чтобы предоставить общий доступ другим пользователям, нужно упаковать расширение в один файл. Его можно опубликовать в магазине Marketplace расширений Azure Data Studio или предоставить для общего доступа другим участникам команды или сообщества. Для этого нужно установить другой пакет npm из командной строки.

```console
npm install -g vsce
```

Внесите в файл `README.md` желаемые изменения. Затем перейдите к базовому каталогу расширения и выполните команду `vsce package`. При необходимости можно связать репозиторий с расширением или продолжить работу без него. Чтобы добавить его, добавьте аналогичную строку в файл `package.json`.

```json
"repository": {
    "type": "git",
    "url": "https://github.com/anjalia/my-test-extension.git"
}
```

После добавления этих строк создается файл `my-test-extension-0.0.1.vsix`, готовый для установки в Azure Data Studio.

:::image type="content" source="media/dashboard-extension/install-vsix.png" alt-text="Снимок экрана, на котором показана установка VSIX.":::

## <a name="publish-your-extension-to-the-marketplace"></a>Публикация расширения в Marketplace

Магазин Marketplace расширений Azure Data Studio пока находится в стадии разработки. Текущий процесс предполагает размещение VSIX-файла расширения в любом расположении, например на странице выпуска GitHub. Затем следует отправить запрос на вытягивание, который обновляет [этот JSON-файл](https://github.com/Microsoft/azuredatastudio/blob/release/extensions/extensionsGallery.json), добавляя в него сведения о расширении.

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы узнали, как выполнять следующие задачи:
> [!div class="checklist"]
> - Установка генератора расширений.
> - Создайте расширение.
> - Создайте вклад в панель мониторинга в расширении.
> - Проверьте работу расширения.
> - Упакуйте расширение.
> - Опубликуйте расширение в Marketplace.

Мы надеемся, что после ознакомления с этой статьей вы захотите создать собственное расширение для Azure Data Studio. Мы обеспечиваем поддержку Dashboard Insights (симпатичное графическое решение, предназначенное для SQL Server), нескольких SQL-ориентированных API, а также обширного набора точек расширений, унаследованных от Visual Studio Code.

Если у вас появилась идея, но вы не знаете, с чего начать, откройте вопрос или отправьте твит нашей команде: [azuredatastudio](https://twitter.com/azuredatastudio).

Для получения дополнительных сведений можно обратиться к [руководству по расширениям Visual Studio Code](https://code.visualstudio.com/docs/extensions/overview), которое охватывает все существующие API и шаблоны.

Чтобы узнать, как работать с T-SQL в Azure Data Studio, изучите руководство по редактору T-SQL:

> [!div class="nextstepaction"]
> [Создание объектов базы данных с помощью редактора Transact-SQL](../tutorial-sql-editor.md)
