---
title: Соединение таблиц вручную (визуальные инструменты для баз данных) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: sql-tools
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- manual joins [SQL Server]
- joins [SQL Server], manual
- joins [SQL Server], creating
ms.assetid: 9c785356-646b-4c87-82d4-25efd6051d9d
author: markingmyname
ms.author: maghan
manager: craigg
ms.openlocfilehash: 85ec2d718c6b80b418f417c5199c9e8ba6439050
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "65096637"
---
# <a name="join-tables-manually-visual-database-tools"></a>Соединение таблицы вручную (визуальные инструменты для баз данных)
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]
При добавлении двух (и более) таблиц к запросу [Конструктор запросов и представлений](../../ssms/visual-db-tools/query-and-view-designer-tools-visual-database-tools.md) пытается соединить таблицы, основываясь на общих данных или на сведениях о связи между этими таблицами, хранящихся в базе данных. Дополнительные сведения см. в статье [Автоматическое соединение таблиц (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/join-tables-automatically-visual-database-tools.md). Однако если конструктор запросов и представлений не соединил таблицы автоматически или если нужно создать дополнительные условия соединения таблиц, можно соединить таблицы вручную.  
  
Соединения можно создавать на основании сравнения двух любых столбцов, а не только столбцов, содержащих одинаковые данные. Например, если база данных содержит две таблицы, `titles` и `roysched`, можно сравнить значения в столбце `ytd_sales` таблицы `titles` со значениями в столбцах `lorange` и `hirange` в таблице `roysched` . Создание этого соединения позволит найти заголовки, для которых сведения о продажах за текущий год находятся в пределах между низким и высоким диапазоном лицензионных платежей.  
  
> [!TIP]  
> Соединения работают быстрее, если столбцы, входящие в условие соединения, были проиндексированы. В некоторых случаях соединение неиндексированных столбцов может привести к медленной работе запроса.  
  
### <a name="to-manually-join-tables-or-table-structured-objects"></a>Соединение таблиц или табличных объектов вручную  
  
1.  Добавьте на [панель диаграммы](../../ssms/visual-db-tools/diagram-pane-visual-database-tools.md) объекты, которые нужно соединить.  
  
2.  Захватите имя соединяемого столбца первой таблицы или табличного объекта и перетащите его к соответствующему столбцу второй таблицы или табличного объекта. Соединение нельзя основывать на столбцах типа **text**, **ntext**или**image** .  
  
    > [!NOTE]  
    > Столбцы соединения должны иметь одинаковые (или совместимые) типы данных. Например, если столбец соединения в первой таблице содержит дату, его нужно связать со столбцом второй таблицы, также содержащем дату. С другой стороны, если первый столбец соединения содержит целые числа, связываемый с ним столбец также должен относиться к целочисленному типу данных, однако размер у него может быть другим. Конструктор запросов и представлений не будет проверять типы данных соединяемых столбцов, но при выполнении запроса база данных отобразит ошибку, если типы данных несовместимы.  
  
3.  Если необходимо, измените оператор соединения; по умолчанию оператором является знак равенства (=). Дополнительные сведения см. в разделе [Изменение операторов соединения (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/modify-join-operators-visual-database-tools.md).  
  
Конструктор запросов и представлений добавляет предложение INNER JOIN к инструкции SQL на [панели SQL](../../ssms/visual-db-tools/sql-pane-visual-database-tools.md). Тип внешнего соединения можно изменить. Дополнительные сведения см. в разделе [Создание внешних соединений (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/create-outer-joins-visual-database-tools.md).  
  
## <a name="see-also"></a>См. также:  
[Запросы с соединениями (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/query-with-joins-visual-database-tools.md)  
  
