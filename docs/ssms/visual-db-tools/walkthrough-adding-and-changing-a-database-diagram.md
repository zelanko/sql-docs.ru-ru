---
title: Пошаговое руководство. Добавление и изменение диаграммы базы данных | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: sql-tools
ms.component: ssms-visual-db
ms.reviewer: ''
ms.suite: sql
ms.technology: ssms
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- database diagrams [SQL Server], about database diagrams
- database diagrams [SQL Server], designing
- database diagrams [SQL Server], creating
ms.assetid: 228caa0d-8f24-46ab-86d1-b6d8631322bc
caps.latest.revision: 5
author: stevestein
ms.author: sstein
manager: craigg
ms.openlocfilehash: a81fc1d6a60bc4bbb1d9ef2f67c3f5c32f60dc7c
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
ms.locfileid: "33054971"
---
# <a name="walkthrough-adding-and-changing-a-database-diagram"></a>Пошаговое руководство. Добавление и изменение диаграммы базы данных
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]
Это пошаговое руководство показывает, как создавать и изменять диаграмму базы данных и производить изменения в базе данных с помощью компонента диаграмм базы данных. Рассматривается добавление таблиц в диаграммы, создание связей между таблицами, создание ограничений и индексов столбцов и изменение уровня сведений, видимых для каждой таблицы.  
  
## <a name="prerequisites"></a>предварительные требования  
Для выполнения задач этого руководства необходимы:  
  
-   Доступ к [!INCLUDE[ssNoVersion](../../includes/ssnoversion_md.md)] с образцом базы данных [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject_md.md)]  
  
-   Учетная запись с правами владельца базы данных **dbo**  
  
> [!NOTE]  
> При попытке сделать изменения с использованием учетной записи, разрешения которой недостаточны для внесения изменений в таблицы, появляется сообщение об ошибке.  
  
## <a name="creating-a-diagram"></a>Создание диаграммы  
  
#### <a name="to-create-a-new-database-diagram"></a>Для создания новой диаграммы базы данных  
  
1.  В меню **Вид** выберите **Обозреватель объектов**.  
  
2.  Откройте узел «Базы данных», а затем узел [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject_md.md)] .  
  
3.  Щелкните правой кнопкой узел "Диаграммы баз данных" и выберите **Создать диаграмму базы данных**.  
  
    Если в базе данных отсутствуют объекты, необходимые для создания диаграмм, появляется следующее сообщение: **Для этой базы данных отсутствует один или несколько объектов поддержки, необходимых для использования функции построения диаграмм баз данных. Создать их?** Выберите **Да**.  
  
    Отображается диалоговое окно **Добавление таблицы** .  
  
4.  Выберите таблицы **AddressType (Person)** и **Address (Person)** и нажмите кнопку **Добавить**.  
  
    В диаграмму будут добавлены две таблицы.  
  
5.  Закройте диалоговое окно **Добавление таблицы** .  
  
#### <a name="to-view-different-column-data"></a>Просмотр данных другого столбца  
  
1.  Щелкните правой кнопкой мыши таблицу `Address` . В контекстном меню выберите **Вид таблицы**и выберите **Стандартный**.  
  
    Сетка таблицы отображает три столбца: **Имя столбца**, **Тип данных**и **Разрешить значения NULL**.  
  
2.  Щелкните правой кнопкой мыши таблицу `Address` , выберите **Вид таблицы** и **Ключи**.  
  
    Сетка таблицы отображает один столбец, содержащий имена столбцов таблицы. Появятся только столбцы, которые участвуют в индексах.  
  
## <a name="creating-new-tables"></a>Создание новых таблиц  
  
#### <a name="to-create-tables-within-diagram-designer"></a>Создание таблиц в конструкторе диаграмм  
  
1.  Щелкните правой кнопкой мыши конструктор диаграмм вне существующих таблиц и выберите **Создать таблицу**.  
  
2.  В диалоговом окне **Выбор имени** нажмите кнопку **ОК** , чтобы принять имя **Table1**, используемое по умолчанию.  
  
    Появится новая сетка таблицы с тремя столбцами: **Имя столбца**, **Тип данных**и **Разрешить значения NULL**.  
  
3.  Добавьте следующие данные в таблицу **Table1**:  
  
    |**Имя столбца**|**Тип данных**|**Разрешить значения NULL**|  
    |-------------------|-----------------|-------------------|  
    |**T1col1**|**int**|включен|  
    |**T1col2**|**varchar(50)**|включен|  
    |**T1col3**|**float**|включен|  
  
4.  Щелкните правой кнопкой мыши `T1col1` и выберите команду **Задать первичный ключ**.  
  
    Рядом с именем столбца появится значок ключа.  
  
5.  В меню **Файл** выберите пункт **Сохранить Diagram1**.  
  
6.  В диалоговом окне **Выбор имени** нажмите кнопку **ОК** , чтобы принять имя **Diagram1**, используемое по умолчанию.  
  
7.  Откроется диалоговое окно **Сохранить** с сообщением, что `Table1` будет сохранена в базу данных. Нажмите кнопку **Да**.  
  
## <a name="modifying-table-structure"></a>Изменение структуры таблицы  
В конструкторе диаграмм можно добавить проверочные ограничения и создать связи между таблицами.  
  
#### <a name="to-create-check-constraints"></a>Создание проверочных ограничений  
  
1.  В `Table1`щелкните правой кнопкой мыши строку `T1col3` и выберите **Проверочные ограничения**.  
  
    Будет открыто диалоговое окно **Проверочные ограничения** .  
  
2.  Нажмите кнопку **Добавить**.  
  
    В списке **Выбранные проверочные ограничения** появится новое проверочное ограничение с именем по умолчанию `CK_Table1`.  
  
3.  Выберите строку **Выражение** в сетке и нажмите кнопку с многоточием.  
  
    Будет открыто диалоговое окно **Выражение проверочного ограничения**.  
  
4.  Введите **T1col3 > 5** и нажмите кнопку **ОК**.  
  
    `Table1` содержит теперь ограничение, согласно которому все значения столбца `T1col3` должны быть больше 5.  
  
5.  Щелкните **Закрыть**.  
  
#### <a name="to-create-relationships-between-tables"></a>Создание связей между таблицами  
  
1.  В конструкторе диаграмм создайте новую таблицу `Table2` со следующими столбцами.  
  
    |**Имя столбца**|**Тип данных**|**Разрешить значения NULL**|  
    |-------------------|-----------------|-------------------|  
    |**T2col1**|**int**|не включен|  
    |**T2col2**|**varchar(50)**|включен|  
    |**T2col3**|**xml**|включен|  
  
    > [!NOTE]  
    > Столбцы на стороне первичного ключа связи внешнего ключа должны быть включены в первичный ключ или в ограничение уникальности.  
  
2.  Перетащите `T2col1` к `T1col1`.  
  
    Отображаются два диалоговых окна: **Связь по внешнему ключу** на заднем плане и **Таблицы и столбцы** на переднем плане.  
  
3.  Нажмите кнопку **OK** , чтобы сохранить новую связь.  
  
4.  Нажмите кнопку **ОК** снова.  
  
## <a name="creating-indexes"></a>Создание индексов  
Индексы можно создавать на большинстве типов данных, включая XML.  
  
#### <a name="to-create-a-standard-index"></a>Создание стандартного индекса  
  
1.  Щелкните правой кнопкой мыши `Table1` и выберите **Индексы/Ключи**.  
  
    Открывается диалоговое окно **Индексы/Ключи** .  
  
2.  Нажмите кнопку **Добавить**.  
  
    Новый индекс появится в списке **Выбранный первичный (уникальный) ключ или индекс** с именем по умолчанию, подобным `IX_Table1`.  
  
3.  Выберите строку **Столбцы** и нажмите кнопку с многоточием.  
  
    Отображается диалоговое окно **Столбцы индекса** .  
  
4.  Щелкните стрелку раскрывающегося списка под полем **Имя столбца** и выберите `T1col2`.  
  
    > [!NOTE]  
    > В индекс можно добавить дополнительные столбцы, выбрав ячейку под `T1col2` и выбрав другое имя столбца.  
  
5.  Нажмите кнопку **ОК** для сохранения этого индекса.  
  
6.  Нажмите кнопку **Закрыть** в диалоговом окне **Индексы/Ключи** .  
  
#### <a name="to-create-an-xml-index"></a>Создание XML-индекса  
  
1.  Щелкните правой кнопкой мыши `T2col1` и выберите команду **Задать первичный ключ**.  
  
    > [!NOTE]  
    > Чтобы добавить XML-индекс, необходимо, чтобы другой столбец в таблице был установлен в качестве кластеризованного первичного ключа таблицы.  
  
2.  Щелкните правой кнопкой мыши строку `T2col3` в `Table2` и выберите пункт **XML-индексы**.  
  
    Отображается диалоговое окно **XML-индексы** .  
  
3.  Нажмите кнопку **Добавить**.  
  
    В список **Выбранный XML-индекс** будет добавлен XML-индекс со значениями по умолчанию.  
  
4.  Щелкните **Закрыть**.  
  
    > [!NOTE]  
    > XML-индексы создаются для каждого столбца. Первый индекс XML-столбца является первичным, все дополнительные XML-индексы являются вторичными.  
  
## <a name="saving-the-diagram"></a>Сохранение диаграммы  
Все изменения в диаграмме не будут отправлены в базу данных до тех пор, пока диаграмма не будет сохранена. В случае возникновения проблем и конфликтов появляется диалоговое окно, содержащее дополнительные сведения.  
  
#### <a name="to-save-a-database-diagram"></a>Сохранение диаграммы базы данных  
  
1.  В меню **Файл** выберите команду **Сохранить Diagram1**.  
  
    Отображается диалоговое окно **Сохранить** . Если установлен флажок **Предупреждать о затронутых таблицах** , перечисляются сведения о новых и измененных таблицах.  
  
2.  Нажмите кнопку **ОК**.  
  
3.  В случае ошибок открывается диалоговое окно **Уведомления после сохранения** , содержащее ошибки и их причины. Исправьте ошибки и сохраните диаграмму снова.  
  
## <a name="next-steps"></a>Next Steps  
Это базовая диаграмма, содержащая только две существующие и две новые таблицы, но она иллюстрирует возможность создания схемы существующей базы данных или визуального создания новой схемы. Для лучшего изучения можно предложить следующее:  
  
-   создать новые диаграммы, содержащие группы связанных таблиц;  
  
-   настроить объем данных, отображаемых в каждой таблице;  
  
-   изменить разметку и добавить заметки;  
  
-   скопировать диаграмму в битовую карту.  
  
## <a name="see-also"></a>См. также:  
[Настройка объема сведений, отображаемых в диаграммах (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/customize-the-amount-of-information-displayed-in-diagrams-visual-database-tools.md)  
[Настройка конструктора диаграмм баз данных (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/set-up-database-diagram-designer-visual-database-tools.md)  
[Добавление таблиц в диаграммы (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/add-tables-to-diagrams-visual-database-tools.md)  
[Создание связи между таблицами на диаграмме (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/create-relationships-between-tables-on-a-diagram-visual-database-tools.md)  
[Создание XML-индексов](http://msdn.microsoft.com/en-us/6ecac598-355d-4408-baf7-1b2e8d4cf7c1)  
[Копирование изображения диаграммы базы данных в буфер обмена (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/copy-an-image-of-a-database-diagram-to-the-clipboard-visual-database-tools.md)  
[Работа с макетом диаграммы (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/work-with-diagram-layout-visual-database-tools.md)  
  
