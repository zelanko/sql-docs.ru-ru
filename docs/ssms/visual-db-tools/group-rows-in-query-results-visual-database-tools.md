---
title: "Группировка строк в результатах запросов (визуальные инструменты для баз данных) | Документация Майкрософт"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- tools-ssms
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- summarizing table subsets
- grouping rows
- grouping query results
ms.assetid: b07082d5-4d55-4903-9af9-4c470554c6d3
caps.latest.revision: 5
author: stevestein
ms.author: sstein
manager: jhubbard
ms.translationtype: Human Translation
ms.sourcegitcommit: 2edcce51c6822a89151c3c3c76fbaacb5edd54f4
ms.openlocfilehash: b615606f07f283037fdd3c41055ee2a6a2a77694
ms.contentlocale: ru-ru
ms.lasthandoff: 04/11/2017

---
# <a name="group-rows-in-query-results-visual-database-tools"></a>Группирование строк в результатах запроса (визуальные инструменты для баз данных)
Если нужно создать подытог или отобразить другие сводные сведения о подмножествах таблицы, создайте группы, используя статистический запрос. Каждая такая группа обобщает данные всех строк таблицы, имеющих одно и то же значение.  
  
Например, нужно узнать среднюю стоимость книг, данные о которых хранятся в таблице `titles` , и разделить результаты в соответствии с идентификаторами издателей. Для этого следует сгруппировать запрос на основе идентификатора издателя (например `pub_id`). Сведения, выведенные таким запросом, могли бы выглядеть следующим образом:  
  
![Результаты запроса: средние цены, сгруппированные по издателям](../../ssms/visual-db-tools/media/dv3w9e1.gif "Результаты запроса: средние цены, сгруппированные по издателям")  
  
Группируя данные, можно отобразить только сводные или сгруппированные данные, подобные следующим.  
  
-   Значения сгруппированных столбцов (столбцов, указанных в предложении GROUP BY). В приведенном выше примере столбец `pub_id` является сгруппированным.  
  
-   Значения, созданные агрегатными функциями, такими как SUM( ) и AVG( ). В приведенном выше примере второй столбец создается путем применения функции AVG( ) к столбцу `price` .  
  
Отобразить значения отдельных строк нельзя. Например, если группируются данные только по идентификаторам издателей, нельзя отобразить в запросе еще и отдельные названия книг. Таким образом, если столбцы добавляются в вывод запроса, [конструктор запросов и представлений](../../ssms/visual-db-tools/query-and-view-designer-tools-visual-database-tools.md) автоматически добавляет их в предложение GROUP BY инструкции на [панели SQL](../../ssms/visual-db-tools/sql-pane-visual-database-tools.md). Если нужно, чтобы столбец содержал статистические данные, можете определить для него агрегатную функцию.  
  
Если данные группируются по нескольким столбцам, каждая группа в запросе отображает статистические значения всех столбцов группировки.  
  
Например, следующий запрос таблицы `titles` группирует данные по идентификаторам издателей (`pub_id`) и типам книг (`type`). Результаты запроса упорядочиваются по идентификаторам издателей и представляют сводные данные о каждом типе книг, издаваемых издателем:  
  
```  
SELECT pub_id, type, SUM(price) Total_price  
FROM titles  
GROUP BY pub_id, type  
```  
  
Итоговый вывод мог бы выглядеть следующим образом:  
  
![Результаты запроса: цены, сгруппированные по издателям и типам](../../ssms/visual-db-tools/media/dv3w9e2.gif "Результаты запроса: цены, сгруппированные по издателям и типам")  
  
### <a name="to-group-rows"></a>Группирование строк  
  
1.  Инициируйте запрос, добавив таблицы, сводную информацию о которых нужно получить, на панель диаграмм.  
  
2.  Щелкните правой кнопкой мыши фон панели диаграммы и выберите из контекстного меню пункт **Добавить Group By** . Конструктор запросов и представлений добавляет столбец **Группировать** в сетку на панели критериев.  
  
3.  Добавьте столбец или столбцы, которые нужно сгруппировать, на панель критериев. Если нужно, чтобы столбец был отображен в выводе запроса, не забудьте убедиться в том, что для вывода выбран столбец **Вывод** .  
  
    Конструктор запросов и представлений добавит в инструкцию, отображаемую на панели SQL, предложение GROUP BY. Например, инструкция SQL может иметь такой вид:  
  
    ```  
    SELECT pub_id  
    FROM titles  
    GROUP BY pub_id  
    ```  
  
4.  Добавьте на панель критериев столбец или столбцы, статистическую информацию о которых нужно получить. Убедитесь, что столбец помечен для вывода.  
  
5.  В ячейке **Группировать** для столбца, статистическую информацию о котором нужно получить, выберите подходящую агрегатную функцию.  
  
    Конструктор запросов и представлений автоматически назначает суммируемому столбцу псевдоним, Псевдоним, созданный автоматически, можно заменить более содержательным псевдонимом. Дополнительные сведения см. в разделе [Создание псевдонимов столбцов (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/create-column-aliases-visual-database-tools.md).  
  
    ![Добавление псевдонима столбца в результирующий набор запроса](../../ssms/visual-db-tools/media/dv3w9e3.gif "Добавление псевдонима столбца в результирующий набор запроса")  
  
    Соответствующая инструкция могла бы выглядеть на панели **SQL** следующим образом:  
  
    ```  
    SELECT   pub_id, SUM(price) AS Totalprice  
    FROM     titles  
    GROUP BY pub_id  
    ```  
  
## <a name="see-also"></a>См. также:  
[Результаты запросов сортировки и группирования (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/sort-and-group-query-results-visual-database-tools.md)  
  

