---
title: Параметризованные запросы
ms.custom: seo-lt-2019
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: sql-tools
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- parameter queries [SQL Server]
ms.assetid: 4897c41a-324a-47b8-a30b-cbc9e9e19a8b
author: markingmyname
ms.author: maghan
ms.manager: jroth
ms.reviewer: ''
ms.openlocfilehash: e14e968620f63a596ff9c5b65c547eab8017cc62
ms.sourcegitcommit: b78f7ab9281f570b87f96991ebd9a095812cc546
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/31/2020
ms.locfileid: "75257063"
---
# <a name="parameter-queries-visual-database-tools"></a>Запросы с параметрами (визуальные инструменты для баз данных)
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]
В некоторых случаях нужно создать запрос, который можно использовать многократно, на каждый раз с разными значениями. Например: можно часто запускать запрос, чтобы найти все `title_ids` , записанные одним автором, можно выполнять один запрос для каждого поиска, меняя только идентификатор автора.  
  
Чтобы создать запрос, который в разное время может иметь разные значения, используются параметры запроса. Параметр — это заполнитель для значения, которое предоставляется при запуске запроса. Инструкция SQL с параметром может выглядеть следующим образом, где «?» представляет параметр для идентификатора автора:  
  
```  
SELECT title_id  
FROM titleauthor  
WHERE (au_id = ?)  
```  
  
## <a name="where-you-can-use-parameters"></a>Где можно использовать параметры  
Параметры можно использовать как метки-заполнители для литеральных значений — текстовых или числовых. Наиболее часто параметры используются в качестве меток-заполнителей в условиях поиска отдельных строк или групп строк (то есть в предложениях WHERE и HAVING инструкций SQL).  
  
Параметр можно использовать в качестве меток-заполнителей в выражениях. Например можно вычислять цены со скидками, предоставляя различное значение скидки при каждом запуске запроса. Для этого нужно указать следующее выражение:  
  
```  
(price * ?)  
```  
  
## <a name="specifying-unnamed-and-named-parameters"></a>Именованные и неименованные параметры  
Можно задать два типа параметров: неименованные и именованные. Неименованный параметр — это восклицательный знак, который можно подставлять в любое место запроса, в котором нужно запросить соответствующее литеральное значение. Например, если неименованный параметр используется для поиска идентификатора автора в таблице `titleauthor` , то полученная в результате инструкция на [панели SQL](../../ssms/visual-db-tools/sql-pane-visual-database-tools.md) может выглядеть следующим образом:  
  
```  
SELECT title_id  
FROM titleauthor  
WHERE (au_id = ?)  
```  
  
При выполнении запроса в [конструкторе запросов и представлений](../../ssms/visual-db-tools/query-and-view-designer-tools-visual-database-tools.md)в диалоговом окне [Параметры запроса](../../ssms/visual-db-tools/query-parameters-dialog-box-visual-database-tools.md) появляется "?" в качестве имени параметра.  
  
Можно также присвоить имя параметру. Именованные параметры особенно полезны, если в запросе имеется несколько параметров. Например, если именованный параметр используется для поиска имени и фамилии автора в таблице `authors` , то полученная в результате инструкция на панели «SQL» может выглядеть следующим образом:  
  
```  
SELECT au_id  
FROM authors  
WHERE au_fname = %first name% AND  
      au_lname = %last name%  
```  
  
> [!TIP]  
> Перед тем как создать запрос с именованным параметром, необходимо определить символы префикса и суффикса.  
  
При выполнении запроса в конструкторе запросов и представлений в диалоговом окне [Параметры запроса](../../ssms/visual-db-tools/query-parameters-dialog-box-visual-database-tools.md) появляется список именованных параметров.  
  
## <a name="see-also"></a>См. также:  
[Запрос с параметрами (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/query-with-parameters-visual-database-tools.md)  
[Поддерживаемые типы запросов (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/supported-query-types-visual-database-tools.md)  
[Разделы по конструированию запросов и представлений (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/design-queries-and-views-how-to-topics-visual-database-tools.md)  
  
