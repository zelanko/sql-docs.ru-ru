---
title: Среда SQL Server Management Studio (SSMS) — журнал изменений | Документация Майкрософт
ms.custom: ''
ms.date: 09/24/2018
ms.prod: sql
ms.prod_service: sql-tools
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
ms.assetid: 3dc76cc1-3b4c-4719-8296-f69ec1b476f9
author: stevestein
ms.author: sstein
manager: craigg
ms.openlocfilehash: fdea834df198dc8fbaf403816895a99d9140e4ec
ms.sourcegitcommit: a2be75158491535c9a59583c51890e3457dc75d6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/07/2018
ms.locfileid: "51270277"
---
# <a name="sql-server-management-studio---changelog-ssms"></a>SQL Server Management Studio - Changelog (SSMS)
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../includes/appliesto-ss-asdb-asdw-pdw-md.md)]
В этой статье приводятся подробные сведения об обновлениях, улучшениях и исправлениях ошибок в текущей и предыдущих версиях SQL Server Management Studio. Скачать [предыдущие версии SQL Server Management Studio можно ниже](#previous-ssms-releases).


## <a name="ssms-180-preview-4download-sql-server-management-studio-ssmsmd"></a>[SSMS 18.0 (предварительная версия 4)](download-sql-server-management-studio-ssms.md)

Номер сборки: 15.0.18040.0<br>
Дата выпуска: 24 сентября 2018 г

Предварительная версия 4 — это первая общедоступная предварительная версия SSMS 18.0. Для последней общедоступной версии SSMS [скачайте и установите SSMS 17.9](#ssms-179-latest-ga-release).

### <a name="whats-new"></a>новые возможности

**Общие ошибки SSMS**

Более компактный файл для скачивания:

- Текущий размер пакета меньше половины SSMS 17.x (приблизительно 400 МБ). Размер со временем будет увеличиваться при добавлении компонентов Integration Services (IS), но не будет таким большим, как раньше.

SSMS 18.x работает на основе изолированной оболочки Visual Studio 2017:

- Это означает использование современной оболочки (мы выбрали Visual Studio 2017 15.6.4). Новая оболочка содержит все исправления специальных возможностей, внесенные в SSMS и Visual Studio.

Улучшения специальных возможностей:

- Мы проделали большую работу, чтобы устранить проблемы специальных возможностей во всех средствах (SSMS, DTA и Profiler).

SSMS можно установить в пользовательской папке:

- В настоящее время доступно только в командной строке. Передайте этот дополнительный аргумент в файл SSMS-Setup-ENU.exe:

  `SSMSInstallRoot=C:\MySSMS18`

  Новое место установки для SSMS по умолчанию: `%ProgramFiles(x86)%\Microsoft SQL Server Management Studio 18\Common7\IDE\ssms.exe`
  
  > [!NOTE]
  > Это не означает, что SSMS имеет несколько экземпляров.

SSMS больше не использует компоненты совместно с ядром SQL:

- Требовалось очень много усилий, чтобы избежать совместного использования компонентов с ядром SQL, которое часто приводило к появлению проблем с обслуживанием, так как при установке SQL перезаписывались файлы, установленные SSMS, и наоборот.

SSMS теперь требует NetFx 4.7.2 или более поздней версии:

- Мы обновили минимальное требование с NetFx4.6.1 до NetFx4.7.2. Теперь можно воспользоваться преимуществами новых функциональных возможностей, предоставляемых этой платформой.

SSMS не поддерживается в Windows 8. Требуется Windows 10 и Windows Server 2016 версии 1607 (10.0.14393) или более поздней:
  
- Из-за новой зависимости от NetFx 4.7.2 SSMS 18.0 не устанавливается на Windows 8, более старых версиях Windows 10 и Windows Server 2016. Установка SSMS будет заблокирована в этих операционных системах. Windows 8.1 по-прежнему поддерживается.

SSMS не добавляется в переменную среды PATH:

- Путь к SSMS. EXE (и средствам в целом) больше не добавляется в путь. Пользователи могут добавить его самостоятельно или, в современной версии Windows, использовать меню "Пуск".

Поддержка [!INCLUDE[sql-server-2019](..\includes\sssqlv15-md.md)]

- Это первый выпуск SSMS, который полностью *сочетается* с [!INCLUDE[sql-server-2019](..\includes\sssqlv15-md.md)] (compatLevel 150 и т. д.).
- Поддержка "BATCH_STARTED_GROUP" и "BATCH_COMPLETED_GROUP" в [!INCLUDE[sql-server-2019](..\includes\sssqlv15-md.md)] и Управляемом экземпляре базы данных SQL в SSMS.
- GraphDB: добавьте флаг в showplan для последовательности Graph TC.
- Always Encrypted: добавлена поддержка функции [Always Encrypted с безопасными анклавами](../relational-databases/security/encryption/always-encrypted-enclaves.md).
  - Диалоговое окно соединения имеет новую вкладку "Always Encrypted", когда пользователь нажимает кнопку "Параметры", чтобы включить и настроить поддержку анклава.

Идентификаторы пакетов больше не нужны для разработки расширений SSMS:

- SSMS выборочно загружала только хорошо известные пакеты, поэтому разработчикам приходилось регистрировать собственные пакеты. Это больше не требуется.

Улучшенная поддержка Azure SQL:

- Свойства базы данных SLO/Edition/MaxSize теперь принимают пользовательские имена, что облегчает поддержку будущих выпусков базы данных SQL Azure.
- Добавлена поддержка номеров SKU виртуальных ядер ("Общего назначения" и "Критически важный для бизнеса"): Gen4_24 и все Gen5.

SMO:

- Расширение поддержки SMO для создания возобновляемого индекса.
- Добавлено новое событие для объектов SMO (PropertyMissing), чтобы разработчикам приложений было проще обнаружить проблемы с производительностью SMO.
- Доступно новое свойство *DefaultBackupChecksum* в объекте конфигурации, которое сопоставляется с конфигурацией сервера контрольной суммы резервной копии по умолчанию.

SSMS:

- Предоставление параметра конфигурации AUTOGROW_ALL_FILES для файловых групп в SSMS
- Из графического пользовательского интерфейса SSMS удалены рискованные параметры "использование упрощенных пулов" и "повышение приоритета" (https://blogs.msdn.microsoft.com/arvindsh/2010/01/26/priority-boost-details-and-why-its-not-recommended).
- Редактор SQL учитывает сочетание клавиш **CTRL+D** для дублирования строк (https://feedback.azure.com/forums/908035-sql-server/suggestions/32896594).
- Новые меню и настраиваемые сочетания клавиш для создания файлов: **CTRL+ALT+N**. **CTRL+N** по-прежнему будет создавать новый запрос.
- Диалоговое окно **Новое правило брандмауэра** теперь позволяет пользователю указать имя правила вместо автоматического создания имени (https://feedback.azure.com/forums/908035-sql-server/suggestions/32902039).
- Классификация данных: обновлены рекомендации.
- Усовершенствована функция IntelliSense в редакторе, особенно для v140 T-SQL.
- Поддержка всех языков уровня 1.
- В пользовательском интерфейсе SSMS добавлена поддержка UTF-8 в диалоговом окне параметров сортировки.
- Переход на диспетчер учетных данных Windows для паролей MRU в диалоговом окне соединения. Это решит давнюю проблему, при которой сохраняемость паролей не всегда была надежной (https://feedback.azure.com/forums/908035-sql-server/suggestions/32896486).
- Поддержка высокого разрешения включена по умолчанию.
- Улучшена поддержка в системах с несколькими мониторами, которая гарантирует, что дополнительные диалоговые и всплывающие окна будут появляться на нужном мониторе.
- Предоставлена конфигурация сервера "контрольная сумма резервной копии по умолчанию" на странице параметров базы данных в диалоговом окне "Свойства сервера". (https://feedback.azure.com/forums/908035-sql-server/suggestions/34634974).


SSMS / ShowPlan:

- Добавлено фактическое истекшее время, фактическое и предполагаемое количество строк в узле оператора ShowPlan, если они доступны. Благодаря этому фактический план будет согласован с планом динамической статистики запросов.
- Изменены подсказки и добавлен комментарий при нажатии на кнопку "Изменить запрос" в ShowPlan, чтобы уведомить пользователя, что ShowPlan может быть усечен ядром SQL, если запрос содержит более 4000 символов.
- Добавлена логика для отображения оператора Materializer (внешний выбор).
- Добавлен новый атрибут showplan BatchModeOnRowStoreUsed для быстрой идентификации запросов, использующих функцию пакетного сканирования rowstore. Каждый раз, когда запрос выполняет пакетное сканирование rowstore, новый атрибут (BatchModeOnRowStoreUsed="true") добавляется к элементу StmtSimple.

Always On:

- Повторное хэширование RTO (предполагаемое время восстановления) и RPO (предполагаемая потеря данных) на панели мониторинга SSMS AlwaysOn. Дополнительные сведения см. в разделе [Мониторинг производительности для групп доступности AlwaysOn](../database-engine/availability-groups/windows/monitor-performance-for-always-on-availability-groups.md).

Файлы аудита:

- Изменен метод проверки подлинности с ключа учетной записи хранения на проверку подлинности на основе Azure AD.

Always Encrypted:

- Добавлена вкладка Always Encrypted с флажком *Включить Always Encrypted* (в диалоговом окне *Соединение с сервером*), на которой теперь можно легко включить или отключить шифрование Always Encrypted для подключения к базе данных.
- Добавлено несколько улучшений поддержки Always Encrypted с безопасными анклавами:
  - Текстовое поле для указания URL-адреса аттестации анклава в диалоговом окне подключения к серверу (новая вкладка Always Encrypted).
  - Новый флажок в диалоговом окне "Новый главный ключ столбца" для указания, будет ли новый главный ключ столбца разрешать вычисления анклава.
  - Другие диалоговые окна управления ключами Always Encrypted теперь предоставляют сведения, в каких главных ключах столбца разрешены вычисления анклава.
  - Дополнительные сведения см. в статье [Always Encrypted с безопасными анклавами](../relational-databases/security/encryption/always-encrypted-enclaves.md).

        
### <a name="bug-fixes"></a>Исправления ошибок

Аварийное завершение/зависания:

- Исправлен источник распространенных сбоев SSMS, связанный с объектами интерфейса графических устройств.
- Исправлен частый источник зависаний и снижения производительности при выборе "Скрипт как создать/изменить/удалить" (удалены ненужные операции принесения объектов SMO).
- Исправлено зависание при подключении к базе данных SQL Azure SQL с помощью многофакторной проверки подлинности, если включены трассировки ADAL.
- Исправлено зависание (или предполагаемое зависание) в динамической статистике запросов при вызове из монитора активности (проблема проявлялась при использовании проверки подлинности SQL Server без заданного параметра "Конфиденциальные данные").
- Исправлено зависание при выборе "Отчеты" в обозревателе объектов, которое проявлялось в больших задержках при подключении или временной недоступности ресурсов.

Диалоговое окно соединения:

- Включено удаление имен пользователей из предыдущего списка имен пользователей с помощью клавиши DEL (https://feedback.azure.com/forums/908035/suggestions/32897632).

XEvent

- Добавлены два столбца "action_name" и "class_type_desc", показывающие поля идентификатора действия и типа класса в виде строк для чтения.
- Удалено ограничение средства просмотра событий XEvent, которое составляло 1 000 000.

Внешние таблицы:

- Добавлена поддержка `Rejected_Row_Location` в шаблон, SMO, IntelliSense и таблицы свойств.

Параметры SSMS:

- Исправлена проблема, при которой страница **Сервис > Параметры > Обозреватель объектов SQL Server > Команды** некорректно изменяла размер.


Редактор SSMS:

- Устранена проблема в системной таблице SQL, при которой после восстановления цветов по умолчанию цвет менялся на травяной вместо зеленого, что затрудняло чтение на белом фоне (https://feedback.azure.com/forums/908035-sql-server/suggestions/32896906).
- Устранена проблема, при которой IntelliSense не работал при подключении к хранилищу данных SQL Azure с использованием проверки подлинности AAD.
- Исправлена проблема IntelliSense в Azure, когда у пользователя не было доступа уровня master.
- Исправлены фрагменты кода для создания темпоральных таблиц, которые были разорваны, если параметры сортировки целевой базы данных зависели от регистра.

Обозреватель объектов:

- Устранена проблема, из-за которой при попытке развернуть узел "Управление" в обозревателе объектов в SSMS возникало исключение "Невозможно привести объект типа DBNull к другим типам" (неправильно настроенный DataCollector).
- Устранена проблема, при которой клавиша DEL не работала при переименовании узла (https://feedback.azure.com/forums/908035/suggestions/32910247 и другие дубликаты).
- Исправлена проблема, при которой обозреватель объектов не вставлял escape-символ для кавычек до вызова "Редактировать верхние N...", вызывая путаницу.
- Исправлена проблема, при которой мастер импорта приложения уровня данных не запускался из дерева службы хранилища Azure.
- Исправлена проблема в конфигурации Database Mail, при которой состояние флажка SSL не сохранялось (https://feedback.azure.com/forums/908035-sql-server/suggestions/32895541).
- Исправлена проблема, при которой в SSMS была неактивна опция закрытия существующих соединений при попытке восстановить базу данных с помощью is_auto_update_stats_async_on
- Исправлена проблема, при которой пользователь нажимал правой кнопкой мыши на узлах в обозревателе объектов (например, "Таблицы") и хотел выполнить действие, например, отфильтровать таблицы в меню **Фильтр > Параметры фильтра**, а форма параметров фильтра могла появиться на другом экране, а не на том, где активна среда SSMS (https://feedback.azure.com/forums/908035-sql-server/suggestions/34284106).
- Исправлена давняя проблема, при которой клавиша DELETE не работала в обозревателе объектов при попытке переименовать объект (https://feedback.azure.com/forums/908035-sql-server/suggestions/33073510).
- При отображении свойств существующих файлов базы данных размер отображается в столбце "Размер (МБ)", а не "Начальный размер (МБ)", который должен отображаться при создании новой базы данных (https://feedback.azure.com/forums/908035-sql-server/suggestions/32629024).
- Отключен элемент контекстного меню "Дизайн" в таблицах графов, поскольку этот тип таблицы не поддерживается в текущей версии SSMS.

        
Окно справки:

- Улучшена логика учета подключенного и автономного режимов.
- Исправлена функция справки, которая теперь учитывает подключенный и автономный режимы (https://feedback.azure.com/forums/908035-sql-server/suggestions/32897791).
    
Сценарии объектов

- Общее повышение производительности — создание скриптов WideWorldImporters теперь происходит в два раза быстрее по сравнению с SSMS 17.7.
- При создании скриптов для объектов опускается конфигурации уровня базы данных, которая имеет значения по умолчанию.
- Не создается динамический T-SQL при создании скрипта (https://feedback.azure.com/forums/908035-sql-server/suggestions/32898391).
- Опускается синтаксис графа "как граница" и "как узел" при создании скрипта для таблицы в SQL Server 2016 и более ранних версий.


Конструктор таблиц:

- Исправлен сбой в функции "Изменить 200 строк".
- Устранена проблема, при которой конструктор позволял добавлять таблицу при подключении к базе данных SQL Azure.

SMO:

- Исправлена проблема, при которой SMO/ServerConnection некорректно обрабатывал подключения на основе SqlCredential (https://feedback.azure.com/forums/908035-sql-server/suggestions/33698941).

AS:

- Устранена проблема, при которой обрезались "Расширенные параметры" в пользовательском интерфейсе Xevent AS.

Мастер импорта неструктурированных файлов:

- Устранена проблема, при которой мастер импорта неструктурированных файлов некорректно обрабатывал двойные кавычки (экранирование).
- Исправлена проблема, связанная с неправильной обработкой типов с плавающей запятой (в языковых стандартах, которые используют другой разделитель для чисел с плавающей запятой).
- Исправлена проблема, связанная с импортом битов, если значения равны 0 или 1 (https://feedback.azure.com/forums/908035-sql-server/suggestions/32898535).
- Устранена проблема, при которой числа с плавающей запятой вводились как значения NULL.
        
Классификация данных:

- Устранена проблема установки, в результате которой часть с рекомендациями для классификации данных не работала в новой установке.

Резервное копирование/восстановление/присоединение/отсоединение базы данных:

- Устранена проблема, при которой пользователю не удавалось присоединить базу данных, если имя физического MDF-файла не совпадало с исходным именем файла.
- Устранена проблема, при которой SSMS не удавалось находить допустимый план восстановления или удавалось находить не оптимальный (https://feedback.azure.com/forums/908035-sql-server/suggestions/32897752).
- Исправлен сбой в SSMS при попытке восстановить резервную копию URL-адреса.

Монитор активности заданий:

- Исправлена проблема сбоев при использовании монитора активности заданий (с фильтрами).
        
Поддержка управляемого экземпляра в SSMS:

- Улучшена и усовершенствована поддержка управляемых экземпляров: отключены неподдерживаемые параметры в пользовательском интерфейсе и исправлена опция просмотра журналов аудита для обработки URL-адреса целевого объекта аудита.
- Скрипты мастера создания и публикации скриптов не поддерживают предложения CREATE DATABASE.
- Динамическая статистика запросов отключена для экземпляров командной строки.
- Раздел "Свойства базы данных -> Файлы" неправильно создавал скрипты для ALTER DB ADD FILE.
- Исправлена регрессия с планировщиком агента SQL, где планирование ONIDLE выбиралось даже при выборе другого типа планирования.
- Настройка MAXTRANSFERRATE, MAXBLOCKSIZE для резервного копирования в службе хранилища Azure.
- Проблема, при которой резервная копия заключительного фрагмента журнала записывалась в скрипт перед выполнением операции RESTORE (не поддерживается в командной строке).
- Мастер создания базы данных неверно записывал в скрипт инструкцию CREATE DATABASE.
- Устранена проблема, при которой отображалась ошибка при попытке использовать монитор активности при подключении к управляемым экземплярам.


База данных SQL Azure:

- Устранена проблема, при которой список баз данных некорректно заполнялся для окна запроса базы данных SQL Azure при подключении к базе данных пользователя в базе данных SQL Azure вместо базы данных master.
- Устранена проблема, при которой невозможно было добавить темпоральную таблицу в базу данных SQL Azure.


Общая поддержка SQL Azure:

- Исправлены ошибки в элементах управления пользовательского интерфейса Azure, которые мешали пользователю вывести список подписок Azure (если их было более 50). Кроме того, изменена сортировка. Теперь подписки сортируются по имени, а не по идентификатору. Пользователь сталкивался с этим, например, при попытке восстановить резервную копию по URL-адресу.
- Устранена проблема в элементе управления пользовательского интерфейса Azure, связанная с перечислением подписок, при которой возникала ошибка "Индекс вне допустимого диапазона. Должен быть неотрицательным и меньше, чем размер коллекции", если у пользователя не было подписок в некоторых клиентах. Пользователь сталкивался с этим, например, при попытке восстановить резервную копию по URL-адресу.

Сетка результатов:

- Исправлена проблема в режиме высокой контрастности (выбранные номера строк не отображаются).

XEvent Profiler:

- Устранена проблема, при которой профилировщик XEvent не мог запуститься при подключении к SQL Server с 96 ядрами.


### <a name="deprecated-features"></a>Устаревшие возможности

Следующие функции больше не доступны в SSMS:

- Отладчик T-SQL.
- Диаграммы базы данных.
- OSQL.EXE
- Пользовательский интерфейс администратора Dreplay
- Средства Configuration Manager:
  - Диспетчер конфигурации SQL Server и диспетчер конфигурации сервера отчетов больше не являются частью установки SSMS.

- Стандартные политики DMF
  - Эти политики больше не устанавливаются с SSMS. Они будут перенесены в Git. Пользователи смогут добавлять и загружать или устанавливать их, если захотят.

- Удален параметр командной строки SSMS -P
  - По соображениям безопасности удалена возможность указания открытых паролей в командной строке.

- Удалена опция "Создание скриптов | Опубликовать в веб-службе". Эта нерекомендуемая функция удалена из пользовательского интерфейса SSMS.

- Удален узел "Обслуживание | Прежние версии" в обозревателе объектов. Удалена опция "Формирование и публикация скриптов | Опубликовать в веб-службе". *Очень старые* узлы "План обслуживания базы данных" и "SQL Mail" больше не доступны. Современные узлы "Database Mail" и "Планы обслуживания" продолжат работу в обычном режиме.

### <a name="known-issues"></a>Известные проблемы

Ниже представлены известные проблемы в текущем выпуске.

> [!IMPORTANT]
> При использовании проверки подлинности *Active Directory — Universal с поддержкой MFA* в редакторе SQL-запросов пользователи могут заметить, что подключение закрывается и снова открывается с каждым вызовом запроса. Побочные эффекты такого закрытия включают неожиданное удаление глобальных временных таблиц и иногда присвоение нового идентификатора SPID для соединения. Закрытие не будет происходить при открытой транзакции в соединении. Чтобы обойти эту проблему, пользователи могут указать `persist security info=true` в параметрах подключения.

SSMS

- При двойном щелчке на SQL-файле запускается SSMS, но не открывается скрипт.
  - Обходное решение: перетащите SQL-файл в редактор SSMS.

Службы SSIS

- Не удается успешно развернуть или выполнить пакет, если он предназначен для SQL Server старой версии и одновременно содержит задачу скрипта и компонент скрипта.
- SSMS не удается подключиться к удаленной службе Integration Services.

## <a name="ssms-179-latest-ga-release"></a>SSMS 17.9 (последний общедоступной выпуск)

![скачать](../ssdt/media/download.png) [SSMS 17.9](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x409)

Номер сборки: 14.0.17285.0.<br>
Дата выпуска: 4 сентября 2018 г.

> [!NOTE]
> При установке на следующие платформы для использования неанглоязычных локализованных выпусков SSMS 17.x требуется [пакет обновления безопасности KB 2862966](https://support.microsoft.com/en-us/kb/2862966): Windows 7, Windows 8, Windows Server 2012 и Windows Server 2008 R2.

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=2014306&clcid=0x40a)


### <a name="whats-new"></a>новые возможности

**Общие ошибки SSMS**


Showplan:

- При активации функции для определенного плана в графическом отображении инструкции Showplan теперь появляются новые атрибуты обратной связи по временно предоставляемому буферу памяти в строковом режиме: IsMemoryGrantFeedbackAdjusted и LastRequestedMemory. Они добавлены в XML-элемент плана запроса MemoryGrantInfo. Дополнительные сведения об обратной связи с временно предоставляемым буфером памяти в строковом режиме см. в статье [Адаптивная обработка запросов в базах данных SQL](https://docs.microsoft.com/sql/relational-databases/performance/adaptive-query-processing).

Azure SQL: 

- Добавлена поддержка номеров SKU виртуальных ядер при создании базы данных Azure. Дополнительные сведения см. в разделе [Модель покупки на основе числа виртуальных ядер](https://docs.microsoft.com/azure/sql-database/sql-database-service-tiers#vcore-based-purchasing-model).
 

### <a name="bug-fixes"></a>Исправления ошибок

**Общие ошибки SSMS**
    
Монитор репликации:

- Устранена проблема, из-за которой не запускался монитор репликации SqlMonitor.exe (запрос на сайте UserVoice: https://feedback.azure.com/forums/908035-sql-server/suggestions/34791079). 

Мастер импорта неструктурированных файлов: 

- Исправлена ссылка на страницу справки для диалогового окна мастера по работе с неструктурированным файлами. 
- Устранена проблема, из-за которой мастер не позволял изменить целевую таблицу, если она существует. Благодаря этому пользователи могут повторить попытку, не закрывая мастер, — удалить таблицу с ошибкой и повторно ввести сведения в мастере (запрос на сайте UserVoice: https://feedback.azure.com/forums/908035-sql-server/suggestions/32896186). 

Импорт и экспорт приложения уровня данных

- Устранена проблема (в DacFx), из-за которой импорт файла BACPAC мог завершиться такой ошибкой: "Error SQL72014: .Net SqlClient Data Provider: Msg 9108, Level 16, State 10, Line 1 This type of statistics is not supported to be incremental" (Ошибка SQL72014: поставщик данных .Net SqlClient. Сообщение 9108, уровень 16, состояние 10, строка 1. Статистика этого типа не может быть добавочной). Такая ошибка возникала при работе с таблицами, в которых определены секции, но отсутствуют индексы.

Технология IntelliSense:

- Устранена проблема, из-за которой не работало завершение элементов кода IntelliSense при использовании AAD с MFA. 

Обозреватель объектов: 

- Устранена проблема, из-за которой диалоговое окно фильтра отображалось на случайных мониторах вместо монитора с запущенным решением SSMS (в системах с несколькими мониторами).

Azure SQL: 

- Устранена проблема, связанная с перечислением баз данных в окне "Доступные базы данных", где в раскрывающемся списке не отображалась база данных "master" при подключении к конкретной базе данных. 
- Устранена проблема, из-за которой попытка создать скрипт ("Данные" или "Схема и данные") завершалась ошибкой, если подключение к Базе данных SQL Azure было установлено с помощью AAD с MFA. 
- Устранена проблема с конструктором представлений (представления), из-за которой в пользовательском интерфейсе нельзя было выбрать элемент "Добавить таблицы", если установлено подключение к Базе данных SQL Azure. 
- Устранена проблема, из-за которой редактор запросов SSMS автоматически закрывал и повторно открывал подключения при обновлении маркера MFA. Это устранит побочные эффекты, которые происходили без ведома пользователя (например, когда транзакции закрывались и не открывались повторно). После изменения время окончания срока действия токена добавлено в окно свойств. 
- Устранена проблема, из-за которой в SSMS не применялись запросы на ввод пароля для импортированных учетных записей MSA, используемых при входе с помощью AAD и MFA. 

Монитор активности 

- Устранена проблема, из-за которой функция динамической статистики запросов переставала отвечать на запросы, когда она запускалась из монитора активности и использовалась аутентификация SQL. 

Интеграция Microsoft Azure 

- Устранена проблема, из-за которой в SSMS отображались только первые 50 подписок (в диалоговых окнах Always Encrypted, резервного копирования и восстановления на основе URL-адреса и т. д.). 
- Устранена проблема, из-за которой в SSMS создавалось исключение ("Индекс вне диапазона") при попытке войти в учетную запись Microsoft Azure, не связанную с какой-либо учетной записью хранения (в диалоговом окне восстановления резервной копии на основе URL-адреса). 

Сценарии объектов 

- Теперь при написании скриптов DROP и CREATE в SSMS можно не создавать динамический запрос T-SQL.
- При создании скрипта для объекта базы данных в SSMS теперь не создается скрипт для установки параметров конфигурации на уровне базы данных, если заданы значения по умолчанию.

Справка

- Устранена проблема, которую долго не удавалось решить и из-за которой для раздела "Использование справки" не работал переход между режимами "в сети" и "вне сети".
- Теперь при выборе раздела справки "Community Projects and Samples" (Проекты и примеры сообщества) открывается браузер по умолчанию со страницей Git, на которой нет предупреждений и сообщений об ошибках, связанных с использованием устаревшего браузера.

### <a name="known-issues"></a>Известные проблемы


> [!IMPORTANT]
> При использовании проверки подлинности *Active Directory — Universal с поддержкой MFA* в редакторе SQL-запросов пользователи могут заметить, что подключение закрывается и снова открывается с каждым вызовом запроса. Побочные эффекты такого закрытия включают неожиданное удаление глобальных временных таблиц и иногда присвоение нового идентификатора SPID для соединения. Закрытие не будет происходить при открытой транзакции в соединении. Чтобы обойти эту проблему, пользователи могут указать `persist security info=true` в параметрах подключения.




## <a name="previous-ssms-releases"></a>Предыдущие выпуски SSMS

Чтобы скачать предыдущие версии SSMS, щелкните заголовки со ссылками в приведенных ниже разделах.

## <a name="downloadssdtmediadownloadpng-ssms-1781httpsgomicrosoftcomfwlinklinkid875802"></a>![Скачать](../ssdt/media/download.png) [SSMS 17.8.1](https://go.microsoft.com/fwlink/?linkid=875802)
*В версии 17.8 обнаружена ошибка, связанная с подготовкой баз данных SQL, поэтому версия 17.8 заменяется новой версией SSMS 17.8.1.*

Номер сборки: 14.0.17277.0<br>
Дата выпуска: 26 июня 2018 г.

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=875802&clcid=0x40a)


### <a name="whats-new"></a>новые возможности

**Общие ошибки SSMS**

Свойства базы данных

- В этом улучшении предоставлен параметр конфигурации **AUTOGROW_ALL_FILES** для файловых групп. Этот новый параметр конфигурации добавлен в окно "Свойства базы данных" > "Файловые группы" в виде нового столбца (Автоматическое увеличение всех файлов) с флажками для каждой из доступных файловых групп (за исключением файловых групп Filestream и Memory Optimized). Пользователь может включить или отключить AUTOGROW_ALL_FILES для определенной файловой группы, установив или сняв соответствующий флажок Autogrow_All_Files. Соответственно, параметр **AUTOGROW_ALL_FILES** должным образом обрабатывается в скриптах базы данных для CREATE и при создании скриптов для базы данных (в SQL 2016 и более поздних версий).
    
Редактор SQL

- Улучшена работа с Intellisense в Базе данных SQL Azure для ситуации, когда у пользователя нет доступа уровня master.

Написание скриптов:

- Общее повышение производительности, особенно при соединениях с высокой задержкой.
    
**Analysis Services**

- Клиентские библиотеки и поставщики данных Analysis Services обновлены до последней версии, в которой добавлена поддержка нового центра AAD Azure для государственных организаций (login.microsoftonline.us).



### <a name="bug-fixes"></a>Исправления ошибок

**Общие ошибки SSMS**
    
Планы обслуживания

- Устранена проблема с изменением планов обслуживания с аутентификацией SQL. Из-за этой проблемы использование аутентификации SQL приводило к сбою задачи уведомления оператора.
    
Написание скриптов:

- Устранена проблема, из-за которой действия PostProcess в объектах SMO приводили к исчерпанию ресурсов и сбоям входа в SQL.
    
SMO:

- Устранена проблема, из-за которой операция Table.Alter() завершалась сбоем, если в непустую таблицу добавлялся столбец с ограничением по умолчанию. Дополнительные сведения об этой проблеме можно получить в [этой ветке форума](https://feedback.azure.com/forums/908035-sql-server/suggestions/32895625).
    
Always Encrypted:

- Устранена проблема в DacFx, которая вызывала ошибку превышения времени ожидания блокировки при включении функции Always Encrypted для секционированной таблицы.
    

**Analysis Services**

- Устранена проблема, которая возникала при изменении источника данных OAuth в табличных моделях Analysis Services с уровнем совместимости 1400 и блокировала обновление токенов OAuth в источнике данных.
- Устранено аварийное завершение, которое могло происходить в SSMS при использовании недопустимых учетных данных для источника или при редактировании источников данных, которые не поддерживают миграцию с изменением источника данных в Power Query (например, Oracle) в табличных моделях Analysis Services с уровнем совместимости 1400.


### <a name="known-issues"></a>Известные проблемы

- Если после изменения любого свойства файловой группы в окне *Свойства* нажать кнопку *Скрипт*, создадутся два скрипта — один с инструкцией *USE <database>* и другой с инструкцией *USE master*.  Скрипт с инструкцией *USE master* формируется с ошибкой, и его необходимо отменить. Выполняйте только тот скрипт, который содержит инструкцию *USE <database>*.
- При работе с новыми выпусками базы данных SQL Azure (*общего назначения* или *критически важный для бизнеса*) в некоторых диалоговых окнах выводится сообщение о недопустимом выпуске.
- В средстве просмотра XEvents могут наблюдаться задержки. Это [известная проблема .NET Framework](https://github.com/Microsoft/dotnet/blob/master/releases/net472/dotnet472-changes.md#sql). Рекомендуем установить версию NetFx 4.7.2.




## <a name="downloadssdtmediadownloadpng-ssms-177httpsgomicrosoftcomfwlinklinkid873126"></a>![скачать](../ssdt/media/download.png) [SSMS 17.7](https://go.microsoft.com/fwlink/?linkid=873126)

Номер сборки: 14.0.17254.0<br>
Дата выпуска: 9 мая 2018 г.

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=873126&clcid=0x40a)


### <a name="whats-new"></a>новые возможности

**Общие ошибки SSMS**

Монитор репликации:   
- Монитор репликации теперь поддерживает регистрацию прослушивателя в сценариях, когда база данных издателя или база данных распространителя входит в группу доступности. Теперь можно отслеживать среды репликации, в которых база данных издателя или база данных распространителя входит в группу доступности AlwaysOn. 
 
Хранилище данных SQL Azure: 
- Добавлена поддержка расположения отклоненных строк для внешних таблиц в хранилище данных SQL Azure. 

**Integration Services (IS)**

- Добавлена функция для планирования выполнения пакетов SQL Server Integration Services, развернутых в базе данных SQL Azure. В отличие от локального сервера SQL Server и управляемого экземпляра базы данных SQL Azure, которые имеют полноценный планировщик заданий (агент SQL Server), база данных SQL Azure не имеет встроенного планировщика. Новая функция SSMS предоставляет знакомый пользовательский интерфейс для планирования выполнения пакетов, развернутых в базе данных SQL, который похож на аналогичный интерфейс агента SQL Server. Если база данных каталога SQL Server Integration Services (SSISDB) размещается в базе данных SQL, с помощью этой функции SSMS можно создать конвейеры, действия и триггеры фабрики данных, необходимые для планирования пакетов SQL Server Integration Services. Затем можно изменять и расширять эти объекты в фабрике данных. Дополнительные сведения см. в статье [Планирование выполнения пакета служб SSIS в базе данных SQL Azure с помощью SSMS](../integration-services/lift-shift/ssis-azure-schedule-packages-ssms.md). Дополнительные сведения о конвейерах, действиях и триггерах фабрики данных Azure см. в статьях [Конвейеры и действия в фабрике данных Azure](https://docs.microsoft.com/azure/data-factory/concepts-pipelines-activities) и [Выполнение конвейера и триггеры в фабрике данных Azure](https://docs.microsoft.com/azure/data-factory/concepts-pipeline-execution-triggers).
- Поддержка планирования выполнения пакетов SQL Server Integration Services в агенте SQL в управляемом экземпляре SQL. Теперь можно создавать задания агента SQL для выполнения пакетов SQL Server Integration Services в управляемом экземпляре. 

### <a name="bug-fixes"></a>Исправления ошибок

**Общие ошибки SSMS** 

План обслуживания:   
- Устранена проблема, из-за которой при попытке изменить расписание существующего плана обслуживания возникало исключение. Подробные сведения см. в описании ошибки [Аварийное завершение SSMS 17.6 при щелчке по расписанию в плане обслуживания](https://feedback.azure.com/forums/908035-sql-server/suggestions/33712924).

Always On: 
- Устранена проблема, из-за которой панель мониторинга задержки AlwaysOn не работала с SQL Server 2012.
 
Написание скриптов: 
- Устранена проблема, из-за которой создание скрипта на основе хранимой процедуры в хранилище данных SQL Azure не выполнялось для пользователя без прав администратора.
- Устранена проблема, из-за которой при создании скрипта на основе базы данных в базе данных SQL Azure в скрипт не включались свойства *SCOPED CONFIGURATION*.
 
Телеметрия: 
- Устранена проблема, из-за которой после отказа от отправки телеметрии происходило аварийное завершение SSMS, а затем выполнялась попытка подключиться к серверу.
 
База данных SQL Azure: 
- Устранена проблема, из-за которой пользователь не мог задать или изменить уровень доступности (раскрывающийся список был пуст). Примечание. Чтобы задать уровень совместимости 150, пользователю по-прежнему необходимо нажать кнопку *Скрипт* и вручную изменить скрипт. 
 
SMO: 
- В SMO стал доступен параметр "Размер журнала ошибок". Подробные сведения см. на странице [Задание максимального размера для журналов ошибок SQL Server](https://feedback.azure.com/forums/908035-sql-server/suggestions/33624115).  
- Исправлена проблема с переводом строки в скриптах в SMO для Linux.
- Различные улучшения производительности при извлечении редко используемых свойств.  

Технология IntelliSense: 
- Улучшение производительности: сокращен объем запросов IntelliSense для данных столбцов. Это особенно полезно при работе с таблицами, содержащими очень много столбцов. 

Параметры пользователя SSMS:
- Устранена проблема с изменением размеров страницы параметров.

Прочее:  
- Улучшено отображение текста на странице *Подробная статистика*. 

**Integration Services (IS)**

- Улучшена поддержка управляемого экземпляра базы данных SQL Azure.
- Устранена проблема, из-за которой пользователь не мог создать каталог для SQL Server 2014 или более ранней версии.
- Устранены две проблемы с отчетами:
   - Удалено имя компьютера для серверов Azure.
   - Улучшена обработка локализованных имен объектов.


### <a name="known-issues"></a>Известные проблемы

При работе с новыми выпусками базы данных SQL Azure (*общего назначения* или *критически важный для бизнеса*) в некоторых диалоговых окнах выводится сообщение о недопустимом выпуске.

## <a name="downloadssdtmediadownloadpng-ssms-176httpsgomicrosoftcomfwlinklinkid870039"></a>![скачать](../ssdt/media/download.png) [SSMS 17.6](https://go.microsoft.com/fwlink/?linkid=870039)

Номер сборки: 14.0.17230.0<br>
Дата выпуска: 20 марта 2018 г.

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=870039&clcid=0x40a)

### <a name="whats-new"></a>новые возможности

**Общие ошибки SSMS**

Управляемый экземпляр базы данных SQL:

- Добавлена поддержка [Управляемого экземпляра базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-managed-instance). Управляемый экземпляр базы данных SQL Azure предоставляет почти полную совместимость с локальным развертыванием SQL Server, собственную реализацию [виртуальной сети](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview), которая решает распространенные проблемы безопасности, и [бизнес-модель](https://azure.microsoft.com/pricing/details/sql-database/), подходящую клиентам локальных версий SQL Server.
- Поддержка распространенных сценариев управления, таких как:
   - создание и изменение баз данных;
   - резервное копирование и восстановление баз данных;
   - импорт, экспорт, извлечение и публикация приложений уровня данных;
   - просмотр и изменение свойств сервера;
   - полная поддержка обозревателя объектов;
   - создание скриптов для объектов базы данных;
   - поддержка заданий агента SQL;
   - поддержка связанных серверов.
- Дополнительные сведения об управляемых экземплярах можно найти [здесь](https://azure.microsoft.com/blog/migrate-your-databases-to-a-fully-managed-service-with-azure-sql-database-managed-instance/).

Обозреватель объектов:
- Добавлены параметры, отключающие принудительное заключение имен в скобки при перетаскивании из обозревателя объектов в окно запроса. (Предложения пользователей [32911933](https://feedback.azure.com/forums/908035-sql-server/suggestions/32911933) и [32671051](https://feedback.azure.com/forums/908035-sql-server/suggestions/32671051).)

Классификация данных:
- Общие усовершенствования и исправления ошибок.

**Integration Services (IS)**

- Добавлена поддержка развертывания пакетов в [Управляемом экземпляре базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-managed-instance).

### <a name="bug-fixes"></a>Исправления ошибок

**Общие ошибки SSMS**

Классификация данных:

- Устранена проблема с *классификацией данных*, из-за которой новые добавляемые классификации отображались с устаревшим *типом сведений* и *меткой конфиденциальности*.
- Устранена проблема, из-за которой *классификация данных* не работала для сервера с параметрами сортировки с учетом регистра.
        
Always On:

- Устранена проблема с панелью мониторинга групп доступности, из-за которой при выборе команды *Сбор данных по задержке* могла возникнуть ошибка, если для сервера были заданы параметры сортировки с учетом регистра.
- Устранена проблема, из-за которой в среде SSMS группа доступности неправильно отображалась как *распределенная* при завершении работы службы кластера.
- Устранена проблема, которая заключалась в том, что при создании группы доступности с помощью диалогового окна *Создание группы доступности* параметр *ReadOnlyRoutingUrl* был обязательным.
- Устранена проблема, из-за которой в случае сбоя сервера-источника и переходе на сервер-получатель вручную возникало исключение NullReferenceException.
- Устранена проблема, из-за которой при создании группы доступности с помощью резервного копирования и восстановления с целью инициализации базы данных во вторичных репликах файлы базы данных создавались в каталоге по умолчанию. Исправление заключается в следующем:
   - Добавлен проверяющий элемент управления для каталогов данных и журналов.
   - Файл перемещается, только если данная реплика и первичная реплика находятся в разных ОС.
- Устранена проблема, которая заключалась в том, что мастер SSMS не создавал параметр *CLUSTER_TYPE*, что приводило к сбою присоединения вторичной реплики.

Программа установки:
- Устранена проблема, из-за которой попытка обновить SSMS путем установки пакета обновления завершалась сбоем, если среда SSMS не была установлена в расположении по умолчанию.

SMO:
- Устранена проблема с производительностью, из-за которой создание скриптов для таблиц в SQL Server 2016 и более поздних версиях могло занимать до 30 секунд (теперь на это требуется менее 1 секунды).

Обозреватель объектов:
- Устранена проблема, из-за которой при попытке развернуть узел *Управление* в обозревателе объектов в SSMS могло возникать исключение наподобие следующего: "Невозможно привести объект типа DBNull к другим типам".
- Устранена проблема, из-за которой при выполнении команды *Запустить PowerShell* не обнаруживался модуль SQLServer в случае, если определенный пользователем профиль PowerShell создавал выходные данные.
- Исправлена проблема с периодическими зависаниями, которые могли происходить при щелчке правой кнопкой мыши по узлу таблицы или индекса в обозревателе объектов.

Database Mail:
- Устранена проблема, из-за которой *мастер настройки Database Mail* создавал исключение при попытке отображения более чем 16 профилей или управления ими.


**Analysis Services**

- Устранена проблема, из-за которой при изменении источника данных для модели с уровнем совместимости 1400 в среде SSMS изменения не сохранялись на сервере.

**Integration Services (IS)**

- Устранена проблема, из-за которой в среде SSMS не отображались узел каталога служб SSIS и отчеты при подключении к Управляемому экземпляру базы данных SQL Azure.

### <a name="known-issues"></a>Известные проблемы

> [!WARNING]
> Существует известная проблема, из-за которой среда SSMS 17.6 работает нестабильно и происходит ее сбой при использовании [планов обслуживания](../relational-databases/maintenance-plans/maintenance-plans.md). Если вы используете планы обслуживания, не устанавливайте SSMS 17.6. Если вы уже установили версию 17.6 и эта проблема вас коснулась, перейдите на более раннюю версию SSMS 17.5. 



## <a name="downloadssdtmediadownloadpng-ssms-175httpsgomicrosoftcomfwlinklinkid867670"></a>![скачать](../ssdt/media/download.png) [SSMS 17.5](https://go.microsoft.com/fwlink/?linkid=867670)
Общедоступная версия | Номер сборки: 14.0.17224.0

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=867670&clcid=0x40a)

### <a name="whats-new"></a>новые возможности

**Общие ошибки SSMS**

Обнаружение и классификация данных

- Добавлена новая функция обнаружения и классификации данных SQL для обнаружения конфиденциальных данных в базах данных, их классификации, назначения им меток и создания отчетов. 
- Автоматическое обнаружение и классификация наиболее важных данных (деловых, финансовых, персональных и т. д.) может играть ключевую роль в защите информации в вашей организации.
- Дополнительные сведения об [обнаружении и классификации данных SQL](../relational-databases/security/sql-data-discovery-and-classification.md).

Редактор запросов:

- Добавлена поддержка параметра SkipRows в формате внешних текстовых файлов с разделителями для хранилища данных SQL Azure. Он позволяет пользователям пропускать указанное число строк при загрузке текстовых файлов с разделителями в хранилище данных SQL. Кроме того, добавлена поддержка ключевого слова FIRST_ROW для IntelliSense и SMO. 

Showplan

- Появилась кнопка предполагаемого плана для хранилища данных SQL
- Добавлен новый атрибут showplan *EstimateRowsWithoutRowGoal*; в *QueryTimeStats* добавлены новые атрибуты showplan: *UdfCpuTime* и *UdfElapsedTime*. Дополнительные сведения см. в статье [Добавление сведений о цели строки оптимизатора в план выполнения запроса в SQL Server 2017 с накопительным пакетом обновления 3](http://support.microsoft.com/help/4051361).



### <a name="bug-fixes"></a>Исправления ошибок

**Общие ошибки SSMS**

Showplan

- Исправлено значение затраченного времени в статистике активных запросов: вместо затраченного времени подключения к статистике активных запросов отображается время выполнения подсистемы.
- Исправлена проблема, из-за которой отчету showplan не удавалось распознать логические операторы Apply, такие как GbApply и InnerApply.
- Исправлена проблема, связанная с ExchangeSpill.

Редактор запросов:

- Исправлена проблема, связанная с кодами SPID, из-за которой в SSMS могла возникать ошибка типа "Входная строка имела неверный формат. (mscorlib)" при выполнении простого запроса с предшествующей инструкцией "SET SHOWPLAN_ALL ON". 


SMO:

- Исправлена проблема, из-за которой SMO не удавалось получить свойства AvailabilityReplica, если в параметрах сортировки сервера учитывался регистр символов. В результате в SSMS могло появляться сообщение об ошибке наподобие следующего: "Не удалось выполнить привязку составного идентификатора a.delimited".
- Исправлена проблема в классе DatabaseScopedConfigurationCollection, из-за которой параметры сортировки обрабатывались неправильно. Из-за нее в SSMS на компьютере ma с турецким языковым стандартом могла возникать ошибка типа "Оценка унаследованной кратности не является допустимой конфигурацией области" при щелчке правой кнопкой мыши по базе данных, выполняющейся на сервере с параметрами сортировки с учетом регистра символов.
- Исправлена проблема в классе JobServer, из-за которой SMO не удавалось получить свойства агента SQL на сервере SQL 2005. В результате в SSMS возникала ошибка типа "Невозможно присвоить значение по умолчанию локальной переменной. Должна быть объявлена скалярная переменная \@ServiceStartMode", и в обозревателе объектов не отображался узел агента SQL.

Шаблоны 

- Database Mail: исправлено несколько опечаток [(https://feedback.azure.com/forums/908035/suggestions/33143512)](https://feedback.azure.com/forums/908035/suggestions/33143512).  

Обозреватель объектов:
- Устранена проблема, из-за которой управляемое сжатие завершалось сбоем для индексов (https://feedback.azure.com/forums/908035-sql-server/suggestions/32610058-ssms-17-4-error-when-enabling-page-compression-o).

Аудит.
- Исправлена проблема с функцией *Объединение файлов аудита*.
<br>

### <a name="known-issues"></a>Известные проблемы

Классификация данных
- Удаление классификации и последующее добавление новой классификации для того же столбца вручную приводят к тому, что в главном представлении столбцу назначаются прежние тип сведений и метка конфиденциальности.<br>
*Решение*. Назначьте новые тип сведений и метку конфиденциальности после добавления классификации в главном представлении и перед сохранением изменений.


## <a name="downloadssdtmediadownloadpng-ssms-174httpsgomicrosoftcomfwlinklinkid864329"></a>![скачать](../ssdt/media/download.png) [SSMS 17.4](https://go.microsoft.com/fwlink/?linkid=864329)
Общедоступная версия | Номер сборки: 14.0.17213.0

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=864329&clcid=0x40a)


### <a name="whats-new"></a>новые возможности

**Общие ошибки SSMS**

Оценка уязвимостей:
- Добавлена новая служба оценки уязвимости SQL, которая проверяет базы данных на наличие потенциальных уязвимостей и отклонений от рекомендаций, например неверных настроек, избыточных разрешений и незащищенных конфиденциальных данных. 
- Результаты оценки включают в себя практические действия по устранению каждой проблемы, а также настроенные скрипты исправления, если это возможно. Отчет об оценке можно настроить для конкретной среды и конкретных требований. Дополнительные сведения об [оценке уязвимостей SQL](https://docs.microsoft.com/sql/relational-databases/security/sql-vulnerability-assessment).

SMO:
- Исправлена проблема, из-за которой свойство *HasMemoryOptimizedObjects* вызывало исключение в Azure.
- Добавлена поддержка новой функции CATALOG_COLLATION.

Панель мониторинга AlwaysOn:
- Усовершенствован анализ задержек в группах доступности.
- Добавлены два новых отчета: *AlwaysOn\_Latency\_Primary* и *AlwaysOn\_Latency\_Secondary*.

Showplan
- Обновленные ссылки указывают на правильную документацию.
- Анализ отдельного плана выполняется непосредственно на основе фактического плана.
- Создан новый набор значков.
- Добавлена поддержка для распознания логических операторов применения, например GbApply, InnerApply.
        
XE Profiler:
- Переименован в XEvent Profiler.
- Теперь при помощи команд меню для остановки и запуска сеанс останавливается и запускается по умолчанию.
- Включена поддержка сочетаний клавиш (например, CTRL+F для поиска).
- Добавлены действия database\_name и client\_hostname для соответствующих событий в сеансах XEvent Profiler. Чтобы изменения вступили в силу, возможно, потребуется удалить существующие экземпляры сеансов QuickSessionStandard или QuickSessionTSQL на серверах. Дополнительные сведения см. на странице [Connect 3142981](https://connect.microsoft.com/SQLServer/feedback/details/3142981).

Командная строка:
- Добавлен новый параметр командной строки (-G), с помощью которого SSMS может автоматически подключаться к серверу или базе данных с использованием аутентификации Active Directory (встроенная аутентификация или аутентификация с помощью пароля). Дополнительные сведения см. в статье [Программа SSMS](ssms-utility.md).

Мастер импорта неструктурированных файлов:
- Теперь при создании таблицы можно выбирать другое имя схемы, помимо стандартного (dbo).

Хранилище запросов
- Восстановлен отчет о регрессивных запросах, отображающийся при развертывании списка доступных отчетов хранилища запросов.

**Integration Services (IS)**
- Добавлена функция проверки пакета в мастере развертывания, которая помогает пользователям найти внутри пакетов SSIS компоненты, не поддерживающиеся в IR Azure SSIS.

### <a name="bug-fixes"></a>Исправления ошибок

**Общие ошибки SSMS**

- Обозреватель объектов: устранена проблема, из-за которой в моментальных снимках базы данных не отображался узел функции с табличным значением. Дополнительные сведения см. на странице [Connect 3140161](https://connect.microsoft.com/SQLServer/feedback/details/3140161).
Повышена производительность при расширении узла *баз данных*, когда на сервере установлено автоматическое закрытие базы данных.
- Редактор запросов: устранена проблема, из-за которой у пользователей без доступа к базе данных master не работала функция IntelliSense.
Устранена проблема, из-за которой программа SSMS аварийно завершала работу при закрытии подключения к удаленному компьютеру. Дополнительные сведения см. на странице [Connect 3142557](https://connect.microsoft.com/SQLServer/feedback/details/3142557).
- Средство просмотра XEvent: снова включена возможность экспорта в XEL.
Исправлены ошибки, из-за которых иногда пользователь не мог загрузить XEL-файл полностью.
- Профилировщик XEvent: устранена проблема, из-за которой программа SSMS аварийно завершала работу, если у пользователя не было разрешения *VIEW SERVER STATE*.
Устранена проблема, из-за которой после закрытия окна интерактивных данных XE Profiler соответствующий сеанс не останавливался.
- Зарегистрированные серверы: устранена проблема, из-за которой не работала команда "Переместить в..." — см. описания [Connect 3142862](https://connect.microsoft.com/SQLServer/feedback/details/3142862) и [Connect 3144359](https://connect.microsoft.com/SQLServer/feedback/details/3144359/).
- SMO: устранена проблема, из-за которой метод TransferData на передавал объекты.
Устранена проблема, из-за которой базы данных сервера создавали исключение для приостановленных баз данных хранилища данных SQL.
Устранена проблема, из-за которой создающая скрипты для хранилища данных SQL база данных SQL формировала неверные значения параметра T-SQL.
Устранена проблема, из-за которой при написании скриптов расширенной базы данных ошибочно выдавался параметр *DATA\_COMPRESSION*.
- Монитор активности заданий: устранена проблема, из-за которой при попытке фильтрации по категории поступало сообщение об ошибке "Индекс вне диапазона. Must be non-negative and less than the size of the collection. 
      Parameter name: index (System.Windows.Forms)" (Индекс вне допустимого диапазона. Значение не может быть отрицательным и меньшим, чем размер коллекции. Имя параметра: index (System.Windows.Forms)). Дополнительные сведения см. на странице [Connect 3138691](https://connect.microsoft.com/SQLServer/feedback/details/3138691).
- Диалоговое окно подключения: устранена проблема, из-за которой пользователи домена без прав чтения и записи в контроллере домена не могли войти на платформу SQL Server с помощью аутентификации SQL. Дополнительные сведения см. на странице [Connect 2373381](https://connect.microsoft.com/SQLServer/feedback/details/2373381).
- Репликация: устранена проблема, из-за которой при просмотре свойств подписки по запросу на платформе SQL Server отображалось сообщение об ошибке "Не удается применить значение null к свойству ServerInstance".
- Установка SSMS: устранена проблема, из-за которой установка SSMS приводила к изменению конфигурации всех установленных продуктов на компьютере.
- Параметры пользователя:
   - При помощи этого исправления независимым пользователям облака для государственных организаций США предоставлен непрерывный доступ к их базе данных SQL Azure и ресурсам Azure Resource Manager из SSMS посредством универсальной аутентификации и входа в Azure Active Directory.  Пользователям предыдущих версий SSMS нужно открыть меню "Сервис | Параметры | Службы Azure" и в группе управления ресурсами изменить значение свойства "Центр Active Directory" на https://login.microsoftonline.us.

**Analysis Services**

- Profiler: исправлена проблема, из-за которой не удавалось подключиться к автономной системе Azure с помощью аутентификации Windows.
- Исправлена проблема, которая могла вызывать аварийное завершение работы при отмене сведений о подключении в модели 1400.
- При задании ключа больших двоичных объектов Azure в диалоговом окне свойств подключения во время обновления учетных данных ключ теперь визуально маскируется.
- Устранена проблема, из-за которой в диалоговом окне выбора пользователя Azure Analysis Services при поиске отображался GUID идентификатора приложения вместо идентификатора объекта.
- Устранена проблема, из-за которой на панели инструментов в конструкторе запросов для базы данных и MDX значки некоторых кнопок неправильно отображались.
- Исправлена проблема, которая препятствовала подключению к SSAS по адресам HTTP и HTTPS при помощи расширения msmdpump служб IIS.
- Несколько строк в диалоговом окне выбора пользователей Azure Analysis Services теперь переведены на другие языки.
- Свойство MaxConnections теперь отображается для источников данных в табличных моделях.
- Теперь мастер развертывания создает правильные определения JSON для членов роли автономной системы Azure.
- Устранена проблема в SQL Profiler, из-за которой при выборе аутентификации Windows для автономной системы Azure все равно отображался запрос на вход.



## <a name="downloadssdtmediadownloadpng-ssms-173httpsgomicrosoftcomfwlinklinkid858904"></a>![скачать](../ssdt/media/download.png) [SSMS 17.3](https://go.microsoft.com/fwlink/?linkid=858904)
Общедоступная версия | Номер сборки: 14.0.17199.0

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=858904&clcid=0x40a)


### <a name="enhancements"></a>Улучшения

- Добавлен новый мастер импорта неструктурированных файлов, работающий на базе интеллектуальной платформы, которая упрощает процесс импорта CSV-файлов и не требует от пользователей многочисленных действий или специализированных знаний. Дополнительные сведения см. в разделе [Мастер импорта неструктурированных файлов в SQL](../relational-databases/import-export/import-flat-file-wizard.md).
- В обозреватель объектов добавлен узел XEvent Profiler. Дополнительные сведения см. в разделе [Использование SSMS XEvent Profiler](../relational-databases/extended-events/use-the-ssms-xe-profiler.md).
- Обновлена фильтрация и классификация ожиданий в отчете об истории ожиданий из панели мониторинга производительности.
- Добавлена проверка синтаксиса функции Predict.
- Добавлена проверка синтаксиса запросов в функции управления внешними библиотеками.
- Добавлена поддержка SMO для управления внешними библиотеками.
- Добавлена поддержка запуска PowerShell в окне "Зарегистрированные серверы" (требуется новый модуль PowerShell для SQL).
- AlwaysOn: добавлена [поддержка маршрутизации запросов только для чтения](../database-engine/availability-groups/windows/configure-read-only-routing-for-an-availability-group-sql-server.md) для групп доступности.
- Добавлена возможность отправлять в окно вывода данные трассировки по входам с использованием проверки подлинности "Active Directory — универсальная с поддержкой MFA". По умолчанию эта функция отключена, и ее нужно включить в параметрах пользователя, последовательно выбрав "Сервис" > "Параметры" > "Службы Azure" > "Облако Azure" > "Уровень трассировки для окна вывода ADAL". 
- Хранилище запросов 
  - Пользовательский интерфейс хранилища запросов доступен, даже когда служба QDS отключена, при условии, что она записала какие-либо данные.
  - Пользовательский интерфейс хранилища запросов теперь предоставляет классификацию ожиданий во всех существующих отчетах. За счет этого пользователям будут доступны сценарии "Топ ожидающих запросов" и многие другие.
- Включать заголовки параметров сценариев стало необязательно. По умолчанию эта возможность отключена, и ее можно включить в параметрах пользователя, последовательно выбрав "Сервис" > "Параметры" > "Обозреватель объектов SQL Server" > "Сценарии" > "Включить заголовок с параметрами сценариев". Это связано с [элементом Connect 3139199](https://connect.microsoft.com/SQLServer/feedback/details/3139199).
- Удалена фирменная символика "RC".

### <a name="bug-fixes"></a>Исправления ошибок

**Общие ошибки SSMS**

- XEvent 
   - Исправлена проблема, когда SSMS открывает только часть событий в XEL-файле.
   - Улучшен интерфейс "Интерактивного просмотра данных", когда база данных по умолчанию не является "master". Это связано с [элементом Connect 1222582](https://connect.microsoft.com/SQLServer/feedback/details/1222582).
- AlwaysOn: исправлена проблема, из-за которой функция "Восстановление архивных копий журнала" могла не сработать и выдавала ошибку "Журнал в этом резервном наборе данных завершается на номере LSN x, что слишком рано для использования в базе данных".
- Монитор активности заданий: исправлены несогласованные значки. Это связано с [элементом Connect 3133100](https://connect.microsoft.com/SQLServer/feedback/details/3133100).
- Хранилище запросов: исправлена проблема, когда пользователь не может выбрать настраиваемый диапазон дат для отчетов хранилища запросов. Это связано с элементами Connect, указанными ниже.
   - [Элемент Connect 3139842](https://connect.microsoft.com/SQLServer/feedback/details/3139842)
   - [Элемент Connect 3139399](http://connect.microsoft.com/SQLServer/feedback/details/3139399)
- Исправлена проблема, когда диалоговое окно подключения не "очищало" последнюю использованную базу данных, если в сохраненных сведениях имелась именованная база данных и пользователь выбирал <default>.
- Объектные сценарии: исправлена проблема, когда пункт "Создать сценарий базы данных" не работал и вызывал ошибку, если пользователь приостанавливал базу данных DW на сервере, но выбирал другую базу данных, отличную от DW, и пытался создавать в ней сценарии.
Исправлена проблема, когда заголовок для включенных в сценарий хранимых процедур не соответствовал параметрам сценария, из-за чего сценарий мог быть непонятным. См. [Connect 3139784](http://connect.microsoft.com/SQLServer/feedback/details/3139784).
Снова включена "Кнопка со сценарием" при использовании в качестве цели объектов SQL Azure.
  Исправлена проблема, когда служба SSMS не разрешала использовать сценарии "Изменить" или "Выполнить" для некоторых объектов (определяемых пользователем функций, представлений, хранимых процедур, триггеров) при подключении к базе данных SQL Azure. См. [Connect 3136386](https://connect.microsoft.com/SQLServer/feedback/details/3136386).
- Редактор запросов
  - Улучшена работа IntelliSense, когда целевыми объектами являются базы данных SQL Azure.
  - Исправлена проблема, когда запросы не срабатывали из-за истекшего токена проверки подлинности (универсальная проверка подлинности).
  - Улучшена работа IntelliSense при использовании с базами данных SQL Azure (в частности, при подключении к базе данных SQL Azure будет использоваться новейшая грамматика T-SQL — 140).
  - Исправлена проблема, когда после открытия на сервере окна запросов с подключением к базе данных, отличной от DataWarehouse, во всех последующих окнах запросов с этого сервера к базам данных DataWarehouse возникали разнообразные ошибки с сообщениями о неподдерживаемых типах или параметрах.
- Always On:
   - На панель мониторинга AlwaysOn и страницу свойств групп доступности добавлен столбец режима заполнения.
   - Исправлена проблема, когда невозможно было создать группу доступности Linux, если основная группа находилась в Windows. Это связано с [элементом Connect 3139856](https://connect.microsoft.com/SQLServer/feedback/details/3139856).
- Исправлено несколько проблем "Недостаточно памяти" при запуске запросов в SSMS: [элемент Connect 2845190](https://connect.microsoft.com/SQLServer/feedback/details/2845190), [элемент Connect 3123864](https://connect.microsoft.com/SQLServer/feedback/details/3123864).
- Profiler 
   - Исправлена проблема, когда профилировщик не работал при разработке для SQL 2005.
   - Исправлена проблема, когда для Profiler не действовал параметр подключения "Доверять сертификату сервера".
- Монитор активности: исправлена проблема, когда монитор активности не работал с SQL Server в среде Linux.
- Исправлена проблема с классом передачи SMO, когда объекты внешнего источника данных или формата внешнего файла не передавались. Теперь объекты этих типов будут корректно включаться в передачу.
- Зарегистрированные серверы
   - Реализована поддержка многосерверных запросов для серверов универсальной проверки подлинности (для каждого такого сервера в группе будет пробоваться один и тот же токен).
- Универсальная проверка подлинности AD
   - Исправлена проблема, когда проверка подлинности Azure AD не поддерживалась.
   - Исправлена проблема, при которой не работал конструктор представлений или таблиц.
   - Исправлена проблема, при которой пункты "Выделить 1000 верхних строк" и "Изменить 200 верхних строк" не работали.
- Восстановление базы данных: исправлена проблема, когда при перемещении файлов в другое местоположение восстановление пропускало последнюю папку в указанном пути.
- Мастер сжатия
   - Исправлена проблема с мастером управления сжатием, связанная с индексами; исправлена проблема, из-за которой мастер сжатия данных не работал в SQL 2016 и более ранних версиях.
        https://connect.microsoft.com/SQLServer/feedback/details/3139342
   - Мастер сжатия добавлен к таблицам и индексам Azure.
- Showplan 
   - Исправлена проблема, из-за которой операторы PDW не распознавались.
- Свойства сервера
   - Исправлена проблема, когда не удавалось изменить сходство процессоров серверов.


**Analysis Services**

- Исправлен ряд проблем с мастером развертывания, связанных с поддержкой табличных моделей уровня совместимости 1400 и источников данных Power Query.
- Теперь мастер развертывания может выполнять развертывание в Azure Analysis Services при запуске из командной строки.
- При использовании проверки подлинности Windows в Azure Analysis Services имя учетной записи пользователя теперь будет корректно отображаться в обозревателе объектов.


### <a name="known-issues-in-this-173-release"></a>Известные проблемы в выпуске 17.3

**Общие ошибки SSMS**

- При использовании универсальной многофакторной проверки подлинности в Azure AD следующие функциональные возможности SSMS не поддерживаются.
   - Для проверки подлинности Azure AD не поддерживается помощник по настройке ядра СУБД. Имеется известная проблема, когда пользователь получает довольно непонятное сообщение об ошибке "Не удалось загрузить файл или сборку Microsoft.IdentityModel.Clients.ActiveDirectory…" вместо правильного сообщения "Помощник по настройке ядра СУБД не поддерживает Базу данных SQL Microsoft Azure. (DTAClient)".
- При попытке проанализировать запрос в DTA появляется сообщение об ошибке "Объект должен реализовать IConvertible. (mscorlib)".
- В списке отчетов хранилища запросов из обозревателя объектов отсутствуют *Регрессионные запросы*.
   - Обходное решение: щелкните правой кнопкой мыши узел **Хранилище запросов** и выберите **Просмотр регрессионных запросов**.

**Integration Services (IS)**

- Для выполнения пакетов в Scale Out указан некорректный [путь_выполнения] в элементе [каталог].[сообщения_событий]. Путь [execution_path] начинается с "\Package", а не с имени объекта исполняемого файла пакета. При просмотре обзорного отчета по выполнению пакетов в SSMS ссылка "Путь выполнения" в обзоре выполнения не работает. Обходное решение: щелкните "Просмотреть сообщения" в обзорном отчете, чтобы проверить все сообщения событий.


## <a name="downloadssdtmediadownloadpng-ssms-172httpsgomicrosoftcomfwlinklinkid854085"></a>![скачать](../ssdt/media/download.png) [SSMS 17.2](https://go.microsoft.com/fwlink/?linkid=854085)
Общедоступная версия | Номер сборки: 14.0.17177.0

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=854085&clcid=0x40a)

### <a name="enhancements"></a>Улучшения

- Многофакторная идентификация (MFA)
  - Проверка подлинности нескольких пользователей Azure AD с помощью универсальной проверки подлинности с Многофакторной идентификацией (MFA)
  - Было добавлено новое поле ввода учетных данных пользователей для поддержки проверки подлинности нескольких пользователей с помощью универсальной проверки подлинности с Многофакторной идентификацией.
- Диалоговое окно подключения теперь поддерживает следующие 5 способов проверки подлинности:
  - Проверка подлинности Windows.
  - Проверка подлинности SQL Server
  - Active Directory — универсальная с поддержкой MFA
  - Active Directory — пароль
  - Active Directory — встроенная

- Импорт и экспорт базы данных для мастера DacFx с использованием универсальной проверки подлинности с MFA.
- Сведения о поддержке API см. в описании [интерфейса IUniversalAuthProvider](https://msdn.microsoft.com/library/microsoft.sqlserver.dac.iuniversalauthprovider.aspx).
- Управляемая библиотека ADAL, используемая для универсальной проверки подлинности Azure AD с MFA, обновлена до версии 3.13.9.
- Кроме того, реализован новый интерфейс командной строки (CLI) с поддержкой параметров администрирования Azure AD для Базы данных SQL и хранилища данных SQL.

 Дополнительные сведения о способах проверки подлинности Active Directory см. в статьях [Универсальная проверка подлинности для Базы данных SQL и хранилища данных SQL (поддержка SSMS для MFA)](https://docs.microsoft.com/azure/sql-database/sql-database-ssms-mfa-authentication) и [Настройка Многофакторной идентификации Базы данных SQL Azure для SQL Server Management Studio](https://docs.microsoft.com/azure/sql-database/sql-database-ssms-mfa-authentication-configure).

- В окне вывода приводятся записи, связанные с запросами, которые выполнялись во время развертывания узлов обозревателя объектов.
- Включен конструктор представлений для Баз данных SQL Azure.
- Изменились параметры скриптов для объектов в обозревателе объектов SQL Server Management Studio.
  - Ранее после первоначальной установки создаваемые скрипты по умолчанию предназначались для последней версии SQL Server (в настоящее время это версия SQL Server 2017).
  - В SQL Server Management Studio 17.2 был добавлен новый параметр: *Использовать параметры сценариев согласно источнику*. Если он имеет значение *Истина*, создаваемый скрипт будет предназначен для той же версии, типа ядра и выпуска ядра, которые используются на сервере, где находится объект, для которого создается скрипт.
  - Параметр *Использовать параметры сценариев согласно источнику* имеет значение *Истина* по умолчанию, поэтому в новой установке SQL Server Management Studio скрипты объектов будут автоматически создаваться для того же целевого ядра, что и на исходном сервере.
  - Если присвоить параметру *Использовать параметры сценариев согласно источнику* значение *Ложь*, будут использоваться обычные, то есть использовавшиеся ранее параметры назначения скриптов.
Кроме того, все параметры написания скриптов были перемещены в отдельный раздел *Параметры версий*. Они больше не приводятся в разделе *Общие параметры скрипта*.

- Добавлена поддержка национальных облаков при восстановлении по URL-адресу.
- Отчеты QueryStoreUI теперь поддерживают дополнительные метрики (число строк, DOP, время CLR и другие) из sys.query_store_runtime_stats.
- Технология IntelliSense теперь поддерживается для базы данных SQL Azure https://connect.microsoft.com/SQLServer/feedback/details/3100677/ssms-2016-would-be-nice-to-have-intellisense-on-azure-sql-databases
- Безопасность: в диалоговом окне подключения по умолчанию отключено доверие к сертификатам сервера и включен запрос шифрования для подключений к Базе данных SQL Azure.
- Общие усовершенствования, касающиеся поддержки SQL Server в Linux:
 - Снова появился узел компонента Database Mail.
 - Устранены различные проблемы, связанные с путями.
 - Повышена стабильность работы монитора активности.
 - В диалоговом окне "Свойства соединения" правильно указывается платформа.
- Отчет панели мониторинга производительности по серверу теперь доступен как отчет по умолчанию.
  - Возможность подключения к SQL Server 2008 и более поздним версиям.
  - Во вложенном отчете об отсутствующих индексах используются оценки, которые помогают определять наиболее полезные индексы.
  - В историческом вложенном отчете по статистике ожидания операции ожидания теперь объединяются по категориям. Ожидания в режиме простоя или спящем режиме по умолчанию отфильтровываются.
  - Новый исторический вложенный отчет о кратковременных блокировках.
- В узле showplan можно выполнять поиск по свойствам плана. Вы можете легко находить любое свойство оператора, например имя таблицы. Чтобы использовать эту возможность при просмотре плана, выполните одно из указанных ниже действий.
  - Щелкните план правой кнопкой мыши, а затем в контекстном меню выберите пункт "Найти узел".
  - Нажмите клавиши CTRL+F.


**Analysis Services**

- Новая возможность выбора пользователей, не имеющих адресов электронной почты, в качестве участников ролей AAD в моделях Analysis Services Azure в проектах SSMS.

**Integration Services (IS)**

- В отчет о выполнении для SSIS добавлен новый столбец ("Число выполненных").

### <a name="known-issues-in-this-release"></a>Известные проблемы в этом выпуске:

- В окнах запросов, в которых используется проверка подлинности "Active Directory — универсальная с поддержкой MFA", может возникать ошибка наподобие следующей при попытке выполнить запрос после того, как окно было открыто в течение часа:

   `Msg 0, Level 11, State 0, Line 0
The connection is broken and recovery is not possible. The client driver attempted to recover the connection one or more times and all attempts failed. Increase the value of ConnectRetryCount to increase the number of recovery attempts.`

   При повторном выполнении запроса эта ошибка возникать не должна.

- При использовании в Azure AD универсальной проверки подлинности с MFA перечисленные ниже функциональные возможности SSMS не поддерживаются.
  - В конструкторе **новой таблицы или представления** выводится запрос на вход в старом стиле и не поддерживается проверка подлинности Azure AD.
  - Функция **Изменить первые 200 строк** не поддерживает проверку подлинности Azure AD.
  - Компонент **Зарегистрированный сервер** не поддерживает проверку подлинности Azure AD.
  - **Помощник по настройке ядра СУБД** не поддерживает проверку подлинности Azure AD. Имеется известная проблема, вследствие которой пользователю выводится сообщение об ошибке *Не удалось загрузить файл или сборку Microsoft.IdentityModel.Clients.ActiveDirectory…* вместо правильного сообщения *Помощник по настройке ядра СУБД не поддерживает Базу данных SQL Microsoft Azure. (DTAClient)*.

**Analysis Services**

- В обозревателе объектов SSAS не отображается имя пользователя для проверки подлинности Windows в свойствах подключения Analysis Services Azure.

### <a name="bug-fixes"></a>Исправления ошибок

- Исправлена проблема, возникавшая при попытке напечатать результаты запроса (в виде текста).  https://connect.microsoft.com/SQLServer/feedback/details/3055225/
- Исправлена проблема, из-за которой в SSMS неправильно удалялись таблицы и другие объекты при создании скриптов для удаления таких объектов в базе данных SQL Azure.
- Исправлена проблема, из-за которой среда SSMS иногда не запускалась и выводилось сообщение об ошибке "Не удается найти один или несколько компонентов. Переустановите приложение".
- Исправлена проблема, из-за которой идентификатор SPID в пользовательском интерфейсе SSMS мог оказаться несинхронизированным и устаревшим. https://connect.microsoft.com/SQLServer/feedback/details/1898875
- Исправлена проблема в программе автоматической установки SSMS, из-за которой аргумент /passive обрабатывался как /quiet.
- Исправлена проблема, из-за которой при запуске SSMS иногда возникала ошибка "Ссылка на объект не указывает на экземпляр объекта". http://connect.microsoft.com/SQLServer/feedback/details/3134698
- Исправлена проблема в мастере сжатия данных, которая приводила к аварийному завершению работы SSMS при нажатии кнопки "Вычислить" в таблице графика.
- Исправлена проблема с производительностью при щелчке правой кнопкой мыши по индексу таблицы (при медленном подключении к Интернету). https://connect.microsoft.com/SQLServer/feedback/details/3120783
- Исправлена проблема, из-за которой среде SSMS не удавалось перечислить файлы резервной копии на серверах с параметрами сортировки с учетом регистра. http://connect.microsoft.com/SQLServer/feedback/details/3134787 и https://connect.microsoft.com/SQLServer/feedback/details/3137000
- Различные исправления, касающиеся отчета showplan и сравнения showplan.
- Исправлена проблема, из-за которой в диалоговом окне подключения пользователь не мог указать сетевой протокол для подключения, если SQL Server не был установлен на компьютере со средой SSMS. https://connect.microsoft.com/SQLServer/feedback/details/3134997
- Улучшена поддержка конфигураций с несколькими мониторами: устранена проблема, из-за которой некоторые диалоговые окна SSMS отображались в произвольных местах. В разделе "Обозреватель объектов SQL Server | Команды" добавлен новый параметр "Диалоговые окна задачи", позволяющий запоминать положение диалогового окна задачи или страницы свойств после их закрытия. https://connect.microsoft.com/SQLServer/feedback/details/889169, https://connect.microsoft.com/SQLServer/feedback/details/1158271, https://connect.microsoft.com/SQLServer/feedback/details/3135260 
- Исправлена проблема, из-за которой среде SSMS не удавалось изменить свойства зашифрованной Базы данных SQL Azure.
- Оптимизирован параметр "Отбросить результаты после выполнения". https://connect.microsoft.com/SQLServer/feedback/details/1196581
- Исправлена проблема, из-за которой пользователям не удавалось получить доступ к подпискам Azure, администраторами которых они не являлись.
- Улучшен мастер восстановления базы данных: выбор конечной базы данных в обозревателе объектов сохраняется вне зависимости от выбранной базы данных-источника. https://connect.microsoft.com/SQLServer/feedback/details/3118581
- Исправлена проблема, из-за которой в обозревателе объектов не сортировались компилируемые в собственном коде хранимые процедуры, добавленные неправильно. http://connect.microsoft.com/SQLServer/feedback/details/3133365
- Исправлена проблема, возникавшая, если в инструкции "SELECT TOP n ROWS" отсутствовало предложение TOP для хранилища данных SQL Azure. https://connect.microsoft.com/SQLServer/feedback/details/3133551 и https://connect.microsoft.com/SQLServer/feedback/details/3135874
- Пользовательский интерфейс хранилища запросов: исправлена проблема, из-за которой ненастраиваемые интервалы времени работали неправильно для некоторых отчетов.
- Always Encrypted. Улучшен обмен сообщениями для состояния разрешения AKV в диалоговом окне создания главного ключа столбца. В раскрывающемся списке ключей шифрования столбцов (CEK) добавлены подсказки, упрощающие различение ключей CEK с длинными именами. Исправлена проблема, из-за которой некоторые поставщики хранилища ключей CNG не отображались в диалоговом окне "Новый главный ключ столбца" для Always Encrypted.
- Исправлена несогласованность имени приложения для подключений SSMS. http://connect.microsoft.com/SQLServer/feedback/details/3135115
- Исправлена проблема, из-за которой среда SSMS неправильно создавала скрипты для SQL Azure (таблиц и индексов с параметром DATA_COMPRESSIONS). https://connect.microsoft.com/SQLServer/feedback/details/3133148
- Исправлена проблема, из-за которой пользователь не мог использовать сочетание клавиш CTRL+Q для быстрого запуска. (Примечание. Новые сочетание клавиш для включения и отключения параметра "Технология IntelliSense включена" в редакторе запросов — CTRL+B и CTRL+I.) https://connect.microsoft.com/SQLServer/feedback/details/3131968
- Исправлена проблема в мастере восстановления базы данных, из-за которой в SSMS создавалось исключение при попытке выбрать учетную запись хранения из подписки, содержащей учетные записи с личными доменами.
- Исправлена проблема в компоненте "Диаграмма базы данных", из-за которой в SSMS возникала ошибка "Индекс находился вне границ массива", а пользователь мог изменить режим таблицы только на стандартный. https://connect.microsoft.com/SQLServer/feedback/details/3133792 и http://connect.microsoft.com/SQLServer/feedback/details/3135326
- Исправлена проблема при резервном копировании или восстановлении по URL-адресу, из-за которой в SSMS не перечислялись классические учетные записи хранения.
- Исправлена проблема, из-за которой при попытке добавить защищаемые объекты, привязанные к схеме, к ролям базы данных создавалось исключение. https://connect.microsoft.com/SQLServer/feedback/details/3118143
- Исправлена проблема, из-за которой в SSMS периодически выводилось сообщение об ошибке "Неопределенные данные. Этот метод или свойство не может вызываться для значений, равных Null". при развертывании узла таблицы http://connect.microsoft.com/SQLServer/feedback/details/3136283
- DTA: исправлена проблема, из-за которой процесс DTAEngine.exe завершался вследствие повреждения кучи при вычислении функции секционирования с определенными граничными значениями.


**Analysis Services**

- Исправлена проблема, из-за которой восстановление базы данных Analysis Services завершалось ошибкой, если имя базы данных отличалось от идентификатора.
- Исправлена проблема, из-за которой в окне запроса DAX игнорировался пункт меню, предназначенный для включения и отключения технологии IntelliSense.
- Исправлена проблема, которая препятствовала подключению к SSAS по адресам HTTP и HTTPS расширения msmdpump служб IIS.
- Разрешено подключение к Analysis Services Azure с использованием пароля, содержащего точку с запятой.
- При написании скрипта для команды восстановления базы данных Analysis Services с параметром "Пропустить членство" включается новый параметр JSON, если используется сервер SQL Server 2017 Analysis Services или Analysis Services Azure.
- Исправлена крайне редко возникающая проблема, которая могла приводить к ошибке при загрузке диалогового окна удаления базы данных.
- Исправлена проблема, которая могла возникать при попытке просмотра секций в модели с уровнем совместимости 1400, содержащей определения SQL-запросов и M-секций.

**Integration Services (IS)**
- Исправлена проблема, из-за которой не могли отображаться отчеты о выполнении для каталога базы данных SSIS.
- Исправлены проблемы в SSMS, связанные с низкой производительностью при работе с большим числом проектов или пакетов.

## <a name="downloadssdtmediadownloadpng-ssms-171httpsgomicrosoftcomfwlinklinkid849819"></a>![скачать](../ssdt/media/download.png) [SSMS 17.1](https://go.microsoft.com/fwlink/?linkid=849819)
Общедоступен | Номер сборки: 14.0.17119.0

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=849819&clcid=0x40a)

### <a name="enhancements"></a>Улучшения

- Профилировщик: Справка > В меню "О программе" теперь отображается номер версии выпуска (например, 17.1).
- Пользователи служб аналитики могут обновлять учетные данные для своих источников данных к моделям 1200 TM и выше в контекстном меню источника данных.
- Теперь во встроенных отчетах служб SSIS в CTP 2.1 отображаются журналы масштабированного выполнения SSIS.
- Приложение для управления масштабированием служб SSIS
  - Просмотр базовых сведений о мастере масштабирования.
  - Просто добавление рабочих ролей в масштабное развертывание.
  - Просмотр всех рабочих ролей масштабирования и основных сведений о них, а также простое включение и отключение этих ролей.

### <a name="bug-fixes"></a>Исправления ошибок
- Always On:
  - Исправлена ошибка, из-за которой свойства реплики доступности для групп доступности WSFC всегда отображались как режим "Автоматическая отработка отказа".
  - Исправлена ошибка, из-за которой список маршрутизации, доступный только для чтения, перезаписывался при обновлении группы доступности.
- Always Encrypted: исправлена проблема, из-за которой в создаваемом файле журнала отсутствовали данные, созданные DacFx.
- ShowPlan: исправлена ошибка, из-за которой для операторов неадаптивного соединения в пользовательском интерфейсе всегда отображался атрибут фактического типа соединения.
- Программа установки:
  - Исправлена ошибка, из-за которой SSMS 17.0 разрывал SSDT в Visual Studio 2013 [элемент Connect № 3133479].
  - Исправлена ошибка, из-за которой при нажатии кнопки перезапуска по завершении установки компьютер не перезапускался.
- Написание скриптов: проблему, из-за которой службы SSMS могли случайно удалять объекты базы данных SQL Azure при попытке создать скрипт удаления, можно решить, отключив соответствующий параметр.  В следующий выпуск служб SSMS будут внесены соответствующие исправления.
- Обозреватель объектов: исправлена проблема, из-за которой узел "Базы данных" не разворачивался при подключении к базе данных Azure, созданной с помощью команды копирования COPY AS.

## <a name="downloadssdtmediadownloadpng-ssms-170httpgomicrosoftcomfwlinklinkid847722"></a>![скачать](../ssdt/media/download.png) [SSMS 17.0](http://go.microsoft.com/fwlink/?LinkID=847722)
Общедоступен | Номер сборки: 14.0.17099.0

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=847722&clcid=0x40a)

### <a name="enhancements"></a>Улучшения 

- Пакет обновления и службы Windows Software Update Services (WSUS) будущие выпуски 17.x включают меньший накопительный пакет обновлений 
  - Пакет обновлений будет также опубликован в каталоге WSUS.  
- Обновления значком. Значки были обновлены и теперь соответствуют значкам, которые используются в оболочке Visual Studio, и поддерживают высокое разрешение. Новые значки для профилировщика и SSMS, позволяющие различать версии 16.х и 17.х.
- Модуль SQL PowerShell:
  - Модуль SQL Server PowerShell был удален из SSMS и теперь поставляется через коллекцию PowerShell (теперь для поддержки модуля управления версиями требуется PowerShell 5.0).
  - Добавлены различные улучшения в представлении (форматировании) некоторых объектов SMO (например, базы данных теперь отображаются с указанием размера и доступного пространства, а таблицы — количества строк и занимаемого места).
  - Добавлено выделение цветом при вызове командной строки PowerShell из меню обозревателя объектов "Запустить PowerShell".
  - добавлены параметры -ClusterType и -RequiredCopiesToCommit в командлеты AG (New-SqlAvailabilityGroup, Join-SqlAvailabilityGroup и Set-SqlAvailabilityGroup);
  - добавлены параметры -ActiveDirectoryAuthority и -AzureKeyVaultResourceId в командлет Add-SqlAzureAuthenticationContext.
  - Добавлены командлеты Revoke-SqlAvailabilityGroupCreateAnyDatabase, Grant-SqlAvailabilityGroupCreateAnyDatabase и Set-SqlAvailabilityReplicaRoleToSecondary.
  - Добавлен параметр SeedingMode для командлетов Set-SqlAvailabilityReplica и New-SqlAvailabilityReplica.
  - Добавлен параметр ConnectionString для командлета Get-SqlDatabase.
- Microsoft SQL Server на Linux. Общие улучшения и исправления для доставки журналов.
  - Добавлена поддержка собственных путей Linux для присоединения, восстановления и резервного копирования баз данных.
  - Добавлена поддержка собственных путей Linux для папки назначения журналов аудита.
- Службы Analysis Services
  - Окно "Запрос DAX":
    - Круглые скобки как в редакторе.
    - Поддержка синтаксиса DEFINE MEASURE и DEFINE VAR.
    - Различные усовершенствования технологии Intellisense.
  - Универсальная проверка подлинности.
    - Позволяет пользователям указать имя пользователя и не указать пароль, после чего подключение будет установлено в диалоговом окне входа в Azure.
  - Интеграция SSMS PQ: 
    - Возможность писать скрипты для структурированных источников данных. 
    - Просмотр и редактирование структурированных источников данных в пользовательском интерфейсе PQ.
- Новый шаблон "Добавить ограничение уникальности".
- Showplan. Отображение максимального показателя вместо суммы для потоков в окне свойств за затраченное время. Новые свойства операторов для предоставления памяти. Добавление кнопки изменения запроса в представлении динамической статистики запросов для выполнения с чередованием.
  - Новый параметр для функции"Анализ фактического плана выполнения".
  - Основные улучшения в работе функции "Сравнение элементов showplan"
  - Теперь функция "Сравнение элементов showplan" позволяет находить существенные различия при оценке кратности между соответствующими узлами двух планов запросов и предоставляет базовый анализ основных причин.
- Удален диспетчер конфигураций из обозревателя зарегистрированных серверов.
- Возможность чтения журналов аудита в хранилище BLOB-объектов Azure.
- Добавлена параметризация для Always Encrypted, дополнительные сведения см. на [этой странице](https://blogs.msdn.microsoft.com/sqlsecurity/2016/12/13/parameterization-for-always-encrypted-using-ssms-to-insert-into-update-and-filter-by-encrypted-columns/). 
- Универсальное подключение к базе данных SQL Azure для проверки подлинности AAD теперь поддерживает пользовательский идентификатор клиента. 
- Создание скриптов для базы данных SQL Azure: теперь поддерживаются создание скриптов полнотекстовых функций, правил и базы данных.
- Исправления фирменной символики на экранах-заставках для SSMS и профилировщика.
- Из SSMS удален пользовательский интерфейс точки управления служебной программой.
- Теперь SSMS может создавать базы данных SQL Azure версии "PremiumRS".
- Группы доступности AlwaysOn
  - Добавлена поддержка новых типов кластеров: EXTERTAL и NONE. Добавлена поддержка SQL Server для Linux. Добавлено автоматическое заполнение как альтернатива начальной синхронизации данных. Исправлены некоторые дефекты, например в обработке конечной точки URL-адресов, обновлении баз данных и макете пользовательского интерфейса. Удалены функции, связанные с репликой Azure.
  - Улучшена работа технологии IntelliSense с несколькими ключевыми словами для группы доступности.
- Монитор активности
  - В окне вывода SSMS добавлена новая панель "Монитор активности".
  - Сообщение об ошибке или окончании времени ожидания подключения к журналу сведений теперь отображается в окне результатов, а не во всплывающем сообщении.
  - Удалена пустая (пятая) диаграмма в разделе общих сведений.
  - Теперь в случае приостановки сбора данных монитором активности в заголовок окна обзор добавляется слово "(приостановлено)".
  - Улучшения в графах SQL Server. Новые значки для узла графов и краевых таблиц.Узел графов и краевые таблицы теперь отображаются в папке "Таблицы графов". Появились шаблоны для создания узла графов и краевых таблиц.
- Режим представления. 3 новых задачи, вызываемых с помощью быстрого запуска (CTRL+Q). PresentOn — включение режима представления. PresentEdit — изменение размеров шрифта для режима представления.  "Шрифт текстового редактора" для редактора запросов  и "Шрифт среды" для других компонентов;
RestoreDefaultFonts — восстановление настроек по умолчанию.
*(Примечание. В настоящее время команда PresentOff недоступна.  Используйте RestoreDefaultFonts для отключения режима представления.)*

### <a name="bug-fixes"></a>Исправления ошибок

- Исправлена ошибка, из-за которой прокручивание snowplan с помощью тачпада Surface Book вызывало аварийное завершение SSMS.
- Исправлена ошибка, из-за которой SSMS зависал при получении свойств базы данных, которая в этот момент находилась в процессе восстановления или в автономном режиме. 
- Исправлена ошибка, из-за которой "Средство просмотра справки" не открывалось в сборках RC.
- Исправлена ошибка, из-за которой в SSMS на панели инструментов "Задачи плана обслуживания" могли отсутствовать элементы.
- Исправлена ошибка SSMS, из-за которой пользователь не мог сжимать базу данных, если ее имя данных содержало фигурные скобки. [Элемент Connect](https://connect.microsoft.com/SQLServer/feedback/details/3122618)
- Исправлена ошибка, из-за которой попытка создать скрипт удаления базы данных Azure в SSMS приводила к удалению этой базы данных. [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3131458/)
- Исправлена ошибка, когда значения по умолчанию не были включены для определяемых пользователем типов таблиц. [Элемент Connect](https://connect.microsoft.com/SQLServer/feedback/details/3119027)
- Дополнительные улучшения производительности контекстного меню индексов. [Элемент Connect](https://connect.microsoft.com/SQLServer/feedback/details/3120783)
- Исправлена ошибка, которая вызывала излишнее мерцание при наведении мыши на отсутствующий индекс в плане выполнения. [Элемент Connect](https://connect.microsoft.com/SQLServer/feedback/details/3118510)
- Исправлена ошибка перевода базы данных в SSMS в автономный режим при создании скрипта. [Элемент Connect](https://connect.microsoft.com/SQLServer/feedback/details/3118550)
- Различные исправления элементов интерфейса в локализованных версиях SSMS (не на английском языке).
- Исправлена ошибка, когда узел "Ключи Always Encrypted" отсутствовал при использовании SQL 2016 SP1 Standard.
- Always Encrypted. Меню Always Encrypted было неправильно включено при использовании SQL 2016 RTM Standard или любых других серверов SQL 2014 и более ранних. Исправлена ошибка, при которой IntelliSense выдавала сообщение об ошибке при использовании синтаксиса CREATE или ALTER. Исправлена ошибка сбоев шифрования в случаях, когда CMK и CEK содержали знаки, которые должны быть экранированы (заключены в скобки). При возникновении исключения нехватки памяти в SSMS пользователь получает уведомление об ошибке. Ему предлагается использовать исходную (64-разрядную) версию PowerShell.
Исправлена ошибка сбоя мастера Always Encrypted в случаях, если пользователь использовал вместо классической подписки Azure подписку Resource Manager (для групп ресурсов). Исправлена ошибка, когда мастер Always Encrypted отображал недопустимую ошибку в случаях, если у пользователя отсутствовали разрешения в подписках или ни в одной из них не содержались хранилища ключей Azure.
Исправлена ошибка в мастере Always Encrypted, когда страница входа в Azure Key Vault не отображала подписки Azure при наличии нескольких каталогов Azure Active Directory. Исправлена ошибка в мастере Always Encrypted, когда страница входа в Azure Key Vault не отображала подписки Azure, для которых у пользователя есть разрешения читателя.
  - Исправлена ошибка, из-за которой файлы ресурсов могли загружаться неправильно, а в результате выдавались ложные сообщения об ошибках.
- Улучшена контрастность гиперссылок на странице параметров SSMS.
- Исправлена ошибка, когда узлы PolyBase не отображаются при подключении к SQL Server Express 2016 с пакетом обновления 1 (SP1).
- Исправлена ошибка, из-за которой SSMS не могла изменить уровень совместимости базы данных Azure на версию 140.
- Повышена производительность обозревателя объектов при развертывании списка баз данных Azure. [Элемент Connect](https://connect.microsoft.com/SQLServer/feedback/details/3100675)
- Исправлена ошибка некорректного появления элемента контекстного меню "Просмотр журнала SQL Server" для нереляционных типов сервера (AS, RS, IS). 
- Исправлена ошибка, при которой проверка синтаксиса запроса к секциям Analysis Services с помощью аутентификации SQL могла привести к получению уведомления об ошибке входа.
- Исправлена ошибка, когда переименование предварительной версии табличной модели AS с уровнем совместимости 1400 завершалось сбоями в SSMS.
- Исправлена ошибка "сбой операции в модели", которая в редких случаях могла возникать из-за выполнения недопустимых операций на AS-сервере. Отмените локальные изменения после неудачного сохранения модели.
- Исправлена опечатка во всплывающем диалоге синхронизации базы данных Analysis Services.
- Диалоговые окна резервного копирования и восстановления контейнеров появляются вне экрана для конфигурации с несколькими мониторами. 
- Происходит сбой создания SecurityPolicy, если в имени целевого объекта содержится символ "]".
- В меню "Открыть последние" SSMS 2016 не отображаются недавно сохраненные файлы. [Элемент Connect](https://connect.microsoft.com/SQLServer/feedback/details/3113288/ssms-2016-open-recent-menu-doesnt-show-recently-saved-files)
- Сброс параметров пользователя при обновлении оболочки VS теперь не выполняется.
- Исправлена ошибка, из-за которой пользователь не мог изменить уровень совместимости базы данных в SQL 2017.
- В окне запроса, в котором используется универсальная проверка подлинности AAD, нельзя обновить запрос через час.
- Из SSMS удален пользовательский интерфейс точки управления служебной программой.
- В подключениях для универсальной проверки подлинности AD не удается выполнить запрос для получения данных после истечения срока действия первоначального маркера.
- Не удается применить в сценарии правила от одной базы данных SQL Azure к другой базе данных SQL Azure.
- Исправлена ошибка, при которой модулю PowerShell не удавалось подключиться к экземплярам SQL предыдущих версий (2014 и более ранних версий). [Элемент Connect](https://connect.microsoft.com/SQLServer/feedback/details/1138754/sql-server-sqlps-powershell-module-fails-connection-to-sql-2012-instance)
- Исправлена ошибка, которая вызывала аварийное завершение работы SSMS при сбое импорта зарегистрированных серверов.
- Исправлена ошибка, которая вызывала аварийное завершение работы SSMS при наличии у пользователя определенных разрешений для базы данных. 
- SSMS — таблицы исчезают из области конструктора при обновлении представления. [Элемент Connect](https://connect.microsoft.com/SQLServer/feedback/details/2946125/ssms-tables-disappears-from-design-surface-while-reviewing-views) 
- Содержимое таблицы невозможно прокрутить с помощью полосы прокрутки таблицы; это можно сделать только с помощью стрелок вверх или вниз. Содержимое таблицы можно прокрутить, сначала попробовав прокрутить его с помощью полосы прокрутки. Это является ошибкой. [Элемент Connect](
http://connect.microsoft.com/SQLServer/feedback/details/3106561/sql-server-manager-2016-bug-in-design-view) 
- Значки для зарегистрированных серверов не отображаются после обновления корневого узла.
- При нажатии кнопки "Скрипт" в разделе "Создание базы данных" на серверах Azure версии 12 скрипт запускается, после чего отображается сообщение "Нет действий для включения в скрипт".
- Вкладка "Дополнительные свойства" в диалоговом окне "Подключение SSMS к серверу" не очищается при каждом новом подключении.
- Скрипт "Создание задач" не создает скрипты создания баз данных для базы данных SQL Azure.
- Полосы прокрутки в конструкторе представлений недоступны.
- Пути к ключам AVK Always Encrypted не содержат идентификаторы версий.
- Уменьшено количество запросов на изменение механизма в окне запросов. [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3113387)
- Ошибки Always Encrypted из-за обновления модулей после шифрования обрабатываются неправильно.
- Время ожидания подключения по умолчанию для OLTP и OLAP изменено с 15 на 30 секунд для исправления ошибок вида "Подключение игнорируется". 
- Исправлен сбой в SSMS при запуске пользовательского отчета. [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3118856)
- Устранена проблема, из-за которой операция "Сформировать скрипт…" завершалась ошибкой для баз данных SQL Azure.
- Исправлены ошибки в разделах "Создать скрипт как" и "Мастер создания скриптов", которые приводили к добавлению лишних новых строк при создании таких объектов, как хранимые процедуры. [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3115850)
- Поставщик SQLAS PowerShell: добавлено свойство LastProcessed в папки Dimension и MeasureGroup. [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3111879)
- Статистика активных запросов: исправлена ошибка, при которой отображается только первый запрос в пакете. [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3114221)  
- Showplan: отображение максимального показателя вместо суммы для потоков в окне свойств.
- Хранилище запросов: добавлен новый отчет для запросов с большой переменчивостью при выполнении.
- Проблемы производительности обозревателя объектов: [элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3114074). Контекстное меню таблиц ненадолго зависает. SSMS замедляет работу при щелчке индекса таблицы правой кнопкой мыши (при работе через удаленное подключение в Интернете). Избегайте выполнения табличных запросов с сортировкой на сервере.
- Мастер развертывания Azure (развертывание базы данных на виртуальной машине Azure) удален из SSMS.
- Исправлена ошибка, при которой отсутствующие индексы не отображались в планах выполнения в SSMS [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3114194).
- Исправлена распространенная ошибка, вызывающая аварийное завершение работы при закрытии SSMS.
- Исправлена ошибка в обозревателе объектов при открытии контекстного меню для узлов PolyBase | Масштабируемая группа [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3115128).
- Исправлена ошибка, вызывающая аварийное завершение работы SSMS при попытке отображения разрешений для базы данных.
- Хранилище запросов: общие улучшения в контекстных меню для сеток результатов в отчете хранилища запросов.
- Настройка Always Encrypted для существующей таблицы завершается с ошибками, в которых указаны посторонние объекты. [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3103181)
- Настройка Always Encrypted для существующей базы данных с несколькими схемами не работает. [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3109591)
- Мастер зашифрованного столбца в Always Encrypted завершается с ошибкой из-за того, что база данных содержит представления, ссылающиеся на системные представления. [Элемент Connect](http://connect.microsoft.com/SQLServer/feedback/details/3111925)
- При шифровании с помощью Always Encrypted ошибки из-за обновления модулей после шифрования обрабатываются неправильно.
- Исправлена ошибка усечения пользовательского интерфейса в диалоговом окне "Регистрация нового сервера".
- Исправлено условие в пользовательском интерфейсе DMF, которое вызывало неправильное обновление выражений, содержащих константные строковые значения с кавычками.
- Устранена проблема, которая могла привести к сбою SSMS при запуске пользовательских отчетов.
- Добавлен пункт меню "Выполнение в масштабированной конфигурации..." для узла папки.
- Исправлена ошибка с функцией белого списка IP-адресов в брандмауэре баз данных SQL.
- Исправлена ошибка SSMS, из-за которой ссылка на объект не вызывала исключение при редактировании источника многомерного раздела AS.
- Исправлена ошибка SSMS, из-за которой ссылка на объект не вызывала исключение при удалении пользовательской сборки из многомерного сервера AS.
- Исправлена ошибка, которая вызывала сбой при переименовании табличной базы данных 1400.
- Исправлена ошибка с созданием скриптов для табличных источников данных с уровнем совместимости 1400 из диалогового окна свойств соединения.
- Удалено допущение о том, что таблицы в модели с уровнем совместимости 1400 включают как минимум один раздел.
- Теперь сочетание клавиш CTRL+R переключает область результатов в редакторе запросов среды SSMS DAX.


## <a name="downloadssdtmediadownloadpng-ssms-1653httpgomicrosoftcomfwlinklinkid840946"></a>![скачать](../ssdt/media/download.png) [SSMS 16.5.3](http://go.microsoft.com/fwlink/?LinkID=840946)
Общедоступная версия | Номер сборки: 13.0.16106.4

[Китайский (упрощенное письмо)](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x804) | [Китайский (традиционное письмо)](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x404) | [Английский (США)](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x409) | [Французский](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x40c) | [Немецкий](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x407) | [Итальянский](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x410) | [Японский](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x411) | [Корейский](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x412) | [Португальский (Бразилия)](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x416) | [Русский](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x419) | [Испанский](https://go.microsoft.com/fwlink/?linkid=840946&clcid=0x40a)

В этом выпуске были решены следующие проблемы.

* Устранена проблема, появившаяся в SSMS 16.5.2. Эта проблема приводила к раскрытию узла "Таблица", если в таблице было несколько разреженных столбцов.

* Пользователи могут развертывать пакеты SSIS, содержащие диспетчер подключений OData, который используется для подключения ресурса Microsoft Dynamics AX или CRM Online к каталогу SSIS. Дополнительные сведения см. в разделе [Диспетчер соединений OData](../integration-services/connection-manager/odata-connection-manager.md).

* Настройка Always Encrypted для существующей таблицы завершается с ошибками, в которых указаны посторонние объекты. [Идентификатор Connect 3103181](https://connect.microsoft.com/SQLServer/feedback/details/3103181/setting-up-always-encrypted-on-an-existing-table-fails-with-errors-on-unrelated-objects)

* Настройка Always Encrypted для существующей базы данных с несколькими схемами не работает. [Идентификатор Connect 3109591](https://connect.microsoft.com/SQLServer/feedback/details/3109591/sql-server-2016-always-encrypted-against-existing-database-with-multiple-schemas-doesnt-work)

* Мастер зашифрованного столбца в Always Encrypted завершается с ошибкой из-за того, что база данных содержит представления, ссылающиеся на системные представления. [Идентификатор Connect 3111925](https://connect.microsoft.com/SQLServer/feedback/details/3111925/sql-server-2016-always-encrypted-encrypted-column-wizard-failed-task-failed-due-to-following-error-cannot-save-package-to-file-the-model-has-build-blocking-errors)

* При шифровании с помощью Always Encrypted ошибки из-за обновления модулей после шифрования обрабатываются неправильно.

* В меню *Открыть последние* не отображаются недавно сохраненные файлы. [Идентификатор Connect 3113288](https://connect.microsoft.com/SQLServer/feedback/details/3113288/ssms-2016-open-recent-menu-doesnt-show-recently-saved-files)

* SSMS замедляет работу при щелчке таблицы правой кнопкой мыши (при работе через удаленное подключение в Интернете). [Идентификатор Connect 3114074](https://connect.microsoft.com/SQLServer/feedback/details/3114074/ssms-slow-when-right-clicking-an-index-for-a-table-over-a-remote-internet-connection)
 
* Устранена проблема с полосой прокрутки конструктора SQL. [Идентификатор Connect 3114856](http://connect.microsoft.com/SQLServer/feedback/details/3114856/bug-in-scrollbar-on-sql-desginer-in-ssms-2016)

* Контекстное меню таблиц ненадолго зависает. 
 
* SSMS иногда выдает исключения в мониторе активности и завершает работу с ошибкой. [Идентификатор Connect 697527](https://connect.microsoft.com/SQLServer/feedback/details/697527/)

* SSMS 2016 аварийно завершает работу с ошибкой "Процесс был завершен из-за внутренней ошибки в среде выполнения .NET: IP 71AF8579 (71AE0000), код выхода 80131506"


## <a name="uninstall-and-reinstall-ssms-17x"></a>Удаление и повторная установка SSMS 17.x

Если в SSMS возникают проблемы, которые не удается устранить посредством удаления и повторной установки, попробуйте [восстановить](https://support.microsoft.com/help/4028054/windows-10-repair-or-remove-programs) Visual Studio 2015 IsoShell. Если восстановление Visual Studio 2015 IsoShell не помогло решить проблему, выполните следующие действия, которые помогут устранить ряд различных проблем:

1.  Удалите SSMS так же, как обычное приложение (в разделе *Приложения и компоненты*, *Программы и компоненты* и т. п. в зависимости от вашей версии Windows).

2.  Удалите Visual Studio 2015 IsoShell **из командной строки с повышенными привилегиями**:
   
    ```PUSHD "C:\ProgramData\Package Cache\FE948F0DAB52EB8CB5A740A77D8934B9E1A8E301\redist"```

    ```vs_isoshell.exe /Uninstall /Force /PromptRestart```

3.  Удалите распространяемый пакет Microsoft Visual C++ 2015 так же, как обычное приложение. Если на вашем компьютере есть обе версии x86 и x64, удалите их.

4.  Повторно установите Visual Studio 2015 IsoShell **из командной строки с повышенными привилегиями**:  

    ```PUSHD "C:\ProgramData\Package Cache\FE948F0DAB52EB8CB5A740A77D8934B9E1A8E301\redist"```  
 
    ```vs_isoshell.exe /PromptRestart```

5.  Повторно установите SSMS.

6.  [Обновите распространяемый пакет Visual C++ 2015 до последней версии](https://support.microsoft.com/help/2977003/the-latest-supported-visual-c-downloads), если он не обновлен.


## <a name="additional-downloads"></a>Дополнительные скачиваемые файлы  
Список всех загрузок для SQL Server Management Studio см. в [центре загрузки Майкрософт](https://www.microsoft.com/en-us/download/search.aspx?q=sql%20server%20management%20studio&p=0&r=10&t=&s=Relevancy~Descending).  
  
Чтобы получить последнюю версию среды SQL Server Management Studio, перейдите на страницу [Скачивание SQL Server Management Studio (SSMS)](../ssms/download-sql-server-management-studio-ssms.md).  
