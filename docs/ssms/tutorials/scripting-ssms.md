---
title: Руководство. Создание скриптов для объектов в среде SQL Server Management Studio
description: Учебник по созданию скриптов для объектов в SSMS
keywords: SQL Server, SSMS, SQL Server Management Studio, скрипты, написание скриптов
author: MashaMSFT
ms.author: mathoma
ms.date: 03/13/2018
ms.topic: tutorial
ms.prod: sql
ms.technology: ssms
ms.prod_service: sql-tools
ms.reviewer: sstein
helpviewer_keywords:
- projects [SQL Server Management Studio], tutorials
- source controls [SQL Server Management Studio], tutorials
- Help [SQL Server], SQL Server Management Studio
- tutorials [SQL Server Management Studio]
- Transact-SQL tutorials
- solutions [SQL Server Management Studio], tutorials
- SQL Server Management Studio [SQL Server], tutorials
- scripts [SQL Server], SQL Server Management Studio
ms.openlocfilehash: 36d3b90a9ac1e49af564323c86421216216522a9
ms.sourcegitcommit: d65cef35cdf992297496095d3ad76e3c18c9794a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/28/2019
ms.locfileid: "72988419"
---
# <a name="script-objects-in-sql-server-management-studio"></a>Создание скриптов для объектов в среде SQL Server Management Studio

В этом учебнике вы научитесь создавать скрипты Transact-SQL (T-SQL) для различных объектов, доступных в SQL Server Management Studio (SSMS). В нем приводятся примеры создания скриптов для следующих объектов:

> [!div class="checklist"]
> * запросов при выполнении действий в графическом пользовательском интерфейсе;
> * баз данных двумя разными способами ("Сформировать скрипт как" и "Создать скрипт");
> * Таблицы
> * Хранимые процедуры
> * Расширенные события

Чтобы создать скрипт любого объекта в **обозревателе объектов**, щелкните его правой кнопкой мыши и выберите команду **Создать скрипт объекта как**. В этом учебнике будет показан процесс.

## <a name="prerequisites"></a>предварительные требования

Для работы с этим учебником требуется среда SQL Server Management Studio, доступ к серверу SQL Server и база данных AdventureWorks.

* Установите [SQL Server Management Studio](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms).
* Установите выпуск [SQL Server 2017 Developer Edition](https://www.microsoft.com/sql-server/sql-server-downloads).
* Скачайте [образцы баз данных AdventureWorks2016](https://github.com/Microsoft/sql-server-samples/releases).

См. инструкции по восстановлению резервной копии базы данных с помощью SSMS см. в статье: [Восстановление базы данных](https://docs.microsoft.com/sql/relational-databases/backup-restore/restore-a-database-backup-using-ssms). 

## <a name="script-queries-from-the-gui"></a>Создание скриптов для запросов в графическом пользовательском интерфейсе

Вы можете создать связанный код T-SQL для задачи в графическом пользовательском интерфейсе SSMS, чтобы выполнить его. Ниже приведены примеры выполнения этого действия при резервном копировании базы данных и сжатии журнала транзакций. Аналогичные инструкции применимы к любому действию, выполняемому в графическом пользовательском интерфейсе.

### <a name="script-t-sql-when-you-back-up-a-database"></a>Создание скрипта T-SQL при резервном копировании базы данных

1. Подключитесь к серверу SQL Server.

2. Разверните узел **Базы данных** .

3. Щелкните правой кнопкой мыши базу данных **Adventureworks2016** и последовательно выберите пункты  > **Задачи** > **Резервное копирование**:

    ![Резервное копирование базы данных](media/scripting-ssms/backupdb.png)

4. Настройте резервное копирование требуемым образом. В этом учебнике оставлены все параметры по умолчанию. Все изменения, внесенные в этом окне, также отражаются в скрипте. 

5. Выберите пункты **Создать скрипт** > **Добавить скрипт в новое окно запроса**:

    ![Создание скрипта резервного копирования базы данных — добавление скрипта](media/scripting-ssms/scriptdbbackup.PNG)
6. Просмотрите код T-SQL в окне запроса.

    ![Создание скрипта резервного копирования базы данных — просмотр кода T-SQL](media/scripting-ssms/dbbackupscript.PNG)
7. Выберите команду **Выполнить**, чтобы выполнить запрос на резервное копирование базы данных с помощью T-SQL. 

### <a name="script-t-sql-when-you-shrink-the-transaction-log"></a>Создание скрипта T-SQL при сжатии журнала транзакций

1. Щелкните правой кнопкой мыши базу данных **Adventureworks2016** и последовательно выберите пункты  > **Задачи** > **Сжать** > **Файлы**:

     ![Сжатие файлов](media/scripting-ssms/shrinkfiles.png)

2. Выберите **Журнал** в раскрывающемся списке **Тип файла**:

    ![Сжатие журнала транзакций](media/scripting-ssms/shrinktlog.png)

3. Выберите пункты **Скрипт** и **Добавить скрипт в буфер обмена**:

    ![Вывести скрипт в буфер обмена](media/scripting-ssms/scriptactiontoclipboard.png)

4. Откройте окно **Новый запрос** и вставьте скрипт. (Щелкните правой кнопкой мыши в окне. Выберите команду **Вставить**.)

    ![Вставка скрипта](media/scripting-ssms/paste.png)

5. Выберите команду **Выполнить**, чтобы выполнить запрос и сжать журнал транзакций.

## <a name="script-databases"></a>Создание скриптов для баз данных

В следующем разделе показано, как создать скрипт для базы данных с помощью команды **Создать скрипт как** или **Создать скрипты**. Команда **Создать скрипт как** повторно создает базу данных и ее параметры конфигурации. Команда **Создать скрипты** позволит создать скрипт для схемы и данных. В этом разделе вы сможете создать две новых базы данных. Для создания *AdventureWorks2016a* используется команда **Создать скрипт как**. Для создания *AdventureWorks2016b* используется команда **Создать скрипты**.

### <a name="script-a-database-by-using-the-script-option"></a>Создание скрипта базы данных с помощью команды "Создать скрипт"

1. Подключитесь к серверу SQL Server.

2. Разверните узел **Базы данных** .

3. Щелкните правой кнопкой мыши базу данных **AdventureWorks2016** и последовательно выберите пункты  > **Создать скрипт базы данных как** > **Создать в** > **Новое окно редактора запросов**:

    ![Создание скрипта базы данных](media/scripting-ssms/scriptdb.png)

4. Просмотрите запрос на создание базы данных в окне:

    ![Созданный скрипт для базы данных](media/scripting-ssms/scriptedoutdb.png). Этот параметр создает скрипт только параметров конфигурации базы данных.

5. Нажмите клавиши CTRL+F, чтобы открыть диалоговое окно **Найти**. Щелкните стрелку вниз, чтобы открыть пункт **Заменить**. Вверху, в строке **Найти**, введите AdventureWorks2016, а внизу, в строке **Заменить**, введите AdventureWorks2016a.

6. Выберите **Заменить все**, чтобы заменить все значения *AdventureWorks2016* на *AdventureWorks2016a*. 

    ![Поиск и замена](media/scripting-ssms/findandreplace.png)

7. Выберите команду **Выполнить**, чтобы выполнить запрос и создать базу данных AdventureWorks2016a. 

### <a name="script-a-database-by-using-the-generate-scripts-option"></a>Создание скрипта базы данных с помощью команды "Создать скрипты"

1. Подключитесь к серверу SQL Server.

2. Разверните узел **Базы данных** .

3. Щелкните правой кнопкой мыши **AdventureWorks2016** и последовательно выберите пункты  > **Задачи** > **Создать скрипты**:

    ![Создание скриптов для баз данных](media/scripting-ssms/generatescriptsfordb.png)

4. Откроется страница **Введение**. Нажмите кнопку **Далее**, чтобы открыть страницу **Выбор объектов**. Вы можете выбрать всю базу данных или отдельные объекты в базе данных. Выберите **Внести в скрипт всю базу данных целиком вместе со всеми объектами**.

    ![Создание скриптов для объектов](media/scripting-ssms/scriptobjects.png)

5. Нажмите кнопку **Далее**, чтобы открыть страницу **Задание параметров скриптов**. Здесь вы можете настроить расположение для сохранения скрипта и другие дополнительные параметры. 

    A. Выберите команду **Сохранить в новом окне запроса**.

    Б. Выберите пункт **Дополнительно** и убедитесь, что заданы следующие значения параметров:

      * параметр **Статистика скриптов** имеет значение *Статистика скриптов*;
      * параметр **Типы данных для создания скриптов** имеет значение *Только схема*;
      * параметр **Индексы скриптов** имеет значение *True*.

   ![Объекты скриптов](media/scripting-ssms/advancedscripts.png)

   > [!NOTE]
   > Вы можете создать скрипт данных для базы данных при выборе варианта *Схема и данные* для параметра **Типы данных для создания скриптов**. Однако это не подходит для крупных баз данных. Может потребоваться больше памяти, чем SSMS может выделить. Это ограничение не влияет на небольшие базы данных. Если вы хотите переместить данные в более крупную базу данных, используйте [мастер импорта и экспорта](https://docs.microsoft.com/sql/integration-services/import-export-data/import-and-export-data-with-the-sql-server-import-and-export-wizard).

6. Нажмите кнопку **ОК**, а затем кнопку **Далее**.

7. Нажмите кнопку **Далее** на странице **Сводка**. После нажмите кнопку **Далее** еще раз, чтобы создать скрипт в окне **Новый запрос**.

8. Откройте диалоговое окно **Найти** (CTRL+F). Щелкните стрелку вниз, чтобы открыть пункт **Заменить**. Вверху, в строке **Найти**, введите *AdventureWorks2016*. Внизу, в строке **Заменить**, введите *AdventureWorks2016b*.

9. Выберите **Заменить все**, чтобы заменить все значения *AdventureWorks2016* на *AdventureWorks2016b*.

    ![AdventureWorks2016b](media/scripting-ssms/adventureworks2016b.png)

10. Выберите команду **Выполнить**, чтобы выполнить запрос и создать базу данных AdventureWorks2016b.

## <a name="script-tables"></a>Создание скриптов для таблиц

В этом разделе описывается, как создать скрипты для таблиц базы данных. С помощью этого параметра вы можете создать таблицу или удалить ее, а затем создать. Он также позволяет создать скрипт T-SQL, связанный с изменением таблицы: вставкой или обновлением. В этом разделе вы сможете удалить таблицу, а затем создать ее. 

1. Подключитесь к серверу SQL Server.

2. Разверните узел **Базы данных**.

3. Разверните узел базы данных **AdventureWorks2016**. 

4. Разверните узел **Таблицы**.

5. Щелкните правой кнопкой мыши **dbo.ErrorLog** и последовательно выберите пункты  > **Создать скрипт таблицы как** > **Удалить и создать в** > **Новое окно редактора запросов**:

    ![Создание скрипта для таблицы](media/scripting-ssms/scripttable.png)

6. Выберите команду **Выполнить**, чтобы выполнить запрос. Это действие удаляет таблицу *Errorlog* и повторно создает ее. 

    >[!NOTE]
    > Таблица *Errorlog* в базе данных AdventureWorks2016 по умолчанию пуста. Вы не потеряете данные, если удалите ее. Однако если в таблице есть данные, при выполнении этих действий они будут потеряны.

## <a name="script-stored-procedures"></a>Создание скриптов для хранимых процедур

В этом разделе вы узнаете, как удалить и создать хранимую процедуру.  

1. Подключитесь к серверу SQL Server.

2. Разверните узел **Базы данных**.

3. Разверните узел **Программируемость**. 

4. Разверните узел **Хранимые процедуры**.

5. Щелкните правой кнопкой мыши хранимую процедуру **dbo.uspGetBillOfMaterials** и последовательно выберите пункты  > **Создать скрипт хранимой процедуры как** > **Удалить и создать в** > **Новое окно редактора запросов**:

    ![Создание скриптов для хранимых процедур](media/scripting-ssms/scriptstoredprocedure.PNG)

## <a name="script-extended-events"></a>Создание скриптов для расширенных событий

В этом разделе описывается, как создать скрипты для [расширенных событий](https://docs.microsoft.com/sql/relational-databases/extended-events/extended-events).

1. Подключитесь к серверу SQL Server.

2. Разверните узел **Управление**.

3. Разверните узел **Расширенные события**.

4. Разверните узел **Сеансы**.

5. Щелкните правой кнопкой мыши нужный расширенный сеанс и выберите пункты **Создать скрипт для сеанса** > **СОЗДАТЬ в** > **Новое окно редактора запросов**:

    ![Расширенный сеанс нового окна редактора запросов](media/scripting-ssms/scriptxevents.png)

6. В **новом окне редактора запросов** измените имя сеанса с *system_health* на *system_health2*. Выберите команду **Выполнить**, чтобы выполнить запрос.

7. Щелкните правой кнопкой мыши **Сеансы** в **обозревателе объектов**. Выберите команду **Обновить**, чтобы увидеть новый сеанс расширенного события. Зеленый значок рядом с сеансом означает, что сеанс выполняется. Красный значок указывает, что сеанс остановлен.

    ![Новый сеанс расширенного события](media/scripting-ssms/newxevent.png)

    >[!NOTE]
    > Вы можете запустить сеанс, щелкнув его правой кнопкой мыши и выбрав команду **Запустить**. Так как это копия уже запущенного сеанса **system_health**, этот шаг можно пропустить. Вы можете удалить копию расширенного сеанса события, щелкнув его правой кнопкой мыши и выбрав команду **Удалить**.

## <a name="next-steps"></a>Дальнейшие действия

Лучший способ познакомиться с SSMS — это поработать в среде самостоятельно. Эти *руководства* и *статьи* помогут вам ознакомиться с различными функциями SSMS. С их помощью вы научитесь работать с компонентами SSMS и легко находить регулярно используемые функции.

* [Подключение к экземпляру и отправка запросов к нему](connect-query-sql-server.md)
* [Использование шаблонов в SSMS](../template/templates-ssms.md)
* [Конфигурация SSMS](ssms-configuration.md)
* [Дополнительные советы и рекомендации по использованию SSMS](ssms-tricks.md)
