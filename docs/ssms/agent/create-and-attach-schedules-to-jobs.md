---
title: Создание и присоединение расписаний к заданиям | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: sql-tools
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- jobs [SQL Server]
- scheduling jobs [SQL Server]
- jobs [SQL Server], scheduling
- CPU [SQL Server], idle conditions
- automatic job processing
- SQL Server Agent jobs, scheduling
- idle time [SQL Server]
ms.assetid: 079c2984-0052-4a37-a2b8-4ece56e6b6b5
author: markingmyname
ms.author: maghan
monikerRange: = azuresqldb-mi-current || >= sql-server-2016 || = sqlallproducts-allversions
ms.openlocfilehash: 2213390f252fdd07f1c8aacc6570940f759e7579
ms.sourcegitcommit: e7d921828e9eeac78e7ab96eb90996990c2405e9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/16/2019
ms.locfileid: "68267260"
---
# <a name="create-and-attach-schedules-to-jobs"></a>Создание и присоединение расписаний к заданиям
[!INCLUDE[appliesto-ss-asdbmi-xxxx-xxx-md](../../includes/appliesto-ss-asdbmi-xxxx-xxx-md.md)]

> [!IMPORTANT]  
> Сейчас в [управляемом экземпляре базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-managed-instance) поддерживается большинство функций агента SQL Server (но не все). Подробные сведения см. в статье [Различия T-SQL между управляемым экземпляром базы данных SQL Azure и SQL Server](https://docs.microsoft.com/azure/sql-database/sql-database-managed-instance-transact-sql-information#sql-server-agent).

Планирование заданий агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] предполагает определение условия или условий, при которых выполнение задания должно начаться без вмешательства пользователя. Можно запланировать автоматическое выполнение задания, создав новое расписание для задания или присоединив к нему существующее расписание.  
  
Существуют следующие два способа создания расписания.  
  
-   Создание расписания во время создания задания.  
  
-   Создание расписания в обозревателе объектов.  
  
После создания расписания его можно присоединить к нескольким заданиям, даже если оно было создано для конкретного задания. Можно также отсоединять расписания от заданий.  
  
Расписание может быть основано на времени или на событии. Например, можно спланировать выполнение задания при следующих условиях:  
  
-   При каждом запуске агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
-   каждый раз, когда использование ЦП компьютера будет достигать уровня, который определен как уровень простоя;  
  
-   однажды, в указанные дату и время;  
  
-   согласно повторяющемуся расписанию;  
  
В качестве альтернативы расписаниям заданий можно также создать предупреждение, отвечающее на событие выполнением задания.  
  
> [!NOTE]  
> Только один экземпляр задания может выполняться в один момент времени. При попытке вручную запустить выполнение задания в то время, как оно выполняется по расписанию, агент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ответит на требование отказом.  
  
Чтобы запретить выполнение запланированного задания, необходимо выполнить одно из следующих действий:  
  
-   отключить расписание;  
  
-   отключить задание;  
  
-   отсоединить расписание от задания;  
  
-   остановить службу агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ;  
  
-   удалить расписание.  
  
Если расписание не включено, задание все равно может выполняться в ответ на предупреждение или при запуске пользователем вручную. Когда расписание заданий не включено, оно выключено для всех заданий, использующих это расписание.  
  
Необходимо явно повторно включить расписание, которое было отключено. Изменение расписания не приводит к его автоматическому повторному включению.  
  
## <a name="scheduling-start-dates"></a>Планирование даты начала  
Дата начала расписания должна быть больше или равна 19900101.  
  
При присоединении расписания к заданию необходимо проверить дату выполнения, которую расписание будет использовать для первого запуска задания. Дата выполнения зависит от дня и времени присоединения расписания к заданию. Например, можно создать расписание, которое выполняется каждый второй понедельник в 8:00. Если задание создается в 10:00. в понедельник 3 марта 2008 г., то начальной датой расписания будет понедельник 17 марта 2008 г. Если во вторник 4 марта 2008 г. создается другое задание, начальной датой расписания будет понедельник 10 марта 2008 г.  
  
Начальную дату расписания можно изменить после его присоединения к заданию.  
  
## <a name="cpu-idle-schedules"></a>Расписания простоя ЦП  
Для максимально эффективного использования ресурсов ЦП можно определить условие простоя ЦП для агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Агент использует настройку условий простоя ЦП, чтобы определить наиболее подходящее время для выполнения заданий. Например, можно спланировать задание для перестройки индексов во время простоя ЦП и периодов невысокой загрузки.  
  
Прежде чем определить задания для выполнения во время простоя ЦП, определите загрузку ЦП во время нормальной обработки. Чтобы сделать это, используйте приложение [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] или системный монитор для контроля над рабочей нагрузкой сервера и сбора статистики. Затем можно использовать собранные сведения, чтобы установить процентную долю и продолжительность времени простоя ЦП.  
  
Определите условие простоя ЦП как процентную долю, ниже которой использование ЦП должно оставаться в течение указанного времени. Затем установите количество времени. Когда использование ЦП окажется ниже указанной процентной доли в течение указанного количества времени, агент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] запускает выполнение всех заданий, имеющих расписание для времени простоя ЦП. Дополнительные сведения об использовании приложения [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] или системного монитора для наблюдения за использованием ЦП см. в разделе [Контроль использования ЦП](../../relational-databases/performance-monitor/monitor-cpu-usage.md).  
  
## <a name="related-tasks"></a>Связанные задачи  
  
|||  
|-|-|  
|**Описание**|**Раздел**|  
|Описывает создание расписания для задания агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .|[Create a Schedule](../../ssms/agent/create-a-schedule.md)|  
|Описывает планирование задания агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .|[Планирование задания](../../ssms/agent/schedule-a-job.md)|  
|Описывает задание условия простоя ЦП для сервера.|[Установка времени и длительности простоя ЦП (среда SQL Server Management Studio)](../../ssms/agent/set-cpu-idle-time-and-duration-sql-server-management-studio.md)|  
  
## <a name="see-also"></a>См. также:  
[sp_help_jobschedule](../../relational-databases/system-stored-procedures/sp-help-jobschedule-transact-sql.md)  
[sysjobschedules](../../relational-databases/system-tables/dbo-sysjobschedules-transact-sql.md)  
  
